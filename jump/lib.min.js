var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(x,ea,p){x!=Array.prototype&&x!=Object.prototype&&(x[ea]=p.value)};$jscomp.getGlobal=function(x){return"undefined"!=typeof window&&window===x?x:"undefined"!=typeof global&&null!=global?global:x};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var x=0;return function(ea){return $jscomp.SYMBOL_PREFIX+(ea||"")+x++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var x=$jscomp.global.Symbol.iterator;x||(x=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[x]&&$jscomp.defineProperty(Array.prototype,x,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(x){var ea=0;return $jscomp.iteratorPrototype(function(){return ea<x.length?{done:!1,value:x[ea++]}:{done:!0}})};$jscomp.iteratorPrototype=function(x){$jscomp.initSymbolIterator();x={next:x};x[$jscomp.global.Symbol.iterator]=function(){return this};return x};
$jscomp.iteratorFromArray=function(x,ea){$jscomp.initSymbolIterator();x instanceof String&&(x+="");var p=0,n={next:function(){if(p<x.length){var f=p++;return{value:ea(f,x[f]),done:!1}}n.next=function(){return{done:!0,value:void 0}};return n.next()}};n[Symbol.iterator]=function(){return n};return n};
$jscomp.polyfill=function(x,ea,p,n){if(ea){p=$jscomp.global;x=x.split(".");for(n=0;n<x.length-1;n++){var f=x[n];f in p||(p[f]={});p=p[f]}x=x[x.length-1];n=p[x];ea=ea(n);ea!=n&&null!=ea&&$jscomp.defineProperty(p,x,{configurable:!0,writable:!0,value:ea})}};$jscomp.polyfill("Array.prototype.keys",function(x){return x?x:function(){return $jscomp.iteratorFromArray(this,function(x){return x})}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(x){return x?x:function(x,p,n){var f=this.length||0;0>p&&(p=Math.max(0,f+p));if(null==n||n>f)n=f;n=Number(n);0>n&&(n=Math.max(0,f+n));for(p=Number(p||0);p<n;p++)this[p]=x;return this}},"es6","es3");
$jscomp.checkStringArgs=function(x,ea,p){if(null==x)throw new TypeError("The 'this' value for String.prototype."+p+" must not be null or undefined");if(ea instanceof RegExp)throw new TypeError("First argument to String.prototype."+p+" must not be a regular expression");return x+""};
$jscomp.polyfill("String.prototype.startsWith",function(x){return x?x:function(x,p){var n=$jscomp.checkStringArgs(this,x,"startsWith");x+="";var f=n.length,ea=x.length;p=Math.max(0,Math.min(p|0,n.length));for(var xb=0;xb<ea&&p<f;)if(n[p++]!=x[xb++])return!1;return xb>=ea}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(x){return x?x:function(x,p){var n=$jscomp.checkStringArgs(this,x,"endsWith");x+="";void 0===p&&(p=n.length);p=Math.max(0,Math.min(p|0,n.length));for(var f=x.length;0<f&&0<p;)if(n[--p]!=x[--f])return!1;return 0>=f}},"es6","es3");
(function(x,ea){function p(a,b){function c(){}c.prototype=a;a=new c;for(var d in b)a[d]=b[d];b.toString!==Object.prototype.toString&&(a.toString=b.toString);return a}function n(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=ge++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}x.lovedna=x.lovedna||{};x.lovedna.game=x.lovedna.game||{};var f=
{},wb=function(){return H.__string_rec(this,"")},xb=function(a,b){this.r=new RegExp(a,b.split("u").join(""))};f.EReg=xb;xb.__name__=["EReg"];xb.prototype={replace:function(a,b){return a.replace(this.r,b)},__class__:xb};var Sb=function(){z.init("assets");this.game=new fb;new jd(this.game);this.game.color.set(0,0,0,0);this.game.onInit=n(this,this.onGameInit)};f.H5Game=Sb;Sb.__name__=["H5Game"];Sb.main=function(){new Sb};Sb.prototype={onGameInit:function(){z.init();z.loadMeta("version.data",n(this,this.onInit))},
onInit:function(){var a=new $a;this.game.addWorld(a);var b=new J;b.name="camera0";a.addChild(b);b.addComponent(ec).distance=150;var c=b.addComponent(gb);b.get_transform().position.set(200,100,200).scale(.5);b.get_transform().rotation.lookAt(b.get_transform().position,new k);b=new J;b.addComponent(Tb);a.addChild(b);b.get_transform().rotation.lookAt(new k(1,0,0),new k);b=new J;a=b.addComponent(fc);c.actor.get_transform().addChild(b.get_transform());b.get_transform().position.set(0,0,100);b=new J;c=
b.addComponent(Ta);c.width=1138;c.height=640;a.actor.get_transform().addChild(b.get_transform());b=new Ub;c.transform.addChild(b.get_transform());gameInit()},__class__:Sb};var B=function(){};f.HxOverrides=B;B.__name__=["HxOverrides"];B.cca=function(a,b){a=a.charCodeAt(b);return a!=a?kd.get_undefined():a};B.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};B.remove=function(a,b){b=a.indexOf(b);if(-1==b)return!1;a.splice(b,1);return!0};
B.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};Math.__name__=["Math"];var V=function(){};f.Reflect=V;V.__name__=["Reflect"];V.hasField=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};V.field=function(a,b){try{return a[b]}catch(c){return null}};V.getProperty=function(a,b){var c;if(null==a)return null;var d=a.__properties__?c=a.__properties__["get_"+b]:!1;return d?a[c]():a[b]};V.setProperty=function(a,
b,c){var d;var e=a.__properties__?d=a.__properties__["set_"+b]:!1;if(e)a[d](c);else a[b]=c};V.callMethod=function(a,b,c){return b.apply(a,c)};V.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b};V.deleteField=function(a,b){if(!V.hasField(a,b))return!1;delete a[b];return!0};var u=function(){};f.Std=u;u.__name__=["Std"];u.is=function(a,b){return H.__instanceof(a,b)};u.string=function(a){return H.__string_rec(a,
"")};u["int"]=function(a){return a|0};u.parseInt=function(a){var b=parseInt(a,10);0!=b||120!=B.cca(a,1)&&88!=B.cca(a,1)||(b=parseInt(a));return isNaN(b)?null:b};u.parseFloat=function(a){return parseFloat(a)};var gc=function(){this.b=""};f.StringBuf=gc;gc.__name__=["StringBuf"];gc.prototype={add:function(a){this.b+=u.string(a)},toString:function(){return this.b},__class__:gc};var P=function(){};f.StringTools=P;P.__name__=["StringTools"];P.startsWith=function(a,b){return a.length>=b.length?B.substr(a,
0,b.length)==b:!1};P.endsWith=function(a,b){var c=b.length,d=a.length;return d>=c?B.substr(a,d-c,c)==b:!1};P.isSpace=function(a,b){a=B.cca(a,b);return 8<a&&14>a?!0:32==a};P.ltrim=function(a){for(var b=a.length,c=0;c<b&&P.isSpace(a,c);)++c;return 0<c?B.substr(a,c,b-c):a};P.rtrim=function(a){for(var b=a.length,c=0;c<b&&P.isSpace(a,b-c-1);)++c;return 0<c?B.substr(a,0,b-c):a};P.trim=function(a){return P.ltrim(P.rtrim(a))};P.replace=function(a,b,c){return a.split(b).join(c)};P.hex=function(a,b){for(var c=
"";c="0123456789ABCDEF".charAt(a&15)+c,a>>>=4,0<a;);if(null!=b)for(;c.length<b;)c="0"+c;return c};P.fastCodeAt=function(a,b){return a.charCodeAt(b)};var ja=function(){};f.Type=ja;ja.__name__=["Type"];ja.getClass=function(a){return null==a?null:H.getClass(a)};ja.getSuperClass=function(a){return a.__super__};ja.getClassName=function(a){a=a.__name__;return null==a?null:a.join(".")};ja.resolveClass=function(a){a=f[a];return null!=a&&H.isClass(a)?a:null};ja.createInstance=function(a,b){switch(b.length){case 0:return new a;
case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6]);case 8:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);case 9:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8]);case 10:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9]);case 11:return new a(b[0],
b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10]);case 12:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10],b[11]);case 13:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10],b[11],b[12]);case 14:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10],b[11],b[12],b[13]);default:throw new M("Too many arguments");}};ja.createEmptyInstance=function(a){function b(){}b.prototype=a.prototype;return new b};ja.enumIndex=function(a){return a[1]};var pa={};
f["_UInt.UInt_Impl_"]=pa;pa.__name__=["_UInt","UInt_Impl_"];pa.gt=function(a,b){var c=0>a;return c!=0>b?c:a>b};pa.gte=function(a,b){var c=0>a;return c!=0>b?c:a>=b};pa.toFloat=function(a){return 0>a?4294967296+a:a+0};var ld=function(){};f["haxe.IMap"]=ld;ld.__name__=["haxe","IMap"];var Vb=function(a,b){this.high=a;this.low=b};f["haxe._Int64.___Int64"]=Vb;Vb.__name__=["haxe","_Int64","___Int64"];Vb.prototype={__class__:Vb};var aa=function(){};f["haxe.Log"]=aa;aa.__name__=["haxe","Log"];aa.trace=function(a,
b){H.__trace(a,b)};var md=function(a){var b=this;this.id=setInterval(function(){b.run()},a)};f["haxe.Timer"]=md;md.__name__=["haxe","Timer"];md.prototype={run:function(){},__class__:md};var ka=function(a){this.length=a.byteLength;this.b=new Yd(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b};f["haxe.io.Bytes"]=ka;ka.__name__=["haxe","io","Bytes"];ka.alloc=function(a){return new ka(new Zd(a))};ka.ofString=function(a){for(var b=[],c=0;c<a.length;){var d=P.fastCodeAt(a,c++);55296<=d&&56319>=d&&
(d=d-55232<<10|P.fastCodeAt(a,c++)&1023);127>=d?b.push(d):(2047>=d?b.push(192|d>>6):(65535>=d?b.push(224|d>>12):(b.push(240|d>>18),b.push(128|d>>12&63)),b.push(128|d>>6&63)),b.push(128|d&63))}return new ka((new Yd(b)).buffer)};ka.ofData=function(a){var b=a.hxBytes;return null!=b?b:new ka(a)};ka.fastGet=function(a,b){return a.bytes[b]};ka.prototype={get:function(a){return this.b[a]},set:function(a,b){this.b[a]=b&255},blit:function(a,b,c,d){if(0>a||0>c||0>d||a+d>this.length||c+d>b.length)throw new M(Ea.OutsideBounds);
0==c&&d==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+d),a)},initData:function(){null==this.data&&(this.data=new he(this.b.buffer,this.b.byteOffset,this.b.byteLength))},setFloat:function(a,b){this.initData();this.data.setFloat32(a,b,!0)},getString:function(a,b){if(0>a||0>b||a+b>this.length)throw new M(Ea.OutsideBounds);var c="",d=this.b,e=String.fromCharCode,l=a;for(a+=b;l<a;)if(b=d[l++],128>b){if(0==b)break;c+=e(b)}else if(224>b)c+=e((b&63)<<6|d[l++]&127);else if(240>b){var ba=d[l++];
c+=e((b&31)<<12|(ba&127)<<6|d[l++]&127)}else{ba=d[l++];var f=d[l++];b=(b&15)<<18|(ba&127)<<12|(f&127)<<6|d[l++]&127;c+=e((b>>10)+55232);c+=e(b&1023|56320)}return c},toString:function(){return this.getString(0,this.length)},getData:function(){return this.b.bufferValue},__class__:ka};var Fb=function(){};f["haxe.crypto.Base64"]=Fb;Fb.__name__=["haxe","crypto","Base64"];Fb.encode=function(a,b){null==b&&(b=!0);var c=(new nd(Fb.BYTES)).encodeBytes(a).toString();if(b)switch(a.length%3){case 1:c+="==";break;
case 2:c+="="}return c};var nd=function(a){for(var b=a.length,c=1;b>1<<c;)++c;if(8<c||b!=1<<c)throw new M("BaseCode : base length must be a power of two.");this.base=a;this.nbits=c};f["haxe.crypto.BaseCode"]=nd;nd.__name__=["haxe","crypto","BaseCode"];nd.prototype={encodeBytes:function(a){for(var b=this.nbits,c=this.base,d=u["int"](8*a.length/b),e=ka.alloc(d+(0==8*a.length%b?0:1)),l=0,ba=0,f=(1<<b)-1,g=0,h=0;h<d;){for(;ba<b;)ba+=8,l<<=8,l|=a.get(g++);ba-=b;e.set(h++,c.get(l>>ba&f))}0<ba&&e.set(h++,
c.get(l<<b-ba&f));return e},__class__:nd};var $d=function(){};f["haxe.crypto.Crc32"]=$d;$d.__name__=["haxe","crypto","Crc32"];$d.make=function(a){var b=-1,c=a.getData(),d=0;for(a=a.length;d<a;){var e=d++;e=(b^ka.fastGet(c,e))&255;for(var l=0;8>l;)l++,e=1==(e&1)?e>>>1^-306674912:e>>>1;b=b>>>8^e}return b^-1};var Q=function(){this.h={}};f["haxe.ds.IntMap"]=Q;Q.__name__=["haxe","ds","IntMap"];Q.__interfaces__=[ld];Q.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},
remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b|0);return B.iter(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var a=this.it.next();return this.ref[a]}}},__class__:Q};var Fa=function(){this.h={__keys__:{}}};f["haxe.ds.ObjectMap"]=Fa;Fa.__name__=["haxe","ds","ObjectMap"];Fa.__interfaces__=[ld];Fa.assignId=function(a){return a.__id__=
++Fa.count};Fa.getId=function(a){return a.__id__};Fa.prototype={set:function(a,b){var c=Fa.getId(a)||Fa.assignId(a);this.h[c]=b;this.h.__keys__[c]=a},get:function(a){return this.h[Fa.getId(a)]},exists:function(a){return null!=this.h.__keys__[Fa.getId(a)]},__class__:Fa};var od=function(a,b){this.map=a;this.keys=b;this.index=0;this.count=b.length};f["haxe.ds._StringMap.StringMapIterator"]=od;od.__name__=["haxe","ds","_StringMap","StringMapIterator"];od.prototype={hasNext:function(){return this.index<
this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:od};var I=function(){this.h={}};f["haxe.ds.StringMap"]=I;I.__name__=["haxe","ds","StringMap"];I.__interfaces__=[ld];I.prototype={isReserved:function(a){return null!=ie[a]},set:function(a,b){this.isReserved(a)?this.setReserved(a,b):this.h[a]=b},get:function(a){return this.isReserved(a)?this.getReserved(a):this.h[a]},exists:function(a){return this.isReserved(a)?this.existsReserved(a):this.h.hasOwnProperty(a)},setReserved:function(a,
b){null==this.rh&&(this.rh={});this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},existsReserved:function(a){return null==this.rh?!1:this.rh.hasOwnProperty("$"+a)},remove:function(a){if(this.isReserved(a)){a="$"+a;if(null==this.rh||!this.rh.hasOwnProperty(a))return!1;delete this.rh[a]}else{if(!this.h.hasOwnProperty(a))return!1;delete this.h[a]}return!0},keys:function(){return B.iter(this.arrayKeys())},arrayKeys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&
a.push(b);if(null!=this.rh)for(b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},iterator:function(){return new od(this,this.arrayKeys())},__class__:I};var Ea={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:["Blocked",0]};Ea.Blocked.toString=wb;Ea.Blocked.__enum__=Ea;Ea.Overflow=["Overflow",1];Ea.Overflow.toString=wb;Ea.Overflow.__enum__=Ea;Ea.OutsideBounds=["OutsideBounds",2];Ea.OutsideBounds.toString=wb;Ea.OutsideBounds.__enum__=Ea;Ea.Custom=function(a){a=
["Custom",3,a];a.__enum__=Ea;a.toString=wb;return a};var xa=function(){};f["haxe.io.FPHelper"]=xa;xa.__name__=["haxe","io","FPHelper"];xa.i32ToFloat=function(a){var b=a>>>23&255,c=a&8388607;return 0==c&&0==b?0:(1-(a>>>31<<1))*(1+Math.pow(2,-23)*c)*Math.pow(2,b-127)};xa.floatToI32=function(a){if(0==a)return 0;var b=0>a?-a:a,c=Math.floor(Math.log(b)/.6931471805599453);-127>c?c=-127:128<c&&(c=128);b=Math.round(8388608*(b/Math.pow(2,c)-1));8388608==b&&128>c&&(b=0,++c);return(0>a?-2147483648:0)|c+127<<
23|b};xa.i64ToDouble=function(a,b){var c=(b>>20&2047)-1023;a=4294967296*(b&1048575)+2147483648*(a>>>31)+(a&2147483647);return 0==a&&-1023==c?0:(1-(b>>>31<<1))*(1+Math.pow(2,-52)*a)*Math.pow(2,c)};xa.doubleToI64=function(a){var b=xa.i64tmp;if(0==a)b.low=0,b.high=0;else if(isFinite(a)){var c=0>a?-a:a,d=Math.floor(Math.log(c)/.6931471805599453),e=Math.round(4503599627370496*(c/Math.pow(2,d)-1));c=u["int"](e);e=u["int"](e/4294967296);b.low=c;b.high=(0>a?-2147483648:0)|d+1023<<20|e}else 0<a?(b.low=0,b.high=
2146435072):(b.low=0,b.high=-1048576);return b};var Ua=function(){};f["haxe.rtti.Meta"]=Ua;Ua.__name__=["haxe","rtti","Meta"];Ua.getType=function(a){a=Ua.getMeta(a);return null==a||null==a.obj?{}:a.obj};Ua.getMeta=function(a){return a.__meta__};Ua.getStatics=function(a){a=Ua.getMeta(a);return null==a||null==a.statics?{}:a.statics};Ua.getFields=function(a){a=Ua.getMeta(a);return null==a||null==a.fields?{}:a.fields};var M=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&
Error.captureStackTrace(this,M)};f["js._Boot.HaxeError"]=M;M.__name__=["js","_Boot","HaxeError"];M.wrap=function(a){return a instanceof Error?a:new M(a)};M.__super__=Error;M.prototype=p(Error.prototype,{__class__:M});var H=function(){};f["js.Boot"]=H;H.__name__=["js","Boot"];H.__unhtml=function(a){return a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")};H.__trace=function(a,b){var c=null!=b?b.fileName+":"+b.lineNumber+": ":"";c+=H.__string_rec(a,"");if(null!=b&&null!=b.customParams)for(a=
0,b=b.customParams;a<b.length;){var d=b[a];++a;c+=","+H.__string_rec(d,"")}if("undefined"!=typeof document){var e=document.getElementById("haxe:trace");a=null!=e}else a=!1;a?e.innerHTML+=H.__unhtml(c)+"<br/>":"undefined"!=typeof console&&null!=console.log&&console.log(c)};H.isClass=function(a){return a.__name__};H.isEnum=function(a){return a.__ename__};H.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;a=H.__nativeClassName(a);return null!=
a?H.__resolveNativeClass(a):null};H.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(H.isClass(a)||H.isEnum(a))&&(c="object");switch(c){case "function":return"<function>";case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";b+="\t";for(var d=2,e=a.length;d<e;){var l=d++;c=2!=l?c+(","+H.__string_rec(a[l],b)):c+H.__string_rec(a[l],b)}return c+")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)l=e++,d+=(0<l?",":
"")+H.__string_rec(a[l],b);return d+"]"}try{d=a.toString}catch(ba){return"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)e&&!a.hasOwnProperty(c)||"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+H.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "string":return a;default:return String(a)}};
H.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var l=d++;l=c[l];if(l==b||H.__interfLoop(l,b))return!0}return H.__interfLoop(a.__super__,b)};H.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array?null==a.__enum__:!1;case ee:return"boolean"==typeof a;case je:return!0;case ae:return"number"==typeof a;case be:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;
default:if(null!=a)if("function"==typeof b){if(a instanceof b||H.__interfLoop(H.getClass(a),b))return!0}else{if("object"==typeof b&&H.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==ke&&null!=a.__name__||b==le&&null!=a.__ename__?!0:a.__enum__==b}};H.__cast=function(a,b){if(H.__instanceof(a,b))return a;throw new M("Cannot cast "+u.string(a)+" to "+u.string(b));};H.__nativeClassName=function(a){a=H.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?
null:a};H.__isNativeObj=function(a){return null!=H.__nativeClassName(a)};H.__resolveNativeClass=function(a){return ea[a]};var Aa=function(){};f["js.Browser"]=Aa;Aa.__name__=["js","Browser"];Aa.__properties__={get_document:"get_document",get_window:"get_window"};Aa.get_window=function(){return window};Aa.get_document=function(){return window.document};var kd=function(){};f["js.Lib"]=kd;kd.__name__=["js","Lib"];kd.__properties__={get_undefined:"get_undefined"};kd.get_undefined=function(){};var Ga=function(a){if(a instanceof
Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{this.a=[];for(var b=0;b<a;){var c=b++;this.a[c]=0}this.byteLength=a}};f["js.html.compat.ArrayBuffer"]=Ga;Ga.__name__=["js","html","compat","ArrayBuffer"];Ga.sliceImpl=function(a,b){a=new Yd(this,a,null==b?null:b-a);b=new Zd(a.byteLength);(new Yd(b)).set(a);return b};Ga.prototype={slice:function(a,b){return new Ga(this.a.slice(a,b))},__class__:Ga};var pd=function(a,b,c){this.buf=a;this.offset=null==b?0:b;this.length=null==c?a.byteLength-
this.offset:c;if(0>this.offset||0>this.length||this.offset+this.length>a.byteLength)throw new M(Ea.OutsideBounds);this.byteLength=this.length;this.byteOffset=this.offset;this.buffer=this.buf};f["js.html.compat.DataView"]=pd;pd.__name__=["js","html","compat","DataView"];pd.prototype={getInt8:function(a){a=this.buf.a[this.offset+a];return 128<=a?a-256:a},getUint8:function(a){return this.buf.a[this.offset+a]},getInt16:function(a,b){a=this.getUint16(a,b);return 32768<=a?a-65536:a},getUint16:function(a,
b){return b?this.buf.a[this.offset+a]|this.buf.a[this.offset+a+1]<<8:this.buf.a[this.offset+a]<<8|this.buf.a[this.offset+a+1]},getInt32:function(a,b){var c=this.offset+a;a=this.buf.a[c++];var d=this.buf.a[c++],e=this.buf.a[c++];c=this.buf.a[c++];return b?a|d<<8|e<<16|c<<24:c|e<<8|d<<16|a<<24},getUint32:function(a,b){a=this.getInt32(a,b);return 0>a?a+4294967296:a},getFloat32:function(a,b){return xa.i32ToFloat(this.getInt32(a,b))},getFloat64:function(a,b){var c=this.getInt32(a,b);a=this.getInt32(a+
4,b);return xa.i64ToDouble(b?c:a,b?a:c)},setInt8:function(a,b){this.buf.a[a+this.offset]=0>b?b+128&255:b&255},setUint8:function(a,b){this.buf.a[a+this.offset]=b&255},setInt16:function(a,b,c){this.setUint16(a,0>b?b+65536:b,c)},setUint16:function(a,b,c){a+=this.offset;c?(this.buf.a[a]=b&255,this.buf.a[a++]=b>>8&255):(this.buf.a[a++]=b>>8&255,this.buf.a[a]=b&255)},setInt32:function(a,b,c){this.setUint32(a,b,c)},setUint32:function(a,b,c){a+=this.offset;c?(this.buf.a[a++]=b&255,this.buf.a[a++]=b>>8&255,
this.buf.a[a++]=b>>16&255,this.buf.a[a++]=b>>>24):(this.buf.a[a++]=b>>>24,this.buf.a[a++]=b>>16&255,this.buf.a[a++]=b>>8&255,this.buf.a[a++]=b&255)},setFloat32:function(a,b,c){this.setUint32(a,xa.floatToI32(b),c)},setFloat64:function(a,b,c){b=xa.doubleToI64(b);c?(this.setUint32(a,b.low),this.setUint32(a,b.high)):(this.setUint32(a,b.high),this.setUint32(a,b.low))},__class__:pd};var hb=function(){};f["js.html.compat.Float32Array"]=hb;hb.__name__=["js","html","compat","Float32Array"];hb._new=function(a,
b,c){if("number"==typeof a){var d=[];for(b=0;b<a;){var e=b++;d[e]=0}d.byteLength=d.length<<2;d.byteOffset=0;a=[];b=0;for(e=d.length<<2;b<e;)b++,a.push(0);d.buffer=new Ga(a)}else if(u.is(a,Ga)){null==b&&(b=0);null==c&&(c=a.byteLength-b>>2);d=[];for(e=0;e<c;){e++;var l=a.a[b++]|a.a[b++]<<8|a.a[b++]<<16|a.a[b++]<<24;d.push(xa.i32ToFloat(l))}d.byteLength=d.length<<2;d.byteOffset=b;d.buffer=a}else if(a instanceof Array&&null==a.__enum__){d=a.slice();a=[];for(b=0;b<d.length;)e=d[b],++b,e=xa.floatToI32(e),
a.push(e&255),a.push(e>>8&255),a.push(e>>16&255),a.push(e>>>24);d.byteLength=d.length<<2;d.byteOffset=0;d.buffer=new Ga(a)}else throw new M("TODO "+u.string(a));d.subarray=hb._subarray;d.set=hb._set;return d};hb._set=function(a,b){if(u.is(a.buffer,Ga)){if(a.byteLength+b>this.byteLength)throw new M("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var e=c++;this[e+b]=a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new M("set() outside of range");c=0;
for(d=a.length;c<d;)e=c++,this[e+b]=a[e]}else throw new M("TODO");};hb._subarray=function(a,b){b=hb._new(this.slice(a,b));b.byteOffset=4*a;return b};var ib=function(){};f["js.html.compat.Uint8Array"]=ib;ib.__name__=["js","html","compat","Uint8Array"];ib._new=function(a,b,c){if("number"==typeof a){c=[];for(b=0;b<a;){var d=b++;c[d]=0}c.byteLength=c.length;c.byteOffset=0;c.buffer=new Ga(c)}else if(u.is(a,Ga))null==b&&(b=0),null==c&&(c=a.byteLength-b),c=0==b?a.a:a.a.slice(b,b+c),c.byteLength=c.length,
c.byteOffset=b,c.buffer=a;else if(a instanceof Array&&null==a.__enum__)c=a.slice(),c.byteLength=c.length,c.byteOffset=0,c.buffer=new Ga(c);else throw new M("TODO "+u.string(a));c.subarray=ib._subarray;c.set=ib._set;return c};ib._set=function(a,b){if(u.is(a.buffer,Ga)){if(a.byteLength+b>this.byteLength)throw new M("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var e=c++;this[e+b]=a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new M("set() outside of range");
c=0;for(d=a.length;c<d;)e=c++,this[e+b]=a[e]}else throw new M("TODO");};ib._subarray=function(a,b){b=ib._new(this.slice(a,b));b.byteOffset=a;return b};var Na=function(){this.__constructed=!1;this.construct()};f["lovedna.Object"]=Na;Na.__name__=["lovedna","Object"];Na.prototype={construct:function(){this.__constructed||(this.__constructed=!0,this.instanceID=Na._id++,this.onConstruct())},toString:function(){return qa.getName(ja.getClass(this))},onConstruct:function(){},__class__:Na};var qd=function(){};
f["lovedna.events.IEventDispatcher"]=qd;qd.__name__=["lovedna","events","IEventDispatcher"];qd.prototype={__class__:qd};var w=function(a){Na.call(this);null!=a&&(this.__targetDispatcher=a)};f["lovedna.events.EventDispatcher"]=w;w.__name__=["lovedna","events","EventDispatcher"];w.__interfaces__=[qd];w.__super__=Na;w.prototype=p(Na.prototype,{addEventListener:function(a,b,c){null==c&&(c=0);if(null!=b)if(null==this.__eventMap&&(this.__eventMap=new I),this.__eventMap.exists(a)){a=this.__eventMap.get(a);
for(var d=0,e=a.length;d<e;){var l=d++;if(a[l].match(b))return}this.__addListenerByPriority(a,new hc(b,c))}else d=[],d.push(new hc(b,c)),this.__eventMap.set(a,d)},dispatchEvent:function(a){if(null==this.__eventMap||null==a)return!0;var b=a.get_type(),c=this.__eventMap.get(b);if(null==c)return!0;null==a.target&&(a.target=null!=this.__targetDispatcher?this.__targetDispatcher:this);b=this.__getTempList();b.fromList(c);c=0;for(var d=b.get_length();c<d;){var e=c++;a.currentTarget=this;a.target=this;b.getElement(e).callback(a)}w._temp.push(b);
return!0},hasEventListener:function(a){return null==this.__eventMap?!1:this.__eventMap.exists(a)},removeEventListener:function(a,b){if(null!=this.__eventMap&&null!=b){var c=this.__eventMap.get(a);if(null!=c){for(var d=c.length;0<d--;)c[d].match(b)&&c.splice(d,1);0==c.length&&this.__eventMap.remove(a)}}},willTrigger:function(a){return this.hasEventListener(a)},__addListenerByPriority:function(a,b){for(var c=a.length,d=c,e=0;e<c;){var l=e++;if(a[l].priority<b.priority){d=l;break}}a.splice(d,0,b)},__getTempList:function(){return 0<
w._temp.length?w._temp.pop():new G},__class__:w});var y=function(){w.call(this)};f["lovedna.game.components.Component"]=y;y.__name__=["lovedna","game","components","Component"];y.__super__=w;y.prototype=p(w.prototype,{onConstruct:function(){w.prototype.onConstruct.call(this)},onAwake:function(){},onStart:function(){},onDestroy:function(){},__connectActor:function(a){this.actor=a;this.onAwake()},__init:function(){this.classType=qa.getClassName(this);this.onStart()},__disconnectActor:function(){if(null!=
this.__calbacks){for(var a=this.__calbacks.keys();a.hasNext();){var b=a.next();this.actor.removeEventListener(b,this.__calbacks.get(b));this.__calbacks.remove(b)}this.__calbacks=null;this.onDestroy();this.actor=null}},bindEvent:function(a,b){null!=b?(null==this.__calbacks&&(this.__calbacks=new I),this.__calbacks.exists(a.get_type())||(this.__calbacks.set(a.get_type(),b),this.actor.addEventListener(a.get_type(),b))):null!=this.__calbacks&&this.__calbacks.exists(a.get_type())&&(b=this.__calbacks.get(a.get_type()),
this.__calbacks.remove(a.get_type()),this.actor.removeEventListener(a.get_type(),b))},__class__:y});var Gb=function(){w.call(this)};f["jump.ActorRoll"]=Gb;Gb.__name__=["jump","ActorRoll"];Gb.__super__=y;Gb.prototype=p(y.prototype,{start:function(a){this._r=0;this.speed=a;this.bindEvent(v.onUpdate,n(this,this.onupdate))},stop:function(){this.actor.get_transform().rotation.setEulerAngles(0,0,0);this.bindEvent(v.onUpdate,null)},onupdate:function(a){this._r+=10*this.actor.deltaTime*this.speed;this.actor.get_transform().rotation.setEulerAngles(0,
0,this._r)},__class__:Gb});var J=function(a){null==a&&(a=!1);w.call(this);this._dontDestroy=a;this.visible=this._enabled=!0;this.frame=0;this.timeScale=1;this.layer=this.deltaTime=0};f["lovedna.game.Actor"]=J;J.__name__=["lovedna","game","Actor"];J.destory=function(a){null==J._destoryed&&(J._destoryed=new Q,J._destoryList=new G);J._destoryed.exists(a.instanceID)||(J._destoryed.set(a.instanceID,a),J._destoryCount++)};J._endFrame=function(){if(!(1>J._destoryCount)){J._destoryCount=0;for(var a=J._destoryed.iterator();a.hasNext();){var b=
a.next();J._destoryed.remove(b.instanceID);J._destoryList.push(b)}for(a=J._destoryList.get_length();0<a--;)J._destoryList.getElement(a)._destory();J._destoryList.clear()}};J.__super__=w;J.prototype=p(w.prototype,{addComponent:function(a){null==this._components&&(this._components=new G);for(var b=this._components.get_length();0<b--;){var c=this._components.get(b);if(u.is(c,a)&&null==Ra.get(a).getClassMeta("allowMulti",!0)){aa.trace("error",{fileName:"Actor.hx",lineNumber:103,className:"lovedna.game.Actor",
methodName:"addComponent",customParams:["can not add same  type component "+qa.getName(a)]});debugger;return c}}c=qa.createInstance(a);if(null==c)return null;this._components.push(c);c.__connectActor(this);null==this._componentStates&&(this._componentStates=new G);this._componentStates.push(new Hb(c,0));u.is(c,Ha)&&(this._transform=c);return c},removeComponent:function(a){if(null!=this._components)for(var b=this._components.get_length();0<b--;){var c=this._components.get(b);u.is(c,a)&&(null==this._componentStates&&
(this._componentStates=new G),this._componentStates.push(new Hb(c,1)),this._components.removeAt(b),u.is(c,Ha)&&(this._transform=null))}},getComponent:function(a){if(null==this._components)return null;for(var b=this._components.get_length();0<b--;){var c=this._components.get(b);if(u.is(c,a))return c}return null},getComponents:function(a){return null},componentUpdate:function(){if(null!=this._componentStates){var a=this._componentStates.get_length();if(!(1>a)){null==this._componentStatesTemp&&(this._componentStatesTemp=
new G);this._componentStatesTemp.clear();for(var b=0;b<a;){var c=b++;this._componentStatesTemp.push(this._componentStates.get(c))}this._componentStates.clear();for(b=0;b<a;)c=b++,c=this._componentStatesTemp.get(c),0==c.state?(c.component.__init(),this.world.addComponent(c.component)):1==c.state&&(c.component.__disconnectActor(),this._components.remove(c.component),this.world.removeComponent(c.component))}}},_collectActors:function(a){var b=this.get_transform().childCount;if(!(1>b))for(var c=0;c<b;){var d=
c++;d=this.get_transform().getChild(d).actor;d.get_enabled()&&(a.push(d),d._collectActors(a))}},_collectComponent:function(a){if(null!=this.world&&null!=this._components)for(var b=this._components.get_length();0<b--;)null!=this._components.get(b).classType&&(a?this.world.addComponent(this._components.get(b)):this.world.removeComponent(this._components.get(b)))},_connectWorld:function(a){this.world=a;this._collectComponent(!0);this.onEnable();this.dispatchEvent(v.onEnable)},_disconnectWorld:function(){this._collectComponent(!1);
this.onDisable();this.dispatchEvent(v.onDisable);this.world=null},onEnable:function(){},onDisable:function(){},_update:function(a){this.componentUpdate();null!=this.get_transform().parent&&(this.deltaTime=this.get_transform().parent.actor.deltaTime*this.timeScale);this.dispatchEvent(v.onUpdate);if(0<a&&this.hasEventListener(v.onFixedUpdate.get_type())){var b=this.deltaTime;for(this.deltaTime=.0166666666666667;0<a--;)this.dispatchEvent(v.onFixedUpdate);this.deltaTime=b}},_updateTransform:function(a){this.get_transform()._updateTransform(a);
this.frame=a},_destory:function(){if(!this._dontDestroy){if(null!=this._components){this._collectComponent(!1);for(var a=this._components.get_length();0<a--;)this._components.getElement(a).__disconnectActor()}this._componentStates=this._components=null}},_setVisible:function(a){this.visible!=a&&(this.visible=a)},get_transform:function(){null==this._transform&&(this._transform=this.getComponent(Ha),null==this._transform&&(this._transform=this.addComponent(Ha)));return this._transform},get_enabled:function(){return this._enabled},
set_enabled:function(a){this._enabled!=a&&null!=this.world&&this.world.set_dirty(!0);return this._enabled=a},__class__:J,__properties__:{get_transform:"get_transform",set_enabled:"set_enabled",get_enabled:"get_enabled"}});var ab=function(){J.call(this);this._offset=new t(0,0)};f["jump.GameActor"]=ab;ab.__name__=["jump","GameActor"];ab.__super__=J;ab.prototype=p(J.prototype,{setOffset:function(a,b){this._offset.set(a,b)},setPosition:function(a,b){this._setx=a;this._sety=b;a=60*(this._setx+.5);b=60*
(10-this._sety-.5);this.get_transform().position.set(a+this._offset.x,b+this._offset.y)},__class__:ab});var fa=function(){this.type=0;ab.call(this);this._dir=new t(0,0);this.mapList=new Q;this._control=W.control;this._circle=new ic(new t,0);this.addEventListener(v.onRemoved.get_type(),n(this,this.onRemoved))};f["jump.MapActor"]=fa;fa.__name__=["jump","MapActor"];fa.__super__=ab;fa.prototype=p(ab.prototype,{hit:function(a){return this._circle.intersectsCircle(a._circle)},hitMapCellAndBreak:function(a){return!0},
hitMapCell:function(){},loadAvatar:function(a){},set:function(a,b,c){this.size=c;this._circle.radius=c;this.setPosition(a,b);this.updatePosition()},addToStage:function(){W.stage.addChild(this.get_transform())},getMinPoint:function(){return t.instance.set(this.get_transform().position.x-this.size,this.get_transform().position.y-this.size)},getMaxPoint:function(){return t.instance.set(this.get_transform().position.x+this.size,this.get_transform().position.y+this.size)},getMoveDir:function(){return this._dir},
updatePosition:function(){this._control.addUpdateActor(this);this._circle.getCenter().set(this.get_transform().position.x,this.get_transform().position.y)},onRemoved:function(a){this._control.removeActor(this);this.removeEventListener(v.onRemoved.get_type(),n(this,this.onRemoved))},__class__:fa});var kc=function(){fa.call(this);this.size=30;this.halfSize=15;this._img=this.addComponent(Oa);this._img.material.renderQueue=40001;var a=this.addComponent(ra);a.materials[0]=this._img.material;a.mesh=(new X).fromGeometry(this._img.geometry);
this._move=this.addComponent(jc)};f["jump.Bullet"]=kc;kc.__name__=["jump","Bullet"];kc.__super__=fa;kc.prototype=p(fa.prototype,{start:function(a){this._move.start(a)},loadAvatar:function(a){fa.prototype.loadAvatar.call(this,a);this._img.load(a)},hitMapCell:function(){fa.prototype.hitMapCell.call(this);this.get_transform().removeFromParent();J.destory(this)},__class__:kc});var jc=function(){w.call(this)};f["jump.BulletMove"]=jc;jc.__name__=["jump","BulletMove"];jc.__super__=y;jc.prototype=p(y.prototype,
{start:function(a){this.bindEvent(v.onUpdate,n(this,this.onUpdate));this._inc.copy(a);this.actor.get_transform().rotation.setEulerAngles(0,0,a.get_angle());this._scale=0},onAwake:function(){y.prototype.onAwake.call(this);this._inc=new t},onStart:function(){y.prototype.onStart.call(this);u.is(this.actor,fa)&&(this._actor=this.actor)},onUpdate:function(a){a=this.actor.deltaTime;var b=this.actor.get_transform().position;b.x+=this._inc.x*a;b.y+=this._inc.y*a;this._scale+=18.84955592153876*a;a=1+.1*Math.sin(this._scale);
b=1+.1*Math.cos(this._scale);this.actor.get_transform().scale.set(a,b,1);null!=this._actor&&this._actor.updatePosition()},__class__:jc});var lc=function(){fa.call(this);this.type=2;this._img=this.addComponent(Oa);this._img.material.renderQueue=40001;var a=this.addComponent(ra);a.materials[0]=this._img.material;a.mesh=(new X).fromGeometry(this._img.geometry);this.addComponent(Gb).start(-20)};f["jump.Cutter"]=lc;lc.__name__=["jump","Cutter"];lc.__super__=fa;lc.prototype=p(fa.prototype,{loadAvatar:function(a){this._img.load(a)},
__class__:lc});var Ia=function(){};f["jump.GameConfig"]=Ia;Ia.__name__=["jump","GameConfig"];Ia.prototype={__class__:Ia};var nc=function(){fa.call(this);this.type=1;this.addComponent(Gb);this.addComponent(mc).stageData=W.data;var a=this.addComponent(Oa),b=this.addComponent(ra);a.material.renderQueue=40010;b.materials[0]=a.material;b.mesh=(new X).fromGeometry(a.geometry)};f["jump.Hero"]=nc;nc.__name__=["jump","Hero"];nc.__super__=fa;nc.prototype=p(fa.prototype,{loadAvatar:function(a){fa.prototype.loadAvatar.call(this,
a);var b=this.getComponent(Oa);null!=b&&(b.transform.width=35,b.transform.height=35,b.load(a))},__class__:nc});var Ib=function(){w.call(this)};f["jump.MapActorComponent"]=Ib;Ib.__name__=["jump","MapActorComponent"];Ib.__super__=y;Ib.prototype=p(y.prototype,{onStart:function(){y.prototype.onStart.call(this);this._lastPosition=new k(-1,-1,-1);u.is(this.actor,fa)&&(this._actor=this.actor)},savePosition:function(){this._lastPosition.copy(this.actor.get_transform().position);null!=this._actor&&this._actor.updatePosition()},
__class__:Ib});var mc=function(){w.call(this)};f["jump.Jump"]=mc;mc.__name__=["jump","Jump"];mc.__super__=Ib;mc.prototype=p(Ib.prototype,{onStart:function(){Ib.prototype.onStart.call(this);this.stageData=W.data;this.bindEvent(v.onUpdate,n(this,this.onUpdate));this._r=this.actor.getComponent(Gb);this._moveDir=new t(1,-1);this._moveValue=new t(230,0);this._size=17.5;this._xStop=!1},onUpdate:function(a){if(A.touchDown(0)){a=this.actor.get_transform().position.x;var b=this.actor.get_transform().position.y,
c=this.stageData.getCell(a-this._moveDir.x*this._size,b-this._size-1);if(null!=c&&c.isBlock(this._moveDir))this._moveValue.y=9,this._moveDir.y=1;else{if(7.2<this._moveValue.y)return;a=this.stageData.getCell(a+(this._size+1)*this._moveDir.x,b);null!=a&&a.isBlock(this._moveDir)&&(this._moveDir.x=-this._moveDir.x,this.actor.get_transform().scale.set(this._moveDir.x,1,1),this._moveDir.y=1,this._moveValue.x=230,this._moveValue.y=10.799999999999999,this._xStop=!1,this.roll(this._moveDir))}}this.onFixedUpdate()},
onFixedUpdate:function(a){var b=this.actor.deltaTime;a=this.actor.get_transform().position.x;var c=this.actor.get_transform().position.y,d=34;this._xStop?0>this._moveValue.y&&(d=1,this._moveValue.y=-90*b):a+=this._moveValue.x*b*this._moveDir.x;this._moveDir.y=0<this._moveValue.y?1:-1;this._moveValue.y-=b*d;-18>this._moveValue.y&&(this._moveValue.y=-18);c+=this._moveValue.y;b=this.stageData.getCell(a,c+this._moveDir.y*(this._size+1));null!=b&&b.isBlock(this._moveDir)&&(0<this._moveDir.y?(c=60*b.y-
this._size,this._moveValue.y=0):(c=60*(b.y+1)+this._size,this._moveValue.y=0,this._moveValue.x=230,this._xStop=!1),this.stopRoll());b=this.stageData.getCell(a+this._moveDir.x*(this._size+1),c);null!=b&&b.isBlock(this._moveDir)?(this._xStop=!0,a=0<this._moveDir.x?60*b.x-this._size:60*(b.x+1)+this._size,this._moveValue.x=115,this.stopRoll()):this._xStop&&(this._xStop=!1);this.actor.get_transform().position.x=a;this.actor.get_transform().position.y=c;this._lastPosition.equals(this.actor.get_transform().position)||
this.savePosition();if(null!=this._actor)for(a=this._actor.mapList.keys();a.hasNext();)for(c=a.next(),c=this.stageData.getCellByIndex(c).getActors().iterator();c.hasNext();)b=c.next(),b!=this._actor&&2==b.type&&this._actor.hit(b)&&(aa.trace("hit",{fileName:"Jump.hx",lineNumber:180,className:"jump.Jump",methodName:"onFixedUpdate"}),b.get_transform().removeFromParent())},roll:function(a){},stopRoll:function(){},__class__:mc});var Ub=x.GameStage=function(a){null==a&&(a=!1);J.call(this,a);Ub.current=
this;W.control=this.addComponent(oc);this.stagedata=new rd;W.data=this.stagedata;a=new J;this.get_transform().addChild(a.get_transform());a.get_transform().position.set(-540,-300);W.stage=a.get_transform();a=new nc;W.hero=a;a=new J;var b=a.addComponent(Oa),c=a.addComponent(ra);c.materials[0]=b.material;b.material.renderQueue=39900;c.mesh=(new X).fromGeometry(b.geometry);this.get_transform().addChild(a.get_transform());W.background=b;a=new J;W.stage.addChild(a.get_transform());b=a.addComponent(ra);
b.get_material().renderQueue=4E4;b.get_material().state.cullMode=-1;b.mesh=(new X).fromGeometry(this.stagedata.geom);a.get_transform().position.set(-29,-20,0);W.foreground=a};f["jump.JumpMain"]=Ub;Ub.__name__=["jump","JumpMain"];Ub.__super__=J;Ub.prototype=p(J.prototype,{load:function(a){this.stagedata.load(a,n(this,this.loaded))},loaded:function(){W.background.load("map/bgr_ground_nordic.png");W.hero.loadAvatar("atlas/hero0.png");W.hero.set(1,6,14);W.hero.addToStage();var a=W.foreground.getComponent(ra);
a.mesh=(new X).fromGeometry(this.stagedata.geom);a.get_material().setTexture(z.texture.get("map/bgr_wall_castle.png").texture);a=W.data.objectList;for(var b=a.get_length();0<b--;){var c=a.get(b);switch(c.type){case "born":var d=c.x;c=c.y;W.hero.loadAvatar("atlas/hero0.png");W.hero.set(d,c,14);W.hero.addToStage();break;case "cutter":d=new lc;d.loadAvatar("atlas/cutter.png");d.set(c.x,c.y,20);d.addToStage();break;case "shooter":d=c.getInt("x");var e=c.getInt("y");d=new t(d,e);e=new pc;0==d.get_lengthSq()?
(e.loadAvatar("atlas/target.png"),e.delay=2):(e.loadAvatar("atlas/look.png"),e.delay=2,e.dir=d);e.setPosition(c.x,c.y);e.start();e.addToStage();break;case "trace":d=new qc,d.loadAvatar("atlas/trace.png"),d.set(c.x,c.y,8),d.start(),d.addToStage()}}},__class__:Ub});var sd=function(){};f["jump.MapActorSet"]=sd;sd.__name__=["jump","MapActorSet"];sd.prototype={parse:function(a){this._values=new I;var b=q.getFloat(a,"x"),c=q.getFloat(a,"y");this.x=g.floor(b/60);this.y=g.floor(c/60);this.type=q.getString(a,
"type");a=q.getArray(a,"properties");if(null!=a)for(b=a.length;0<b--;){var d=a[b];c=q.getString(d,"name");d=q.getValue(d,"value");this._values.set(c,d)}},getInt:function(a,b){null==b&&(b=0);return this._values.exists(a)&&(a=this._values.get(a),"number"==typeof a&&(a|0)===a)?a:b},getFloat:function(a,b){null==b&&(b=0);return this._values.exists(a)&&(a=this._values.get(a),"number"==typeof a)?a:b},getString:function(a,b){null==b&&(b="");return this._values.exists(a)&&(a=this._values.get(a),"string"==
typeof a)?a:b},__class__:sd};var td=function(a,b){this.x=a;this.y=b;this.block=!1;this._actors=new Q};f["jump.MapCell"]=td;td.__name__=["jump","MapCell"];td.prototype={getIndex:function(){return 18*this.y+this.x},clear:function(){this.block=!1;for(var a=this._actors.keys();a.hasNext();){var b=a.next();this._actors.remove(b)}},isBlock:function(a){return this.block},addActor:function(a){this._actors.set(a.instanceID,a)},existActor:function(a){return this._actors.exists(a)},removeActor:function(a){this._actors.remove(a)},
getActors:function(){return this._actors},toString:function(){return"MapCell "+this.x+","+this.y},__class__:td};var pc=function(){ab.call(this);this.delay=1.5;this._time=0;this._img=this.addComponent(Oa);this._img.material.renderQueue=40001;var a=this.addComponent(ra);a.materials[0]=this._img.material;a.mesh=(new X).fromGeometry(this._img.geometry);this._target=new R};f["jump.Shooter"]=pc;pc.__name__=["jump","Shooter"];pc.__super__=ab;pc.prototype=p(ab.prototype,{loadAvatar:function(a){this._img.load(a)},
start:function(){this._time=.3;this._freezeTime=0;this._traceHero=!0;null!=this.dir&&(this._traceHero=!1,this.get_transform().rotation.setEulerAngles(0,0,this.dir.get_angle()));this.addEventListener(v.onUpdate.get_type(),n(this,this.onUpdate))},stop:function(){this.addEventListener(v.onUpdate.get_type(),null)},addToStage:function(){W.stage.addChild(this.get_transform())},onUpdate:function(a){if(this._traceHero)if(0>=this._freezeTime){a=W.hero;var b=t.instance;b.set(a.get_transform().position.x,a.get_transform().position.y);
b.x-=this.get_transform().position.x;b.y-=this.get_transform().position.y;this._target.setEulerAngles(0,0,b.get_angle());this.get_transform().rotation.slerpTo(this._target,2*this.deltaTime)}else this._freezeTime-=this.deltaTime;this._time-=this.deltaTime;0>=this._time&&(this._time=this.delay,this.shoot())},shoot:function(){var a=t.instance;if(null!=this.dir)a.copy(this.dir);else{var b=k.instance.set(1,0);this.get_transform().rotation.rotate(b);a.set(b.x,b.y);this.get_transform().rotation.setEulerAngles(0,
0,a.get_angle())}a.normalize();a.scale(240);b=new kc;b.type=2;b.loadAvatar("bullet.png");var c=k.instance.set(20,0,0);this.get_transform().rotation.rotate(c);b.setOffset(c.x,c.y);b.set(this._setx,this._sety,8);b.addToStage();b.start(a);this._freezeTime=.1*this.delay},__class__:pc});var W=function(){};f["jump.StageConfig"]=W;W.__name__=["jump","StageConfig"];W.prototype={__class__:W};var oc=function(){w.call(this)};f["jump.StageControl"]=oc;oc.__name__=["jump","StageControl"];oc.__super__=y;oc.prototype=
p(y.prototype,{addUpdateActor:function(a){this._updateMap.exists(a.instanceID)||(this._updateMap.set(a.instanceID,a),this.updateList.push(a))},removeActor:function(a){for(var b=a.instanceID,c=a.mapList.keys();c.hasNext();){var d=c.next(),e=this._data.getCellByIndex(d);a.mapList.remove(d);e.existActor(b)&&e.removeActor(b)}},onAwake:function(){y.prototype.onAwake.call(this);this.updateList=new G;this._updateMap=new Q},onStart:function(){y.prototype.onStart.call(this);this._data=W.data;this.bindEvent(v.onUpdate,
n(this,this.onUpdate))},onUpdate:function(a){a=this.updateList.get_length();var b=this.actor.frame;if(0<a)for(;0<a--;){var c=this.updateList.get(a);if(null!=c&&null!=c.world){var d=!1,e=c.getMoveDir(),l=c.instanceID;this.updateList.removeAt(a);this._updateMap.remove(l);var ba=c.getMinPoint(),f=this._data.getCell(ba.x,ba.y);ba=c.getMaxPoint();ba=this._data.getCell(ba.x,ba.y);if(null!=f&&null!=ba)for(var g=f.x,h=ba.x+1;g<h;)for(var k=g++,m=f.y,n=ba.y+1;m<n;){var p=m++;d||(p=this._data.getCellByXY(k,
p),null!=p&&(p.existActor(l)||p.addActor(c),c.mapList.set(p.getIndex(),b),p.isBlock(e)&&c.hitMapCellAndBreak(p)&&(d=!0)))}else null!=f?(f.existActor(l)||f.addActor(c),c.mapList.set(f.getIndex(),b),f.isBlock(e)&&c.hitMapCellAndBreak(f)&&(d=!0)):null!=ba&&(ba.existActor(l)||ba.addActor(c),c.mapList.set(ba.getIndex(),b),ba.isBlock(e)&&c.hitMapCellAndBreak(ba)&&(d=!0));if(d)c.hitMapCell();else for(d=c.mapList.keys();d.hasNext();)e=d.next(),c.mapList.get(e)<b&&(f=this._data.getCellByIndex(e),c.mapList.remove(e),
f.existActor(l)&&f.removeActor(l))}}},__class__:oc});var rd=function(){this.objectList=new G;this.data=new Sa(18,10);this.cellSize=.016666666666666666;this._edge=10.5;this.geom=new sa;for(var a=0,b=this.data.width;a<b;)for(var c=a++,d=0,e=this.data.height;d<e;){var l=d++;this.data.set(c,l,new td(c,l))}};f["jump.StageData"]=rd;rd.__name__=["jump","StageData"];rd.prototype={load:function(a,b){this._callback=b;z.bytes.get(a).addEventListener(D.complete.get_type(),n(this,this.loaded))},getCell:function(a,
b){a=g.floor(a*this.cellSize);b=g.floor(b*this.cellSize);return this.getCellByXY(a,b)},getCellByXY:function(a,b){return this.data.outside(a,b)?null:this.data.get(a,b)},getCellByIndex:function(a){return this.data.getElement(a)},isEmpty:function(a,b){a=this.data.get(a,b);return null==a?!1:!a.block},getIndex:function(a,b){return this.data.getIndex(a,b)},setCell:function(a,b){1>b||(b=this.data.getX(a),a=this.data.getY(a),a=this.data.get(b,10-a-1),null!=a&&(a.block=!0))},loaded:function(a){a=a.target;
if(a.enabled){a=JSON.parse(a.bytes.toString());this.objectList.clear();a=q.getArray(a,"layers");for(var b=a.length;0<b--;){var c=a[b],d=q.getString(c,"type");if("tilelayer"==d)for(c=q.getArray(c,"data"),d=c.length;0<d--;)this.setCell(d,c[d]);else if("objectgroup"==d)for(c=q.getArray(c,"objects"),d=c.length;0<d--;){var e=c[d],l=new sd;l.parse(e);this.objectList.push(l)}}this.drawMesh();null!=this._callback&&this._callback()}},clear:function(){for(var a=this.data.length;0<a--;)this.data.getElement(a).clear()},
drawMesh:function(){this.geom.position=[];this.geom.uv=[];this._ilist=[];this._index=0;for(var a=k.get_temp().set(29,20,0),b=this.data.length,c;0<b--;){var d=this.data.getElement(b);if(d.block){var e=d.x,l=d.y,f=60*d.x,g=60*d.y;d=4;this.isEmpty(e-1,l)&&this.isEmpty(e,l-1)&&this.isEmpty(e-1,l-1)&&0<this._edge?(++d,c=new k(f,g+this._edge),this.geom.position.push(c.add(a)),this.geom.uv.push(new t(c.x/1138,c.y/640)),c=new k(f+this._edge,g)):c=new k(f,g);this.geom.position.push(c.add(a));this.geom.uv.push(new t(c.x/
1138,c.y/640));this.isEmpty(e+1,l)&&this.isEmpty(e,l-1)&&this.isEmpty(e+1,l-1)&&0<this._edge?(++d,c=new k(f+60-this._edge,g),this.geom.position.push(c.add(a)),this.geom.uv.push(new t(c.x/1138,c.y/640)),c=new k(f+60,g+this._edge)):c=new k(f+60,g);this.geom.position.push(c.add(a));this.geom.uv.push(new t(c.x/1138,c.y/640));this.isEmpty(e+1,l)&&this.isEmpty(e,l+1)&&this.isEmpty(e+1,l+1)&&0<this._edge?(++d,c=new k(f+60,g+60-this._edge),this.geom.position.push(c.add(a)),this.geom.uv.push(new t(c.x/1138,
c.y/640)),c=new k(f+60-this._edge,g+60)):c=new k(f+60,g+60);this.geom.position.push(c.add(a));this.geom.uv.push(new t(c.x/1138,c.y/640));this.isEmpty(e-1,l)&&this.isEmpty(e,l+1)&&this.isEmpty(e-1,l+1)&&0<this._edge?(++d,c=new k(f+this._edge,g+60),this.geom.position.push(c.add(a)),this.geom.uv.push(new t(c.x/1138,c.y/640)),c=new k(f,g+60-this._edge)):c=new k(f,g+60);this.geom.position.push(c.add(a));this.geom.uv.push(new t(c.x/1138,c.y/640));e=d-2;for(l=0;0<e--;)this._ilist.push(this._index),this._ilist.push(this._index+
l+1),this._ilist.push(this._index+l+2),++l;this._index+=d}}this.drawQuad(new k(0,0),new k(1138,0),new k(1109,20),new k(29,20));this.drawQuad(new k(1138,0),new k(1138,640),new k(1109,620),new k(1109,20));this.drawQuad(new k(1138,640),new k(0,640),new k(29,620),new k(1109,620));this.drawQuad(new k(0,640),new k(0,0),new k(29,20),new k(29,620));this.geom.addGroup(this._ilist)},drawQuad:function(a,b,c,d){this.geom.position.push(a);this.geom.uv.push(new t(a.x/1138,a.y/640));this.geom.position.push(b);this.geom.uv.push(new t(b.x/
1138,b.y/640));this.geom.position.push(c);this.geom.uv.push(new t(c.x/1138,c.y/640));this.geom.position.push(d);this.geom.uv.push(new t(d.x/1138,d.y/640));a=2;for(b=0;0<a--;)this._ilist.push(this._index),this._ilist.push(this._index+b+1),this._ilist.push(this._index+b+2),++b;this._index+=4},__class__:rd};var qc=function(){fa.call(this);this.type=2;this._img=this.addComponent(Oa);this._img.material.renderQueue=40100;var a=this.addComponent(ra);a.materials[0]=this._img.material;a.mesh=(new X).fromGeometry(this._img.geometry);
this._comp=this.addComponent(rc)};f["jump.Trace"]=qc;qc.__name__=["jump","Trace"];qc.__super__=fa;qc.prototype=p(fa.prototype,{start:function(){this._comp.start()},loadAvatar:function(a){fa.prototype.loadAvatar.call(this,a);this._img.load(a)},__class__:qc});var rc=function(){w.call(this)};f["jump.TraceHero"]=rc;rc.__name__=["jump","TraceHero"];rc.__super__=y;rc.prototype=p(y.prototype,{start:function(){this._cangle=new R;this._tangle=new R;this._hero=W.hero;this._size=16;this.stageData=W.data;this.bindEvent(v.onUpdate,
n(this,this.onUpdate))},stop:function(){this.bindEvent(v.onUpdate,null)},onAwake:function(){y.prototype.onAwake.call(this);this._moveValue=new t;this._moveDir=new t},onStart:function(){y.prototype.onStart.call(this);u.is(this.actor,fa)&&(this._actor=this.actor)},onUpdate:function(a){var b=this.actor.deltaTime;this._moveDir.set(this._hero.get_transform().position.x,this._hero.get_transform().position.y);this._moveDir.x-=this.actor.get_transform().position.x;this._moveDir.y-=this.actor.get_transform().position.y;
this._tangle.setEulerAngles(0,0,this._moveDir.get_angle());this._cangle.slerpTo(this._tangle,5*b);this._moveDir.set_angle(this._cangle.getEulerAngles().z);this._moveDir.normalize();this._moveValue.copy(this._moveDir).scale(115);a=this.actor.get_transform().position.x;var c=this.actor.get_transform().position.y;a+=this._moveValue.x*b;c+=this._moveValue.y*b;b=this.stageData.getCell(a,c+(0<this._moveDir.y?1:-1)*(this._size+1));null!=b&&b.isBlock(this._moveDir)&&(c=0<this._moveDir.y?60*b.y-this._size:
60*(b.y+1)+this._size);b=this.stageData.getCell(a+(0<this._moveDir.x?1:-1)*(this._size+1),c);null!=b&&b.isBlock(this._moveDir)&&(a=0<this._moveDir.x?60*b.x-this._size:60*(b.x+1)+this._size);this.actor.get_transform().position.x=a;this.actor.get_transform().position.y=c;null!=this._actor&&this._actor.updatePosition()},__class__:rc});var K=function(){};f["lovedna.Time"]=K;K.__name__=["lovedna","Time"];K.__properties__={get_now:"get_now"};K.setTimeHandler=function(a){null==a&&(a=K.getnow);K._custom=
a};K.setCustomNowTime=function(a){K._offset=a-K.get_now()};K.get_now=function(){return K._custom()};K.getnow=function(){return.001*(new Date).getTime()+K._offset};K.prototype={__class__:K};var jb=function(){};f["lovedna.ds.IArrayAccess"]=jb;jb.__name__=["lovedna","ds","IArrayAccess"];jb.prototype={__class__:jb};var Sa=function(a,b){if(1>a*b)throw new M("error size ");this._list=[];this.width=a;this.height=b;this.length=a*b};f["lovedna.ds.Array2D"]=Sa;Sa.__name__=["lovedna","ds","Array2D"];Sa.__interfaces__=
[jb];Sa.prototype={fill:function(a){for(var b=this.length;0<b--;)this._list[b]=a},clear:function(){this.fill(null)},fromArray:function(a){for(var b=this.length;0<b--;)this._list[b]=a[b]},getIndex:function(a,b){return 0>a||0>b||a>=this.width||b>=this.height?-1:b*this.width+a},getX:function(a){return a%this.width},getY:function(a){return g.floor(a/this.width)},get:function(a,b){a=this.getIndex(a,b);return 0<=a?this.getElement(a):null},set:function(a,b,c){a=this.getIndex(a,b);0<=a&&this.setElement(a,
c)},outside:function(a,b){return 0>a||0>b||a>=this.width||b>=this.height?!0:!1},getListByX:function(a,b){if(null!=b)for(var c=this.height;0<c--;)b[c]=this.get(a,c)},getListByY:function(a,b){if(null!=b)for(var c=this.width;0<c--;)b[c]=this.get(c,a)},rotateRight:function(){for(var a=0,b=0,c=this.width;b<c;)for(var d=b++,e=this.height;0<e--;){var l=this.get(d,e);Sa._temp[a++]=l}for(a=this.length;0<a--;)this._list[a]=Sa._temp[a];this.width^=this.height;this.height^=this.width;this.width^=this.height},
rotateLeft:function(){for(var a=0,b=this.width;0<b--;)for(var c=0,d=this.height;c<d;){var e=c++;e=this.get(b,e);Sa._temp[a++]=e}for(a=this.length;0<a--;)this._list[a]=Sa._temp[a];this.width^=this.height;this.height^=this.width;this.width^=this.height},getElement:function(a){return this._list[a]},setElement:function(a,b){this._list[a]=b},toString:function(){for(var a="\nArray2["+this.width+","+this.height+"]\n",b=0,c=this.height;b<c;){var d=b++;this.getListByY(d,Sa._temp);d=0;for(var e=this.width;d<
e;){var l=d++;0<l&&(a+=",");a+=u.string(Sa._temp[l])}a+="\n"}return a},__class__:Sa};var ud=function(a){this._items=new G;this._items.push(null);this._compare=a;this.count=0};f["lovedna.ds.BinaryHeap"]=ud;ud.__name__=["lovedna","ds","BinaryHeap"];ud.prototype={push:function(a){this._items.push(a);this.toRoot(this._items.get_length()-1);this.count=this._items.get_length()-1},shift:function(){if(1==this._items.get_length())return null;if(2==this._items.get_length())return this.count=0,this._items.pop();
var a=this._items.get(1);this.toLeaf();this.count=this._items.get_length()-1;return a},Clear:function(){this._items.set_length(1)},toRoot:function(a){for(var b=a;1<b;){var c=b>>1,d=this._items.get(b),e=this._items.get(c);if(0>this._compare(d,e))this._items.setElement(b,e),this._items.setElement(c,d);else break;b=c;if(0>a--)break}},toLeaf:function(){var a=1;this._items.setElement(1,this._items.pop());for(var b=this._items.get_length(),c=b;;){var d=a,e=a<<1;if(e<b){var l=this._items.get(a),f=this._items.get(e);
0<this._compare(l,f)&&(a=e,l=f);e+1<b&&(f=this._items.get(e+1),0<this._compare(l,f)&&(a=e+1))}if(a!=d)l=this._items.get(a),e=this._items.get(d),this._items.setElement(a,e),this._items.setElement(d,l);else break;if(0>c--)break}},__class__:ud};var va=function(a){null==a&&(a=0);this.value=0;this.value=a};f["lovedna.ds.Bit32"]=va;va.__name__=["lovedna","ds","Bit32"];va.prototype={toString:function(){return"Bit32("+g.toBin(this.value)+")"},getElement:function(a){pa.gt(0,a)?(a=u["int"](pa.toFloat(a)%pa.toFloat(32)),
a+=32):pa.gte(a,32)&&(a=u["int"](pa.toFloat(a)%pa.toFloat(32)));a=1<<a;return(this.value&a)==a},setElement:function(a,b){null==b&&(b=!0);0>a?a=a%32+32:32<=a&&(a%=32);this.value=b?this.value|1<<a:this.value&~(1<<a)},negate:function(){this.value^=-1;return this},clear:function(){this.value=0;return this},add:function(a,b){var c=null==b;this.value=(c?this:a).value|(c?a:b).value;return this},sub:function(a,b){var c=null==b;this.value=(c?this:a).value&~(c?a:b).value;return this},contains:function(a){return(this.value|
a.value)==this.value},__class__:va};var sc=function(a){null==a&&(a=0);this.bigEndian=!1;this._data=ka.alloc(a);this._length=this.position=0};f["lovedna.ds.Blob"]=sc;sc.__name__=["lovedna","ds","Blob"];sc.prototype={setBytes:function(a){if(null==a&&0==a.length)return this;this.__resize(a.length);this.position=0;this._data.blit(0,a,0,a.length);return this},getBytes:function(){this.trim();return this._data},readUnsignedByte:function(){var a=this.position;if(pa.gt(this.get_length(),a))return this._data.get(this.position++);
throw new M("EOF");},readByte:function(){var a=this.readUnsignedByte();return 0!=(a&128)?a-256:a},writeByte:function(a){this.__resize(this.position+1);this._data.set(this.position++,a&255)},readBoolean:function(){return 0!=this.readUnsignedByte()},writeBoolean:function(a){this.writeByte(a?1:0)},readUnsignedShort:function(){var a=this.readUnsignedByte(),b=this.readUnsignedByte();return this.bigEndian?a<<8|b:(b<<8)+a},readShort:function(){var a=this.readUnsignedShort();return 0!=(a&32768)?a-65536:a},
writeShort:function(a){this.__resize(this.position+2);this.bigEndian?(this._data.set(this.position++,a>>8),this._data.set(this.position++,a)):(this._data.set(this.position++,a),this._data.set(this.position++,a>>8))},readUnsignedInt:function(){var a=this.readUnsignedByte(),b=this.readUnsignedByte(),c=this.readUnsignedByte(),d=this.readUnsignedByte();return this.bigEndian?a<<24|b<<16|c<<8|d:d<<24|c<<16|b<<8|a},readInt:function(){var a=this.readUnsignedByte(),b=this.readUnsignedByte(),c=this.readUnsignedByte(),
d=this.readUnsignedByte();return this.bigEndian?a<<24|b<<16|c<<8|d:d<<24|c<<16|b<<8|a},writeUnsignedInt:function(a){this.writeInt(a)},writeInt:function(a){this.__resize(this.position+4);this.bigEndian?(this._data.set(this.position++,a>>24&255),this._data.set(this.position++,a>>16&255),this._data.set(this.position++,a>>8&255),this._data.set(this.position++,a&255)):(this._data.set(this.position++,a&255),this._data.set(this.position++,a>>8&255),this._data.set(this.position++,a>>16&255),this._data.set(this.position++,
a>>24&255))},readFloat:function(){return xa.i32ToFloat(this.readInt())},writeFloat:function(a){this.bigEndian?(a=xa.floatToI32(a),this.writeInt(a)):(this.__resize(this.position+4),this._data.setFloat(this.position,a),this.position+=4)},readDouble:function(){var a=this.readInt(),b=this.readInt();return this.bigEndian?xa.i64ToDouble(b,a):xa.i64ToDouble(a,b)},writeDouble:function(a){a=xa.doubleToI64(a);this.bigEndian?(this.writeInt(a.high),this.writeInt(a.low)):(this.writeInt(a.low),this.writeInt(a.high))},
readUTFBytes:function(a){if(this.position+a>this._length)throw new M("EOF");this.position+=a;return this._data.getString(this.position-a,a)},writeUTFBytes:function(a){a=ka.ofString(a);this.writeBytes(a)},readUTF:function(){var a=this.readUnsignedShort();return this.readUTFBytes(a)},writeUTF:function(a){a=ka.ofString(a);this.writeShort(a.length);this.writeBytes(a)},readBlob:function(a,b,c){null==c&&(c=0);null==b&&(b=0);0==c&&(c=this.get_length()-this.position);if(pa.gt(this.position+c,this.get_length()))throw new M("EOF");
a._data.length<b+c&&a.__resize(b+c);a._data.blit(b,this._data,this.position,c);this.position+=c},writeBlob:function(a,b,c){null==c&&(c=0);null==b&&(b=0);this.writeBytes(a.getBytes(),b,c)},writeBytes:function(a,b,c){null==c&&(c=0);null==b&&(b=0);0!=a.length&&(0==c&&(c=a.length-b),this.__resize(this.position+c),this._data.blit(this.position,a,b,c),this.position+=c)},trim:function(){if(this._data.length>this._length){var a=ka.alloc(this._length);a.blit(0,this._data,0,this._length);this._data=a}},__resize:function(a){if(a>
this._data.length){var b=ka.alloc(3*(a+1)>>1);b.blit(0,this._data,0,this._length);this._data=b}pa.gt(a,this.get_length())&&(this._length=a)},get_bytesAvailable:function(){return this._length-this.position},get_length:function(){return this._length},set_length:function(a){0<a&&this.__resize(a);a<this.position&&(this.position=a);return a},__class__:sc,__properties__:{get_bytesAvailable:"get_bytesAvailable",set_length:"set_length",get_length:"get_length"}};var ta={};f["lovedna.ds._ByteArray.ByteArray_Impl_"]=
ta;ta.__name__=["lovedna","ds","_ByteArray","ByteArray_Impl_"];ta._new=function(a){null==a&&(a=0);return new sc(a)};ta.fromBytes=function(a){return(new sc).setBytes(a)};ta.toBytes=function(a){return a.getBytes()};var G=function(){this._length=0};f["lovedna.ds.FastArray"]=G;G.__name__=["lovedna","ds","FastArray"];G.__interfaces__=[jb];G.prototype={toArray:function(){return this._buffer},clear:function(){if(null!=this._buffer&&!(1>this._length)){for(var a=g.minInt(this._length,this._buffer.length);0<
a--;)this._buffer[a]=null;this._length=0}},dispose:function(){this._buffer=null;this._length=0},fromList:function(a){if(null==a)return this;null==this._buffer&&(this._buffer=[],this._length=0);for(var b=a.length,c=0;c<b;){var d=c++;this._buffer[d]=a[d]}this._length=b;return this},add:function(a,b,c){null==c&&(c=0);null==b&&(b=0);if(null!=a){null==this._buffer&&(this._buffer=[],this._length=0);0>c&&(c=0);var d=a.get_length();0<b&&(d>=b&&(d=b),c+d>a.get_length()&&(d-=c+d-a.get_length()));for(b=0;b<
d;){var e=b++;this._buffer[this._length++]=a.getElement(c+e)}}},addList:function(a,b,c){null==c&&(c=0);null==b&&(b=0);if(null!=a){null==this._buffer&&(this._buffer=[],this._length=0);0>c&&(c=0);var d=a.length;0<b&&(d>=b&&(d=b),c+d>a.length&&(d-=c+d-a.length));for(b=0;b<d;){var e=b++;e=a[c+e];this._buffer[this._length++]=e}}},push:function(a){null==this._buffer&&(this._buffer=[]);this._buffer[this._length++]=a},pop:function(){if(null==this._buffer||1>this._length)return null;var a=this._buffer[--this._length];
this._buffer[this._length]=null;return a},shift:function(){if(null==this._buffer||1>this._length)return null;this._length--;return this._buffer.shift()},get:function(a,b){null==b&&(b=!1);if(b||0>a)a%=this._length,0>a&&(a+=this._length);return this.getElement(a)},getElement:function(a){return 1>this._length||null==this._buffer?null:this._buffer[a]},setElement:function(a,b){null==this._buffer&&(this._buffer=[]);this._buffer[a]=b;++a;this._length<a&&(this._length=a)},indexOf:function(a,b){null==b&&(b=
0);return null==this._buffer||1>this._length?-1:this._buffer.indexOf(a,b)},insert:function(a,b){null==this._buffer&&(this._buffer=[]);this._buffer.splice(a,0,b);this._length++},remove:function(a,b){null==b&&(b=0);if(null==this._buffer||1>this._length)return-1;a=this.indexOf(a,b);if(-1==a)return-1;this._buffer.splice(a,1);this._length--;return a},removeAt:function(a,b){null==b&&(b=1);null==this._buffer||1>this._length||1>b||(a+b>=this._length&&(b=this._length-a),1>b||(this._length-=b,this._buffer.splice(a,
b)))},unshift:function(a){null==this._buffer&&(this._buffer=[]);this._buffer.unshift(a);this._length++},sort:function(a){null!=this._buffer&&(2>this._length||this._buffer.sort(a))},toString:function(){return null!=this._buffer?this._length+" "+this._buffer.toString():"empty"},get_length:function(){return this._length},set_length:function(a){this._length=a;if(null==this._buffer)return this._length;var b=this._buffer.length;a<b&&this._buffer.splice(a,b-a);return this._length},__class__:G,__properties__:{set_length:"set_length",
get_length:"get_length"}};var kb=function(){this._lasttype=0;this.reset()};f["lovedna.ds.Fnv"]=kb;kb.__name__=["lovedna","ds","Fnv"];kb.prototype={reset:function(){this._lasttype=this._index=this._value=0},getCode:function(){return this._value},getString:function(){return g.intToHex(this._value)},addInt:function(a){2!=this._lasttype&&(this._lasttype=2,this._addInt(this._lasttype));this._addInt(a)},addString:function(a){4!=this._lasttype&&(this._lasttype=4,this._addInt(this._lasttype));var b=a.length;
for(this._addInt(b);0<b--;)this._addInt(B.cca(a,b))},addFloat:function(a){8!=this._lasttype&&(this._lasttype=8,this._addInt(this._lasttype));var b=g.floor(a);a=g.fract(a);this._addInt(b);0!=a&&this._addInt(g.round(4294967296*a))},addBool:function(a){16!=this._lasttype&&(this._lasttype=16,this._addInt(this._lasttype));this._addInt(a?1:0)},_addInt:function(a){this._value*=16777619;this._value^=a},__class__:kb};var yb=function(){};f["lovedna.ds.IFillArray"]=yb;yb.__name__=["lovedna","ds","IFillArray"];
yb.prototype={__class__:yb};var tc=function(a,b){null==b&&(b=!1);null==a&&(a="");this._list=[];this._keep=b;this.decode(a)};f["lovedna.ds.StringLine"]=tc;tc.__name__=["lovedna","ds","StringLine"];tc.prototype={readLine:function(){return this._position<this._length?this._list[this._position++]:null},writeLine:function(a){a=P.replace(a,"\r","\n");a=a.split("\n");for(var b=0,c=a.length;b<c;){var d=b++;d=a[d];(""!=d||this._keep)&&this._writeLine(d)}},encode:function(){return this._list.join("\n")},decode:function(a){0<
this._length&&this._list.splice(0,this._length);this._position=this._length=0;if(null!=a){a=P.replace(a,"\r","\n");a=a.split("\n");for(var b=0,c=a.length;b<c;){var d=b++;d=a[d];(""!=d||this._keep)&&this._list.push(d)}this._length=this._list.length;this._position=0}},_writeLine:function(a){this._position>=this._length&&this._length++;this._list[this._position++]=a},get_position:function(){return this._position},get_length:function(){return this._length},set_position:function(a){0<=a&&a<this._length&&
(this._position=a);return this._position},get_lineAvailable:function(){return this._length-this._position},__class__:tc,__properties__:{get_length:"get_length",get_lineAvailable:"get_lineAvailable",set_position:"set_position",get_position:"get_position"}};var qa=function(){};f["lovedna.utils.TypeUtil"]=qa;qa.__name__=["lovedna","utils","TypeUtil"];qa.getName=function(a){if(qa._typeMap.exists(a))return qa._typeMap.get(a);var b=ja.getClassName(a);qa._typeMap.set(a,b);return b};qa.createInstance=function(a,
b){a=null==b?ja.createEmptyInstance(a):ja.createInstance(a,b);u.is(a,Na)&&a.construct();return a};qa.getClassName=function(a){return null==a?"null":ja.getClassName(ja.getClass(a))};qa.getClass=function(a){if(qa._typeClassMap.exists(a))return qa._typeClassMap.get(a);var b=ja.getClass(a);qa._typeClassMap.set(a,b);return b};qa.prototype={__class__:qa};var D=function(a){this.name=a;this._type=qa.getClassName(this)+"."+a+"."+(new Date(2018,7,1,19,1,22)).getTime()};f["lovedna.events.Event"]=D;D.__name__=
["lovedna","events","Event"];D.prototype={get_type:function(){return this._type},__class__:D,__properties__:{get_type:"get_type"}};var hc=function(a,b){this.callback=a;this.priority=b};f["lovedna.events._EventDispatcher.Listener"]=hc;hc.__name__=["lovedna","events","_EventDispatcher","Listener"];hc.prototype={match:function(a){return this.callback==a},__class__:hc};var lb=function(a){D.call(this,a)};f["lovedna.events.KeyEvent"]=lb;lb.__name__=["lovedna","events","KeyEvent"];lb.__super__=D;lb.prototype=
p(D.prototype,{__class__:lb});var mb=function(a){D.call(this,a)};f["lovedna.events.TouchEvent"]=mb;mb.__name__=["lovedna","events","TouchEvent"];mb.__super__=D;mb.prototype=p(D.prototype,{__class__:mb});var Va=function(a){w.call(this);this.frames=new G;this.file=a;this._map=new I};f["lovedna.format.atlas.Atlas"]=Va;Va.__name__=["lovedna","format","atlas","Atlas"];Va.getAtlas=function(a){return Va._atlasMap.get(a)};Va.__super__=w;Va.prototype=p(w.prototype,{getSprite:function(a){return this._map.get(a)},
addSprite:function(a){this._map.exists(a.get_name())||(this._map.set(a.get_name(),a),this.frames.push(a))},encode:function(){var a=ta._new();null==this.file&&(this.file="");a.writeUTF(this.file);var b=this.frames.get_length();for(a.writeInt(b);0<b--;)this.frames.get(b).encode(a);return a},decode:function(a){this.file=a.readUTF();Va._atlasMap.set(this.file,this);var b=a.readInt();for(this.frames.clear();0<b--;){var c=new uc;c.decode(a);this.frames.push(c);this._map.set(c.get_name(),c)}},__class__:Va});
var uc=function(){this._name="";this.frame=new Wa;this._rotated=!1;this.sourceSize=new t;this.offset=new t;this.pivot=new t(.5,.5);this.border=new Wa(0,0,0,0);this._inited=!1};f["lovedna.format.atlas.SpriteData"]=uc;uc.__name__=["lovedna","format","atlas","SpriteData"];uc.prototype={hasBorder:function(){return 0<this.border.x||0<this.border.y||0<this.border.get_width()?!0:0<this.border.get_height()},encode:function(a){a.writeUTF(this.get_name());a.writeFloat(this.frame.x);a.writeFloat(this.frame.y);
a.writeFloat(this.frame.get_width());a.writeFloat(this.frame.get_height());a.writeBoolean(this.get_rotated());0==this.sourceSize.x&&(this.sourceSize.x=this.frame.get_width());0==this.sourceSize.y&&(this.sourceSize.y=this.frame.get_height());a.writeFloat(this.sourceSize.x);a.writeFloat(this.sourceSize.y);a.writeFloat(this.offset.x);a.writeFloat(this.offset.y);a.writeFloat(this.pivot.x);a.writeFloat(this.pivot.y);a.writeFloat(this.border.x);a.writeFloat(this.border.y);a.writeFloat(this.border.get_width());
a.writeFloat(this.border.get_height())},decode:function(a){this.set_name(a.readUTF());this.frame.set(a.readFloat(),a.readFloat(),a.readFloat(),a.readFloat());this.set_rotated(a.readBoolean());this.sourceSize.set(a.readFloat(),a.readFloat());this.offset.set(a.readFloat(),a.readFloat());this.pivot.set(a.readFloat(),a.readFloat());this.border.set(a.readFloat(),a.readFloat(),a.readFloat(),a.readFloat());this._inited=!0},get_name:function(){return this._name},set_name:function(a){this._inited||(this._name=
a);return this._name},get_rotated:function(){return this._rotated},set_rotated:function(a){this._inited||(this._rotated=a);return this._rotated},__class__:uc,__properties__:{set_rotated:"set_rotated",get_rotated:"get_rotated",set_name:"set_name",get_name:"get_name"}};var Jb=function(){w.call(this);this._chars=new Q;this.scaleH=this.scaleW=this.base=this.lineHeight=this.italic=this.bold=0;this.pages=1;this.id=this.packed=0};f["lovedna.format.fnt.Fnt"]=Jb;Jb.__name__=["lovedna","format","fnt","Fnt"];
Jb.__super__=w;Jb.prototype=p(w.prototype,{getChar:function(a){return this._chars.get(a)},encode:function(){var a=ta._new();a.writeUTF(this.face);a.writeInt(this.size);a.writeInt(this.bold);a.writeInt(this.italic);a.writeInt(this.lineHeight);a.writeInt(this.base);a.writeInt(this.scaleW);a.writeInt(this.scaleH);a.writeInt(this.pages);a.writeInt(this.packed);a.writeInt(this.id);a.writeUTF(this.file);a.writeInt(this.count);for(var b=this._chars.keys();b.hasNext();){var c=b.next();this._chars.get(c).encode(a)}return a},
decode:function(a){this.face=a.readUTF();this.size=a.readInt();this.bold=a.readInt();this.italic=a.readInt();this.lineHeight=a.readInt();this.base=a.readInt();this.scaleW=a.readInt();this.scaleH=a.readInt();this.pages=a.readInt();this.packed=a.readInt();this.id=a.readInt();this.file=a.readUTF();for(var b=this.count=a.readInt();0<b--;){var c=new vd;c.decode(a);this.addChar(c)}},addChar:function(a){this._chars.set(a.id,a)},__class__:Jb});var vd=function(){};f["lovedna.format.fnt.FntChar"]=vd;vd.__name__=
["lovedna","format","fnt","FntChar"];vd.prototype={parse:function(a){this.id=q.getInt(a,"id");this.x=q.getInt(a,"x");this.y=q.getInt(a,"y");this.width=q.getInt(a,"width");this.height=q.getInt(a,"height");this.xoffset=q.getFloat(a,"xoffset");this.yoffset=q.getFloat(a,"yoffset");this.xadvance=q.getFloat(a,"xadvance");this.page=q.getInt(a,"page")},encode:function(a){a.writeInt(this.id);a.writeInt(this.x);a.writeInt(this.y);a.writeInt(this.width);a.writeInt(this.height);a.writeFloat(this.xoffset);a.writeFloat(this.yoffset);
a.writeFloat(this.xadvance);a.writeInt(this.page)},decode:function(a){this.id=a.readInt();this.x=a.readInt();this.y=a.readInt();this.width=a.readInt();this.height=a.readInt();this.xoffset=a.readFloat();this.yoffset=a.readFloat();this.xadvance=a.readFloat();this.page=a.readInt()},__class__:vd};var Kb=function(){w.call(this)};f["lovedna.format.g3d.DataG3D"]=Kb;Kb.__name__=["lovedna","format","g3d","DataG3D"];Kb.encode=function(a){var b=ta._new();b.writeUTFBytes("G3D");b.writeInt(1);a.encode(b);return b};
Kb.__super__=w;Kb.prototype=p(w.prototype,{__class__:Kb});var vc=function(){this.nodeAnimations=[];this.totalTime=0};f["lovedna.format.g3d.ModelAnimation"]=vc;vc.__name__=["lovedna","format","g3d","ModelAnimation"];vc.prototype={add:function(a){null==this.nodeAnimations&&(this.nodeAnimations=[]);this.nodeAnimations.push(a);a.totalTime>this.totalTime&&(this.totalTime=a.totalTime)},encode:function(a){a.writeUTF(this.id);a.writeInt(this.nodeAnimations.length);for(var b=0,c=this.nodeAnimations.length;b<
c;){var d=b++;this.nodeAnimations[d].encode(a)}},decode:function(a){this.id=a.readUTF();for(var b=a.readInt();0<b--;){var c=new wc;c.decode(a);this.add(c)}},__class__:vc};var Ka=function(){this.id=""};f["lovedna.format.g3d.ModelData"]=Ka;Ka.__name__=["lovedna","format","g3d","ModelData"];Ka.prototype={clear:function(){this.bones=this.animations=this.nodes=this.materials=this.meshes=null;Ka.current=this;this.partCount=0},addMesh:function(a){null!=a&&(null==this.meshes&&(this.meshes=[]),null==a.id&&
(a.id=this.meshes.length+""),this.meshes.push(a))},getMeshById:function(a){for(var b=0,c=this.meshes;b<c.length;){var d=c[b];++b;if(d.id==a)return d}return null},getMeshByPartId:function(a){for(var b=0,c=this.meshes;b<c.length;){var d=c[b];++b;if(null!=d.getPart(a))return d}return null},addNode:function(a){null!=a&&(null==this.nodes&&(this.nodes=[]),this.nodes.push(a))},addMaterial:function(a){null!=a&&(null==this.materials&&(this.materials=[]),this.materials.push(a),a.Init())},getMaterial:function(a){null==
a&&(a="");if(null==this.materials)return null;if(1==this.materials.length&&""==a)return this.materials[0];for(var b=0,c=this.materials;b<c.length;){var d=c[b];++b;if(d.id==a)return d}return null},addBone:function(a){if(null==a)throw new M("bone is null");null==this.bones&&(this.bones=new I);this.bones.exists(a.id)||this.bones.set(a.id,a)},getBone:function(a){return null==this.bones?null:this.bones.get(a)},addAnimation:function(a){null==this.animations&&(this.animations=[]);this.animations.push(a)},
getAnimation:function(a){null==a&&(a="");if(null==this.animations)return null;if(1==this.animations.length&&""==a)return this.animations[0];for(var b=0,c=this.animations;b<c.length;){var d=c[b];++b;if(d.id==a)return d}return null},init:function(){if(null!=this.nodes)for(var a=0,b=this.nodes.length;a<b;){var c=a++;this.buildNode(this.nodes[c])}if(null!=this.meshes)for(a=0,b=this.meshes.length;a<b;)c=a++,this.meshes[c].init()},dispose:function(){if(null!=this.meshes)for(var a=0,b=this.meshes.length;a<
b;){var c=a++;this.meshes[c].dispose()}},buildNode:function(a){if(null!=a.parts)for(var b=0,c=a.parts.length;b<c;){var d=b++;d=a.parts[d];this.getMeshByPartId(d.meshPartId).addNodePart(d);if(null!=d.bones)for(var e=0,l=d.bones.length;e<l;){var f=e++;this.addBone(d.getBone(d.bones[f]))}}if(null!=a.children)for(b=0,a=a.children;b<a.length;)c=a[b],++b,this.buildNode(c)},encode:function(a){var b=new va;b.setElement(1,null!=this.meshes);b.setElement(2,null!=this.materials);b.setElement(3,null!=this.nodes);
b.setElement(4,null!=this.animations);a.writeUTF(this.id);a.writeInt(b.value);if(null!=this.meshes){b=this.meshes.length;a.writeInt(b);for(var c=0;c<b;){var d=c++;this.meshes[d].encode(a)}}if(null!=this.materials)for(b=this.materials.length,a.writeInt(b),c=0;c<b;)d=c++,this.materials[d].encode(a);if(null!=this.nodes)for(b=this.nodes.length,a.writeInt(b),c=0;c<b;)d=c++,this.nodes[d].encode(a);if(null!=this.animations)for(b=this.animations.length,a.writeInt(b),c=0;c<b;)d=c++,this.animations[d].encode(a)},
decode:function(a){this.animations=this.nodes=this.materials=this.meshes=null;this.id=a.readUTF();var b=new va;b.value=a.readInt();if(b.getElement(1))for(var c=0,d=a.readInt();c<d;){c++;var e=new Ba;e.decode(a);this.addMesh(e)}if(b.getElement(2))for(c=0,d=a.readInt();c<d;)c++,e=new xc,e.decode(a),this.addMaterial(e);if(b.getElement(3))for(c=0,d=a.readInt();c<d;)c++,e=new Wb,e.decode(a),this.addNode(e);if(b.getElement(4))for(b=0,c=a.readInt();b<c;)b++,d=new vc,d.decode(a),this.addAnimation(d)},__class__:Ka};
var xc=function(){this.opacity=1;this.shininess=2};f["lovedna.format.g3d.ModelMaterial"]=xc;xc.__name__=["lovedna","format","g3d","ModelMaterial"];xc.prototype={addTexture:function(a){null==this.textures&&(this.textures=[]);this.textures.push(a);a.Init()},getTexture:function(a){null==a&&(a=0);if(null==this.textures)return null;if(0==a)return this.textures[0];for(var b=0,c=this.textures;b<c.length;){var d=c[b];++b;if(d.usage==a)return d}return null},Init:function(){null!=this.ambient&&(this.ambient.w=
this.opacity);null!=this.diffuse&&(this.diffuse.w=this.opacity);null!=this.specular&&(this.specular.w=this.opacity);null!=this.emissive&&(this.emissive.w=this.opacity);null!=this.reflection&&(this.reflection.w=this.opacity)},decode:function(a){this.reflection=this.emissive=this.specular=this.diffuse=this.ambient=this.textures=null;this.id=a.readUTF();var b=new va;b.value=a.readInt();b.getElement(1)&&(this.ambient=new E(a.readFloat(),a.readFloat(),a.readFloat(),1));b.getElement(2)&&(this.diffuse=new E(a.readFloat(),
a.readFloat(),a.readFloat(),1));b.getElement(3)&&(this.emissive=new E(a.readFloat(),a.readFloat(),a.readFloat(),1));b.getElement(4)&&(this.specular=new E(a.readFloat(),a.readFloat(),a.readFloat(),1));b.getElement(5)&&(this.reflection=new E(a.readFloat(),a.readFloat(),a.readFloat(),1));this.opacity=a.readFloat();this.shininess=a.readFloat();if(b.getElement(6))for(b=a.readInt();0<b--;){var c=new Ca;c.decode(a);this.addTexture(c)}},encode:function(a){a.writeUTF(this.id);var b=new va(0);b.setElement(1,
null!=this.ambient);b.setElement(2,null!=this.diffuse);b.setElement(3,null!=this.emissive);b.setElement(4,null!=this.specular);b.setElement(5,null!=this.reflection);b.setElement(6,null!=this.textures);a.writeInt(b.value);null!=this.ambient&&(a.writeFloat(this.ambient.x),a.writeFloat(this.ambient.y),a.writeFloat(this.ambient.z));null!=this.diffuse&&(a.writeFloat(this.diffuse.x),a.writeFloat(this.diffuse.y),a.writeFloat(this.diffuse.z));null!=this.emissive&&(a.writeFloat(this.emissive.x),a.writeFloat(this.emissive.y),
a.writeFloat(this.emissive.z));null!=this.specular&&(a.writeFloat(this.specular.x),a.writeFloat(this.specular.y),a.writeFloat(this.specular.z));null!=this.reflection&&(a.writeFloat(this.reflection.x),a.writeFloat(this.reflection.y),a.writeFloat(this.reflection.z));a.writeFloat(this.opacity);a.writeFloat(this.shininess);if(null!=this.textures){a.writeInt(this.textures.length);b=0;for(var c=this.textures.length;b<c;){var d=b++;this.textures[d].encode(a)}}},__class__:xc};var Ba=function(){};f["lovedna.format.g3d.ModelMesh"]=
Ba;Ba.__name__=["lovedna","format","g3d","ModelMesh"];Ba.prototype={encode:function(a){a.writeUTF(this.id);var b=new va;b.setElement(1,null!=this.attributes);b.setElement(2,null!=this.vertices);b.setElement(3,null!=this.parts);a.writeInt(b.value);if(null!=this.attributes){a.writeInt(this.attributes.length);b=0;for(var c=this.attributes.length;b<c;){var d=b++;a.writeUTF(this.attributes[d])}}if(null!=this.vertices)for(a.writeInt(this.vertices.length),b=0,c=this.vertices.length;b<c;)d=b++,a.writeFloat(this.vertices[d]);
if(null!=this.parts)for(a.writeInt(this.parts.length),b=0,c=this.parts.length;b<c;)d=b++,this.parts[d].encode(a)},decode:function(a){this.parts=null;this.id=a.readUTF();var b=new va;b.value=a.readInt();if(b.getElement(1)){this.attributes=[];for(var c=a.readInt();0<c--;)this.attributes.push(a.readUTF())}if(b.getElement(2))for(this.vertices=[],c=a.readInt();0<c--;)this.vertices.push(a.readFloat());if(b.getElement(3))for(b=a.readInt();0<b--;)c=new yc,c.decode(a),this.addPart(c)},addPart:function(a){null==
this.parts&&(this.parts=[]);a.mesh=this;this.parts.push(a)},getPart:function(a){for(var b=this.parts.length;0<b--;){var c=this.parts[b];if(c.id==a)return c}return null},addNodePart:function(a){null==this.nodeParts&&(this.nodeParts=[]);this.nodeParts.push(a)},init:function(){this.geom=new sa;for(var a=[],b=0,c=0,d=this.attributes.length;c<d;){var e=c++;e=this.attributes[e];"POSITION"==e?(this.geom.position=[],a.push(n(this,this._readPOSITION)),b+=3):"NORMAL"==e?(this.geom.normal=[],a.push(n(this,this._readNORMAL)),
b+=3):"BINORMAL"==e?(this.geom.normal2=[],a.push(n(this,this._readBINORMAL)),b+=3):"TANGENT"==e?(this.geom.tangent=[],a.push(n(this,this._readTANGENT)),b+=3):"COLOR"==e?(this.geom.color=[],a.push(n(this,this._readCOLOR)),b+=4):"TEXCOORD0"==e?(this.geom.uv=[],a.push(n(this,this._readTEXCOORD0)),b+=2):"TEXCOORD1"==e?(this.geom.uv2=[],a.push(n(this,this._readTEXCOORD1)),b+=2):"BLENDWEIGHT0"==e?(this.geom.boneWeight=[],a.push(n(this,this._readBLENDWEIGHT0)),b+=2):"BLENDWEIGHT1"==e?(a.push(n(this,this._readBLENDWEIGHT1)),
b+=2):"BLENDWEIGHT2"==e?(a.push(n(this,this._readBLENDWEIGHT2)),b+=2):"BLENDWEIGHT3"==e&&(a.push(n(this,this._readBLENDWEIGHT3)),b+=2)}c=u["int"](this.vertices.length/b);if(c<this.vertices.length/b)throw new M("error vertices count");b=0;d=a.length;for(e=0;e<c;){e++;for(var l=0,f=d;l<f;){var g=l++;b+=a[g](b)}}if(null!=this.nodeParts)for(a=0,c=this.nodeParts.length;a<c;)b=a++,b=this.getPart(this.nodeParts[b].meshPartId),b.subMeshId=this.geom.groups.length,this.geom.addGroup(b.indices)},dispose:function(){this.vertices=
null;if(null!=this.nodeParts)for(var a=0,b=this.nodeParts.length;a<b;){var c=a++;this.getPart(this.nodeParts[c].meshPartId).indices=null}},_readPOSITION:function(a){a=(new k).fromArray(this.vertices,a);null!=Ka.transform&&Ka.transform.transformVector(a);this.geom.position.push(a);return 3},_readNORMAL:function(a){a=(new k).fromArray(this.vertices,a);null!=Ka.transform&&Ka.transform.transformVector(a);this.geom.normal.push(a.normalize());return 3},_readBINORMAL:function(a){a=(new k).fromArray(this.vertices,
a);null!=Ka.transform&&Ka.transform.transformVector(a);this.geom.normal2.push(a);return 3},_readTANGENT:function(a){this.geom.tangent.push((new E).fromArray(this.vertices,a));return 3},_readCOLOR:function(a){this.geom.color.push((new E).fromArray(this.vertices,a));return 4},_readTEXCOORD0:function(a){this.geom.uv.push((new t).fromArray(this.vertices,a));return 2},_readTEXCOORD1:function(a){this.geom.uv2.push((new t).fromArray(this.vertices,a));return 2},_readBLENDWEIGHT0:function(a){var b=new wd;
b.index.x=this.vertices[a];b.weight.x=this.vertices[a+1];this.geom.boneWeight.push(b);return 2},_readBLENDWEIGHT1:function(a){var b=this.geom.boneWeight[this.geom.boneWeight.length-1];b.index.y=this.vertices[a];b.weight.y=this.vertices[a+1];return 2},_readBLENDWEIGHT2:function(a){var b=this.geom.boneWeight[this.geom.boneWeight.length-1];b.index.z=this.vertices[a];b.weight.y=this.vertices[a+1];return 2},_readBLENDWEIGHT3:function(a){var b=this.geom.boneWeight[this.geom.boneWeight.length-1];b.index.w=
this.vertices[a];b.weight.w=this.vertices[a+1];return 2},__class__:Ba};var yc=function(){this.primitiveType="TRIANGLES"};f["lovedna.format.g3d.ModelMeshPart"]=yc;yc.__name__=["lovedna","format","g3d","ModelMeshPart"];yc.prototype={encode:function(a){a.writeUTF(this.id);a.writeUTF(this.primitiveType);if(null!=this.indices){a.writeInt(this.indices.length);for(var b=0,c=this.indices.length;b<c;){var d=b++;a.writeShort(this.indices[d])}}else a.writeInt(0)},decode:function(a){this.id=a.readUTF();this.primitiveType=
a.readUTF();var b=a.readInt();for(this.indices=[];0<b--;)this.indices.push(a.readShort())},__class__:yc};var Wb=function(){};f["lovedna.format.g3d.ModelNode"]=Wb;Wb.__name__=["lovedna","format","g3d","ModelNode"];Wb.prototype={addPart:function(a){null==this.parts&&(this.parts=[]);this.parts.push(a);a.node=this},addChildren:function(a){null==this.children&&(this.children=[]);this.children.push(a);a.parent=this},decode:function(a){this.scale=this.rotation=this.translation=this.meshId=this.children=
this.parts=null;this.id=a.readUTF();var b=new va;b.value=a.readInt();b.getElement(1)&&(this.translation=new k(a.readFloat(),a.readFloat(),a.readFloat()));b.getElement(2)&&(this.rotation=new R(a.readFloat(),a.readFloat(),a.readFloat(),a.readFloat()));b.getElement(3)&&(this.scale=new k(a.readFloat(),a.readFloat(),a.readFloat()));b.getElement(4)&&(this.meshId=a.readUTF());if(b.getElement(5))for(var c=a.readInt();0<c--;){var d=new zc;d.decode(a);this.addPart(d)}if(b.getElement(6))for(b=a.readInt();0<
b--;)c=new Wb,c.decode(a),this.addChildren(c)},encode:function(a){a.writeUTF(this.id);var b=new va;b.clear();b.setElement(1,null!=this.translation);b.setElement(2,null!=this.rotation);b.setElement(3,null!=this.scale);b.setElement(4,null!=this.meshId);b.setElement(5,null!=this.parts);b.setElement(6,null!=this.children);a.writeInt(b.value);null!=this.translation&&(a.writeFloat(this.translation.x),a.writeFloat(this.translation.y),a.writeFloat(this.translation.z));null!=this.rotation&&(a.writeFloat(this.rotation.x),
a.writeFloat(this.rotation.y),a.writeFloat(this.rotation.z),a.writeFloat(this.rotation.w));null!=this.scale&&(a.writeFloat(this.scale.x),a.writeFloat(this.scale.y),a.writeFloat(this.scale.z));null!=this.meshId&&a.writeUTF(this.meshId);if(null!=this.parts){b=this.parts.length;a.writeInt(b);for(var c=0;c<b;){var d=c++;this.parts[d].encode(a)}}if(null!=this.children)for(b=this.children.length,a.writeInt(b),c=0;c<b;)d=c++,this.children[d].encode(a)},__class__:Wb};var wc=function(){this.translation=[];
this.rotation=[];this.scaling=[];this.count=this.totalTime=0;this._tTime=[];this._rTime=[];this._sTime=[];this._rincTime=[];this._tincTime=[];this._sincTime=[];this._ct=new k;this._cr=new R;this._cs=new k};f["lovedna.format.g3d.ModelNodeAnimation"]=wc;wc.__name__=["lovedna","format","g3d","ModelNodeAnimation"];wc.prototype={getTranslation:function(a,b){var c=this.translation.length;if(1>c)return null;var d=g.binarySearchLow(this._tTime,a);if(0>d)return this._ct.copy(this.translation[0].value),this._ct;
a=(a-this._tTime[d])/this._tincTime[d];null!=b&&(a=b(a));this._ct.copy(this.translation[d].value);d+1<c&&this._ct.lerpTo(this.translation[d+1].value,a);return this._ct},getRotation:function(a,b){var c=this.rotation.length;if(1>c)return null;var d=g.binarySearchLow(this._rTime,a);if(0>d)return this._cr.copy(this.rotation[0].value),this._cr;a=(a-this._rTime[d])/this._rincTime[d];null!=b&&(a=b(a));this._cr.copy(this.rotation[d].value);d<c-1&&this._cr.slerpTo(this.rotation[d+1].value,a);return this._cr},
getScaling:function(a,b){var c=this.scaling.length;if(1>c)return null;var d=g.binarySearchLow(this._sTime,a);if(0>d)return this._cs.copy(this.scaling[0].value),this._cs;a=(a-this._sTime[d])/this._sincTime[d];null!=b&&(a=b(a));this._cs.copy(this.scaling[d].value);d<c-1&&this._cs.lerpTo(this.scaling[d+1].value,a);return this._cs},addTranslation:function(a){this.translation.push(a);0<this._tTime.length&&this._tincTime.push(a.keytime-this._tTime[this._tTime.length-1]);this._tTime.push(a.keytime)},addRotation:function(a){this.rotation.push(a);
0<this._rTime.length&&this._rincTime.push(a.keytime-this._rTime[this._rTime.length-1]);this._rTime.push(a.keytime)},addScaling:function(a){this.scaling.push(a);0<this._sTime.length&&this._sincTime.push(a.keytime-this._sTime[this._sTime.length-1]);this._sTime.push(a.keytime)},encode:function(a){a.writeUTF(this.nodeId);a.writeInt(this.translation.length);for(var b=0,c=this.translation.length;b<c;){var d=b++;d=this.translation[d];a.writeFloat(d.keytime);a.writeFloat(d.value.x);a.writeFloat(d.value.y);
a.writeFloat(d.value.z)}a.writeInt(this.rotation.length);b=0;for(c=this.rotation.length;b<c;)d=b++,d=this.rotation[d],a.writeFloat(d.keytime),a.writeFloat(d.value.x),a.writeFloat(d.value.y),a.writeFloat(d.value.z),a.writeFloat(d.value.w);a.writeInt(this.scaling.length);b=0;for(c=this.scaling.length;b<c;)d=b++,d=this.scaling[d],a.writeFloat(d.keytime),a.writeFloat(d.value.x),a.writeFloat(d.value.y),a.writeFloat(d.value.z)},decode:function(a){this.nodeId=a.readUTF();for(var b=a.readInt();0<b--;)this.addTranslation(new nb(a.readFloat(),
new k(a.readFloat(),a.readFloat(),a.readFloat())));for(b=a.readInt();0<b--;)this.addRotation(new nb(a.readFloat(),new R(a.readFloat(),a.readFloat(),a.readFloat(),a.readFloat())));for(b=a.readInt();0<b--;)this.addScaling(new nb(a.readFloat(),new k(a.readFloat(),a.readFloat(),a.readFloat())));this.init()},init:function(){this._tincTime.push(1);this._rincTime.push(1);this._sincTime.push(1);this.totalTime=this.count=0;var a=this.translation.length;0<a&&(this.count=a,this.totalTime=this.translation[a-
1].keytime);a=this.rotation.length;0<a&&(a>this.count&&(this.count=a),this.rotation[a-1].keytime>this.totalTime&&(this.totalTime=this.rotation[a-1].keytime));a=this.scaling.length;0<a&&(a>this.count&&(this.count=a),this.scaling[a-1].keytime>this.totalTime&&(this.totalTime=this.scaling[a-1].keytime))},__class__:wc};var nb=function(a,b){this.keytime=a;this.value=b};f["lovedna.format.g3d.ModelNodeKeyframe"]=nb;nb.__name__=["lovedna","format","g3d","ModelNodeKeyframe"];nb.prototype={__class__:nb};var zc=
function(){};f["lovedna.format.g3d.ModelNodePart"]=zc;zc.__name__=["lovedna","format","g3d","ModelNodePart"];zc.prototype={encode:function(a){a.writeUTF(this.materialId);a.writeUTF(this.meshPartId);if(null!=this.bones){a.writeInt(this.bones.length);for(var b=0,c=this.bones.length;b<c;){var d=b++;this.getBone(this.bones[d]).encode(a)}}else a.writeInt(0)},decode:function(a){Ka.current.partCount++;this._boneMap=this.bones=null;this.materialId=a.readUTF();this.meshPartId=a.readUTF();for(var b=a.readInt();0<
b--;){var c=new Ac;c.decode(a);this.addBone(c.id,c.translation,c.rotation,c.scale)}},addBone:function(a,b,c,d){null==this.bones&&(this.bones=[],this._boneMap=new I);var e=new Ac;this._boneMap.set(a,e);e.id=a;e.translation=b;e.rotation=c;e.scale=d;this.bones.push(a)},getBone:function(a){return this._boneMap.get(a)},__class__:zc};var Ac=function(){};f["lovedna.format.g3d.ModelNodePartBone"]=Ac;Ac.__name__=["lovedna","format","g3d","ModelNodePartBone"];Ac.prototype={encode:function(a){a.writeUTF(this.id);
var b=new va;b.setElement(1,null!=this.translation);b.setElement(2,null!=this.rotation);b.setElement(3,null!=this.scale);a.writeInt(b.value);null!=this.translation&&(a.writeFloat(this.translation.x),a.writeFloat(this.translation.y),a.writeFloat(this.translation.z));null!=this.rotation&&(a.writeFloat(this.rotation.x),a.writeFloat(this.rotation.y),a.writeFloat(this.rotation.z),a.writeFloat(this.rotation.w));null!=this.scale&&(a.writeFloat(this.scale.x),a.writeFloat(this.scale.y),a.writeFloat(this.scale.z))},
decode:function(a){this.id=a.readUTF();var b=new va;b.value=a.readInt();b.getElement(1)&&(this.translation=new k(a.readFloat(),a.readFloat(),a.readFloat()));b.getElement(2)&&(this.rotation=new R(a.readFloat(),a.readFloat(),a.readFloat(),a.readFloat()));b.getElement(3)&&(this.scale=new k(a.readFloat(),a.readFloat(),a.readFloat()))},__class__:Ac};var Ca=function(){this.uvTranslation=new t(0,0);this.uvScaling=new t(1,1);this.type="DIFFUSE";this.fileName=this.id=""};f["lovedna.format.g3d.ModelTexture"]=
Ca;Ca.__name__=["lovedna","format","g3d","ModelTexture"];Ca.prototype={Init:function(){"AMBIENT"==this.type?this.usage=4:"BUMP"==this.type?this.usage=8:"DIFFUSE"==this.type?this.usage=2:"EMISSIVE"==this.type?this.usage=3:"NONE"==this.type?this.usage=1:"NORMAL"==this.type?this.usage=7:"REFLECTION"==this.type?this.usage=10:"SHININESS"==this.type?this.usage=6:"SPECULAR"==this.type?this.usage=5:"TRANSPARENCY"==this.type&&(this.usage=9);this.usage=0},encode:function(a){null==this.id&&(this.id="");a.writeUTF(this.id);
a.writeUTF(this.fileName);a.writeUTF(this.type);a.writeFloat(this.uvTranslation.x);a.writeFloat(this.uvTranslation.y);a.writeFloat(this.uvScaling.x);a.writeFloat(this.uvScaling.y)},decode:function(a){this.id=a.readUTF();this.fileName=a.readUTF();this.type=a.readUTF();this.uvTranslation=new t(a.readFloat(),a.readFloat());this.uvScaling=new t(a.readFloat(),a.readFloat())},__class__:Ca};var wd=function(){this.index=new E(0,0,0,0);this.weight=new E(0,0,0,0)};f["lovedna.format.mesh.BoneWeight"]=wd;wd.__name__=
["lovedna","format","mesh","BoneWeight"];wd.prototype={__class__:wd};var O=function(a,b,c){null==c&&(c=!0);this._list=[];this._index=0;this._create=a;this._opts=b;this.count=0;c&&O._pools.push(this);this._avacount=10};f["lovedna.utils.TempPool"]=O;O.__name__=["lovedna","utils","TempPool"];O.reset=function(){for(var a=K.get_now(),b=O._pools.length;0<b--;)O._pools[b].clear(a)};O.prototype={get:function(){if(this._index<this._list.length){var a=this._list[this._index++];null!=this._opts&&null!=this._opts.reset&&
this._opts.reset(a)}else a=this._create(),this._list[this._index++]=a,null!=this._opts&&null!=this._opts.init&&this._opts.init(a);this.count=this._list.length;return a},clear:function(a){this._index=0},__class__:O};var t=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};f["lovedna.math.Vector2"]=t;t.__name__=["lovedna","math","Vector2"];t.__interfaces__=[jb,yb];t.__properties__={get_one:"get_one",get_zero:"get_zero",get_left:"get_left",get_right:"get_right",get_down:"get_down",get_up:"get_up",
get_temp:"get_temp"};t.get_temp=function(){return t._pool.get()};t.get_up=function(){return t.get_temp().set(0,1)};t.get_down=function(){return t.get_temp().set(0,-1)};t.get_right=function(){return t.get_temp().set(1,0)};t.get_left=function(){return t.get_temp().set(-1,0)};t.get_zero=function(){return t.get_temp().set(0,0)};t.get_one=function(){return t.get_temp().set(1,1)};t.prototype={toString:function(){return this.fixed(4)},fixed:function(a){null==a&&(a=4);return"Vector2("+g.fixed(this.x,a)+","+
g.fixed(this.y,a)+")"},set:function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;return this},copy:function(a){return null==a||a==this?this:this.set(a.x,a.y)},from:function(a){return this.set(a.x,a.y)},clone:function(){return new t(this.x,this.y)},add:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(d.x+a.x,d.y+a.y)},sub:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(d.x-a.x,d.y-a.y)},mul:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(d.x*a.x,
d.y*a.y)},dot:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return d.x*a.x+d.y*a.y},cross:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return d.x*a.y-d.y*a.x},min:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(g.min(d.x,a.x),g.min(d.y,a.y))},max:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(g.max(d.x,a.x),g.max(d.y,a.y))},scale:function(a){return this.set(this.x*a,this.y*a)},negate:function(){return this.set(-this.x,-this.y)},normalize:function(){var a=this.get_length();
return 0!=a?this.scale(1/a):this.set(0,0)},distanceSquared:function(a,b){var c=null==b,d=c?this:a;b=c?a:b;a=d.x-b.x;d=d.y-b.y;return a*a+d*d},distance:function(a,b){return Math.sqrt(this.distanceSquared(a,b))},equals:function(a){return this.x==a.x?this.y==a.y:!1},isZero:function(){return g.isZero(this.x)?g.isZero(this.y):!1},isOne:function(){return g.isZero(this.x-1)?g.isZero(this.y-1):!1},angleTo:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;b=d.get_length();c=a.get_length();return 0<b&&0<c?g.radianToAngle(Math.acos(d.dot(a)/
(b*c))):0},lerpTo:function(a,b){if(0>=b)return this;if(1<=b)return this.copy(a);this.x+=b*(a.x-this.x);this.y+=b*(a.y-this.y);return this},projectOnto:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;b=a.dot(a);if(0==b)return this.set(0,0);d=d.dot(a)/b;return this.copy(a).scale(d)},reflectBy:function(a){a=t.get_temp().copy(this).projectOnto(a);a.scale(2);return this.sub(a)},rotateLeft:function(){var a=-this.y;this.y=this.x;this.x=a;return this},rotateRight:function(){var a=this.y;this.y=-this.x;this.x=
a;return this},rotate:function(a,b){a=g.angleToRadian(a);var c=Math.cos(a);a=Math.sin(a);var d=this.x-b.x;b=this.y-b.y;this.x=d*c-b*a;this.y=d*a+b*c;return this},clamp:function(a,b){this.x=g.clamp(this.x,a,b);this.y=g.clamp(this.y,a,b);return this},getElement:function(a){0>a?a=a%2+2:2<=a&&(a%=2);return 0==a?this.x:this.y},setElement:function(a,b){0>a?a=a%2+2:2<=a&&(a%=2);0==a?this.x=b:this.y=b},fillArray:function(a,b){null==b&&(b=0);a[b++]=this.x;a[b++]=this.y},fromArray:function(a,b){null==b&&(b=
0);if(null==a)return this;var c=a.length;b<c&&(this.x=a[b++]);b<c&&(this.y=a[b++]);return this},get_length:function(){return Math.sqrt(this.get_lengthSq())},set_length:function(a){var b=Math.atan2(this.y,this.x);this.x=Math.cos(b)*a;this.y=Math.sin(b)*a;return a},get_lengthSq:function(){return this.x*this.x+this.y*this.y},get_angle:function(){return g.radianToAngle(Math.atan2(this.y,this.x))},set_angle:function(a){var b=this.get_length();a=g.angleToRadian(a);this.x=Math.cos(a)*b;this.y=Math.sin(a)*
b;return a},__class__:t,__properties__:{get_lengthSq:"get_lengthSq",get_length:"get_length",set_angle:"set_angle",get_angle:"get_angle"}};var sa=function(){this.id=sa._id++;this.groups=[]};f["lovedna.format.mesh.Geometry"]=sa;sa.__name__=["lovedna","format","mesh","Geometry"];sa.prototype={clearGroup:function(){this.groups.splice(0,this.groups.length)},addGroup:function(a){var b=0;0<this.groups.length&&(b=this.groups[this.groups.length-1],b=b.offset+b.indices.length);a=new xd(a,b);this.groups.push(a)},
addCustomUvGetter:function(a,b){null==b&&(b=-1);null==this._customUvGetter&&(this._customUvGetter=[]);0>b?this._customUvGetter.push(a):this._customUvGetter.splice(b,0,a)},getCustomUvGetter:function(a){null==a&&(a=0);return null==this._customUvGetter||null==this._customUvGetter[a]?n(this,this._getuv):this._customUvGetter[a]},_getuv:function(a,b){return sa._uv.set(a,b)},__class__:sa};var xd=function(a,b){null==b&&(b=0);this.indices=a;this.offset=b;this.start=2*b};f["lovedna.format.mesh.Group"]=xd;xd.__name__=
["lovedna","format","mesh","Group"];xd.prototype={__class__:xd};var Xb=function(){w.call(this);this._list=[];this._map=new I};f["lovedna.format.meta.Meta"]=Xb;Xb.__name__=["lovedna","format","meta","Meta"];Xb.__super__=w;Xb.prototype=p(w.prototype,{addMeta:function(a){this._list.push(a);null!=a.path&&this._map.set(a.path,a)},getMeta:function(a){return this._map.get(a)},encode:function(){var a=ta._new(),b=this._list.length;for(a.writeInt(b);0<b--;)a.writeUTF(this._list[b].encode());return a},decode:function(a){for(var b=
a.readInt();0<b--;){var c=new yd;c.read(JSON.parse(a.readUTF()));null!=c.path&&this._map.set(c.path,c)}},__class__:Xb});var yd=function(){this._meta=new I};f["lovedna.format.meta.MetaInfo"]=yd;yd.__name__=["lovedna","format","meta","MetaInfo"];yd.prototype={get:function(a){return this._meta.get(a)},addInfo:function(a,b){this._meta.set(a,b);"path"==a?this.path=b:"crc"==a?this.crc=b:"size"==a&&(this.size=b)},encode:function(){this._meta.set("path",this.path);return JSON.stringify(this._meta)},read:function(a){for(var b=
q.getKeys(a),c=b.length;0<c--;){var d=b[c];this.addInfo(d,q.getValue(a,d))}},__class__:yd};var zb=function(){this._IEND=new Y;this._IEND.type=1229278788;this._chunkList=[];if(null==zb._keepType){zb._keepType=new Q;for(var a=[1229472850,1229209940,1229278788,1665684045,1732332865,1933723988,1347179589,1649100612,1749635924,1951551059],b=a.length;0<b--;)zb._keepType.set(a[b],!0)}};f["lovedna.format.png.Png"]=zb;zb.__name__=["lovedna","format","png","Png"];zb.prototype={decode:function(a){var b=this._chunkList.length;
0<b&&this._chunkList.splice(0,b);if(!pa.gt(12,a.get_bytesAvailable())){a.bigEndian=!0;b=a.position;a.position=b+8;var c=a.readInt();if(100<c&&(a.position=b+8,c=a.readInt(),100<c))return;if(1229472850==a.readInt())for(a.position=b+8;pa.gt(a.get_length()-a.position,0);){b=new Y;b.decode(a);c=b.type;if(1>c)break;1229278788==c?this._IEND=b:this.addChunk(b)}}},pack:function(){var a=ta._new();a.bigEndian=!0;a.writeUnsignedInt(-1991225785);a.writeUnsignedInt(218765834);for(var b,c=0,d=this._chunkList.length;c<
d;)b=c++,b=this._chunkList[b].encode(),a.writeBlob(b);b=this._IEND.encode();a.writeBlob(b);return a},getChunkList:function(){return this._chunkList},getChunk:function(a){for(var b=this._chunkList.length;0<b--;){var c=this._chunkList[b];if(c.type==a)return c}return null},addChunk:function(a){this._chunkList.push(a)},getData:function(){return this._bytes},removeChunk:function(a){null==a&&(a=0);if(null!=this._chunkList)for(var b=this._chunkList.length;0<b--;){var c=this._chunkList[b];zb._keepType.exists(c.type)||
(0==a?this._chunkList.splice(b,1):c.type==a&&this._chunkList.splice(b,1))}},__class__:zb};var Y=function(){};f["lovedna.format.png.PngChunk"]=Y;Y.__name__=["lovedna","format","png","PngChunk"];Y.prototype={decode:function(a){var b=a.readUnsignedInt();this.type=a.readUnsignedInt();this._content=ta._new();0<b&&a.readBlob(this._content,0,b);this._crc=a.readInt()},encode:function(){var a=0;null!=this._content&&(a=this._content.get_length());var b=ta._new();b.bigEndian=!0;b.writeInt(a);b.writeUnsignedInt(this.type);
null!=this._content&&b.writeBlob(this._content);b.writeInt(this._crc);return b},getContent:function(){this._content.bigEndian=!1;return this._content},setContent:function(a){this._content=a;a=ta._new();a.bigEndian=!1;a.writeUnsignedInt(this.type);null!=this._content&&a.writeBlob(this._content);this._crc=ob.getCRC32(a.getBytes())},toString:function(){return"Chunk:0x"+g.intToHex(this.type,8)},__class__:Y};var Lb=function(a){this.type=a;this.compress=!0};f["lovedna.format.tag.TagData"]=Lb;Lb.__name__=
["lovedna","format","tag","TagData"];Lb.prototype={encode:function(a){this.compress&&(a.position=0,a=ta.fromBytes(ob.compress(ta.toBytes(a))));var b=a.get_length(),c=ta._new();c.writeUnsignedInt(-199789115);c.writeUnsignedInt(this.type);c.writeBoolean(this.compress);c.writeInt(b);c.writeBlob(a);return c},decode:function(a){if(pa.gt(1,a.get_bytesAvailable())||pa.gt(2,a.get_length()-a.position)||pa.gt(13,a.get_bytesAvailable()))return null;var b=a.get_length();if(pa.gte(a.position+13,b))return null;
if(-199789115==a.readUnsignedInt()){this.type=a.readUnsignedInt();b=a.readBoolean();var c=a.readInt(),d=ta._new();a.readBlob(d,0,c);return b?ta.fromBytes(ob.uncompress(ta.toBytes(d))):d}a.position-=4;return null},__class__:Lb};var Hb=function(a,b){this.component=a;this.state=b};f["lovedna.game._Actor.ComponentState"]=Hb;Hb.__name__=["lovedna","game","_Actor","ComponentState"];Hb.prototype={__class__:Hb};var Ab=function(){this.type=3;this.color=new S(0,0,0,0)};f["lovedna.game.CameraClearFlags"]=Ab;
Ab.__name__=["lovedna","game","CameraClearFlags"];Ab.prototype={__class__:Ab};var m=function(a,b,c){null==c&&(c=0);null==b&&(b=0);this.name=a;this.size=b;this.index=c};f["lovedna.game.DefineName"]=m;m.__name__=["lovedna","game","DefineName"];m.prototype={__class__:m};var fb=x.lovedna.game.Game=function(){w.call(this);this._frame=0;this.playStep=this.pause=!1;fb.current=this;this.commands=new Bc;this.pause=!1;this._worlds=new G;this.system=new r;this.clear=!0;this.color=new S;this.color.setRGBA(-1412567041);
this.system.addEventListener(na.init.get_type(),n(this,this.sysinit));aa.trace("Game build 2018-08-01 19:01:22",{fileName:"Game.hx",lineNumber:54,className:"lovedna.game.Game",methodName:"new"})};f["lovedna.game.Game"]=fb;fb.__name__=["lovedna","game","Game"];fb.debug=function(){debugger};fb.__super__=w;fb.prototype=p(w.prototype,{addWorld:function(a){fb.current=this;a.width=this.system.width;a.height=this.system.height;this._worlds.remove(a);this._worlds.push(a);a._onAdd()},removeWorld:function(a){this._worlds.remove(a);
a._onRemove()},sysinit:function(a){this.resize(null);this.system.addEventListener(na.update.get_type(),n(this,this.update));this.system.addEventListener(na.resize.get_type(),n(this,this.resize));h.init(r.gl);if(null!=this.onInit)this.onInit()},update:function(a){if(this.pause){if(!this.playStep)return;this.playStep=!1}this.commands.clear();h.start(this.w,this.h);a=this._target;null!=Z.customBackBuffer&&(a=Z.customBackBuffer);h.pushTarget(a);this.clear&&null!=this.color&&h.clear(this.color,1,0);for(var b=
0,c=this._worlds.get_length();b<c;){var d=b++;this._worlds.get(d)._update(this._frame)}this._frame+=1;A.update();b=0;for(c=this._worlds.get_length();b<c;)d=b++,this._worlds.get(d)._render();this.commands.flush();this.dispatchEvent(v.onPostRender);h.popTarget();Z.blit(a,null,Z.customBackMaterial);h.end();J._endFrame();O.reset()},resize:function(a){a=this._worlds.get_length();this.w=this.system.width;this.h=this.system.height;Z.setSize(this.w,this.h);for(var b=0;b<a;){var c=b++;this._worlds.get(c)._resize(this.w,
this.h)}null==this._target?(a=0,this.system.depth&&(a=16),this.system.stencil&&(a=24),this._target=new Cc(this.w,this.h,a)):this._target.resize(this.w,this.h)},__class__:fb});var ca=function(a){if(null==a)this.data=new va(-1);else{this.data=new va(0);for(var b=a.length;0<b--;){var c=ca.nameToLayer(a[b]);this.data.setElement(c)}0==this.data.value&&(this.data.value=-1)}};f["lovedna.game.LayerMask"]=ca;ca.__name__=["lovedna","game","LayerMask"];ca.setLayerName=function(a,b){null==ca._names[a]&&(ca._names[a]=
b,ca._layers.set(b,a))};ca.layerToName=function(a){return ca._names[a]};ca.nameToLayer=function(a){return ca._layers.get(a)};ca.prototype={exist:function(a){return this.data.getElement(a)},clear:function(){this.data.clear()},__class__:ca};var A=function(){};f["lovedna.game.GameInput"]=A;A.__name__=["lovedna","game","GameInput"];A.raycastAll=function(a,b,c,d){null==c&&(c=99999999);A._raycastList.clear();null==b&&(b=A._layerMask);null==d&&(d=$a.current);if(null==a||null==d)return A._raycastList;d=d.collectorCollider;
var e=d.count;for(c*=c;0<e--;){var l=d.get(e);l.enabled&&b.exist(l.actor.layer)&&(l=l.raycast(a,c),null!=l&&A._raycastList.push(l))}return A._raycastList};A.touchDown=function(a){null==a&&(a=0);return 1==A._touchDown.get(a)};A.touchUp=function(a){null==a&&(a=0);return 1==A._touchUp.get(a)};A.getTouch=function(a){null==a&&(a=0);return A._touchs[a]};A.update=function(){if(!A._init){A._init=!0;A._touchDown=new Q;A._touchUp=new Q;A._touchIdList=new G;for(var a=10;0<a--;)A._touchDown.set(a,!1),A._touchUp.set(a,
!1);A.touchCount=0;Da.onEvent.addEventListener(mb.onUpdate.get_type(),A.ontouch)}if(A._touchChange){A._touchChange=!1;for(a=A._touchIdList.get_length();0<a--;){var b=A._touchIdList.get(a);A._touchUp.get(b)&&A._touchIdList.removeAt(a);A._touchUp.set(b,!1);A._touchDown.set(b,!1)}A.touchCount=A._touchIdList.get_length()}};A.ontouch=function(a){a=mb.onUpdate.touch;var b=a.type;1==b?1!=A._touchDown.get(a.touchId)&&(A._touchIdList.push(a.touchId),A._touchDown.set(a.touchId,!0),A._touchChange=!0,A.touchCount=
A._touchIdList.get_length(),A._touchs[a.touchId]=a):5==b&&(A._touchUp.set(a.touchId,!0),A._touchChange=!0)};A.prototype={__class__:A};var la=function(){};f["lovedna.game.GameTime"]=la;la.__name__=["lovedna","game","GameTime"];la.__properties__={get_now:"get_now"};la.blur=function(){la._focused||la.focus();la._blurTime=K.get_now()};la.focus=function(){var a=K.get_now()-la._blurTime;la._offset+=a;la._blurTime=0};la.get_now=function(){return K.get_now()-la._offset};la.prototype={__class__:la};var La=
function(){this.uniforms=new bb;this.define=new Xa;this.renderQueue=2E4;this.shader=new wa(null);this.subMesh=-1;this.state=new F;this.color=new S(1,1,1,1);this.uniforms.setColor(m.COLOR.name,this.color)};f["lovedna.game.Material"]=La;La.__name__=["lovedna","game","Material"];La.getRenderQueue=function(a){return g.floor(1E4*g.clamp(g.floor(1E-4*a),1,5))};La.prototype={setTexture:function(a,b){null==b&&(b=m.TEX.name);null==a?(this.uniforms.remove(b),this.define.define(b,"",!1)):(this.uniforms.setTexture(a),
this.define.define(b,"",!0))},__class__:La};var X=function(){this.id=X._id--};f["lovedna.game.Mesh"]=X;X.__name__=["lovedna","game","Mesh"];X.deleteGeometryBuffer=function(a){if(X._geombuffer.exists(a)){var b=X._geombuffer.get(a);X._geombuffer.remove(a);b.unload()}};X.prototype={fromGeometry:function(a){if(X._geombuffer.exists(a.id))this.buffer=X._geombuffer.get(a.id),this.id=a.id,X._geombuffer.get(a.id).build();else{var b=new Dc(a);b.build();this.id=a.id;X._geombuffer.set(a.id,b);this.buffer=b}return this},
__class__:X};var Ec=function(){};f["lovedna.game.RaycastHit"]=Ec;Ec.__name__=["lovedna","game","RaycastHit"];Ec.prototype={__class__:Ec};var Ma=function(){};f["lovedna.game.render.RenderCommand"]=Ma;Ma.__name__=["lovedna","game","render","RenderCommand"];Ma.prototype={__class__:Ma};var bb=function(){this.data=new I};f["lovedna.game.ShaderUniform"]=bb;bb.__name__=["lovedna","game","ShaderUniform"];bb.prototype={clear:function(){for(var a=this.data.iterator();a.hasNext();){var b=a.next();this.data.remove(b.name)}},
copy:function(a){this.clear();for(a=a.data.iterator();a.hasNext();){var b=a.next();this.data.set(b.name,b)}},add:function(a){for(a=a.data.iterator();a.hasNext();){var b=a.next();this.data.set(b.name,b)}},bind:function(a){for(var b=this.data.iterator();b.hasNext();){var c=b.next(),d=a.getUniformInput(c.name);if(null!=d){if(!c.bind(d))return!1;d.set_success(!0)}}return!0},remove:function(a){this.data.remove(a)},setInt:function(a,b){this.get(a).setInt(b)},setFloat:function(a,b){this.get(a).setFloat(b)},
setFloatArray:function(a,b){this.get(a).setFloatArray(b)},setFloat2:function(a,b){this.get(a).setFloat2(b)},setFloat3:function(a,b){this.get(a).setFloat3(b)},setFloat4:function(a,b){this.get(a).setFloat4(b)},setColor:function(a,b){this.get(a).setFloat4(b)},setMatrix44:function(a,b){this.get(a).setMatrix(b)},setMatrix44Handler:function(a,b){this.get(a).setMatrixHandler(b)},setMatrix44Array:function(a,b){this.get(a).setMatrixArray(b)},setTexture:function(a,b){null==b&&(b=m.TEX.name);null==a?this.remove(b):
this.get(b).setTexture(a)},get:function(a){if(this.data.exists(a))return this.data.get(a);var b=new ya;b.name=a;this.data.set(a,b);return b},__class__:bb};var Xa=function(){this._defineMap=new I;this._define=null;this._id=-1};f["lovedna.game.ShaderDefine"]=Xa;Xa.__name__=["lovedna","game","ShaderDefine"];Xa.prototype={clear:function(){for(var a=this._defineMap.keys();a.hasNext();){var b=a.next();this._defineMap.remove(b);this.dirtyDefine()}},define:function(a,b,c){null==c&&(c=!0);null==b&&(b="");
c?(null==b&&(b=""),this._defineMap.exists(a))?this._defineMap.get(a)!=b&&(this._defineMap.set(a,b),this.dirtyDefine()):(this._defineMap.set(a,b),this.dirtyDefine()):this._defineMap.exists(a)&&(this._defineMap.remove(a),this.dirtyDefine())},dirtyDefine:function(){this._define=null;this._id=-1},sortDefine:function(a,b){return a!=b?a>b?1:-1:0},build:function(){this._id=0;this._define="";for(var a=[],b=this._defineMap.keys();b.hasNext();){var c=b.next();a.push(c)}if(!(1>a.length)){a.sort(n(this,this.sortDefine));
b=a.length;Xa._fnv.reset();Xa._fnv.addInt(b);for(c=new gc;0<b--;){var d=a[b];d="#define "+d+" "+this._defineMap.get(d)+"\n";Xa._fnv.addString(d);c.add(d)}this._id=Xa._fnv.getCode();this._define=c.toString()}},get_id:function(){if(-1!=this._id)return this._id;this.build();return this._id},get_value:function(){if(null!=this._define)return this._define;this.build();return this._define},__class__:Xa,__properties__:{get_id:"get_id",get_value:"get_value"}};var zd=function(){this._vert="precision highp float;\nprecision highp int;\nprecision lowp sampler2D;\nprecision lowp samplerCube;\n";
this._frag="precision highp float;\nprecision mediump int;\nprecision lowp sampler2D;\nprecision lowp samplerCube;\n"};f["lovedna.game.ShaderPrecision"]=zd;zd.__name__=["lovedna","game","ShaderPrecision"];zd.prototype={getVertPrecision:function(){return this._vert},getFragPrecision:function(){return this._frag},__class__:zd};var wa=function(a){null==a&&(a=cb.defaultCode);this.uniforms=new bb;this._code=a;this._id=-1;this._defineHashList=[];this._defineList=[]};f["lovedna.game.Shader"]=wa;wa.__name__=
["lovedna","game","Shader"];wa.prototype={clearDefine:function(a){null==a&&(a=0);null!=this._defineList[a]&&(this.dirtyDefine(),this._defineList[a]=null,this._defineHashList[a]=-1)},setDefine:function(a,b){null==b&&(b=0);0>b||5<b||null==a||null!=this._defineHashList[b]&&this._defineHashList[b]==a.get_id()||(this._defineList[b]=a,this.dirtyDefine())},bind:function(){if(null==this._code||-1==this.get_id())return!1;if(null==this._program)if(wa._programMap.exists(this.get_id()))this._program=wa._programMap.get(this.get_id());
else{var a=this._code.get_vert(),b=this._code.get_frag(),c=this.createDefine();this._program=new pb(c+wa.defaultPrecision.getVertPrecision()+a,c+wa.defaultPrecision.getFragPrecision()+b);wa._programMap.set(this.get_id(),this._program)}if(null==this._program||!this._program.enabled)return!1;this._program.bind();return!0},getBufferInput:function(a){if(null==this._code||null==this._program)return null;var b=this._code.getAttributeName(a);return null!=b?this._program.getBufferInput(b):this._program.getBufferInput(a)},
getUniformInput:function(a){if(null==this._code||null==this._program)return null;var b=this._code.getUniformName(a);return null!=b?this._program.getUniformInput(b):this._program.getUniformInput(a)},setCode:function(a){this.dirtyDefine();this._code=a},GetCode:function(){return this._code},checkUniformSuccess:function(){return 0==this._program.checkUniformFail()},dirtyDefine:function(){this._define=null;this._id=-1},sortDefine:function(a,b){return a!=b?a>b?1:-1:0},createDefine:function(){if(null!=this._define)return this._define;
this._define="";wa._fnv.reset();wa._fnv.addInt(this._code.id);if(0<this._code.get_defineCount())for(var a=this._defineList.length;0<a--;){var b=this._defineList[a];null!=b&&(this._define+=b.get_value(),this._defineHashList[a]=b.get_id(),wa._fnv.addInt(b.get_id()))}this._id=wa._fnv.getCode();return this._define},get_id:function(){-1==this._id&&this.createDefine();return this._id},__class__:wa,__properties__:{get_id:"get_id"}};var cb=function(a,b,c){this._defineCount=0;this.id=cb._id++;this.name=a;
if(null==b||""==b)b=cb.defaultCode.sourceVert;if(null==c||""==c)c=cb.defaultCode.sourceFrag;this.sourceVert=b;this.sourceFrag=c;this._vert=b;this._frag=c;this._attributeNames=new I;this._uniformNames=new I};f["lovedna.game.ShaderCode"]=cb;cb.__name__=["lovedna","game","ShaderCode"];cb.prototype={setAttributeAlias:function(a,b){this._attributeNames.set(b,a)},setUniformAlias:function(a,b){this._uniformNames.set(b,a)},getAttributeName:function(a){this.init();return this._attributeNames.get(a)},getUniformName:function(a){this.init();
return this._uniformNames.get(a)},existDefine:function(a){this.init();return this._defineMap.exists(a)},init:function(){this._init||(this._init=!0,this._defineMap=new I,this._vert="\n"+this.parse(this._vert),this._frag="\n"+this.parse(this._frag))},parse:function(a){a=new tc(a);for(var b="";0<a.get_lineAvailable();){var c=a.readLine();b+=this.parseLine(c)+"\n"}return b},parseLine:function(a){for(var b=g.trim(a),c="",d=[],e="",l=0,f=0,h=b.length;f<h;){var k=f++;k=b.charAt(k);if(" "==k||":"==k||";"==
k){d[l]=c;if(0==l)if("attribute"==c||"uniform"==c)e=a.indexOf(c),e=B.substr(a,0,e);else if("#ifdef"==c)e=a.indexOf(c),e=B.substr(a,0,e);else{l=0;break}++l;c=""}else c+=k}if(0!=l){""!=c&&(d[l]=c);b=d[0];if("attribute"==b)return this._attributeNames.set(d[3],d[2]),e+b+" "+d[1]+" "+d[2]+";";if("uniform"==b)return a=d[2],l=a.indexOf("["),-1!=l&&(a=B.substr(a,0,l)),this._uniformNames.set(d[3],a),e+b+" "+d[1]+" "+d[2]+";";"#ifdef"==b&&(d=d[1],null==d||this._defineMap.exists(d)||(this._defineMap.set(d,!0),
this._defineCount++))}return a},get_vert:function(){this.init();return this._vert},get_frag:function(){this.init();return this._frag},get_defineCount:function(){this.init();return this._defineCount},__class__:cb,__properties__:{get_defineCount:"get_defineCount",get_frag:"get_frag",get_vert:"get_vert"}};var F=function(){this.depthWrite=this.depthTest=!0;this.cullMode=1029;this.depthMode=513;this.stencilTest=!1;this.stencilMode=519;this.stencilFail=this.stencilDepthFail=this.stencilBothPass=7680;this.stencilReferenceValue=
0;this.stencilWriteMask=this.stencilReadMask=255;this.blend=!0;this.blendAlphaOperation=this.blendColorOperation=32774;this.blendSrcColor=770;this.blendDstColor=771;this.blendDstAlpha=this.blendSrcAlpha=1;this.drawMode=4};f["lovedna.game.graphics.GLState"]=F;F.__name__=["lovedna","game","graphics","GLState"];F.set=function(a){};F.prototype={copy:function(a){if(null==a)return this;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.cullMode=a.cullMode;this.depthMode=a.depthMode;this.stencilTest=
a.stencilTest;this.stencilMode=a.stencilMode;this.stencilBothPass=a.stencilBothPass;this.stencilDepthFail=a.stencilDepthFail;this.stencilFail=a.stencilFail;this.stencilReferenceValue=a.stencilReferenceValue;this.stencilReadMask=a.stencilReadMask;this.stencilWriteMask=a.stencilWriteMask;this.blend=a.blend;this.blendColorOperation=a.blendColorOperation;this.blendAlphaOperation=a.blendAlphaOperation;this.blendSrcColor=a.blendSrcColor;this.blendDstColor=a.blendDstColor;this.blendSrcAlpha=a.blendSrcAlpha;
this.blendDstAlpha=a.blendDstAlpha;this.drawMode=a.drawMode;return this},defaultValue:function(){this.depthWrite=this.depthTest=!1;this.cullMode=-1;this.depthMode=519;this.stencilTest=!0;this.stencilMode=514;this.stencilFail=this.stencilDepthFail=this.stencilBothPass=7680;this.stencilReferenceValue=0;this.stencilWriteMask=this.stencilReadMask=255;this.blend=!1;this.blendAlphaOperation=this.blendColorOperation=32774;this.blendSrcColor=770;this.blendDstColor=771;this.blendDstAlpha=this.blendSrcAlpha=
1;this.drawMode=4},__class__:F};var E=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d};f["lovedna.math.Vector4"]=E;E.__name__=["lovedna","math","Vector4"];E.__interfaces__=[jb,yb];E.__properties__={get_temp:"get_temp"};E.get_temp=function(){return E._pool.get()};E.prototype={toString:function(){return this.fixed(4)},fixed:function(a){null==a&&(a=4);return"Vector4("+g.fixed(this.x,a)+","+g.fixed(this.y,a)+","+g.fixed(this.z,a)+","+g.fixed(this.w,
a)+")"},set:function(a,b,c,d){null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d;return this},copy:function(a){return null==a||a==this?this:this.set(a.x,a.y,a.z,a.w)},from:function(a){return this.set(a.x,a.y,a.z,a.w)},clone:function(){return new E(this.x,this.y,this.z,this.w)},equals:function(a){return this.x==a.x&&this.y==a.y&&this.z==a.z?this.w==a.w:!1},add:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(d.x+a.x,d.y+a.y,d.z+a.z,d.w+a.w)},
sub:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(d.x-a.x,d.y-a.y,d.z-a.z,d.w-a.w)},mul:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(d.x*a.x,d.y*a.y,d.z*a.z,d.w*a.w)},min:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(g.min(d.x,a.x),g.min(d.y,a.y),g.min(d.z,a.z),g.min(d.w,a.w))},max:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(g.max(d.x,a.x),g.max(d.y,a.y),g.max(d.z,a.z),g.max(d.w,a.w))},clamp:function(a,b){return this.set(g.clamp(this.x,
a.x,b.x),g.clamp(this.y,a.y,b.y),g.clamp(this.z,a.z,b.z),g.clamp(this.w,a.w,b.w))},scale:function(a){return this.set(this.x*a,this.y*a,this.z*a,this.w*a)},negate:function(){return this.set(-this.x,-this.y,-this.z,-this.w)},getElement:function(a){0>a?a=a%4+4:4<=a&&(a%=4);switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w}return 0},setElement:function(a,b){0>a?a=a%4+4:4<=a&&(a%=4);switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;
case 3:this.w=b}},fillArray:function(a,b){null==b&&(b=0);a[b++]=this.x;a[b++]=this.y;a[b++]=this.z;a[b++]=this.w},fromArray:function(a,b){null==b&&(b=0);if(null==a)return this;var c=a.length;b<c&&(this.x=a[b++]);b<c&&(this.y=a[b++]);b<c&&(this.z=a[b++]);b<c&&(this.w=a[b++]);return this},__class__:E};var S=function(a,b,c,d){null==d&&(d=1);null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);E.call(this,a,b,c,d)};f["lovedna.math.Color"]=S;S.__name__=["lovedna","math","Color"];S.__properties__={get_temp:"get_temp"};
S.get_temp=function(){return S._pool.get()};S.__super__=E;S.prototype=p(E.prototype,{setRGBA:function(a){this.set_r(.00392156863*(a>>24&255));this.set_g(.00392156863*(a>>16&255));this.set_b(.00392156863*(a>>8&255));this.set_a(.00392156863*(a&255));return this},getRGBA:function(){var a=u["int"](255*this.get_r()),b=u["int"](255*this.get_g()),c=u["int"](255*this.get_b()),d=u["int"](255*this.get_a());return a<<24|b<<16|c<<8|d},setByte:function(a,b,c,d){null==d&&(d=255);null==c&&(c=255);null==b&&(b=255);
null==a&&(a=255);this.set_r(.00392156863*a);this.set_g(.00392156863*b);this.set_b(.00392156863*c);this.set_a(.00392156863*d);return this},mix:function(a,b){0>b&&(b=0);1<b&&(b=1);this.scale(1-b);S.get_temp().copy(a);S.get_temp().scale(b);this.add(S.get_temp());return this},compress:function(){return 1*this.x+.00392156862745098*this.y+1.5378700499807768E-5*this.z+6.030862941101084E-8*this.w},decompress:function(a){if(0<=a||1>=a){var b=g.fract(255*a),c=g.fract(255*b),d=g.fract(255*c);a-=.00392156863*
b;this.set(a,b-.00392156863*c,c-.00392156863*d,d)}return this},fixed:function(a){null==a&&(a=4);return"Color("+g.fixed(this.x,a)+","+g.fixed(this.y,a)+","+g.fixed(this.z,a)+","+g.fixed(this.w,a)+")"},get_r:function(){return this.x},get_g:function(){return this.y},get_b:function(){return this.z},get_a:function(){return this.w},set_r:function(a){return this.x=a},set_g:function(a){return this.y=a},set_b:function(a){return this.z=a},set_a:function(a){return this.w=a},__class__:S,__properties__:{set_a:"set_a",
get_a:"get_a",set_b:"set_b",get_b:"get_b",set_g:"set_g",get_g:"get_g",set_r:"set_r",get_r:"get_r"}});var oa=function(){};f["lovedna.game.render.commands.Blit"]=oa;oa.__name__=["lovedna","game","render","commands","Blit"];oa.__interfaces__=[Ma];oa.prototype={execute:function(a){null==this.material&&(this.material=oa._material);null==oa._mesh&&(oa._color=new S(0,0,0,0),oa._mat=new T,oa._mesh=new X,a=new sa,a.position=[new k(-1,-1,0),new k(1,-1,0),new k(1,1,0),new k(-1,1,0)],a.uv=[new t(0,0),new t(1,
0),new t(1,1),new t(0,1)],a.addGroup([0,1,2,0,2,3]),oa._mesh.fromGeometry(a));a=this.material.shader;null!=a&&this.source.enabled&&(this.material.uniforms.setMatrix44(m.M.name,oa._mat),this.material.uniforms.setMatrix44(m.V.name,oa._mat),this.material.uniforms.setMatrix44(m.P.name,oa._mat),this.material.uniforms.setMatrix44(m.VP.name,oa._mat),this.material.setTexture(this.source),a.setDefine(this.material.define,2),a.setDefine(oa._mesh.buffer.define,1),a.bind()&&(oa._mesh.buffer.updateLocations(a),
oa._mesh.buffer.getPositionBuffer().bind(a.get_id()),oa._mesh.buffer.getVertexBuffer().bind(a.get_id()),oa._mesh.buffer.getIndexBuffer().bind(),h.state(this.material.state),h.pushTarget(this.dest),h.drawBefore(),null!=this.rect&&h.viewport(g.floor(this.rect.x),g.floor(this.rect.get_height()-this.rect.y),g.floor(this.rect.get_width()),g.floor(this.rect.get_height())),this.material.uniforms.bind(a)&&(r.gl.drawElements(this.material.state.drawMode,oa._mesh.buffer.getIndexBuffer().length,5123,0),h.drawAfter(),
h.popTarget())))},__class__:oa};var Fc=function(){};f["lovedna.game.render.commands.Draw"]=Fc;Fc.__name__=["lovedna","game","render","commands","Draw"];Fc.__interfaces__=[Ma];Fc.prototype={execute:function(a){var b=a.currentMaterial;if(null!=b){var c=b.shader;if(null!=c){a.currentUniforms.add(b.uniforms);c.setDefine(b.define,2);c.setDefine(a.globalDefine,0);if(null!=a.currentMeshBuffer){var d=a.currentMeshBuffer.buffer;if(!d.enabled)return;a.currentIndexBuffer=d.getIndexBuffer();a.currentVertexBuffers.clear();
a.currentVertexBuffers.push(d.getPositionBuffer());null!=d.getVertexBuffer()&&a.currentVertexBuffers.push(d.getVertexBuffer());null!=d.getColorBuffer()&&a.currentVertexBuffers.push(d.getColorBuffer());null!=d.getBoneBuffer()&&a.currentVertexBuffers.push(d.getBoneBuffer());c.setDefine(d.define,1);c.bind();d.updateLocations(c)}else{if(null==a.currentIndexBuffer)return;c.bind();for(d=a.currentVertexBuffers.get_length();0<d--;){var e=a.currentVertexBuffers.getElement(d).layouts;if(null==e)a.currentVertexBuffers.removeAt(d);
else for(var l=e.length;0<l--;){var f=e[l],g=c.getBufferInput(f.name);null!=g&&(f.location=g.location)}}}for(d=a.currentVertexBuffers.get_length();0<d--;)if(!a.currentVertexBuffers.getElement(d).bind(c.get_id()))return;h.drawBefore();if(a.globalUniforms.bind(c)&&a.currentUniforms.bind(c)&&c.checkUniformSuccess()){a.currentIndexBuffer.bind();c=!0;d=a.currentMaterial.subMesh;0>d&&(c=!1);c&&(null==a.currentIndexBuffer.layouts?c=!1:null==a.currentIndexBuffer.layouts[d]&&(c=!1));h.state(b.state);if(c)c=
a.currentIndexBuffer.layouts[d],r.gl.drawElements(b.state.drawMode,c.length,5123,c.offset);else{c=a.currentIndexBuffer.length;if(2E4<c)debugger;r.gl.drawElements(b.state.drawMode,c,5123,0)}h.drawAfter();a.clearCurrent()}}}},__class__:Fc};var Gc=function(){};f["lovedna.game.render.commands.SetCallback"]=Gc;Gc.__name__=["lovedna","game","render","commands","SetCallback"];Gc.__interfaces__=[Ma];Gc.prototype={execute:function(a){this.v(a)},__class__:Gc};var Hc=function(){};f["lovedna.game.render.commands.SetRenderContext"]=
Hc;Hc.__name__=["lovedna","game","render","commands","SetRenderContext"];Hc.__interfaces__=[Ma];Hc.prototype={execute:function(a){Yb.current=this.value},__class__:Hc};var Ic=function(){};f["lovedna.game.render.commands.SetGlobalShaderUniform"]=Ic;Ic.__name__=["lovedna","game","render","commands","SetGlobalShaderUniform"];Ic.__interfaces__=[Ma];Ic.prototype={execute:function(a){a.globalUniforms.add(this.v)},__class__:Ic};var Jc=function(){};f["lovedna.game.render.commands.SetIndexBuffer"]=Jc;Jc.__name__=
["lovedna","game","render","commands","SetIndexBuffer"];Jc.__interfaces__=[Ma];Jc.prototype={execute:function(a){a.currentIndexBuffer=this.v},__class__:Jc};var Kc=function(){};f["lovedna.game.render.commands.SetMaterial"]=Kc;Kc.__name__=["lovedna","game","render","commands","SetMaterial"];Kc.__interfaces__=[Ma];Kc.prototype={execute:function(a){a.currentMaterial=this.v},__class__:Kc};var Lc=function(){};f["lovedna.game.render.commands.SetMeshBuffer"]=Lc;Lc.__name__=["lovedna","game","render","commands",
"SetMeshBuffer"];Lc.__interfaces__=[Ma];Lc.prototype={execute:function(a){a.currentMeshBuffer=this.v},__class__:Lc};var Mc=function(){};f["lovedna.game.render.commands.SetShaderDefine"]=Mc;Mc.__name__=["lovedna","game","render","commands","SetShaderDefine"];Mc.__interfaces__=[Ma];Mc.prototype={execute:function(a){},__class__:Mc};var Nc=function(){};f["lovedna.game.render.commands.SetShaderUniform"]=Nc;Nc.__name__=["lovedna","game","render","commands","SetShaderUniform"];Nc.__interfaces__=[Ma];Nc.prototype=
{execute:function(a){a.currentUniforms.add(this.v)},__class__:Nc};var Oc=function(){};f["lovedna.game.render.commands.SetVertexBuffer"]=Oc;Oc.__name__=["lovedna","game","render","commands","SetVertexBuffer"];Oc.__interfaces__=[Ma];Oc.prototype={execute:function(a){a.currentVertexBuffers.push(this.v)},__class__:Oc};var L=function(){this.enabled=!1;this._list=new G;this.distance=this.shaderId=0};f["lovedna.game.render.RenderBuffer"]=L;L.__name__=["lovedna","game","render","RenderBuffer"];L.__properties__=
{get_temp:"get_temp"};L.get_temp=function(){return L._pool.get()};L.prototype={clear:function(){this._list.clear()},add:function(a){this._list.push(a)},execute:function(){var a=this._list.get_length();L.$length+=a;for(var b=0;b<a;){var c=b++;this._list.getElement(c).execute(Yb.current)}},setContext:function(a){var b=L._SetContext.get();b.value=a;this.add(b)},setGlobalShaderUniform:function(a){var b=L._SetGlobalShaderUniform.get();b.v=a;this.add(b)},setGlobalShaderDefine:function(a){},setShaderDefine:function(a){var b=
L._SetShaderDefine.get();b.v=a;this.add(b)},setShaderUniform:function(a){var b=L._SetShaderUniform.get();b.v=a;this.add(b)},setMaterial:function(a){var b=L._SetMaterial.get();b.v=a;this.add(b)},setMeshBuffer:function(a){var b=L._SetMeshBuffer.get();b.v=a;this.add(b)},setIndexBuffer:function(a){var b=L._SetIndexBuffer.get();b.v=a;this.add(b)},setVertexBuffer:function(a){var b=L._SetVertexBuffer.get();b.v=a;this.add(b)},setCallback:function(a){var b=L._SetCallback.get();b.v=a;this.add(b)},draw:function(){var a=
L._Draw.get();this.add(a)},blit:function(a,b,c,d){var e=L._Blit.get();e.source=a;e.dest=b;e.material=c;e.rect=d;this.add(e)},__class__:L};var Z=function(){};f["lovedna.game.Screen"]=Z;Z.__name__=["lovedna","game","Screen"];Z.__properties__={get_currentBackBuffer:"get_currentBackBuffer"};Z.blit=function(a,b,c,d){a!=b&&(null==c&&(c=Z._material),Z._buffer.clear(),Z._buffer.blit(a,b,c,d),Z._buffer.execute())};Z.setSize=function(a,b){Z.width=a;Z.height=b};Z.get_currentBackBuffer=function(){return h.getTarget()};
Z.prototype={__class__:Z};var Pc=function(){};f["lovedna.game.graphics.RenderContext"]=Pc;Pc.__name__=["lovedna","game","graphics","RenderContext"];Pc.prototype={setup:function(a,b){this.gl=this.__context=a;this.version=b},beginQuery:function(a,b){this.__context.beginQuery(a,b)},beginTransformFeedback:function(a){this.__context.beginTransformFeedback(a)},bindBufferBase:function(a,b,c){this.__context.bindBufferBase(a,b,c)},bindBufferRange:function(a,b,c,d,e){this.__context.bindBufferRange(a,b,c,d,
e)},bindSampler:function(a,b){this.__context.bindSampler(a,b)},bindTransformFeedback:function(a,b){this.__context.bindTransformFeedback(a,b)},bindVertexArray:function(a){this.__context.bindVertexArray(a)},blitFramebuffer:function(a,b,c,d,e,l,f,g,h,k){this.__context.blitFramebuffer(a,b,c,d,e,l,f,g,h,k)},bufferData:function(a,b,c,d){this.__context.bufferData(a,c,d)},bufferSubData:function(a,b,c,d){this.__context.bufferSubData(a,b,d)},activeTexture:function(a){this.__context.activeTexture(a)},attachShader:function(a,
b){this.__context.attachShader(a,b)},bindAttribLocation:function(a,b,c){this.__context.bindAttribLocation(a,b,c)},bindBuffer:function(a,b){this.__context.bindBuffer(a,b)},bindFramebuffer:function(a,b){this.__context.bindFramebuffer(a,b)},bindRenderbuffer:function(a,b){this.__context.bindRenderbuffer(a,b)},bindTexture:function(a,b){this.__context.bindTexture(a,b)},blendColor:function(a,b,c,d){this.__context.blendColor(a,b,c,d)},blendEquation:function(a){this.__context.blendEquation(a)},blendEquationSeparate:function(a,
b){this.__context.blendEquationSeparate(a,b)},blendFunc:function(a,b){this.__context.blendFunc(a,b)},blendFuncSeparate:function(a,b,c,d){this.__context.blendFuncSeparate(a,b,c,d)},bufferDataWEBGL:function(a,b,c,d,e){null!=d?this.__context.bufferData(a,b,c,d,e):this.__context.bufferData(a,b,c)},bufferSubDataWEBGL:function(a,b,c,d,e){null!=d?this.__context.bufferSubData(a,b,c,d,e):this.__context.bufferSubData(a,b,c)},checkFramebufferStatus:function(a){return this.__context.checkFramebufferStatus(a)},
clear:function(a){this.__context.clear(a)},clearBufferfi:function(a,b,c,d){this.__context.clearBufferfi(a,b,c,d)},clearBufferfv:function(a,b,c){this.__context.clearBufferfv(a,b,c)},clearBufferfvWEBGL:function(a,b,c,d){this.__context.clearBufferfv(a,b,c,d)},clearBufferiv:function(a,b,c){this.__context.clearBufferiv(a,b,c)},clearBufferivWEBGL:function(a,b,c,d){this.__context.clearBufferiv(a,b,c,d)},clearBufferuiv:function(a,b,c){this.__context.clearBufferuiv(a,b,c.toUInt32Array())},clearBufferuivWEBGL:function(a,
b,c,d){this.__context.clearBufferuiv(a,b,c,d)},clearColor:function(a,b,c,d){this.__context.clearColor(a,b,c,d)},clearDepth:function(a){this.__context.clearDepth(a)},clearDepthf:function(a){this.clearDepth(a)},clearStencil:function(a){this.__context.clearStencil(a)},clientWaitSync:function(a,b,c){return this.__context.clientWaitSync(a,b,c)},copyBufferSubData:function(a,b,c,d,e){},colorMask:function(a,b,c,d){this.__context.colorMask(a,b,c,d)},compileShader:function(a){this.__context.compileShader(a)},
compressedTexImage2D:function(a,b,c,d,e,l,f,g){this.__context.compressedTexImage2D(a,b,c,d,e,l,g.toBufferView(f))},compressedTexImage2DWEBGL:function(a,b,c,d,e,l,f,g,h){null!=g?this.__context.compressedTexImage2D(a,b,c,d,e,l,f,g,h):this.__context.compressedTexImage2D(a,b,c,d,e,l,f)},compressedTexImage3D:function(a,b,c,d,e,l,f,g,h){this.__context.compressedTexImage3D(a,b,c,d,e,l,f,h.toBufferView(g))},compressedTexImage3DWEBGL:function(a,b,c,d,e,l,f,g,h,k){this.__context.compressedTexImage3D(a,b,c,
d,e,l,f,g,h,k)},compressedTexSubImage2D:function(a,b,c,d,e,l,f,g,h){this.__context.compressedTexSubImage2D(a,b,c,d,e,l,f,h.toBufferView(g))},compressedTexSubImage2DWEBGL:function(a,b,c,d,e,l,f,g,h,k){null!=h?this.__context.compressedTexSubImage2D(a,b,c,d,e,l,f,g,h,k):this.__context.compressedTexSubImage2D(a,b,c,d,e,l,f,g)},compressedTexSubImage3D:function(a,b,c,d,e,l,f,g,h,k,m){this.__context.compressedTexSubImage3D(a,b,c,d,e,l,f,g,h,m.toBufferView(k))},compressedTexSubImage3DWEBGL:function(a,b,c,
d,e,l,f,g,h,k,m,n){this.__context.compressedTexSubImage3D(a,b,c,d,e,l,f,g,h,k,m,n)},copySubBufferData:function(a,b,c,d,e){this.__context.copySubBufferData(a,b,c,d,e)},copyTexImage2D:function(a,b,c,d,e,l,f,g){this.__context.copyTexImage2D(a,b,c,d,e,l,f,g)},copyTexSubImage2D:function(a,b,c,d,e,l,f,g){this.__context.copyTexSubImage2D(a,b,c,d,e,l,f,g)},copyTexSubImage3D:function(a,b,c,d,e,l,f,g,h){this.__context.copyTexSubImage3D(a,b,c,d,e,l,f,g,h)},createBuffer:function(){return this.__context.createBuffer()},
createFramebuffer:function(){return this.__context.createFramebuffer()},createProgram:function(){return this.__context.createProgram()},createQuery:function(){return this.__context.createQuery()},createRenderbuffer:function(){return this.__context.createRenderbuffer()},createSampler:function(){return this.__context.createSampler()},createShader:function(a){return this.__context.createShader(a)},createTexture:function(){return this.__context.createTexture()},createTransformFeedback:function(){return this.__context.createTransformFeedback()},
createVertexArray:function(){return this.__context.createVertexArray()},cullFace:function(a){this.__context.cullFace(a)},deleteBuffer:function(a){this.__context.deleteBuffer(a)},deleteFramebuffer:function(a){this.__context.deleteFramebuffer(a)},deleteProgram:function(a){this.__context.deleteProgram(a)},deleteQuery:function(a){this.__context.deleteQuery(a)},deleteRenderbuffer:function(a){this.__context.deleteRenderbuffer(a)},deleteSampler:function(a){this.__context.deleteSampler(a)},deleteShader:function(a){this.__context.deleteShader(a)},
deleteSync:function(a){this.__context.deleteSync(a)},deleteTexture:function(a){this.__context.deleteTexture(a)},deleteTransformFeedback:function(a){this.__context.deleteTransformFeedback(a)},deleteVertexArray:function(a){this.__context.deleteVertexArray(a)},depthFunc:function(a){this.__context.depthFunc(a)},depthMask:function(a){this.__context.depthMask(a)},depthRange:function(a,b){this.__context.depthRange(a,b)},depthRangef:function(a,b){this.depthRange(a,b)},detachShader:function(a,b){this.__context.detachShader(a,
b)},disable:function(a){this.__context.disable(a)},disableVertexAttribArray:function(a){this.__context.disableVertexAttribArray(a)},drawArrays:function(a,b,c){this.__context.drawArrays(a,b,c)},drawArraysInstanced:function(a,b,c,d){this.__context.drawArraysInstanced(a,b,c,d)},drawBuffers:function(a){this.__context.drawBuffers(a)},drawElements:function(a,b,c,d){this.__context.drawElements(a,b,c,d)},drawElementsInstanced:function(a,b,c,d,e){this.__context.drawElementsInstanced(a,b,c,d,e)},drawRangeElements:function(a,
b,c,d,e,l){this.__context.drawRangeElements(a,b,c,d,e,l)},enable:function(a){this.__context.enable(a)},enableVertexAttribArray:function(a){this.__context.enableVertexAttribArray(a)},endQuery:function(a){this.__context.endQuery(a)},endTransformFeedback:function(){this.__context.endTransformFeedback()},fenceSync:function(a,b){return this.__context.fenceSync(a,b)},finish:function(){this.__context.finish()},flush:function(){this.__context.flush()},framebufferRenderbuffer:function(a,b,c,d){this.__context.framebufferRenderbuffer(a,
b,c,d)},framebufferTexture2D:function(a,b,c,d,e){this.__context.framebufferTexture2D(a,b,c,d,e)},framebufferTextureLayer:function(a,b,c,d,e){this.__context.framebufferTextureLayer(a,b,c,d,e)},frontFace:function(a){this.__context.frontFace(a)},generateMipmap:function(a){this.__context.generateMipmap(a)},getActiveAttrib:function(a,b){return this.__context.getActiveAttrib(a,b)},getActiveUniform:function(a,b){return this.__context.getActiveUniform(a,b)},getActiveUniformBlocki:function(a,b,c){return this.getActiveUniformBlockParameter(a,
b,c)},getActiveUniformBlockiv:function(a,b,c,d){d[0]=this.getActiveUniformBlockParameter(a,b,c)},getActiveUniformBlockName:function(a,b){return this.__context.getActiveUniformBlockName(a,b)},getActiveUniformBlockParameter:function(a,b,c){return this.__context.getActiveUniformBlockParameter(a,b,c)},getActiveUniforms:function(a,b,c){return this.__context.getActiveUniforms(a,b,c)},getActiveUniformsiv:function(a,b,c,d){},getAttachedShaders:function(a){return this.__context.getAttachedShaders(a)},getAttribLocation:function(a,
b){return this.__context.getAttribLocation(a,b)},getBoolean:function(a){return this.getParameter(a)},getBooleanv:function(a,b){a=this.getParameter(a);if(a instanceof Array&&null==a.__enum__)for(var c=0,d=a.length;c<d;){var e=c++;b[e]=a[e]?1:0}else b[0]=H.__cast(a,ee)?1:0},getBufferParameter:function(a,b){return this.__context.getBufferParameter(a,b)},getBufferParameteri:function(a,b){return this.getBufferParameter(a,b)},getBufferParameteri64v:function(a,b,c){},getBufferParameteriv:function(a,b,c){c[0]=
this.getBufferParameter(a,b)},getBufferPointerv:function(a,b){return 0},getBufferSubData:function(a,b,c,d){this.__context.getBufferSubData(a,b,d)},getBufferSubDataWEBGL:function(a,b,c,d,e){null!=d?this.__context.getBufferSubData(a,b,c,d,e):this.__context.getBufferSubData(a,b,c)},getContextAttributes:function(){return this.__context.getContextAttributes()},getError:function(){return this.__context.getError()},getExtension:function(a){return this.__context.getExtension(a)},getFloat:function(a){return this.getParameter(a)},
getFloatv:function(a,b){a=this.getParameter(a);if(u.is(a,ArrayBufferView))for(var c=0,d=a.length;c<d;){var e=c++;b[e]=a[e]}else b[0]=H.__cast(a,ae)},getFragDataLocation:function(a,b){return this.__context.getFragDataLocation(a,b)},getFramebufferAttachmentParameter:function(a,b,c){return this.__context.getFramebufferAttachmentParameter(a,b,c)},getFramebufferAttachmentParameteri:function(a,b,c){return this.getFramebufferAttachmentParameter(a,b,c)},getFramebufferAttachmentParameteriv:function(a,b,c,
d){a=this.getFramebufferAttachmentParameteri(a,b,c);d[0]=a},getIndexedParameter:function(a,b){return this.__context.getIndexedParameter(a,b)},getInteger:function(a){return this.getParameter(a)},getInteger64:function(a){return new Vb(0,0)},getInteger64i:function(a){return new Vb(0,0)},getInteger64i_v:function(a,b,c){},getInteger64v:function(a,b){},getIntegeri:function(a){return 0},getIntegeri_v:function(a,b,c){},getIntegerv:function(a,b){a=this.getParameter(a);if(u.is(a,ArrayBufferView))for(var c=
0,d=a.length;c<d;){var e=c++;b[e]=a[e]}else b[0]=H.__cast(a,be)},getInternalformati:function(a,b,c){return 0},getInternalformativ:function(a,b,c,d,e){},getInternalformatParameter:function(a,b,c){return this.__context.getInternalformatParameter(a,b,c)},getParameter:function(a){return this.__context.getParameter(a)},getProgramBinary:function(a,b){return null},getProgrami:function(a,b){return this.getProgramParameter(a,b)},getProgramiv:function(a,b,c){c[0]=this.getProgramParameter(a,b)},getProgramInfoLog:function(a){return this.__context.getProgramInfoLog(a)},
getProgramParameter:function(a,b){return this.__context.getProgramParameter(a,b)},getQuery:function(a,b){return this.__context.getQuery(a,b)},getQueryi:function(a,b){return 0},getQueryiv:function(a,b,c){},getQueryObjectui:function(a,b){return 0},getQueryObjectuiv:function(a,b,c){},getQueryParameter:function(a,b){return this.__context.getQueryParameter(a,b)},getRenderbufferParameter:function(a,b){return this.__context.getRenderbufferParameter(a,b)},getRenderbufferParameteri:function(a,b){return this.getRenderbufferParameter(a,
b)},getRenderbufferParameteriv:function(a,b,c){c[0]=this.getRenderbufferParameter(a,b)},getSamplerParameter:function(a,b){return this.__context.getSamplerParameter(a,b)},getSamplerParameterf:function(a,b){return 0},getSamplerParameterfv:function(a,b,c){},getSamplerParameteri:function(a,b){return 0},getSamplerParameteriv:function(a,b,c){},getShaderi:function(a,b){return this.getShaderParameter(a,b)},getShaderiv:function(a,b,c){c[0]=this.getShaderParameter(a,b)},getShaderInfoLog:function(a){return this.__context.getShaderInfoLog(a)},
getShaderParameter:function(a,b){return this.__context.getShaderParameter(a,b)},getShaderPrecisionFormat:function(a,b){return this.__context.getShaderPrecisionFormat(a,b)},getShaderSource:function(a){return this.__context.getShaderSource(a)},getString:function(a){return this.getParameter(a)},getStringi:function(a,b){return null},getSupportedExtensions:function(){return this.__context.getSupportedExtensions()},getSyncParameter:function(a,b){return this.__context.getSyncParameter(a,b)},getSyncParameteri:function(a,
b){return 0},getSyncParameteriv:function(a,b,c){},getTexParameter:function(a,b){return this.__context.getTexParameter(a,b)},getTexParameterf:function(a,b){return this.getTexParameter(a,b)},getTexParameterfv:function(a,b,c){c[0]=this.getTexParameter(a,b)},getTexParameteri:function(a,b){return this.getTexParameter(a,b)},getTexParameteriv:function(a,b,c){c[0]=this.getTexParameter(a,b)},getTransformFeedbackVarying:function(a,b){return this.__context.getTransformFeedbackVarying(a,b)},getUniform:function(a,
b){return this.__context.getUniform(a,b)},getUniformf:function(a,b){return this.getUniform(a,b)},getUniformfv:function(a,b,c){c[0]=this.getUniformf(a,b)},getUniformi:function(a,b){return this.getUniform(a,b)},getUniformiv:function(a,b,c){a=this.getUniformi(a,b);c[0]=a},getUniformui:function(a,b){return 0},getUniformuiv:function(a,b,c){},getUniformBlockIndex:function(a,b){return this.__context.getUniformBlockIndex(a,b)},getUniformIndices:function(a,b){return this.__context.getUniformIndices(a,b)},
getUniformLocation:function(a,b){return this.__context.getUniformLocation(a,b)},getVertexAttrib:function(a,b){return this.__context.getVertexAttrib(a,b)},getVertexAttribf:function(a,b){return 0},getVertexAttribfv:function(a,b,c){},getVertexAttribi:function(a,b){return 0},getVertexAttribIi:function(a,b){return 0},getVertexAttribIiv:function(a,b,c){},getVertexAttribIui:function(a,b){return 0},getVertexAttribIuiv:function(a,b,c){},getVertexAttribiv:function(a,b,c){},getVertexAttribOffset:function(a,
b){return this.__context.getVertexAttribOffset(a,b)},getVertexAttribPointerv:function(a,b){return this.getVertexAttribOffset(a,b)},hint:function(a,b){this.__context.hint(a,b)},invalidateFramebuffer:function(a,b){this.__context.invalidateFramebuffer(a,b)},invalidateSubFramebuffer:function(a,b,c,d,e,l){this.__context.invalidateSubFramebuffer(a,b,c,d,e,l)},isBuffer:function(a){return this.__context.isBuffer(a)},isEnabled:function(a){return this.__context.isEnabled(a)},isFramebuffer:function(a){return this.__context.isFramebuffer(a)},
isProgram:function(a){return this.__context.isProgram(a)},isQuery:function(a){return this.__context.isQuery(a)},isRenderbuffer:function(a){return this.__context.isRenderbuffer(a)},isSampler:function(a){return this.__context.isSampler(a)},isShader:function(a){return this.__context.isShader(a)},isSync:function(a){return this.__context.isSync(a)},isTexture:function(a){return this.__context.isTexture(a)},isTransformFeedback:function(a){return this.__context.isTransformFeedback(a)},isVertexArray:function(a){return this.__context.isVertexArray(a)},
lineWidth:function(a){this.__context.lineWidth(a)},linkProgram:function(a){this.__context.linkProgram(a)},mapBufferRange:function(a,b,c,d){return 0},pauseTransformFeedback:function(){this.__context.pauseTransformFeedback()},pixelStorei:function(a,b){this.__context.pixelStorei(a,b)},polygonOffset:function(a,b){this.__context.polygonOffset(a,b)},programBinary:function(a,b,c,d){},programParameteri:function(a,b,c){},readBuffer:function(a){this.__context.readBuffer(a)},readPixels:function(a,b,c,d,e,l,
f){this.__context.readPixels(a,b,c,d,e,l,f.toBufferView())},readPixelsWEBGL:function(a,b,c,d,e,l,f,g){null!=g?this.__context.readPixels(a,b,c,d,e,l,f,g):this.__context.readPixels(a,b,c,d,e,l,f)},releaseShaderCompiler:function(){},renderbufferStorage:function(a,b,c,d){this.__context.renderbufferStorage(a,b,c,d)},renderbufferStorageMultisample:function(a,b,c,d,e){1==this.version?this.renderbufferStorage(a,c,d,e):2==this.version&&this.__context.renderbufferStorageMultisample(a,b,c,d,e)},resumeTransformFeedback:function(){this.__context.resumeTransformFeedback()},
sampleCoverage:function(a,b){this.__context.sampleCoverage(a,b)},samplerParameterf:function(a,b,c){this.__context.samplerParameterf(a,b,c)},samplerParameteri:function(a,b,c){this.__context.samplerParameteri(a,b,c)},scissor:function(a,b,c,d){this.__context.scissor(a,b,c,d)},shaderBinary:function(a,b,c,d){},shaderSource:function(a,b){this.__context.shaderSource(a,b)},stencilFunc:function(a,b,c){this.__context.stencilFunc(a,b,c)},stencilFuncSeparate:function(a,b,c,d){this.__context.stencilFuncSeparate(a,
b,c,d)},stencilMask:function(a){this.__context.stencilMask(a)},stencilMaskSeparate:function(a,b){this.__context.stencilMaskSeparate(a,b)},stencilOp:function(a,b,c){this.__context.stencilOp(a,b,c)},stencilOpSeparate:function(a,b,c,d){this.__context.stencilOpSeparate(a,b,c,d)},texImage2D:function(a,b,c,d,e,l,f,g,h){this.__context.texImage2D(a,b,c,d,e,l,f,g,h)},texImage2DWEBGL:function(a,b,c,d,e,l,f,g,h,k){null!=k?this.__context.texImage2D(a,b,c,d,e,l,f,g,h,k):null!=f?this.__context.texImage2D(a,b,c,
d,e,l,f,g,h):this.__context.texImage2D(a,b,c,d,e,l)},texImage3D:function(a,b,c,d,e,l,f,g,h,k){this.__context.texImage3D(a,b,c,d,e,l,f,g,h,k.toBufferView())},texImage3DWEBGL:function(a,b,c,d,e,l,f,g,h,k,m){this.__context.texImage3D(a,b,c,d,e,l,f,g,h,k,m)},texStorage2D:function(a,b,c,d,e){this.__context.texStorage2D(a,b,c,d,e)},texStorage3D:function(a,b,c,d,e,l){this.__context.texStorage3D(a,b,c,d,e,l)},texParameterf:function(a,b,c){this.__context.texParameterf(a,b,c)},texParameteri:function(a,b,c){this.__context.texParameteri(a,
b,c)},texSubImage2D:function(a,b,c,d,e,l,f,g,h){this.__context.texSubImage2D(a,b,c,d,e,l,f,g,h.toBufferView())},texSubImage2DWEBGL:function(a,b,c,d,e,l,f,g,h,k){null!=k?this.__context.texSubImage2D(a,b,c,d,e,l,f,g,h,k):null!=g?this.__context.texSubImage2D(a,b,c,d,e,l,f,g,h):this.__context.texSubImage2D(a,b,c,d,e,l,f)},texSubImage3D:function(a,b,c,d,e,l,f,g,h,k,m){this.__context.texSubImage3D(a,b,c,d,e,l,f,g,h,k,m.toBufferView())},texSubImage3DWEBGL:function(a,b,c,d,e,l,f,g,h,k,m,n){this.__context.texSubImage3D(a,
b,c,d,e,l,f,g,h,k,m,n)},transformFeedbackVaryings:function(a,b,c){this.__context.transformFeedbackVaryings(a,b,c)},uniform1f:function(a,b){this.__context.uniform1f(a,b)},uniform1fv:function(a,b,c){this.__context.uniform1fv(a,c)},uniform1fvWEBGL:function(a,b,c,d){null!=c?this.__context.uniform1fv(a,b,c,d):this.__context.uniform1fv(a,b)},uniform1i:function(a,b){this.__context.uniform1i(a,b)},uniform1iv:function(a,b,c){this.__context.uniform1iv(a,c)},uniform1ivWEBGL:function(a,b,c,d){null!=c?this.__context.uniform1iv(a,
b,c,d):this.__context.uniform1iv(a,b)},uniform1ui:function(a,b){this.__context.uniform1ui(a,b)},uniform1uiv:function(a,b,c){this.__context.uniform1uiv(a,c)},uniform1uivWEBGL:function(a,b,c,d){this.__context.uniform1uiv(a,b,c,d)},uniform2f:function(a,b,c){this.__context.uniform2f(a,b,c)},uniform2fv:function(a,b,c){this.__context.uniform2fv(a,c)},uniform2fvWEBGL:function(a,b,c,d){null!=c?this.__context.uniform2fv(a,b,c,d):this.__context.uniform2fv(a,b)},uniform2i:function(a,b,c){this.__context.uniform2i(a,
b,c)},uniform2iv:function(a,b,c){this.__context.uniform2iv(a,c)},uniform2ivWEBGL:function(a,b,c,d){null!=c?this.__context.uniform2iv(a,b,c,d):this.__context.uniform2iv(a,b)},uniform2ui:function(a,b,c){this.__context.uniform2ui(a,b,c)},uniform2uiv:function(a,b,c){this.__context.uniform2uiv(a,c)},uniform2uivWEBGL:function(a,b,c,d){this.__context.uniform2uiv(a,b,c,d)},uniform3f:function(a,b,c,d){this.__context.uniform3f(a,b,c,d)},uniform3fv:function(a,b,c){this.__context.uniform3fv(a,c)},uniform3fvWEBGL:function(a,
b,c,d){null!=c?this.__context.uniform3fv(a,b,c,d):this.__context.uniform3fv(a,b)},uniform3i:function(a,b,c,d){this.__context.uniform3i(a,b,c,d)},uniform3iv:function(a,b,c){this.__context.uniform3iv(a,c)},uniform3ivWEBGL:function(a,b,c,d){null!=c?this.__context.uniform3iv(a,b,c,d):this.__context.uniform3iv(a,b)},uniform3ui:function(a,b,c,d){this.__context.uniform3ui(a,b,c,d)},uniform3uiv:function(a,b,c){this.__context.uniform3uiv(a,c)},uniform3uivWEBGL:function(a,b,c,d){this.__context.uniform3uiv(a,
b,c,d)},uniform4f:function(a,b,c,d,e){this.__context.uniform4f(a,b,c,d,e)},uniform4fv:function(a,b,c){this.__context.uniform4fv(a,c)},uniform4fvWEBGL:function(a,b,c,d){null!=c?this.__context.uniform4fv(a,b,c,d):this.__context.uniform4fv(a,b)},uniform4i:function(a,b,c,d,e){this.__context.uniform4i(a,b,c,d,e)},uniform4iv:function(a,b,c){this.__context.uniform4iv(a,c)},uniform4ivWEBGL:function(a,b,c,d){null!=c?this.__context.uniform4iv(a,b,c,d):this.__context.uniform4iv(a,b)},uniform4ui:function(a,b,
c,d,e){this.__context.uniform4ui(a,b,c,d,e)},uniform4uiv:function(a,b,c){this.__context.uniform4uiv(a,c)},uniform4uivWEBGL:function(a,b,c,d){this.__context.uniform4uiv(a,b,c,d)},uniformBlockBinding:function(a,b,c){this.__context.uniformBlockBinding(a,b,c)},uniformMatrix2fv:function(a,b,c,d){this.__context.uniformMatrix2fv(a,c,d)},uniformMatrix2fvWEBGL:function(a,b,c,d,e){null!=d?this.__context.uniformMatrix2fv(a,b,c,d,e):this.__context.uniformMatrix2fv(a,b,c)},uniformMatrix2x3fv:function(a,b,c,d){this.__context.uniformMatrix2x3fv(a,
c,d)},uniformMatrix2x3fvWEBGL:function(a,b,c,d,e){this.__context.uniformMatrix2x3fv(a,b,c,d,e)},uniformMatrix2x4fv:function(a,b,c,d){this.__context.uniformMatrix2x4fv(a,c,d)},uniformMatrix2x4fvWEBGL:function(a,b,c,d,e){this.__context.uniformMatrix2x4fv(a,b,c,d,e)},uniformMatrix3fv:function(a,b,c,d){this.__context.uniformMatrix3fv(a,c,d)},uniformMatrix3fvWEBGL:function(a,b,c,d,e){null!=d?this.__context.uniformMatrix3fv(a,b,c,d,e):this.__context.uniformMatrix3fv(a,b,c)},uniformMatrix3x2fv:function(a,
b,c,d){this.__context.uniformMatrix3x2fv(a,c,d)},uniformMatrix3x2fvWEBGL:function(a,b,c,d,e){this.__context.uniformMatrix3x2fv(a,b,c,d,e)},uniformMatrix3x4fv:function(a,b,c,d){this.__context.uniformMatrix3x4fv(a,c,d)},uniformMatrix3x4fvWEBGL:function(a,b,c,d,e){this.__context.uniformMatrix3x4fv(a,b,c,d,e)},uniformMatrix4fv:function(a,b,c,d){this.__context.uniformMatrix4fv(a,c,d)},uniformMatrix4fvWEBGL:function(a,b,c,d,e){null!=d?this.__context.uniformMatrix4fv(a,b,c,d,e):this.__context.uniformMatrix4fv(a,
b,c)},uniformMatrix4x2fv:function(a,b,c,d){this.__context.uniformMatrix4x2fv(a,c,d)},uniformMatrix4x2fvWEBGL:function(a,b,c,d,e){null!=d?this.__context.uniformMatrix4x2fv(a,b,c,d,e):this.__context.uniformMatrix4x2fv(a,b,c)},uniformMatrix4x3fv:function(a,b,c,d){this.__context.uniformMatrix4x3fv(a,c,d)},uniformMatrix4x3fvWEBGL:function(a,b,c,d,e){this.__context.uniformMatrix4x3fv(a,b,c,d,e)},unmapBuffer:function(a){return!1},useProgram:function(a){this.__context.useProgram(a)},validateProgram:function(a){this.__context.validateProgram(a)},
vertexAttrib1f:function(a,b){this.__context.vertexAttrib1f(a,b)},vertexAttrib1fv:function(a,b){this.__context.vertexAttrib1fv(a,b)},vertexAttrib1fvWEBGL:function(a,b){this.__context.vertexAttrib1fv(a,b)},vertexAttrib2f:function(a,b,c){this.__context.vertexAttrib2f(a,b,c)},vertexAttrib2fv:function(a,b){this.__context.vertexAttrib2fv(a,b)},vertexAttrib2fvWEBGL:function(a,b){this.__context.vertexAttrib2fv(a,b)},vertexAttrib3f:function(a,b,c,d){this.__context.vertexAttrib3f(a,b,c,d)},vertexAttrib3fv:function(a,
b){this.__context.vertexAttrib3fv(a,b)},vertexAttrib3fvWEBGL:function(a,b){this.__context.vertexAttrib3fv(a,b)},vertexAttrib4f:function(a,b,c,d,e){this.__context.vertexAttrib4f(a,b,c,d,e)},vertexAttrib4fv:function(a,b){this.__context.vertexAttrib4fv(a,b)},vertexAttrib4fvWEBGL:function(a,b){this.__context.vertexAttrib4fv(a,b)},vertexAttribDivisor:function(a,b){this.__context.vertexAttribDivisor(a,b)},vertexAttribI4i:function(a,b,c,d,e){this.__context.vertexAttribI4i(a,b,c,d,e)},vertexAttribI4iv:function(a,
b){this.__context.vertexAttribI4iv(a,b)},vertexAttribI4ivWEBGL:function(a,b){this.__context.vertexAttribI4iv(a,b)},vertexAttribI4ui:function(a,b,c,d,e){this.__context.vertexAttribI4ui(a,b,c,d,e)},vertexAttribI4uiv:function(a,b){this.__context.vertexAttribI4uiv(a,b.toUInt32Array())},vertexAttribI4uivWEBGL:function(a,b){this.__context.vertexAttribI4uiv(a,b)},vertexAttribIPointer:function(a,b,c,d,e){this.__context.vertexAttribIPointer(a,b,c,d,e)},vertexAttribPointer:function(a,b,c,d,e,l){this.__context.vertexAttribPointer(a,
b,c,d,e,l)},viewport:function(a,b,c,d){this.__context.viewport(a,b,c,d)},waitSync:function(a,b,c){this.__context.waitSync(a,b,c)},__class__:Pc};var r=function(){w.call(this);this.stencil=this.depth=!0;this._initDelay=new ua(n(this,this.init));this._inited=!1;this._focusDelay=new ua(n(this,this.focus));this._touchManager=new Bb(!1);this._touch=new Da;for(var a=["blur","resize","focus","beforeunload"],b=0;b<a.length;){var c=a[b];++b;Aa.get_window().addEventListener(c,n(this,this.handleWindowEvent),
{capture:!1,passive:!1})}this._keyManager=qb.getInstance();this._key=new Ja;Aa.get_window().addEventListener("keydown",n(this,this.handleKeyEvent),!1);Aa.get_window().addEventListener("keyup",n(this,this.handleKeyEvent),!1);a=["ms","moz","webkit","o"];for(b=0;b<a.length&&!window.requestAnimationFrame;++b)window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"]||window[a[b]+"CancelRequestAnimationFrame"];this._frame=0;this._active=
!0;null!=(Ya=Aa.get_window(),n(Ya,Ya.requestAnimationFrame))?this.handleWindowUpdate():aa.trace("RequestAnimationFrame is null",{fileName:"System.hx",lineNumber:86,className:"lovedna.game.System",methodName:"new"});Aa.get_window().oncontextmenu=function(a){a.preventDefault()};this.requestedFullscreen=this.isFullscreen=!1};f["lovedna.game.System"]=r;r.__name__=["lovedna","game","System"];r.__super__=w;r.prototype=p(w.prototype,{setup:function(a){if(null!=a){if(q.exist(a,"canvas")){var b=q.getValue(a,
"canvas");if(null!=b){this._canvas_webgl=b;this.setupTouchInput(this._canvas_webgl);this.depth=q.getBool(a,"depth",!0);this.stencil=q.getBool(a,"stencil",!0);b={alpha:q.getBool(a,"alpha",!0),antialias:q.getBool(a,"alpha",!1),depth:this.depth,premultipliedAlpha:q.getBool(a,"premultipliedAlpha",!0),stencil:this.stencil,preserveDrawingBuffer:q.getBool(a,"preserveDrawingBuffer",!1)};var c=["webgl","experimental-webgl"];2==q.getInt(a,"webgl")&&c.unshift("webgl2");for(var d=null,e=1,l=0;l<c.length;){var f=
c[l];++l;d=this._canvas_webgl.getContext(f,b);if(null!=d){"webgl2"==f&&(e=2);break}}null!=d&&(this._inited||ua.add(this._initDelay,.1),this._inited=!0,r.gl.setup(d,e))}}q.exist(a,"input")&&(a=q.getValue(a,"input"),this.setupTouchInput(a))}},setFullscreen:function(a){var b=Aa.get_window().document;a?this.requestedFullscreen||this.isFullscreen||(this.requestedFullscreen=!0,(Ya=this._inputElement,n(Ya,Ya.requestFullscreen))?(b.addEventListener("fullscreenchange",n(this,this.handleFullscreenEvent),!1),
b.addEventListener("fullscreenerror",n(this,this.handleFullscreenEvent),!1),this._inputElement.requestFullscreen()):this._inputElement.mozRequestFullScreen?(b.addEventListener("mozfullscreenchange",n(this,this.handleFullscreenEvent),!1),b.addEventListener("mozfullscreenerror",n(this,this.handleFullscreenEvent),!1),this._inputElement.mozRequestFullScreen()):this._inputElement.webkitRequestFullscreen?(b.addEventListener("webkitfullscreenchange",n(this,this.handleFullscreenEvent),!1),b.addEventListener("webkitfullscreenerror",
n(this,this.handleFullscreenEvent),!1),this._inputElement.webkitRequestFullscreen()):this._inputElement.msRequestFullscreen&&(b.addEventListener("MSFullscreenChange",n(this,this.handleFullscreenEvent),!1),b.addEventListener("MSFullscreenError",n(this,this.handleFullscreenEvent),!1),this._inputElement.msRequestFullscreen())):this.isFullscreen&&(this.requestedFullscreen=!1,n(b,b.exitFullscreen)?b.exitFullscreen():b.mozCancelFullScreen?b.mozCancelFullScreen():b.webkitExitFullscreen?b.webkitExitFullscreen():
b.msExitFullscreen&&b.msExitFullscreen())},init:function(){this.width=this._canvas_webgl.width;this.height=this._canvas_webgl.height;this.doResize();this.dispatchEvent(na.init)},setupTouchInput:function(a){null!=a&&this._inputElement!=a&&(null!=this._inputElement&&this.touchdisconnect(),this._inputElement=a,this.touchconnect())},touchconnect:function(){var a=new kb;a.addString(this._inputElement.id);this._touch.device=a.getCode();a="mousedown mouseenter mouseleave mousemove mouseup wheel".split(" ");
for(var b=0;b<a.length;){var c=a[b];++b;this._inputElement.addEventListener(c,n(this,this.handleMouseEvent),{capture:!1,passive:!1})}a=["touchstart","touchmove","touchend","touchcancel"];for(b=0;b<a.length;)c=a[b],++b,this._inputElement.addEventListener(c,n(this,this.handleTouchEvent),{capture:!1,passive:!1})},touchdisconnect:function(){for(var a="mousedown mouseenter mouseleave mousemove mouseup wheel".split(" "),b=0;b<a.length;){var c=a[b];++b;this._inputElement.removeEventListener(c,n(this,this.handleMouseEvent))}a=
["touchstart","touchmove","touchend","touchcancel"];for(b=0;b<a.length;)c=a[b],++b,this._inputElement.removeEventListener(c,n(this,this.handleTouchEvent))},handleMouseEvent:function(a){0==this._touchManager.touchType&&(this._touchManager.touchType=1);if(1==this._touchManager.touchType){var b=a.type;this._touch.position.set(0,0);this._touch.touchId=a.button;this._touch.pressure=-1;if("wheel"!=b){var c=this._inputElement.getBoundingClientRect();this._touch.position.set(a.offsetX/c.width,a.offsetY/c.height);
"mousemove"==b&&this._touchManager.move(this._touch);"mousedown"==b&&this._touchManager.begin(this._touch);"mouseup"==b&&this._touchManager.end(this._touch);"mouseleave"==b&&this._touchManager.cancel(this._touch)}}},handleTouchEvent:function(a){0==this._touchManager.touchType&&(this._touchManager.touchType=2);if(2==this._touchManager.touchType){var b=a.type,c=this._inputElement.getBoundingClientRect();this._touch.position.set(0,0);var d=this._touch.touchId=0;for(a=a.changedTouches;d<a.length;){var e=
a[d];++d;this._touch.position.set((e.clientX-c.left)/c.width,(e.clientY-c.top)/c.height);this._touch.touchId=e.identifier;this._touch.pressure=e.force;"touchmove"==b?this._touchManager.move(this._touch):"touchstart"==b?this._touchManager.begin(this._touch):"touchend"==b?this._touchManager.end(this._touch):"touchcancel"==b&&this._touchManager.cancel(this._touch)}}},handleWindowEvent:function(a){a=a.type;"focus"==a?ua.add(this._focusDelay,.1):"blur"==a?(la.blur(),this._active=!1,this._frame=0):"resize"==
a&&this._inited&&this.doResize()},focus:function(){la.focus();this._active=!0;0==this._frame&&this.handleWindowUpdate()},handleWindowUpdate:function(a){0!=this._frame&&this.dispatchEvent(na.update);this._active&&(this._frame++,Aa.get_window().requestAnimationFrame(n(this,this.handleWindowUpdate)))},doResize:function(){if(null!=this._canvas_webgl.parentElement){var a=this._canvas_webgl.parentElement.clientWidth;var b=this._canvas_webgl.parentElement.clientHeight}else a=Aa.get_window().innerWidth,b=
Aa.get_window().innerHeight;if(this.width!=a||this.height!=b)this.width=g.floor(a),this.height=g.floor(b),this._canvas_webgl.width=this.width,this._canvas_webgl.height=this.height,na.resize.vintlist[0]=this.width,na.resize.vintlist[1]=this.height,this.dispatchEvent(na.resize)},handleFullscreenEvent:function(a){a=Aa.get_window().document;this.requestedFullscreen=!1;if(null!=(a.fullscreenElement||a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement))a=!0;else{a=!1;for(var b=["fullscreenchange",
"mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"],c=["fullscreenerror","mozfullscreenerror","webkitfullscreenerror","MSFullscreenError"],d=0,e=b.length;d<e;){var l=d++;Aa.get_document().removeEventListener(b[l],n(this,this.handleFullscreenEvent),!1);Aa.get_document().removeEventListener(c[l],n(this,this.handleFullscreenEvent),!1)}}a!=this.isFullscreen&&(this.isFullscreen=a,na.resize.vbool=this.isFullscreen,this.dispatchEvent(na.fullScreen))},handleKeyEvent:function(a){this._key.deviceType=
0;this._key.deviceId=0;this._key.keyCode=a.keyCode;this._key.key=a.key;this._key.value=0;this._key.modifier.clear();this._key.modifier.setElement(3,a.altKey);this._key.modifier.setElement(2,a.ctrlKey);this._key.modifier.setElement(1,a.shiftKey);this._key.modifier.setElement(4,a.metaKey);this._key.type="keydown"==a.type?1:2;this._keyManager.keyTrigger(this._key)},__class__:r});var $a=function(){this.fixedCount=1;Na.call(this);this._dirty=!0;this.set_dirty(!0);this._resized=!0;this._now=K.get_now();
this._fixedTime=0;this._root=new J;this._actorList=new G;this._actorMap=new Q;this._addMap=new Q;this._collectorMap=new I;this._collectorList=[];this.collectorCamera=new Qc;this.collectorRenderer=new Rc;this.collectorCollider=new Sc;this.collectorLight=new Tc;this.addCollector(this.collectorCamera);this.addCollector(this.collectorRenderer);this.addCollector(this.collectorCollider);this.addCollector(this.collectorLight)};f["lovedna.game.World"]=$a;$a.__name__=["lovedna","game","World"];$a.__super__=
Na;$a.prototype=p(Na.prototype,{addChild:function(a){this._root.get_transform().addChild(a.get_transform());this.set_dirty(!0)},removeChild:function(a){this._root.get_transform().removeChild(a.get_transform());this.set_dirty(!0)},addCollector:function(a){-1==this._collectorList.indexOf(a)&&this._collectorList.push(a)},removeCollector:function(a){var b=this._collectorList.indexOf(a);-1!=b&&this._collectorList.splice(b,1);for(b=this._collectorMap.keys();b.hasNext();){var c=b.next();this._collectorMap.get(c)==
a&&this._collectorMap.remove(c)}},getCollector:function(a){for(var b=this._collectorMap.iterator();b.hasNext();){var c=b.next();if(u.is(c,a))return c}return null},_onAdd:function(){this._now=K.get_now();this._fixedTime=0;this.game=fb.current},_onRemove:function(){},_resize:function(a,b){this.width=a;this.height=b;this._resized=!0},_update:function(a){$a.current=this;var b=this._resized;this._resized=!1;var c=la.get_now();this.deltaTime=c-this._now;if(0>this.deltaTime||this.deltaTime>$a.maxDeltaTime)this.deltaTime=
$a.maxDeltaTime;this._root.deltaTime=this.deltaTime;this._fixedTime+=this.deltaTime;this.fixedCount=0;.0166666666666667<=this._fixedTime&&(this.fixedCount=g.floor(this._fixedTime/.0166666666666667),this._fixedTime%=.0166666666666667);this._now=c;c=this._actorList.get_length();for(var d,e=0,l=c;e<l;)d=e++,d=this._actorList.get(d),d.get_enabled()&&d._update(this.fixedCount);for(e=0;e<c;)d=e++,d=this._actorList.get(d),d.get_enabled()&&d.dispatchEvent(v.onLateUpdate);this.collectActors();c=this._actorList.get_length();
for(e=0;e<c;)d=e++,d=this._actorList.get(d),d.get_enabled()&&(b&&d.dispatchEvent(v.onScreenResize),d._updateTransform(a));c=this.collectorCamera.count;a=0;for(b=c;a<b;)c=a++,this.collectorCamera.get(c).data.render(this.collectorRenderer)},_render:function(){},collectActors:function(){if(this._dirty){this._dirty=!1;for(var a=this._actorList.get_length();0<a--;){var b=this._actorList.get(a);this._addMap.set(b.instanceID,b)}this._actorList.clear();this._root._collectActors(this._actorList);for(a=this._actorList.get_length();0<
a--;)b=this._actorList.get(a),this._actorMap.exists(b.instanceID)||(b._connectWorld(this),this._actorMap.set(b.instanceID,b)),this._addMap.remove(b.instanceID);for(a=this._addMap.iterator();a.hasNext();)b=a.next(),b._disconnectWorld(),this._addMap.remove(b.instanceID)}},addComponent:function(a){var b=a.classType;if(this._collectorMap.exists(b))this._collectorMap.get(b).add(a);else for(var c=this._collectorList.length;0<c--;){var d=this._collectorList[c];d.exist(a)&&(d.add(a),this._collectorMap.set(b,
d))}},removeComponent:function(a){var b=a.classType;this._collectorMap.exists(b)&&this._collectorMap.get(b).remove(a)},set_dirty:function(a){return this._dirty=!0},__class__:$a,__properties__:{set_dirty:"set_dirty"}});var Mb=function(){};f["lovedna.game.collectors.ComponentCollector"]=Mb;Mb.__name__=["lovedna","game","collectors","ComponentCollector"];Mb.prototype={__class__:Mb};var Qc=function(){this._dirty=!1;this.count=0;this._cameras=new Q;this._list=[]};f["lovedna.game.collectors.CameraCollector"]=
Qc;Qc.__name__=["lovedna","game","collectors","CameraCollector"];Qc.__interfaces__=[Mb];Qc.prototype={exist:function(a){return u.is(a,gb)},add:function(a){this._cameras.exists(a.instanceID)||(this._cameras.set(a.instanceID,a),this._dirty=!0,this._list.push(a),this.count=this._list.length)},remove:function(a){this._cameras.exists(a.instanceID)&&(this._cameras.remove(a.instanceID),B.remove(this._list,a),this.count=this._list.length)},get:function(a){this._dirty&&this._list.sort(n(this,this.sort));return this._list[a]},
sort:function(a,b){return a.depth!=b.depth?a.depth>b.depth?1:-1:0},__class__:Qc};var Sc=function(){this._list=[];this.count=0;this._map=new Q};f["lovedna.game.collectors.ColliderCollector"]=Sc;Sc.__name__=["lovedna","game","collectors","ColliderCollector"];Sc.__interfaces__=[Mb];Sc.prototype={exist:function(a){return u.is(a,rb)},add:function(a){this._map.exists(a.instanceID)||(this._map.set(a.instanceID,this._list.length),this._list.push(a),this.count=this._list.length)},remove:function(a){if(this._map.exists(a.instanceID)){var b=
this._map.get(a.instanceID);this._list.splice(b,1);this._map.remove(a.instanceID);a=b;for(b=this._list.length;a<b;){var c=a++;this._map.set(this._list[c].instanceID,c)}this.count=this._list.length}},get:function(a){return this._list[a]},__class__:Sc};var Tc=function(){this._dirty=!1;this.count=0;this._map=new Q;this._list=[]};f["lovedna.game.collectors.LightCollector"]=Tc;Tc.__name__=["lovedna","game","collectors","LightCollector"];Tc.__interfaces__=[Mb];Tc.prototype={exist:function(a){return u.is(a,
Tb)},add:function(a){this._map.exists(a.instanceID)||(this._map.set(a.instanceID,a),this._dirty=!0,this._list.push(a),this.count=this._list.length)},remove:function(a){this._map.exists(a.instanceID)&&(this._map.remove(a.instanceID),B.remove(this._list,a),this.count=this._list.length)},get:function(a){return this._list[a]},__class__:Tc};var Rc=function(){this._list=[];this.count=0;this._map=new Q};f["lovedna.game.collectors.RendererCollector"]=Rc;Rc.__name__=["lovedna","game","collectors","RendererCollector"];
Rc.__interfaces__=[Mb];Rc.prototype={exist:function(a){return u.is(a,sb)},add:function(a){this._map.exists(a.instanceID)||(this._map.set(a.instanceID,this._list.length),this._list.push(a),this.count=this._list.length)},remove:function(a){if(this._map.exists(a.instanceID)){var b=this._map.get(a.instanceID);this._list.splice(b,1);this._map.remove(a.instanceID);a=b;for(b=this._list.length;a<b;){var c=a++;this._map.set(this._list[c].instanceID,c)}this.count=this._list.length}},get:function(a){return this._list[a]},
__class__:Rc};var Ad=function(){this.size=1;w.call(this)};f["lovedna.game.components.AxisLine"]=Ad;Ad.__name__=["lovedna","game","components","AxisLine"];Ad.__super__=y;Ad.prototype=p(y.prototype,{onAwake:function(){y.prototype.onAwake.call(this);this.size=1E3},onStart:function(){y.prototype.onStart.call(this);var a=this.actor.addComponent(ra);a.get_material().renderQueue=3E4;a.get_material().state.depthTest=!1;a.cameraCull=!1;a.get_material().state.drawMode=1;var b=new Uc;b.size=this.size;a.mesh=
(new X).fromGeometry(b.build())},__class__:Ad});var rb=function(){w.call(this)};f["lovedna.game.components.Collider"]=rb;rb.__name__=["lovedna","game","components","Collider"];rb.__super__=y;rb.prototype=p(y.prototype,{raycast:function(a,b){return null},onAwake:function(){y.prototype.onAwake.call(this);this._transformFrame=-1;this.enabled=!0},get_bounds:function(){return null},__class__:rb,__properties__:{get_bounds:"get_bounds"}});var Bd=function(){w.call(this)};f["lovedna.game.components.BoxCollider"]=
Bd;Bd.__name__=["lovedna","game","components","BoxCollider"];Bd.__super__=rb;Bd.prototype=p(rb.prototype,{raycast:function(a,b){var c=this.get_bounds(),d=a.intersectSphere(c.sphere);if(null==d)return null;d=a.intersectBox(c.box);if(null==d||d.distanceSquared(a.start)>b)return null;a=new Ec;a.point=d;return a},onAwake:function(){rb.prototype.onAwake.call(this);this.center=new k;this.size=new k(1,1,1);this._bounds=new Zb},get_bounds:function(){if(this._transformFrame!=this.actor.frame){this._transformFrame=
this.actor.frame;this._bounds.reset();var a=k.get_temp().copy(this.size);a.scale(.5);this._bounds.expand(a.add(this.center));a.copy(this.size).scale(-.5);this._bounds.expand(a.add(this.center));this._bounds.multiplyMatrix44(this.actor.get_transform().getLocalToWorld())}return this._bounds},__class__:Bd});var gb=function(){w.call(this)};f["lovedna.game.components.Camera"]=gb;gb.__name__=["lovedna","game","components","Camera"];gb.__super__=y;gb.prototype=p(y.prototype,{viewportToScreenPoint:function(a){var b=
g.lerpTo(-1,1,0,1,a.x),c=g.lerpTo(1,-1,0,1,a.y);return k.get_temp().set(b,c,a.z)},screenToViewportPoint:function(a){var b=g.lerpTo(0,1,-1,1,a.x),c=g.lerpTo(0,1,1,-1,a.y);return k.get_temp().set(b,c,a.z)},viewportToWorldPoint:function(a){var b=k.get_temp().set(a.x,a.y,-1),c=k.get_temp().copy(b);c.z=1;this.projectionViewInverseMatrix.transformVector(b,!0);this.projectionViewInverseMatrix.transformVector(c,!0);return c.sub(b).scale(g.lerpTo(-1,1,0,1,a.z)).add(b)},worldToViewport:function(a){a=k.get_temp().copy(a);
this.projectionViewMatrix.transformVector(a,!0);return a},worldToScreenPoint:function(a){a=k.get_temp().copy(a);this.projectionViewMatrix.transformVector(a,!0);return this.viewportToScreenPoint(a)},screenToWorldPoint:function(a){return this.viewportToWorldPoint(this.screenToViewportPoint(a))},viewportPointToRay:function(a){a=k.get_temp().set(a.x,a.y,-1);var b=k.get_temp().copy(a);b.z=1;this.projectionViewInverseMatrix.transformVector(a,!0);this.projectionViewInverseMatrix.transformVector(b,!0);return Za.get_temp().set(a,
b)},ScreenPointToRay:function(a){return this.viewportPointToRay(this.screenToViewportPoint(a))},onConstruct:function(){y.prototype.onConstruct.call(this);this.clearFlags=new Ab;this.cullingMask=new ca;this.orthographic=!1;this.orthographicScale=1;this.depth=0;this.render=!0;this.viewMatrix=this.worldToCameraMatrix=new T;this.viewInverseMatrix=this.cameraToWorldMatrix=new T;this.projectionMatrix=new T;this.projectionViewMatrix=new T;this.projectionViewInverseMatrix=new T;this.nearClipPlane=.1;this.farClipPlane=
2E3;this.fieldOfView=60;this._projectionParams=new E(this.nearClipPlane,this.farClipPlane,this.fieldOfView,0);this.frustum=new Cd;this._orthographicParams=new E;this._transformFrame=0;this._eye=new k;this.uniforms=new bb;this.uniforms.setMatrix44(m.P.name,this.projectionMatrix);this.uniforms.setMatrix44(m.V.name,this.viewMatrix);this.uniforms.setMatrix44(m.IV.name,this.viewInverseMatrix);this.uniforms.setMatrix44(m.VP.name,this.projectionViewMatrix);this.uniforms.setMatrix44(m.IVP.name,this.projectionViewInverseMatrix);
this.uniforms.setMatrix44(m.IVP.name,this.projectionViewInverseMatrix);this.uniforms.setFloat4(m.PROJECTION_PARAMS.name,this._projectionParams);this.uniforms.setFloat4(m.ORTHOGRAPHIC_PARAMS.name,this._orthographicParams);this.uniforms.setFloat3(m.EYE.name,this._eye)},onStart:function(){y.prototype.onStart.call(this);this._orthographicParams.x=this.actor.world.width;this._orthographicParams.y=this.actor.world.height;this._aspect=this._orthographicParams.x/this._orthographicParams.y;this.bindEvent(v.onScreenResize,
n(this,this.screenResize));this.bindEvent(v.onTransformComplete,n(this,this.transformComplete));this.data=new Dd(this)},screenResize:function(a){this._orthographicParams.x=this.actor.world.width;this._orthographicParams.y=this.actor.world.height;this._aspect=this._orthographicParams.x/this._orthographicParams.y},transformComplete:function(a){this.updateCamera()},updateCamera:function(){var a=!1;if(this._projectionParams.x!=this.nearClipPlane||this._projectionParams.y!=this.farClipPlane||this._projectionParams.z!=
this.fieldOfView||this._projectionParams.w!=this._aspect||this._orthographicParams.z!=(this.orthographic?1:0)||this._orthographicParams.w!=this.orthographicScale){this._projectionParams.set(this.nearClipPlane,this.farClipPlane,this.fieldOfView,this._aspect);this._orthographicParams.z=this.orthographic?1:0;this._orthographicParams.w=this.orthographicScale;if(this.orthographic){a=this._orthographicParams.x;var b=this._orthographicParams.y;this.projectionMatrix.setOrtho(-a*this.orthographicScale,a*this.orthographicScale,
-b*this.orthographicScale,b*this.orthographicScale,this.nearClipPlane,this.farClipPlane)}else this.projectionMatrix.setProjection(this.nearClipPlane,this.farClipPlane,this.fieldOfView,this._aspect);a=!0}this.actor.frame!=this._transformFrame&&(this._transformFrame=this.actor.frame,this._eye.copy(this.actor.get_transform().get_worldPosition()),a=this.actor.get_transform().get_worldRotation().rotate(k.get_forward()),a.scale(this.farClipPlane-this.nearClipPlane).add(this._eye),this.viewMatrix.lookAt(this._eye,
a,this.actor.get_transform().get_worldRotation().rotate(k.get_up())),a=!0);a&&(this.projectionViewMatrix.copy(this.projectionMatrix),this.projectionViewMatrix.append(this.viewMatrix),this.viewInverseMatrix.copy(this.viewMatrix),this.viewInverseMatrix.inverse(),this.frustum.multiplyMatrix44(this.projectionViewMatrix),this.projectionViewInverseMatrix.copy(this.projectionViewMatrix),this.projectionViewInverseMatrix.inverse(),this.actor.dispatchEvent(v.onCameraUpdate))},__class__:gb});var ec=function(){this.maxy=
89.9;this.miny=-89.9;w.call(this)};f["lovedna.game.components.CameraControl"]=ec;ec.__name__=["lovedna","game","components","CameraControl"];ec.__super__=y;ec.prototype=p(y.prototype,{onAwake:function(){y.prototype.onAwake.call(this);this.target=new k;this._rotationStart=new t;this._rotationEnd=new t;this._rotationDelta=new t;this._rotation=new R;this.rotationSpeed=.5;this.distance=100;this.miny=-89.9;this.maxy=89.9},onStart:function(){y.prototype.onStart.call(this);this._camera=this.actor.getComponent(gb);
null!=this._camera&&this.bindEvent(v.onUpdate,n(this,this.onUpdate))},onUpdate:function(a){1==A.touchCount&&(a=A.getTouch(0),A.touchDown(0)&&this._rotationStart.copy(a.position),this._rotationEnd.copy(a.position),this._rotationDelta.sub(this._rotationEnd,this._rotationStart),this._rotationStart.copy(this._rotationEnd),this._rotationDelta.isZero()||(this._rotationDelta.scale(180*this.rotationSpeed),this._rotation.setEulerAngles(this._rotationDelta.y,-this._rotationDelta.x,0),a=this.actor.get_transform().rotation.getEulerAngles().add(k.instance.set(this._rotationDelta.y,
-this._rotationDelta.x,0)),a.x>this.maxy&&(a.x=this.maxy),a.x<this.miny&&(a.x=this.miny),this.actor.get_transform().rotation.setEulerAngles(a.x,a.y,a.z),this.actor.get_transform().position.copy(this.actor.get_transform().rotation.rotate(k.get_forward()).scale(-this.distance).add(this.target))))},__class__:ec});var za=function(){w.call(this)};f["lovedna.game.components.UI"]=za;za.__name__=["lovedna","game","components","UI"];za.__super__=y;za.prototype=p(y.prototype,{onConstruct:function(){y.prototype.onConstruct.call(this)},
onAwake:function(){y.prototype.onAwake.call(this);var a=this.actor.getComponent(Ha);null!=a?(this.actor.removeComponent(Ha),this.transform=this.actor.addComponent(Nb),this.transform.position.copy(a.position),this.transform.scale.copy(a.scale),this.transform.rotation.copy(a.rotation)):this.transform=this.actor.addComponent(Nb)},__class__:za});var Ta=function(){w.call(this)};f["lovedna.game.components.Canvas"]=Ta;Ta.__name__=["lovedna","game","components","Canvas"];Ta.__super__=za;Ta.prototype=p(za.prototype,
{onAwake:function(){za.prototype.onAwake.call(this);this.width=800;this.height=480;this.scaleMode=1;this.bindEvent(v.onAdded,n(this,this.onScreenResize))},onStart:function(){za.prototype.onStart.call(this);this.bindEvent(v.onScreenResize,n(this,this.onScreenResize));this.bindEvent(v.onTransform,n(this,this.onTransform))},onScreenResize:function(a){0==this.scaleMode?(this.transform.width=Z.width,this.transform.height=Z.height,this.transform.scale.set(1,1,1)):1==this.scaleMode&&(a=this.width/this.height,
a=a>Z.width/Z.height?Z.width/this.width:Z.height/this.height,this.transform.scale.set(a,a,a),this.transform.width=this.width,this.transform.height=this.height)},onTransform:function(a){},__class__:Ta});var Vc=function(){w.call(this)};f["lovedna.game.components.G3D"]=Vc;Vc.__name__=["lovedna","game","components","G3D"];Vc.__super__=y;Vc.prototype=p(y.prototype,{onDestroy:function(){y.prototype.onDestroy.call(this);this.clear();this.set_resource(null);this.jointMap=null;null!=this._skinMeshRenderers&&
(this._skinMeshRenderers.dispose(),this._skinMeshRenderers=null);null!=this._bones&&(this._bones.dispose(),this._bones=null);null!=this._renderers&&(this._renderers.dispose(),this._renderers=null)},getRenderer:function(a){return this._renderers.getElement(a)},getVisible:function(){for(var a=this._renderers.get_length();0<a--;)if(this._renderers.getElement(a).actor.visible)return!0;return!1},onConstruct:function(){y.prototype.onConstruct.call(this);this._init=!1;this.jointMap=new I;this._skinMeshRenderers=
new G;this._renderers=new G;this._bones=new G;this.useRoot=!1},clear:function(){for(var a=this.jointMap.keys();a.hasNext();){var b=a.next(),c=this.jointMap.get(b);c.actor.get_transform().removeFromParent();c.clear();this.jointMap.remove(b)}this._init=!1;this._renderers.clear();this._skinMeshRenderers.clear();this._bones.clear();this.rendererCount=0},srcLoaded:function(a){if(null!=this.resource&&this.resource.enabled){this.clear();this.resource.removeEventListener(D.complete.get_type(),n(this,this.srcLoaded));
a=this.resource.modelData.nodes;var b=a.length;aa.trace(this.resource.get_file().path,{fileName:"G3D.hx",lineNumber:123,className:"lovedna.game.components.G3D",methodName:"srcLoaded"});for(var c=0;c<b;){var d=c++;this.parseNode(a[d],null)}this.rendererCount=this._renderers.get_length();b=this._skinMeshRenderers.get_length();if(0<b){a=0;for(c=b;a<c;){var e=a++;b=this._skinMeshRenderers.getElement(e);d=b.bones;e=this._bones.getElement(e);if(null!=e&&null!=e.bones&&0<e.bones.length)for(var l=0,f=e.bones.length;l<
f;){var g=l++;g=this.jointMap.get(e.bones[g]);null==g?d.push(null):d.push(g.animation)}b.set_bones(d)}a=this.actor.getComponent($b);null==a&&(a=this.actor.addComponent($b));null==a.resource?a.set_resource(this.resource):a.setJointMap(this.jointMap)}this._init=!0;this.dispatchEvent(D.complete)}},parseNode:function(a,b){if(null!=a.parts)for(var c=0,d=a.parts.length;c<d;){var e=c++,l=a.parts[e],f=this.resource.modelData.getMeshByPartId(l.meshPartId).getPart(l.meshPartId);e=1!=this.resource.modelData.partCount||
this.useRoot?new J:this.actor;if(null!=l.bones){var g=e.addComponent(Wc);this._skinMeshRenderers.push(g);this._bones.push(l)}else null==e.getComponent(ra)&&e.addComponent(ra);e.name=a.id;null!=b?b.actor.get_transform().addChild(e.get_transform()):this.actor.get_transform().addChild(e.get_transform());e.get_transform().position.copy(a.translation);e.get_transform().rotation.copy(a.rotation);e.get_transform().scale.copy(a.scale);e=e.getComponent(ra);this._renderers.push(e);e.mesh=(new X).fromGeometry(this.resource.modelData.getMeshByPartId(l.meshPartId).geom);
e.get_material().subMesh=f.subMeshId;l=this.resource.modelData.getMaterial(l.materialId);null!=l&&(l=l.getTexture(),null!=l&&(l=l.fileName,l=ha.Combine((new ha(this.resource.get_file().path)).getDir(),l),e.get_material().uniforms.setTexture(z.texture.get(l).texture),e.get_material().define.define(m.TEX.name)))}else if(e=a.id,d=new J,d.name=e,c=d.addComponent(Xc),this.jointMap.set(e,c),e=this.resource.modelData.getBone(e),null!=e&&(c.worldToLocal=(new T).setTRS(e.translation,e.rotation,e.scale).inverse()),
null==b?this.actor.get_transform().addChild(d.get_transform()):b.actor.get_transform().addChild(d.get_transform()),c.updateLocal(a.translation,a.rotation,a.scale),null!=a.children)for(b=0,a=a.children;b<a.length;)d=a[b],++b,this.parseNode(d,c)},set_resource:function(a){if(this.resource==a)return a;null!=this.resource&&(aa.trace("resource  "+u.string(this.resource.enabled),{fileName:"G3D.hx",lineNumber:278,className:"lovedna.game.components.G3D",methodName:"set_resource"}),this.resource.enabled||this.resource.removeEventListener(D.complete.get_type(),
n(this,this.srcLoaded)));this._init=!1;this.resource=a;this.resource.enabled?this.srcLoaded():this.resource.addEventListener(D.complete.get_type(),n(this,this.srcLoaded));return this.resource},__class__:Vc,__properties__:{set_resource:"set_resource"}});var $b=function(){w.call(this)};f["lovedna.game.components.G3DAnimator"]=$b;$b.__name__=["lovedna","game","components","G3DAnimator"];$b.__super__=y;$b.prototype=p(y.prototype,{Play:function(a,b){this.action=a;this.enabled&&this._clips.exists(a)&&(this._animation=
this._clips.get(a),this._totalTime=this._animation.totalTime,this._time.set(0,0),this._preTime.set(0,0))},onConstruct:function(){y.prototype.onConstruct.call(this);this.update=this.enabled=!1;this._totalTime=0;this._loop=-1;this._time=new t;this._preTime=new t;this._t=new k;this._r=new R;this._s=new k;this.playing=!0;this._lastTime=this.updateTime=0;this._processId=-1},onStart:function(){y.prototype.onStart.call(this);this.bindEvent(v.onUpdate,n(this,this.onUpdate))},onUpdate:function(a){this.updateAnimation()},
updateAnimation:function(){if(this.playing&&this.enabled&&0!=this._totalTime&&0!=this._loop&&null!=this._animation){this._time.x+=this.actor.deltaTime;this._time.y=this._time.x%this._totalTime;0>this._time.y&&(this._time.y+=this._totalTime);var a=0;0!=this._preTime.x&&(a=this._time.x-this._preTime.x);this._preTime.x=this._time.x;0<a&&this._time.y<this._preTime.y?0<this._loop&&this._loop--:0>a&&this._time.y>this._preTime.y&&0<this._loop&&this._loop--;if(0!=this._loop&&this.playing&&this.enabled&&0!=
this._loop&&0!=this._totalTime&&!(g.abs(this._lastTime-this._time.x)<this.updateTime||null!=this._g3d&&!this._g3d.getVisible())){this._lastTime=this._time.x;a=this._preTime.y=this._time.y;this._processId++;for(var b=this._animation.nodeAnimations.length,c=0;0<b--;){var d=this._animation.nodeAnimations[b],e=this._jointMap.get(d.nodeId);null!=e&&(this.currentTranslation=d.getTranslation(a),this.currentRotation=d.getRotation(a),this.currentScale=d.getScaling(a),null!=this.currentTranslation&&(this._t.copy(this.currentTranslation),
this.currentTranslation=this._t),null!=this.currentRotation&&(this._r.copy(this.currentRotation),this.currentRotation=this._r),null!=this.currentScale&&(this._s.copy(this.currentScale),this.currentScale=this._s),e.updateLocal(this.currentTranslation,this.currentRotation,this.currentScale),++c)}}}},animationResourceLoaded:function(a){this.enabled=!1;this.dirtyTime=K.get_now();if(null!=this.resource.modelData.animations&&(a=this.resource.modelData.animations.length,!(1>a))){for(this._clips=new I;0<
a--;){var b=this.resource.modelData.animations[a];this._clips.set(b.id,b);null==this.action&&(this.action=b.id)}null!=this.action&&(this._animation=this._clips.get(this.action),null!=this._animation&&(a=this.actor.getComponent(Vc),null!=a&&this.setJointMap(a.jointMap),this._g3d=a,this.enabled=!0,this._totalTime=this._animation.totalTime,this._time.set(0,0),this._preTime.set(0,0),this._lastTime=0,this.updateAnimation()))}},setJointMap:function(a){this._jointMap=a},set_resource:function(a){if(this.resource==
a)return a;null!=this.resource&&(this.resource.enabled||this.resource.removeEventListener(D.complete.get_type(),n(this,this.animationResourceLoaded)));this.resource=a;this.resource.enabled?this.animationResourceLoaded():this.resource.addEventListener(D.complete.get_type(),n(this,this.animationResourceLoaded));return this.resource},__class__:$b,__properties__:{set_resource:"set_resource"}});var Oa=function(){w.call(this)};f["lovedna.game.components.Image"]=Oa;Oa.__name__=["lovedna","game","components",
"Image"];Oa.__super__=za;Oa.prototype=p(za.prototype,{load:function(a){null==this.sprite||this.sprite.enabled||this.sprite.removeEventListener(D.init.get_type(),n(this,this.onSpriteInit));this.sprite=z.sprite.get(a);if(this.sprite.enabled)this.onSpriteInit();else this.sprite.addEventListener(D.init.get_type(),n(this,this.onSpriteInit))},onAwake:function(){za.prototype.onAwake.call(this);this.material=new La;this.material.state.depthTest=!1;this.material.state.depthWrite=!1;this.material.state.cullMode=
-1;this.material.renderQueue=4E4;this.geometry=new sa},onStart:function(){za.prototype.onStart.call(this);this.bindEvent(v.onRectTransform,n(this,this.onRectTransform))},onDestroy:function(){za.prototype.onDestroy.call(this);X.deleteGeometryBuffer(this.geometry.id)},onSpriteInit:function(a){this.sprite.removeEventListener(D.init.get_type(),n(this,this.onSpriteInit));this.sprite.enabled&&(this.material.setTexture(this.sprite.texture.texture),1>this.transform.width&&(this.transform.width=this.sprite.data.frame.z),
1>this.transform.height&&(this.transform.height=this.sprite.data.frame.w),this.onRectTransform())},onRectTransform:function(a){this.draw()},draw:function(){this.sprite.enabled&&(this.simpleFill(),this.dispatchEvent(D.init))},simpleFill:function(){var a=this.transform.width,b=this.transform.height,c=a/this.sprite.data.sourceSize.x,d=b/this.sprite.data.sourceSize.y,e=this.sprite.data.offset.x,l=this.sprite.data.sourceSize.y-this.sprite.data.offset.y-this.sprite.data.frame.get_height();e=e*c-this.transform.pivot.x*
a;l=l*d-this.transform.pivot.y*b;a=this.sprite.data.frame.get_width()*c;b=this.sprite.data.frame.get_height()*d;c=new k(e,l,0);d=new k(a+e,l,0);a=new k(a+e,b+l,0);this.geometry.position=[c,d,a,new k(e,b+l,0)];b=this.sprite.getUV(0,1).clone();e=this.sprite.getUV(1,1).clone();l=this.sprite.getUV(1,0).clone();a=this.sprite.getUV(0,0).clone();this.geometry.uv=[b,e,l,a];b=(new E(1,1,1,1)).mul(this.material.color);e=(new E(1,1,1,1)).mul(this.material.color);l=(new E(1,1,1,1)).mul(this.material.color);a=
(new E(1,1,1,1)).mul(this.material.color);this.geometry.color=[b,e,l,a];this.geometry.clearGroup();this.geometry.addGroup([0,1,2,0,2,3]);Oa.mesh.fromGeometry(this.geometry)},__class__:Oa});var Xc=function(){w.call(this)};f["lovedna.game.components.Joint"]=Xc;Xc.__name__=["lovedna","game","components","Joint"];Xc.__super__=y;Xc.prototype=p(y.prototype,{updateLocal:function(a,b,c){this.actor.get_transform().position.copy(a);this.actor.get_transform().rotation.copy(b);this.actor.get_transform().scale.copy(c)},
updateWorld:function(){null!=this.worldToLocal&&this.animation.copy(this.actor.get_transform().getLocalToWorld()).append(this.worldToLocal)},clear:function(){this.worldToLocal=this.animation=null},onAwake:function(){y.prototype.onAwake.call(this);this.animation=new T},onStart:function(){y.prototype.onStart.call(this);this.bindEvent(v.onTransform,n(this,this.onTrasform))},onTrasform:function(a){this.updateWorld()},__class__:Xc});var Tb=function(){w.call(this)};f["lovedna.game.components.Light"]=Tb;
Tb.__name__=["lovedna","game","components","Light"];Tb.__super__=y;Tb.prototype=p(y.prototype,{onAwake:function(){y.prototype.onAwake.call(this);this.position=new k;this.ambient=new E(0,0,0,1);this.diffuse=new E(1,1,1,1);this.specular=new E(0,0,0,10);this.uniforms=new bb;this.uniforms.setFloat3(m.LIGHT_POSITION.name,this.position);this.uniforms.setFloat4(m.LIGHT_AMBIENT.name,this.ambient);this.uniforms.setFloat4(m.LIGHT_DIFFUSE.name,this.diffuse);this.uniforms.setFloat4(m.LIGHT_SPECULAR.name,this.specular)},
onStart:function(){y.prototype.onStart.call(this);this.onTransform();this.bindEvent(v.onTransform,n(this,this.onTransform))},onTransform:function(a){a=this.actor.get_transform().get_worldRotation().rotate(k.get_backward()).normalize();this.position.copy(a)},__class__:Tb});var sb=function(){w.call(this)};f["lovedna.game.components.Renderer"]=sb;sb.__name__=["lovedna","game","components","Renderer"];sb.__super__=y;sb.prototype=p(y.prototype,{cullWithCamera:function(a){return!0},collectRenderBuffer:function(a){},
onConstruct:function(){y.prototype.onConstruct.call(this);this.visible=!0;this.materials=[new La];this.cameraCull=!0},onDestroy:function(){y.prototype.onDestroy.call(this);this.materials=null},get_material:function(){return this.materials[0]},__class__:sb,__properties__:{get_material:"get_material"}});var ra=function(){w.call(this)};f["lovedna.game.components.MeshRenderer"]=ra;ra.__name__=["lovedna","game","components","MeshRenderer"];ra.__super__=sb;ra.prototype=p(sb.prototype,{cullWithCamera:function(a){if(null==
this.mesh||null==this.mesh.buffer)return!0;if(!this.cameraCull)return!1;var b=a.frustum;this._meshId!=this.mesh.id&&(this._meshId=this.mesh.id,--this._transformFrame);if(null==this.actor.world)return!0;this._transformFrame!=this.actor.frame&&(this._transformFrame=this.actor.frame,this.bounds.copy(this.mesh.buffer.bounds),this.bounds.multiplyMatrix44(this.actor.get_transform().getLocalToWorld()));if(!b.intersectsSphere(this.bounds.sphere)||!b.intersectsBox(this.bounds.box))return!0;this._distanceToCamera=
a.actor.get_transform().get_worldPosition().distanceSquared(this.actor.get_transform().get_worldPosition());return!1},collectRenderBuffer:function(a){if(null!=this.mesh)if(0<this.skipFrame)this.skipFrame--;else if(this.mesh.buffer.enabled)for(var b=0,c=this.materials.length;b<c;){var d=b++;d=this.materials[d];if(null!=d&&null!=d.shader){d.uniforms.setMatrix44Handler(m.M.name,(Ya=this.actor.get_transform(),n(Ya,Ya.getLocalToWorld)));d.uniforms.setMatrix44Handler(m.IM.name,(Ya=this.actor.get_transform(),
n(Ya,Ya.getWorldToLocal)));var e=L.get_temp();e.clear();e.name=this.actor.name;e.renderQueue=d.renderQueue;e.shaderId=d.shader.get_id();e.renderIndex=this.mesh.id;e.distance=this._distanceToCamera;e.setMaterial(d);e.setMeshBuffer(this.mesh);e.draw();this.onFillBuffer(d,e);a.add(e)}}},onConstruct:function(){sb.prototype.onConstruct.call(this);this._meshId=1E7;this.bounds=new Zb;this.skipFrame=0},onAwake:function(){this._distanceToCamera=0;this._transformFrame=-1},onDestroy:function(){sb.prototype.onDestroy.call(this);
this.bounds=this.mesh=null},onFillBuffer:function(a,b){},__class__:ra});var Ha=function(){w.call(this)};f["lovedna.game.components.Transform"]=Ha;Ha.__name__=["lovedna","game","components","Transform"];Ha.__super__=y;Ha.prototype=p(y.prototype,{transformLocalToWorld:function(a){this.getLocalToWorld().transformVector(a)},transformWorldToLocal:function(a){this.getWorldToLocal().transformVector(a)},getWorldToLocalMatrix:function(a){var b=T.get_temp();b.copy(this.getWorldToLocal());b.append(a.getLocalToWorld());
return b},addChild:function(a,b){null==b&&(b=!1);this.addChildAt(a,1E7,b)},addChildAt:function(a,b,c){null==c&&(c=!1);null==a||a==this||a.hasChild(this)||(null!=a.parent&&(a.parent.removeChild(a),a.parent==this&&(c=!1)),null==this._childs&&(this._childs=new G),0>b?this._childs.unshift(a):b>=this._childs.get_length()?this._childs.push(a):this._childs.insert(b,a),c&&(b=T.get_temp(),b.copy(this.getWorldToLocal()),b.append(a.getLocalToWorld()),a.rotation.copy(b.getRotation()),a.position.copy(b.getTranslation()),
a.scale.copy(b.getScale())),a.parent=this,a.actor.dispatchEvent(v.onAdded),null!=this.actor.world&&this.actor.world.set_dirty(!0),this.childCount=this._childs.get_length())},removeFromParent:function(){null!=this.parent&&this.parent.removeChild(this)},removeChild:function(a){null!=a&&a!=this&&a.parent==this&&null!=this._childs&&-1!=this._childs.remove(a)&&(this.childCount=this._childs.get_length(),a.actor.dispatchEvent(v.onRemoved),null!=this.actor.world&&this.actor.world.set_dirty(!0))},removeChildAt:function(a){if(null!=
this._childs&&!(0>a||a>=this._childs.get_length())){var b=this._childs.getElement(a);this.childCount=this._childs.get_length();this._childs.removeAt(a);null!=b&&(b.dispatchEvent(v.onRemoved),null!=this.actor.world&&this.actor.world.set_dirty(!0))}},getChild:function(a,b){null==b&&(b=!1);return null==this._childs?null:this._childs.get(a,b)},findChild:function(a){return null},hasChild:function(a){if(null==a||a==this||null==a.parent)return!1;a=a.parent;for(var b=200;null!=a;){if(a==this)return!0;var c=
a.parent;if(c==a)break;a=c;--b;if(1>b)break}return!1},getLocalToWorld:function(){null==this._localToWorld&&(null==this.__localToWorld&&(this.__localToWorld=new T),this._localToWorld=this.__localToWorld,this._doUpdateTransform());return this._localToWorld},getWorldToLocal:function(){null==this._worldToLocal&&(null==this.__worldToLocal&&(this.__worldToLocal=new T),this._worldToLocal=this.__worldToLocal,this._worldToLocal.copy(this.getLocalToWorld()),this._worldToLocal.inverse());return this._worldToLocal},
onConstruct:function(){y.prototype.onConstruct.call(this);this.position=new k(0,0,0);this.scale=new k(1,1,1);this.rotation=new R;this._localPosition=new k(.1,.2,.3);this._localScale=new k(1.1,1.2,1.3);this._localRotation=new R;this.childCount=0},onDestroy:function(){y.prototype.onDestroy.call(this);if(null!=this._childs)for(var a=this._childs.get_length();0<a--;){var b=this._childs.getElement(a);this.removeChild(b);J.destory(b.actor)}null!=this.parent&&this.parent.removeChild(this);this._worldToLocal=
this.__worldToLocal=this._localToWorld=this.__localToWorld=this._localRotation=this._localScale=this._localPosition=this.rotation=this.scale=this.position=this.parent=this._childs=null},needTransformUpdate:function(){return this._localPosition.equals(this.position)&&this._localRotation.equals(this.rotation)&&this._localScale.equals(this.scale)?!1:!0},_updateTransform:function(a){var b=this.needTransformUpdate();b||null!=this.parent&&this.transformFrame<this.parent.transformFrame&&(b=!0);b&&(this.transformFrame=
a,this.cacheTransform(),this.actor.dispatchEvent(v.onTransform));this.actor.dispatchEvent(v.onTransformComplete)},cacheTransform:function(){this._localPosition.copy(this.position);this._localScale.copy(this.scale);this._localRotation.copy(this.rotation);this._worldToLocal=this._scale=this._rotation=this._position=this._localToWorld=null},_doUpdateTransform:function(){null==this.parent?this._localToWorld.setTRS(this.position,this.rotation,this.scale):(this._localToWorld.copy(this.parent.getLocalToWorld()),
this._localToWorld.appendTRS(this.position,this.rotation,this.scale))},get_worldPosition:function(){null==this._position&&(null==this.__position&&(this.__position=new k),this._position=this.__position,this.getLocalToWorld().getTranslation(this._position));return this._position},get_worldScale:function(){null==this._scale&&(null==this.__scale&&(this.__scale=new k),this._scale=this.__scale,this.getLocalToWorld().getScale(this._scale));return this._position},get_worldRotation:function(){null==this._rotation&&
(null==this.__rotation&&(this.__rotation=new R),this._rotation=this.__rotation,this.getLocalToWorld().getRotation(this._rotation));return this._rotation},__class__:Ha,__properties__:{get_worldRotation:"get_worldRotation",get_worldScale:"get_worldScale",get_worldPosition:"get_worldPosition"}});var Nb=function(){w.call(this)};f["lovedna.game.components.RectTransform"]=Nb;Nb.__name__=["lovedna","game","components","RectTransform"];Nb.__super__=Ha;Nb.prototype=p(Ha.prototype,{onAwake:function(){Ha.prototype.onAwake.call(this);
this.anchorX=new t(.5,.5);this.anchorY=new t(.5,.5);this.height=this.width=0;this._size=new t;this._anchorX=new t(.5,.5);this._anchorY=new t(.5,.5);this.pivot=new t(.5,.5);this._pivot=new t(.5,.5);this._rectDirty=!0;this.bindEvent(v.onAdded,n(this,this.onAdded))},needTransformUpdate:function(){this._rectDirty=!0;if(this.width!=this._size.x||this.height!=this._size.y||!this.pivot.equals(this.pivot)||!this._anchorY.equals(this.anchorY)||!this._anchorX.equals(this.anchorX))return!0;this._rectDirty=!1;
return Ha.prototype.needTransformUpdate.call(this)},cacheTransform:function(){Ha.prototype.cacheTransform.call(this);this._size.set(this.width,this.height);this._anchorY.copy(this.anchorY);this._anchorX.copy(this.anchorX);this._pivot.copy(this.pivot);this._rectDirty&&(this._rectDirty=!1,this.actor.dispatchEvent(v.onRectTransform))},_doUpdateTransform:function(){var a=k.get_temp().copy(this.position);if(null!=this._parent){this.anchorX.clamp(0,1);this.anchorY.clamp(0,1);if(this.anchorX.y>this.anchorX.x){var b=
this.anchorX.y-this.anchorX.x;this.width=this._parent.width*b;a.x+=(this.anchorX.x+.5*b-.5)*this._parent.width+(this.pivot.x-.5)*this.width}else a.x+=(this.anchorX.x-.5)*this._parent.width;this.anchorY.y>this.anchorY.x?(b=this.anchorY.y-this.anchorY.x,this.height=this._parent.height*b,a.y+=(this.anchorY.x+.5*b-.5)*this._parent.height+(this.pivot.y-.5)*this.height):a.y+=(this.anchorY.x-.5)*this._parent.height}null==this.parent?this._localToWorld.setTRS(a,this.rotation,this.scale):(this._localToWorld.copy(this.parent.getLocalToWorld()),
this._localToWorld.appendTRS(a,this.rotation,this.scale))},onAdded:function(a){u.is(this.parent,Nb)&&(this._parent=this.parent)},__class__:Nb});var Wc=function(){w.call(this)};f["lovedna.game.components.SkinnedMeshRenderer"]=Wc;Wc.__name__=["lovedna","game","components","SkinnedMeshRenderer"];Wc.__super__=ra;Wc.prototype=p(ra.prototype,{onConstruct:function(){ra.prototype.onConstruct.call(this);this.set_bones([])},onStart:function(){ra.prototype.onStart.call(this)},onFillBuffer:function(a,b){null!=
this.bones&&(1>this.bones.length||a.uniforms.setMatrix44Array(m.BONE.name,this.bones))},set_bones:function(a){return this.bones=a},__class__:Wc,__properties__:p(ra.prototype.__properties__,{set_bones:"set_bones"})});var ac=function(){this.rect=new Wa;this.lineIndex=0};f["lovedna.game.components._Text.CharInfo"]=ac;ac.__name__=["lovedna","game","components","_Text","CharInfo"];ac.isNewLine=function(a){return 10!=a?13==a:!0};ac.prototype={set_char:function(a){this["char"]=a;return this["char"]},__class__:ac,
__properties__:{set_char:"set_char"}};var Wa=function(a,b,c,d){null==d&&(d=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);this._vec2=new t;E.call(this,a,b,c,d);this.x=a;this.y=b;this.set_width(c);this.set_height(d)};f["lovedna.geom.Rect"]=Wa;Wa.__name__=["lovedna","geom","Rect"];Wa.__super__=E;Wa.prototype=p(E.prototype,{setScale:function(a,b){this.x*=a;this.y*=b;this.set_width(this.get_width()*a);this.set_height(this.get_height()*b);return this},setSize:function(a,b){this.set_width(a);this.set_height(b);
return this},setPosition:function(a,b){this.x=a;this.y=b;return this},setEdge:function(a,b,c,d){this.x=a;this.y=c;this.set_width(this.get_width()-(a+b));this.set_height(this.get_height()-(c+d));return this},setEdgeFromRect:function(a){this.x=a.x;this.y=a.y;this.set_width(this.get_width()-(a.x+a.get_width()));this.set_height(this.get_height()-(a.y+a.get_height()));return this},normalize:function(a){this.x/=a.x;this.set_width(this.get_width()/a.x);this.y/=a.y;this.set_height(this.get_height()/a.y);
return this},contains:function(a,b){return a>=this.x&&b>=this.y&&a<this.get_right()?b<this.get_bottom():!1},containsPoint:function(a){return this.contains(a.x,a.y)},containsRect:function(a){return 0>=a.get_width()||0>=a.get_height()?a.x>this.x&&a.y>this.y&&a.get_right()<this.get_right()?a.get_bottom()<this.get_bottom():!1:a.x>=this.x&&a.y>=this.y&&a.get_right()<=this.get_right()?a.get_bottom()<=this.get_bottom():!1},overlap:function(a,b){null==b&&(b=0);var c=Wa._helpVec0,d=Wa._helpVec1,e=.5*a.get_width()+
b,l=.5*a.get_height()+b,f=.5*this.get_width()+b;b=.5*this.get_height()+b;c.set(a.get_left()+e,a.get_top()+l);d.set(this.get_left()+f,this.get_top()+b);return g.abs(c.x-d.x)<=e+f?g.abs(c.y-d.y)<=l+b:!1},isEmpty:function(){return 0>=this.get_width()?!0:0>=this.get_height()},set_width:function(a){return this.z=a},get_width:function(){return this.z},get_height:function(){return this.w},set_height:function(a){return this.w=a},get_bottom:function(){return this.y+this.get_height()},set_bottom:function(a){this.set_height(a-
this.y);return a},get_left:function(){return this.x},set_left:function(a){this.set_width(this.get_width()-(a-this.x));return this.x=a},get_right:function(){return this.x+this.get_width()},set_right:function(a){this.set_width(a-this.x);return a},get_size:function(){return this._vec2.set(this.get_width(),this.get_height())},set_size:function(a){this.set_width(a.x);this.set_height(a.y);return a},get_top:function(){return this.y},set_top:function(a){this.set_height(this.get_height()-(a-this.y));return this.y=
a},__class__:Wa,__properties__:{set_top:"set_top",get_top:"get_top",set_size:"set_size",get_size:"get_size",set_right:"set_right",get_right:"get_right",set_left:"set_left",get_left:"get_left",set_bottom:"set_bottom",get_bottom:"get_bottom",set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width"}});var Ob=function(){this._paramKey=new G};f["lovedna.utils.string.RichChunk"]=Ob;Ob.__name__=["lovedna","utils","string","RichChunk"];Ob.prototype={Parse:function(a,b){this._paramMap=
new I;this.next=this.value=this.name=null;this._paramKey.clear();this.start=b;a=g.replace(a,"<","");a=g.replace(a,">","");a=g.trim(a);this.type=-1;b=a.indexOf("/");if(0==b)this.type=1,this.name=B.substr(a,b+1,null);else{b==a.length-1&&(this.type=0,a=g.trim(B.substr(a,0,a.length-1)));b=a.indexOf(" ");var c=a.indexOf("=");-1==b&&-1==c?this.name=a:-1!=b&&-1!=c?c<b?(a=a.split("="),this.name=g.trim(a[0]),1<a.length&&(this.value=a[1])):(this.name=B.substr(a,0,b),this.parseParams(B.substr(a,b+1,null))):
-1!=b?(this.name=B.substr(a,0,b),this.parseParams(B.substr(a,b+1,null))):-1!=c&&(this.name=g.trim(B.substr(a,0,c)),this.parseParams(B.substr(a,c+1,null)))}},GetParamList:function(){return this._paramKey},GetParam:function(a){return null==this._paramMap?null:this._paramMap.get(a)},GetParams:function(){return this._paramMap},setNext:function(a){this.next=a},toString:function(){return"{"+this.name+" start "+this.start+(null!=this.next?" end "+this.next.start:"")+(null!=this.value?" "+this.value:"")+
(0<this._paramKey.get_length()?" has "+this._paramKey.get_length()+" param":"")+"}"},parseParams:function(a){a=g.trim(a);if(-1==a.indexOf(" ")&&-1==a.indexOf("="))this.value=a;else{a=a.split(" ");var b=a.length;if(0!=b)for(var c=0;c<b;){var d=c++;d=g.trim(a[d]);if(""!=d){d=d.split("=");var e=g.trim(d[0]),l=null;1<d.length&&(l=g.trim(d[1]));this._paramKey.push(e);this._paramMap.set(e,l)}}}},__class__:Ob};var bc=function(){this._chunkList=new G;this._list=new G};f["lovedna.utils.string.RichTextParser"]=
bc;bc.__name__=["lovedna","utils","string","RichTextParser"];bc.prototype={parse:function(a){this.value=a;this._chunkList.clear();for(a=a.length;;){var b=this.value.indexOf("<",0),c=this.value.indexOf(">",b),d=c-b;if(0<d){if(this.addChunk(b,B.substr(this.value,b,d+1)),this.value=B.substr(this.value,0,b)+B.substr(this.value,c+1,null),this.value.length>a)break}else break;--a;if(0>a)break}this.buildChunk();return this._list},addChunk:function(a,b){var c=bc._pool.get();c.Parse(b,a);this._chunkList.push(c)},
buildChunk:function(){this._list.clear();for(var a,b=0,c=this._chunkList.get_length();b<c;){var d=b++;a=this._chunkList.getElement(d);if(null==a)break;-1==a.type?(this._list.push(a),a.setNext(this.getNextChunk(d+1,a.name))):0==a.type&&this._list.push(a)}},getNextChunk:function(a,b){for(var c=this._chunkList.get_length();a<c;){var d=a++,e=this._chunkList.getElement(d);if(e.name==b&&1==e.type)return this._chunkList.removeAt(d),e}return null},__class__:bc};var db=function(){w.call(this)};f["lovedna.game.components.Text"]=
db;db.__name__=["lovedna","game","components","Text"];db.__super__=za;db.prototype=p(za.prototype,{onAwake:function(){za.prototype.onAwake.call(this);this._dirty=!1;this._letterSpace=this._lineSpace=0;this._alignmentY=this._alignmentX=-1;this.transform.width=this.transform.height=200;this.geometry=new sa;this.geometry.position=[];this.geometry.uv=[];this.geometry.color=[];this._indexs=[];this._charList=new G;this._charLineWidth=new G;this._drawFrame=this._updateFrame=0},onStart:function(){za.prototype.onStart.call(this)},
dirty:function(){this._dirty||this.bindEvent(v.onTransformComplete,n(this,this.onTransformComplete));this._dirty=!0;this._updateFrame=0},onTransformComplete:function(a){this._dirty=!1;this.bindEvent(v.onTransformComplete,null);this.refresh();this.drawText()},fontInit:function(a){this.dirty()},refresh:function(){if(null!=this._font&&this._font.enabled){var a=this.actor.frame;if(this._updateFrame!=a&&(this._updateFrame=a,null!=this._text&&0!=this._text.length)){db._parse.parse(this._text);this._text=
db._parse.value;this._charList.clear();db._charpool.clear(0);var b=this._text.length;a=0;for(var c=b;a<c;){var d=a++;d=B.cca(this._text,d);var e=this._font.fnt.getChar(d),l=db._charpool.get();l.set_char(e);l.newline=ac.isNewLine(d);this._charList.push(l)}c=a=0;d=this.transform.width;e=this.transform.height;b=this._charList.get_length();for(var f=l=0,g=this._font.fnt.lineHeight,h=2>g,k=0,m=0;m<b;){var n=m++;n=this._charList.getElement(n);n.lineIndex=this._charLineWidth.get_length();if(n.newline)this._charLineWidth.push(l),
l=0,f=0==k?f+g:f+k,f+=this.get_lineSpace(),f>c&&(c=f),k=0;else{var p=n["char"];if(null!=p){var q=p.width,t=p.height;q*=1;t*=1;l+p.xadvance>d&&(this._charLineWidth.push(l),l=0,f=0==k?f+g:f+k,f+=this.get_lineSpace(),f>c&&(c=f),k=0);if(f>e)break;var r=1*p.xoffset,u=1*p.yoffset;h&&(u=r=0);n.rect.set(l+r,f+u,q,t);l+=this.get_letterSpace();l=p.xadvance<q?l+q:l+p.xadvance;l>a&&(a=l);t+p.yoffset>k&&(k=t+p.yoffset)}}}this._charLineWidth.push(l);this._textWidth=a;this._textHeight=c+k}}},drawText:function(){if(null!=
this._font&&this._font.enabled){var a=this.actor.frame;if(this._drawFrame!=a&&(this._drawFrame=a,null!=this._text&&0!=this._text.length)){a=this.transform.width;var b=this.transform.height,c=-this.transform.pivot.x*a,d=-this.transform.pivot.y*b;this._indexs.splice(0,this._indexs.length);this.geometry.position.splice(0,this.geometry.position.length);this.geometry.uv.splice(0,this.geometry.position.length);this.geometry.color.splice(0,this.geometry.position.length);this.geometry.clearGroup();var e=
this._charList.get_length(),l=this._font.texture.width,f=this._font.texture.height,g=0;b=this._textHeight-b;0>=this._alignmentY&&(b=0==this._alignmentY?.5*b:0);for(var h=0;h<e;){var m=h++,n=this._charList.getElement(m);if(!n.newline&&(m=n["char"],null!=m)){var p=this._charLineWidth.getElement(n.lineIndex),q=a-p;0>=this.get_alignmentX()&&(q=0==this.get_alignmentX()?.5*q:0);p=n.rect.x+q;var r=-n.rect.get_bottom()+b;q=n.rect.get_right()+q;n=-n.rect.y+b;this.geometry.position.push((new k(p+c,r+d,0)).scale(1));
this.geometry.position.push((new k(q+c,r+d,0)).scale(1));this.geometry.position.push((new k(q+c,n+d,0)).scale(1));this.geometry.position.push((new k(p+c,n+d,0)).scale(1));p=m.x/l;r=(m.y+m.height)/f;q=(m.x+m.width)/l;n=m.y/f;this.geometry.uv.push(new t(p,r));this.geometry.uv.push(new t(q,r));this.geometry.uv.push(new t(q,n));this.geometry.uv.push(new t(p,n));null!=this.colorBottom?(this.geometry.color.push(this.colorBottom),this.geometry.color.push(this.colorBottom)):(this.geometry.color.push((new S).setRGBA(-1)),
this.geometry.color.push((new S).setRGBA(-1)));null!=this.colorTop?(this.geometry.color.push(this.colorTop),this.geometry.color.push(this.colorTop)):(this.geometry.color.push((new S).setRGBA(-1)),this.geometry.color.push((new S).setRGBA(-1)));this._indexs.push(g);this._indexs.push(1+g);this._indexs.push(2+g);this._indexs.push(g);this._indexs.push(2+g);this._indexs.push(3+g);g+=4}}this.geometry.addGroup(this._indexs);this.dispatchEvent(D.init)}}},get_richText:function(){return this._richText},set_richText:function(a){this._richText!=
a&&(this._richText=a,this.dirty());return this._richText},get_text:function(){return this._text},set_text:function(a){this._text!=a&&(this._text=a,this.dirty());return this._text},get_font:function(){return this._font},set_font:function(a){this._font!=a&&(null==this._font||this._font.enabled||this._font.removeEventListener(D.complete.get_type(),n(this,this.fontInit)),this._font=a,null==this._font||this._font.enabled?this.dirty():this._font.addEventListener(D.complete.get_type(),n(this,this.fontInit)));
return this._font},get_lineSpace:function(){return this._lineSpace},set_lineSpace:function(a){this._lineSpace!=a&&(this._lineSpace=a,this.dirty());return this._lineSpace},get_letterSpace:function(){return this._letterSpace},set_letterSpace:function(a){this._letterSpace!=a&&(this._letterSpace=a,this.dirty());return this._letterSpace},get_alignmentX:function(){return this._alignmentX},set_alignmentX:function(a){0<a&&(a=1);0>a&&(a=-1);a!=this._alignmentX&&(this._alignmentX=a,this.dirty());return this._alignmentX},
get_alignmentY:function(){return this._alignmentY},set_alignmentY:function(a){0<a&&(a=1);0>a&&(a=-1);a!=this._alignmentY&&(this._alignmentY=a,this.dirty());return this._alignmentY},__class__:db,__properties__:{set_alignmentY:"set_alignmentY",get_alignmentY:"get_alignmentY",set_alignmentX:"set_alignmentX",get_alignmentX:"get_alignmentX",set_letterSpace:"set_letterSpace",get_letterSpace:"get_letterSpace",set_lineSpace:"set_lineSpace",get_lineSpace:"get_lineSpace",set_font:"set_font",get_font:"get_font",
set_richText:"set_richText",get_richText:"get_richText",set_text:"set_text",get_text:"get_text"}});var fc=function(){w.call(this)};f["lovedna.game.components.UIRoot"]=fc;fc.__name__=["lovedna","game","components","UIRoot"];fc.__super__=y;fc.prototype=p(y.prototype,{onAwake:function(){y.prototype.onAwake.call(this);this.distance=60;this.height=this.width=0;this._dirty=!1},onStart:function(){y.prototype.onStart.call(this);this.actor.get_transform().position.set(0,0,this.distance);this.bindEvent(v.onTransformComplete,
n(this,this.onTransformComplete));this._dirty=!0},onCameraUpdate:function(a){this._dirty=!0},onTransformComplete:function(a){if(null==this._camera){this._camera=this.actor.get_transform().parent.actor.getComponent(gb);if(null==this._camera)return;this._camera.actor.addEventListener(v.onCameraUpdate.get_type(),n(this,this.onCameraUpdate))}if(this._dirty&&null!=this._camera){this._dirty=!1;var b=k.get_temp(),c=k.get_temp(),d=k.get_temp(),e=1;a=this.distance/(this._camera.farClipPlane-this._camera.nearClipPlane);
b.set(-e,-e,1);c.set(e,-e,1);d.set(-e,e,1);this._camera.projectionViewInverseMatrix.transformVector(b,!0);this._camera.projectionViewInverseMatrix.transformVector(c,!0);this._camera.projectionViewInverseMatrix.transformVector(d,!0);e=b.distance(c);d=b.distance(d);b=e*a;a*=d;e=b/Z.width;0<this.width&&0<this.height&&(e=this.width/this.height>b/a?b/this.width:a/this.height);this.actor.get_transform().scale.set(-e,e,e)}},set_camera:function(a){null!=this._camera&&this._camera.actor.removeEventListener(v.onCameraUpdate.get_type(),
n(this,this.onCameraUpdate));this._camera=a;null!=this._camera&&(this.distance<this._camera.nearClipPlane&&(this.distance=this._camera.nearClipPlane+1),this.distance>this._camera.farClipPlane&&(this.distance=this._camera.farClipPlane-1),this._camera.actor.addEventListener(v.onCameraUpdate.get_type(),n(this,this.onCameraUpdate)));return this._camera},__class__:fc});var v=function(a){D.call(this,a)};f["lovedna.game.events.ActorEvent"]=v;v.__name__=["lovedna","game","events","ActorEvent"];v.__super__=
D;v.prototype=p(D.prototype,{__class__:v});var na=function(a){D.call(this,a);this.vintlist=[];this.vfloatlist=[];this.vstringlist=[]};f["lovedna.game.events.SystemEvent"]=na;na.__name__=["lovedna","game","events","SystemEvent"];na.__super__=D;na.prototype=p(D.prototype,{__class__:na});var Zb=function(){this.box=new Yc;this.sphere=new Zc};f["lovedna.game.geometry.Bounds"]=Zb;Zb.__name__=["lovedna","game","geometry","Bounds"];Zb.prototype={copy:function(a){null!=a&&(this.box.copy(a.box),this.sphere.copy(a.sphere));
return this},reset:function(){null!=this.box&&(this.box.reset(),this.sphere.radius=0)},expand:function(a){this.box.expand(a)},multiplyMatrix44:function(a){if(null!=a){this.box.multiplyMatrix44(a);this.sphere.center.copy(this.box.getCenter());a=this.box.getSize().scale(.5);var b=g.max(a.x,a.y);this.sphere.radius=g.max(b,a.z)}},__class__:Zb};var Uc=function(){sa.call(this);this.size=1};f["lovedna.game.geometry.GeomAxisLine"]=Uc;Uc.__name__=["lovedna","game","geometry","GeomAxisLine"];Uc.__super__=sa;
Uc.prototype=p(sa.prototype,{build:function(){aa.trace("size "+this.size,{fileName:"GeomAxisLine.hx",lineNumber:31,className:"lovedna.game.geometry.GeomAxisLine",methodName:"build"});this.position=[new k(0,0,0),new k(this.size,0,0),new k(0,0,0),new k(0,this.size,0),new k(0,0,0),new k(0,0,this.size)];this.color=[new E(1,0,0,1),new E(1,.6,0,1),new E(0,1,0,1),new E(.6,1,0,1),new E(0,0,1,1),new E(0,.6,1,1)];this.addGroup([0,1,2,3,4,5]);return this},__class__:Uc});var Ed=function(){sa.call(this);this.heightSegments=
this.widthSegments=this.height=this.width=1};f["lovedna.game.geometry.GeomPlane"]=Ed;Ed.__name__=["lovedna","game","geometry","GeomPlane"];Ed.__super__=sa;Ed.prototype=p(sa.prototype,{build:function(){1>this.widthSegments&&(this.widthSegments=1);1>this.heightSegments&&(this.heightSegments=1);0>=this.width&&(this.width=1E-4);0>=this.height&&(this.height=1E-4);var a=[];this.normal=[];this.uv=[];this.color=[];for(var b=[],c=.5*this.width,d=.5*this.height,e=this.widthSegments,l=this.heightSegments,f=
e+1,g=l+1,h=this.width/e,m=this.height/l,n=this.getCustomUvGetter(0),p=0;p<g;)for(var q=p++,r=q*m-d,u=0,v=f;u<v;){var x=u++,w=new k(x*h-c,-r,0),y=new k(0,0,1);x/=e;var z=q/l;x=(new t).copy(n(x,z));null!=this.transform&&(this.transform.transformVector(w),this.transform.transformVector(y));a.push(w);this.normal.push(y);this.uv.push(x);null!=this.customColor?this.color.push(this.customColor):this.color.push(new E(1,1,1,1))}for(c=0;c<l;)for(d=c++,g=0,h=e;g<h;)m=g++,n=m+f*(d+1),p=m+1+f*(d+1),q=m+1+f*d,
b.push(m+f*d),b.push(n),b.push(q),b.push(n),b.push(p),b.push(q);this.position=a;this.addGroup(b);return this},__class__:Ed});var Fd=function(){sa.call(this);this.radius=1;this.tube=.4;this.radialSegments=10;this.tubularSegments=30;this.arc=360;this.customColor=new S(1,1,1,1)};f["lovedna.game.geometry.GeomTorus"]=Fd;Fd.__name__=["lovedna","game","geometry","GeomTorus"];Fd.__super__=sa;Fd.prototype=p(sa.prototype,{build:function(){.01>this.radius&&(this.radius=.01);.004>this.tube&&(this.tube=.004);
2>this.radialSegments&&(this.radialSegments=2);3>this.tubularSegments&&(this.tubularSegments=3);1>this.arc&&(this.arc=1);this.arc=g.angleToRadian(g.clamp(this.arc,1,360));for(var a=[],b=[],c=[],d=[],e=[],l=new k,f=new Gd,h=this.getCustomUvGetter(),m=0,n=this.radialSegments+1;m<n;)for(var p=m++,q=p/this.radialSegments*6.283185307179586,r=Math.cos(q),u=0,x=this.tubularSegments+1;u<x;){var w=u++,v=w/this.tubularSegments*this.arc,y=Math.cos(v),z=Math.sin(v);v=new k;v.x=(this.radius+this.tube*r)*y;v.y=
(this.radius+this.tube*r)*z;v.z=this.tube*Math.sin(q);l.x=this.radius*y;l.y=this.radius*z;y=(new k).sub(v,l);z=(new t).copy(h(w/this.tubularSegments,p/this.radialSegments));null!=this.transform&&(this.transform.transformVector(v),this.transform.transformVector(y));a.push(v);c.push(y.normalize());e.push(z);null==this.customColor?(f.set(360/this.tubularSegments*w,1,1),w=f.toColor(),d.push(w)):(w=new S,w.from(this.customColor),d.push(w))}l=1;for(f=this.radialSegments+1;l<f;)for(h=l++,m=1,n=this.tubularSegments+
1;m<n;)p=m++,q=(this.tubularSegments+1)*(h-1)+p-1,r=(this.tubularSegments+1)*(h-1)+p,u=(this.tubularSegments+1)*h+p,b.push((this.tubularSegments+1)*h+p-1),b.push(q),b.push(u),b.push(q),b.push(r),b.push(u);this.position=a;this.normal=c;this.uv=e;this.color=d;this.addGroup(b);return this},__class__:Fd});var Hd=function(){};f["lovedna.game.geometry.MeshBuffer"]=Hd;Hd.__name__=["lovedna","game","geometry","MeshBuffer"];Hd.prototype={__class__:Hd};var Dc=function(a){this._geom=a;this._shaderId=0;this.define=
new Xa;this.enabled=!1;this.bounds=new Zb};f["lovedna.game.geometry.GeometryBuffer"]=Dc;Dc.__name__=["lovedna","game","geometry","GeometryBuffer"];Dc.__interfaces__=[Hd];Dc.prototype={build:function(){this.colorBuffer=this.vertexBuffer=this.positionBuffer=this.indexBuffer=null;null!=this.getIndexBuffer()&&null!=this.getPositionBuffer()&&(this.getVertexBuffer(),this.getColorBuffer(),this.getBoneBuffer(),this.enabled=!0)},unload:function(){null!=this._indexBuffer&&this._indexBuffer.unload();null!=this._positionBuffer&&
this._positionBuffer.unload();null!=this._vertexBuffer&&this._vertexBuffer.unload();null!=this._boneBuffer&&this._boneBuffer.unload();null!=this._colorBuffer&&this._colorBuffer.unload();this.define=this.colorBuffer=this.vertexBuffer=this.positionBuffer=this.indexBuffer=this._geom=this._colorBuffer=this._boneBuffer=this._vertexBuffer=this._positionBuffer=this._indexBuffer=null;this.enabled=!1;this.bounds=null},buildBounds:function(){var a=this._geom.position.length;if(!(2>a)){var b=[];this.bounds.reset();
for(var c=0;c<a;){var d=c++,e=this._geom.position[d];e.fillArray(b,3*d);this.bounds.expand(e)}}},raycast:function(a){for(var b=this._geom.groups.length,c=k.get_temp(),d=k.get_temp(),e=k.get_temp();0<b--;)for(var l=this._geom.groups[b].indices,f=g.floor(l.length/3);0<f--;){var h=3*f,m=l[h+1],n=l[h+2];c.copy(this._geom.position[l[h]]);d.copy(this._geom.position[m]);e.copy(this._geom.position[n]);h=a.intersectTriangle(c,d,e);if(null!=h)return a=new Ec,a.point=h,a}return null},getIndexBuffer:function(){if(null==
this.indexBuffer){if(null==this._geom.position||1>this._geom.groups.length)return null;for(var a=[],b=[],c=0,d=this._geom.groups.length;c<d;){var e=c++;e=this._geom.groups[e];var l=new Id;l.length=e.indices.length;l.offset=e.start;b.push(l);g.concat(a,e.indices)}null==this._indexBuffer&&(this._indexBuffer=new Pa);this._indexBuffer.setLayouts(b);this.indexBuffer=this._indexBuffer;this.indexBuffer.upload(a)}return this.indexBuffer},getPositionBuffer:function(){if(null==this.positionBuffer){if(null==
this._geom.position)return null;var a=this._geom.position.length;if(2>a)return null;var b=[];this.bounds.reset();for(var c=0;c<a;){var d=c++,e=this._geom.position[d];e.fillArray(b,3*d);this.bounds.expand(e)}null==this._positionBuffer&&(this._positionBuffer=new U,this._positionBuffer.setLayout([new Cb(m.POSITION.name,m.POSITION.size)]));this.positionBuffer=this._positionBuffer;this.positionBuffer.upload(b);this._shaderId=0}return this.positionBuffer},getVertexBuffer:function(){if(null==this.vertexBuffer){if(null==
this._geom.position)return null;var a=this._geom.position.length;if(2>a)return null;for(var b=[this._geom.uv,this._geom.uv2,this._geom.normal,this._geom.normal2,this._geom.tangent],c=[m.UV,m.UV2,m.NORMAL,m.NORMAL2,m.TANGENT],d=c.length,e=0,l=0;l<d;){var f=l++,g=b[f];f=c[f];this.define.define(f.name,null,!1);null==g||g.length<a||(e+=f.size,this.define.define(f.name,""))}if(0==e)return null;null==this._vertexBuffer&&(this._vertexBuffer=new U);l=[];g=0;f=[];for(var h=0;h<d;){var k=h++,n=b[k];if(null!=
n&&!(n.length<a)){for(var p=0,q=a;p<q;){var r=p++;var t=e*r+g;n[r].fillArray(l,t)}t=c[k];g+=t.size;f.push(new Cb(t.name,t.size))}}this._vertexBuffer.setLayout(f);this.vertexBuffer=this._vertexBuffer;this.vertexBuffer.upload(l);this._shaderId=0}return this.vertexBuffer},getBoneBuffer:function(){if(null==this.boneBuffer){if(null==this._geom.boneWeight||null==this._geom.position)return null;var a=this._geom.position.length;if(2>a)return null;for(var b=[];0<a--;){var c=8*a,d=this._geom.boneWeight[a];
d.index.fillArray(b,c);d.weight.fillArray(b,c+4)}null==this._boneBuffer&&(this._boneBuffer=new U,this.define.define(m.BONE.name),this._boneBuffer.setLayout([new Cb(m.BONE_INDEX.name,m.BONE_INDEX.size),new Cb(m.BONE_WEIGHT.name,m.BONE_WEIGHT.size)]));this.boneBuffer=this._boneBuffer;this.boneBuffer.upload(b)}return this.boneBuffer},getColorBuffer:function(){if(null==this.colorBuffer){if(null==this._geom.position)return null;var a=this._geom.position.length;if(2>a)return null;for(var b=[this._geom.color,
this._geom.color2,this._geom.color3,this._geom.color4,this._geom.color5,this._geom.color6,this._geom.color7,this._geom.color8,this._geom.color9],c=[m.COLOR,m.COLOR2,m.COLOR3,m.COLOR4,m.COLOR5,m.COLOR6,m.COLOR7,m.COLOR8,m.COLOR9],d=c.length,e=0,l=0;l<d;){var f=l++,g=b[f];f=c[f];this.define.define(f.name,null,!1);null==g||g.length<a||(e+=f.size,this.define.define(f.name,""))}if(0==e)return null;null==this._colorBuffer&&(this._colorBuffer=new U);l=[];g=0;f=[];for(var h=0;h<d;){var k=h++,n=b[k];if(null!=
n&&!(n.length<a)){for(var p=0,q=a;p<q;){var r=p++;var t=e*r+g;n[r].fillArray(l,t)}t=c[k];g+=t.size;f.push(new Cb(t.name,t.size))}}this._colorBuffer.setLayout(f);this.colorBuffer=this._colorBuffer;this.colorBuffer.upload(l);this._shaderId=0}return this.colorBuffer},updateLocations:function(a){var b=this._shaderId!=a.get_id();this._shaderId=a.get_id();if(this.enabled){var c=this.getPositionBuffer();b&&this.updateLayout(c,a);c=this.getVertexBuffer();null!=c&&b&&this.updateLayout(c,a);c=this.getColorBuffer();
null!=c&&b&&this.updateLayout(c,a);c=this.getBoneBuffer();null!=c&&b&&this.updateLayout(c,a);this._shaderId=a.get_id()}},bind:function(){if(!this.enabled)return!1;var a=this.getPositionBuffer();this.getIndexBuffer().bind();a.bind();a=this.getVertexBuffer();null!=a&&a.bind(this._shaderId);a=this.getColorBuffer();null!=a&&a.bind(this._shaderId);a=this.getBoneBuffer();null!=a&&a.bind(this._shaderId);return!0},updateLayout:function(a,b){a=a.layouts;if(null!=a){var c=a.length;if(!(1>c))for(;0<c--;){var d=
a[c],e=b.getBufferInput(d.name);d.location=null==e?-1:e.location}}},get_indexBuffer:function(){return this._indexBuffer},get_positionBuffer:function(){return this._positionBuffer},get_vertexBuffer:function(){return this._vertexBuffer},get_boneBuffer:function(){return this._boneBuffer},__class__:Dc};var Jd=function(){this.enabled=!1;this.color=new S(0,0,0,0);this.depth=1;this.stencil=0;this.target=null};f["lovedna.game.graphics._GLContext.ClearTarget"]=Jd;Jd.__name__=["lovedna","game","graphics","_GLContext",
"ClearTarget"];Jd.prototype={clear:function(){if(null==this.target||this.enabled){var a=0;null!=this.color&&(a|=16384);0<=this.depth&&(a|=256,this.gl.depthMask(!0),this.gl.clearDepthf(this.depth));0<=this.stencil&&(a|=1024,this.gl.clearStencil(this.stencil));null!=this.color&&this.gl.clearColor(this.color.get_r(),this.color.get_g(),this.color.get_b(),this.color.get_a());this.gl.clear(a)}},__class__:Jd};var h=function(){};f["lovedna.game.graphics.GLContext"]=h;h.__name__=["lovedna","game","graphics",
"GLContext"];h.init=function(a){null==h.gl&&(h.gl=a,h.currentState=new F,h.currentState.defaultValue())};h.start=function(a,b){h._targetStack.clear();h._currentTargetID=-2;h._currentTarget=null;h._clearStack.clear();h._currentClear=null;h._width=a;h._height=b;h.viewport(0,0,a,b)};h.end=function(){h.viewport(0,0,h._width,h._height);h.colorWrite(!0,!0,!0,!0);h.currentState.blend||(h.currentState.blend=!0);h.gl.enable(3042);-1==h.currentState.cullMode&&(h.currentState.cullMode=1029);h.gl.enable(2884);
h.currentState.depthTest||(h.currentState.depthTest=!0);h.gl.enable(2929);513!=h.currentState.depthMode&&(h.currentState.depthMode=513);h.gl.depthFunc(h.currentState.depthMode);h.currentState.depthWrite||(h.currentState.depthWrite=!0);h.gl.depthMask(!0);h.gl.bindFramebuffer(36160,null);h.gl.bindRenderbuffer(36161,null);Pa.current=null;pb.current=null;h.gl.bindTexture(3553,null);h.gl.bindBuffer(34963,null);h.gl.bindBuffer(34962,null);for(var a=5;0<a--;)h.gl.disableVertexAttribArray(a)};h.colorWrite=
function(a,b,c,d){if(h._colorMask[0]!=a||h._colorMask[1]!=b||h._colorMask[2]!=c||h._colorMask[3]!=d)h._colorMask[0]=a,h._colorMask[1]=b,h._colorMask[2]=c,h._colorMask[3]=d,h.gl.colorMask(a,b,c,d)};h.viewport=function(a,b,c,d){h.gl.viewport(a,b,c,d)};h.clear=function(a,b,c){null==c&&(c=0);null==b&&(b=1);var d=!1;null==h._currentClear&&(h._currentClear=h._clearTargetPool.get(),h._currentClear.gl=h.gl,h._currentClear.target=null,d=!0);h._currentClear.enabled=!0;h._currentClear.color=a;h._currentClear.depth=
b;h._currentClear.stencil=c;d&&(h._currentClear.clear(),h._currentClear=null)};h.state=function(a){var b=a.cullMode;b!=h.currentState.cullMode&&(h.currentState.cullMode=b,-1==h.currentState.cullMode?h.gl.disable(2884):(h.gl.enable(2884),h.gl.cullFace(h.currentState.cullMode)));b=a.depthTest;b!=h.currentState.depthTest&&(h.currentState.depthTest=b,h.currentState.depthTest?h.gl.enable(2929):h.gl.disable(2929));b&&a.depthMode!=h.currentState.depthMode&&(h.gl.depthFunc(a.depthMode),h.currentState.depthMode=
a.depthMode);b=a.depthWrite;b!=h.currentState.depthWrite&&(h.currentState.depthWrite=b,h.gl.depthMask(h.currentState.depthWrite));b=a.blend;b!=h.currentState.blend&&(h.currentState.blend=b,h.currentState.blend||h.gl.disable(3042));b&&(h.gl.enable(3042),h.gl.blendEquationSeparate(a.blendColorOperation,a.blendAlphaOperation),h.gl.blendFuncSeparate(a.blendSrcColor,a.blendDstColor,a.blendSrcAlpha,a.blendDstAlpha));b=a.stencilTest;h.currentState.stencilTest!=b&&(h.currentState.stencilTest=b,h.currentState.stencilTest?
h.gl.enable(2960):h.gl.disable(2960));h.currentState.stencilTest&&(h.currentState.stencilReadMask=a.stencilReadMask,h.currentState.stencilReferenceValue=a.stencilReferenceValue,h.currentState.stencilMode=a.stencilMode,h.currentState.stencilFail=a.stencilFail,h.currentState.stencilDepthFail=a.stencilDepthFail,h.currentState.stencilBothPass=a.stencilBothPass,h.gl.stencilFunc(h.currentState.stencilMode,h.currentState.stencilReferenceValue,h.currentState.stencilReadMask),h.gl.stencilOp(h.currentState.stencilFail,
h.currentState.stencilDepthFail,h.currentState.stencilBothPass))};h.getTarget=function(){return h._currentTarget};h.pushTarget=function(a){h._currentTarget=a;h._targetStack.push(h._currentTarget);h._currentClear=h._clearTargetPool.get();h._currentClear.gl=h.gl;h._currentClear.target=a;h._currentClear.enabled=!1;h._clearStack.push(h._currentClear)};h.popTarget=function(){0<h._targetStack.get_length()&&(h._targetStack.pop(),h._clearStack.pop());0<h._targetStack.get_length()?(h._currentTarget=h._targetStack.get(-1,
!0),h._currentClear=h._clearStack.get(-1,!0)):(h._currentTarget=null,h._currentClear=null)};h.drawBefore=function(){h.applyRenderTarget()};h.drawAfter=function(){h.gl.activeTexture(33984);h.gl.bindTexture(3553,null);h.gl.activeTexture(33985);h.gl.bindTexture(3553,null);h.gl.activeTexture(33986);h.gl.bindTexture(3553,null);h.gl.bindBuffer(34963,null);h.gl.bindBuffer(34962,null)};h.applyRenderTarget=function(){var a=-1;null!=h._currentTarget&&(a=h._currentTarget.id);a!=h._currentTargetID&&(h._currentTargetID=
a,null!=h._currentTarget?(h._currentTarget.bindBuffer(),h.viewport(0,0,h._currentTarget.width,h._currentTarget.height)):(h.gl.bindFramebuffer(36160,null),h.viewport(0,0,h._width,h._height)),null!=h._currentClear&&h._currentClear.clear())};h.prototype={__class__:h};var Pb=function(){};f["lovedna.resource.IResource"]=Pb;Pb.__name__=["lovedna","resource","IResource"];Pb.prototype={__class__:Pb};var Pa=function(){this.id=Pa._id++;this.enabled=!1;this.type=5123};f["lovedna.game.graphics.IndexBuffer"]=
Pa;Pa.__name__=["lovedna","game","graphics","IndexBuffer"];Pa.__interfaces__=[Pb];Pa.prototype={setLayouts:function(a){null==this.layouts?this.layouts=[]:this.layouts.splice(0,this.layouts.length);for(var b=0,c=a.length;b<c;){var d=b++,e=a[d];null==e&&aa.trace("error",{fileName:"IndexBuffer.hx",lineNumber:52,className:"lovedna.game.graphics.IndexBuffer",methodName:"setLayouts",customParams:["layout is null "+d]});this.layouts.push(e)}},upload:function(a){this.enabled=!1;null!=a&&1<a.length&&(this.enabled=
!0,this._data=a,this.length=this._data.length)},bind:function(){this._time=K.get_now();null!=this._data?(null==this._buffer&&(this._buffer=r.gl.createBuffer()),r.gl.bindBuffer(34963,this._buffer),r.gl.bufferData(34963,2*this._data.length,this.getData(),35044),this.length=this._data.length,this._data=null):null!=this._buffer&&this!=Pa.current&&(Pa.current=this,r.gl.bindBuffer(34963,this._buffer))},unload:function(){null!=this._buffer&&(r.gl.deleteBuffer(this._buffer),this._buffer=null);this._data=
null},getData:function(){var a=this._data.length,b=g.intToNextPow2(a),c=g.pow2Count(b),d=Pa._tempList[c];null==d&&(d=new Uint16Array(b),Pa._tempList[c]=d);for(;0<a--;)d[a]=this._data[a]&65535;return d},__class__:Pa};var Id=function(){};f["lovedna.game.graphics.IndexLayout"]=Id;Id.__name__=["lovedna","game","graphics","IndexLayout"];Id.prototype={__class__:Id};var pb=function(a,b){this.id=pb._id++;this.enabled=!1;var c=r.gl.createShader(35633);r.gl.shaderSource(c,a);r.gl.compileShader(c);if(0==r.gl.getShaderParameter(c,
35713))aa.trace(this.addLineNumber(a),{fileName:"Program.hx",lineNumber:41,className:"lovedna.game.graphics.Program",methodName:"new"}),aa.trace("vertex compileShader "+r.gl.getShaderInfoLog(c),{fileName:"Program.hx",lineNumber:42,className:"lovedna.game.graphics.Program",methodName:"new"});else if(a=r.gl.createShader(35632),r.gl.shaderSource(a,b),r.gl.compileShader(a),0==r.gl.getShaderParameter(a,35713))aa.trace(this.addLineNumber(b),{fileName:"Program.hx",lineNumber:49,className:"lovedna.game.graphics.Program",
methodName:"new"}),aa.trace("fragment compileShader "+r.gl.getShaderInfoLog(a),{fileName:"Program.hx",lineNumber:50,className:"lovedna.game.graphics.Program",methodName:"new"});else if(this._glprogram=r.gl.createProgram(),r.gl.attachShader(this._glprogram,c),r.gl.attachShader(this._glprogram,a),r.gl.linkProgram(this._glprogram),r.gl.deleteShader(c),r.gl.deleteShader(a),0==r.gl.getProgramParameter(this._glprogram,35714))aa.trace("linkProgram "+r.gl.getProgramInfoLog(this._glprogram),{fileName:"Program.hx",
lineNumber:62,className:"lovedna.game.graphics.Program",methodName:"new"});else{this.enabled=!0;this._bufferAttribs=new I;this._uniforms=new I;b=r.gl.getProgramParameter(this._glprogram,35721);c=0;for(a=b;c<a;){var d=c++;var e=r.gl.getActiveAttrib(this._glprogram,d);b=e.name;this._bufferAttribs.set(b,new Kd(d,r.gl.getAttribLocation(this._glprogram,b),e,this.id))}b=r.gl.getProgramParameter(this._glprogram,35718);a=this._uniformCount=c=0;for(d=b;a<d;){b=a++;e=r.gl.getActiveUniform(this._glprogram,b);
b=e.name;var l=e.type;35678==l||35680==l?(e=new $c(c,r.gl.getUniformLocation(this._glprogram,b),e,this),this._uniforms.set(b,e),++c):(l=b.indexOf("["),0<l&&(b=B.substr(b,0,l)),e=new $c(-1,r.gl.getUniformLocation(this._glprogram,b),e,this),this._uniforms.set(b,e));this._uniformCount++}this._successList=new G}};f["lovedna.game.graphics.Program"]=pb;pb.__name__=["lovedna","game","graphics","Program"];pb.prototype={bind:function(){this._time=K.get_now();if(this.enabled){this._success=0;this._successList.clear();
for(var a=this._uniforms.iterator();a.hasNext();){var b=a.next();this._successList.push(b)}pb.current!=this&&(r.gl.useProgram(this._glprogram),pb.current=this)}},getBufferInput:function(a){return null==this._bufferAttribs?null:this._bufferAttribs.get(a)},getUniformInput:function(a){return this._uniforms.get(a)},checkUniformFail:function(){for(var a=this._successList.get_length();0<a--;)aa.trace(this._successList.get(a).name,{fileName:"Program.hx",lineNumber:147,className:"lovedna.game.graphics.Program",
methodName:"checkUniformFail"});return this._uniformCount-this._success},uploadUniform:function(a){this._success++;this._successList.remove(a)},addLineNumber:function(a){var b="";a=new tc(a,!0);a.set_position(0);for(var c=a.get_length(),d=-(c+"").length,e=0;e<c;){var l=e++;b+=g.stringFill(l+1+"",d)+":\t"+a.readLine()+"\n"}return b},__class__:pb};var Kd=function(a,b,c,d){this.id=a;this.location=b;this.name=c.name;this.type=c.type;this.size=c.size;this.version=d};f["lovedna.game.graphics.ProgramBufferInput"]=
Kd;Kd.__name__=["lovedna","game","graphics","ProgramBufferInput"];Kd.prototype={__class__:Kd};var T=function(){this.identity()};f["lovedna.math.Matrix44"]=T;T.__name__=["lovedna","math","Matrix44"];T.__interfaces__=[yb];T.__properties__={get_temp:"get_temp"};T.get_temp=function(){return T._pool.get()};T.prototype={copy:function(a){return null==a?this:this.set(a.m0,a.m1,a.m2,a.m3,a.m4,a.m5,a.m6,a.m7,a.m8,a.m9,a.m10,a.m11,a.m12,a.m13,a.m14,a.m15)},clone:function(){return(new T).copy(this)},set:function(a,
b,c,d,e,l,f,g,h,k,m,n,p,q,r,t){this.m0=a;this.m1=b;this.m2=c;this.m3=d;this.m4=e;this.m5=l;this.m6=f;this.m7=g;this.m8=h;this.m9=k;this.m10=m;this.m11=n;this.m12=p;this.m13=q;this.m14=r;this.m15=t;this.dirty();return this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},append:function(a,b){null==b&&(b=!1);if(null==a)return this;var c=this,d=a;b&&(c=a,d=this);return this.set(c.m0*d.m0+c.m4*d.m1+c.m8*d.m2+c.m12*d.m3,c.m1*d.m0+c.m5*d.m1+c.m9*d.m2+c.m13*d.m3,c.m2*d.m0+c.m6*d.m1+
c.m10*d.m2+c.m14*d.m3,c.m3*d.m0+c.m7*d.m1+c.m11*d.m2+c.m15*d.m3,c.m0*d.m4+c.m4*d.m5+c.m8*d.m6+c.m12*d.m7,c.m1*d.m4+c.m5*d.m5+c.m9*d.m6+c.m13*d.m7,c.m2*d.m4+c.m6*d.m5+c.m10*d.m6+c.m14*d.m7,c.m3*d.m4+c.m7*d.m5+c.m11*d.m6+c.m15*d.m7,c.m0*d.m8+c.m4*d.m9+c.m8*d.m10+c.m12*d.m11,c.m1*d.m8+c.m5*d.m9+c.m9*d.m10+c.m13*d.m11,c.m2*d.m8+c.m6*d.m9+c.m10*d.m10+c.m14*d.m11,c.m3*d.m8+c.m7*d.m9+c.m11*d.m10+c.m15*d.m11,c.m0*d.m12+c.m4*d.m13+c.m8*d.m14+c.m12*d.m15,c.m1*d.m12+c.m5*d.m13+c.m9*d.m14+c.m13*d.m15,c.m2*d.m12+
c.m6*d.m13+c.m10*d.m14+c.m14*d.m15,c.m3*d.m12+c.m7*d.m13+c.m11*d.m14+c.m15*d.m15)},inverse:function(){var a=this.getDeterminant();if(0==a)throw new M("non-invertible matrix");a=1/a;var b=this.m12*this.m10*this.m7-this.m8*this.m14*this.m7-this.m12*this.m6*this.m11+this.m4*this.m14*this.m11+this.m8*this.m6*this.m15-this.m4*this.m10*this.m15,c=this.m8*this.m13*this.m7-this.m12*this.m9*this.m7+this.m12*this.m5*this.m11-this.m4*this.m13*this.m11-this.m8*this.m5*this.m15+this.m4*this.m9*this.m15,d=this.m12*
this.m9*this.m6-this.m8*this.m13*this.m6-this.m12*this.m5*this.m10+this.m4*this.m13*this.m10+this.m8*this.m5*this.m14-this.m4*this.m9*this.m14,e=this.m13*this.m10*this.m3-this.m9*this.m14*this.m3-this.m13*this.m2*this.m11+this.m1*this.m14*this.m11+this.m9*this.m2*this.m15-this.m1*this.m10*this.m15,f=this.m8*this.m14*this.m3-this.m12*this.m10*this.m3+this.m12*this.m2*this.m11-this.m0*this.m14*this.m11-this.m8*this.m2*this.m15+this.m0*this.m10*this.m15,g=this.m12*this.m9*this.m3-this.m8*this.m13*this.m3-
this.m12*this.m1*this.m11+this.m0*this.m13*this.m11+this.m8*this.m1*this.m15-this.m0*this.m9*this.m15,h=this.m8*this.m13*this.m2-this.m12*this.m9*this.m2+this.m12*this.m1*this.m10-this.m0*this.m13*this.m10-this.m8*this.m1*this.m14+this.m0*this.m9*this.m14,k=this.m5*this.m14*this.m3-this.m13*this.m6*this.m3+this.m13*this.m2*this.m7-this.m1*this.m14*this.m7-this.m5*this.m2*this.m15+this.m1*this.m6*this.m15,m=this.m12*this.m6*this.m3-this.m4*this.m14*this.m3-this.m12*this.m2*this.m7+this.m0*this.m14*
this.m7+this.m4*this.m2*this.m15-this.m0*this.m6*this.m15,n=this.m4*this.m13*this.m3-this.m12*this.m5*this.m3+this.m12*this.m1*this.m7-this.m0*this.m13*this.m7-this.m4*this.m1*this.m15+this.m0*this.m5*this.m15,p=this.m12*this.m5*this.m2-this.m4*this.m13*this.m2-this.m12*this.m1*this.m6+this.m0*this.m13*this.m6+this.m4*this.m1*this.m14-this.m0*this.m5*this.m14,q=this.m9*this.m6*this.m3-this.m5*this.m10*this.m3-this.m9*this.m2*this.m7+this.m1*this.m10*this.m7+this.m5*this.m2*this.m11-this.m1*this.m6*
this.m11,r=this.m4*this.m10*this.m3-this.m8*this.m6*this.m3+this.m8*this.m2*this.m7-this.m0*this.m10*this.m7-this.m4*this.m2*this.m11+this.m0*this.m6*this.m11,t=this.m8*this.m5*this.m3-this.m4*this.m9*this.m3-this.m8*this.m1*this.m7+this.m0*this.m9*this.m7+this.m4*this.m1*this.m11-this.m0*this.m5*this.m11,u=this.m4*this.m9*this.m2-this.m8*this.m5*this.m2+this.m8*this.m1*this.m6-this.m0*this.m9*this.m6-this.m4*this.m1*this.m10+this.m0*this.m5*this.m10;this.m0=(this.m9*this.m14*this.m7-this.m13*this.m10*
this.m7+this.m13*this.m6*this.m11-this.m5*this.m14*this.m11-this.m9*this.m6*this.m15+this.m5*this.m10*this.m15)*a;this.m4=b*a;this.m8=c*a;this.m12=d*a;this.m1=e*a;this.m5=f*a;this.m9=g*a;this.m13=h*a;this.m2=k*a;this.m6=m*a;this.m10=n*a;this.m14=p*a;this.m3=q*a;this.m7=r*a;this.m11=t*a;this.m15=u*a;this.dirty();return this},setProjection:function(a,b,c,d){null==d&&(d=1.78);null==c&&(c=60);null==b&&(b=1E3);null==a&&(a=.1);c=1/Math.tan(.5*g.angleToRadian(c));this.m0=c/d;this.m4=this.m3=this.m2=this.m1=
0;this.m5=c;this.m9=this.m8=this.m7=this.m6=0;this.m10=(b+a)/(a-b);this.m11=-1;this.m13=this.m12=0;this.m14=2*b*a/(a-b);this.m15=0;this.dirty();return this},setFrustum:function(a,b,c,d,e,f){this.m0=2*e/(b-a);this.m4=this.m3=this.m2=this.m1=0;this.m5=2*e/(d-c);this.m7=this.m6=0;this.m8=(b+a)/(b-a);this.m9=(d+c)/(d-c);this.m10=(f+e)/(e-f);this.m11=-1;this.m13=this.m12=0;this.m14=2*f*e/(e-f);this.m15=0;this.dirty();return this},setOrtho:function(a,b,c,d,e,f){this.m0=2/(b-a);this.m4=this.m3=this.m2=this.m1=
0;this.m5=2/(d-c);this.m9=this.m8=this.m7=this.m6=0;this.m10=-2/(f-e);this.m11=0;this.m12=-(b+a)/(b-a);this.m13=-(d+c)/(d-c);this.m14=-(f+e)/(f-e);this.m15=1;this.dirty();return this},setOrtho2D:function(a,b,c,d,e,f){null==f&&(f=1);null==e&&(e=0);return this.setOrtho(a,a+c,b,b+d,e,f)},lookAt:function(a,b,c){null==b&&(b=k.get_temp().set(0,0,0));null==c&&(c=k.get_up());var d=k.get_temp(),e=k.get_temp(),f=k.get_temp(),g=k.get_temp();b=d.copy(b).sub(a);g.copy(b).normalize();e.copy(b).normalize();e.cross(c).normalize();
f.copy(e).cross(g).normalize();this.identity();this.m0=e.x;this.m4=e.y;this.m8=e.z;this.m1=f.x;this.m5=f.y;this.m9=f.z;this.m2=-g.x;this.m6=-g.y;this.m10=-g.z;this.appendTranslation(d.copy(a).scale(-1));return this},setTranslation:function(a){this.m12=a.x;this.m13=a.y;this.m14=a.z;this.dirty();return this},getTranslation:function(a){null==a&&(a=k.get_temp());return a.set(this.m12,this.m13,this.m14)},setScale:function(a){this.m0=a.x;this.m5=a.y;this.m10=a.z;this.dirty();return this},getScale:function(a){null==
a&&(a=k.get_temp());return a.set(this.getScaleX(),this.getScaleY(),this.getScaleZ())},setRotation:function(a){var b=a.x*a.x,c=a.x*a.y,d=a.x*a.z,e=a.x*a.w,f=a.y*a.y,g=a.y*a.z,h=a.y*a.w,k=a.z*a.z;a=a.z*a.w;this.m0=1-2*(f+k);this.m1=2*(c+a);this.m2=2*(d-h);this.m4=2*(c-a);this.m5=1-2*(b+k);this.m6=2*(g+e);this.m8=2*(d+h);this.m9=2*(g-e);this.m10=1-2*(b+f);this.dirty();return this},getRotation:function(a){null==a&&(a=R.get_temp());var b=this.getRotationMatrix();return a.setFromAxes(b.m0,b.m4,b.m8,b.m1,
b.m5,b.m9,b.m2,b.m6,b.m10)},getRotationMatrix:function(a){null==a&&(a=T.get_temp());var b=0>this.m4*this.m5*this.m6*this.m7?-1:1,c=0>this.m8*this.m9*this.m10*this.m11?-1:1,d=Math.sqrt,e=(0>this.m0*this.m1*this.m2*this.m3?-1:1)*d(this.m0*this.m0+this.m1*this.m1+this.m2*this.m2);b*=d(this.m4*this.m4+this.m5*this.m5+this.m6*this.m6);c*=d(this.m8*this.m8+this.m9*this.m9+this.m10*this.m10);return a.set(this.m0/e,this.m1/e,this.m2/e,0,this.m4/b,this.m5/b,this.m6/b,0,this.m8/c,this.m9/c,this.m10/c,0,0,0,
0,1)},appendTranslation:function(a){a.isZero()||this.append(T.get_temp().identity().setTranslation(a));return this},appendScale:function(a){a.isOne()||this.append(T.get_temp().identity().setScale(a));return this},appendRotation:function(a){a.isZero()||this.append(T.get_temp().identity().setRotation(a));return this},appendTRS:function(a,b,c){null!=a&&this.appendTranslation(a);null!=b&&this.appendRotation(b);null!=c&&this.appendScale(c);return this},setTRS:function(a,b,c){return this.identity().appendTRS(a,
b,c)},getScaleXSquared:function(){return this.m0*this.m0+this.m4*this.m4+this.m8*this.m8},getScaleYSquared:function(){return this.m1*this.m1+this.m5*this.m5+this.m9*this.m9},getScaleZSquared:function(){return this.m2*this.m2+this.m6*this.m6+this.m10*this.m10},getScaleX:function(){return g.isZero(this.m4)&&g.isZero(this.m8)?g.abs(this.m0):Math.sqrt(this.getScaleXSquared())},getScaleY:function(){return g.isZero(this.m1)&&g.isZero(this.m9)?g.abs(this.m5):Math.sqrt(this.getScaleYSquared())},getScaleZ:function(){return g.isZero(this.m2)&&
g.isZero(this.m6)?g.abs(this.m10):Math.sqrt(this.getScaleZSquared())},transpose:function(){return this},transformVector:function(a,b){null==b&&(b=!1);var c=a.x,d=a.y,e=a.z,f=1;b&&(f=1/(c*this.m3+d*this.m7+e*this.m11+this.m15));return a.set((c*this.m0+d*this.m4+e*this.m8+this.m12)*f,(c*this.m1+d*this.m5+e*this.m9+this.m13)*f,(c*this.m2+d*this.m6+e*this.m10+this.m14)*f)},fillFloat32Array:function(a,b){null==b&&(b=0);a[b++]=this.m0;a[b++]=this.m1;a[b++]=this.m2;a[b++]=this.m3;a[b++]=this.m4;a[b++]=this.m5;
a[b++]=this.m6;a[b++]=this.m7;a[b++]=this.m8;a[b++]=this.m9;a[b++]=this.m10;a[b++]=this.m11;a[b++]=this.m12;a[b++]=this.m13;a[b++]=this.m14;a[b++]=this.m15},toString:function(){return"Matrix44\n["+this.m0+" | "+this.m4+" | "+this.m8+" | "+this.m12+"]\n["+this.m1+" | "+this.m5+" | "+this.m9+" | "+this.m13+"]\n["+this.m2+" | "+this.m6+" | "+this.m10+" | "+this.m14+"]\n["+this.m3+" | "+this.m7+" | "+this.m11+" | "+this.m15+"]\n"},fillArray:function(a,b){null==b&&(b=0);a[b++]=this.m0;a[b++]=this.m1;a[b++]=
this.m2;a[b++]=this.m3;a[b++]=this.m4;a[b++]=this.m5;a[b++]=this.m6;a[b++]=this.m7;a[b++]=this.m8;a[b++]=this.m9;a[b++]=this.m10;a[b++]=this.m11;a[b++]=this.m12;a[b++]=this.m13;a[b++]=this.m14;a[b++]=this.m15},fromArray:function(a,b){null==b&&(b=0);if(a.length<b+16)return this;this.m0=a[b++];this.m1=a[b++];this.m2=a[b++];this.m3=a[b++];this.m4=a[b++];this.m5=a[b++];this.m6=a[b++];this.m7=a[b++];this.m8=a[b++];this.m9=a[b++];this.m10=a[b++];this.m11=a[b++];this.m12=a[b++];this.m13=a[b++];this.m14=
a[b++];this.m15=a[b++];return this},getDeterminant:function(){return this.m3*this.m6*this.m9*this.m12-this.m2*this.m7*this.m9*this.m12-this.m3*this.m5*this.m10*this.m12+this.m1*this.m7*this.m10*this.m12+this.m2*this.m5*this.m11*this.m12-this.m1*this.m6*this.m11*this.m12-this.m3*this.m6*this.m8*this.m13+this.m2*this.m7*this.m8*this.m13+this.m3*this.m4*this.m10*this.m13-this.m0*this.m7*this.m10*this.m13-this.m2*this.m4*this.m11*this.m13+this.m0*this.m6*this.m11*this.m13+this.m3*this.m5*this.m8*this.m14-
this.m1*this.m7*this.m8*this.m14-this.m3*this.m4*this.m9*this.m14+this.m0*this.m7*this.m9*this.m14+this.m1*this.m4*this.m11*this.m14-this.m0*this.m5*this.m11*this.m14-this.m2*this.m5*this.m8*this.m15+this.m1*this.m6*this.m8*this.m15+this.m2*this.m4*this.m9*this.m15-this.m0*this.m6*this.m9*this.m15-this.m1*this.m4*this.m10*this.m15+this.m0*this.m5*this.m10*this.m15},dirty:function(){this._dirty=!0},get_data:function(){null==this._data&&(this._data=new Ld(16));if(this._dirty){var a=0;this._data[a++]=
this.m0;this._data[a++]=this.m1;this._data[a++]=this.m2;this._data[a++]=this.m3;this._data[a++]=this.m4;this._data[a++]=this.m5;this._data[a++]=this.m6;this._data[a++]=this.m7;this._data[a++]=this.m8;this._data[a++]=this.m9;this._data[a++]=this.m10;this._data[a++]=this.m11;this._data[a++]=this.m12;this._data[a++]=this.m13;this._data[a++]=this.m14;this._data[a++]=this.m15}return this._data},__class__:T,__properties__:{get_data:"get_data"}};var ya=function(){this._type=-1;this.enabled=!1;this._dirty=
!0};f["lovedna.game.graphics.ProgramUniformData"]=ya;ya.__name__=["lovedna","game","graphics","ProgramUniformData"];ya.prototype={getInt:function(){return this._intValue},setInt:function(a){if(this._intValue==a)return this;this._intValue=a;this.setType(1);return this},getFloat:function(){return this._floatValue},setFloat:function(a){if(this._floatValue==a)return this;this._floatValue=a;this.setType(2);return this},setFloatArray:function(a){if(null==a)throw new M(this.name+" value error ");if(this._floatArrayValue==
a)return this;this._floatArrayValue=a;this.setType(3);return this},getFloat2:function(){return this._float2Value},setFloat2:function(a){if(null==a)throw new M(this.name+" value error ");if(this._float2Value==a)return this;this._float2Value=a;this.setType(4);return this},getFloat3:function(){return this._float3Value},setFloat3:function(a){if(null==a)throw new M(this.name+" value error ");if(this._float3Value==a)return this;this._float3Value=a;this.setType(5);return this},getFloat4:function(){return this._float4Value},
setFloat4:function(a){if(null==a)throw new M(this.name+" value error ");if(this._float4Value==a)return this;this._float4Value=a;this.setType(6);return this},setFloat4Array:function(a){if(null==a)throw new M(this.name+" value error ");this._dirty=!0;if(this._float4ArrayValue==a)return this;this._float4ArrayValue=a;this.setType(11);return this},getMatrix:function(){return this._matrix4Value},setMatrix:function(a){if(null==a)throw new M(this.name+" value error ");this._dirty=!0;if(this._matrix4Value==
a)return this;this._matrix4Value=a;this.setType(7);return this},setMatrixHandler:function(a){if(null==a)throw new M(this.name+" value error ");this._matrix4HandlerValue=a;this.setType(10);return this},setMatrixArray:function(a){if(null==a)throw new M(this.name+" value error ");this._dirty=!0;if(this._matrix4ArrayValue==a)return this;this._matrix4ArrayValue=a;this.setType(8);return this},setTexture:function(a){if(this._texture==a)return this;this._texture=a;if(null==this._texture)throw new M(this.name+
" value error ");this.setType(9);return this},bind:function(a){if(null==a)return aa.trace(this.name+" input null",{fileName:"ProgramUniformData.hx",lineNumber:186,className:"lovedna.game.graphics.ProgramUniformData",methodName:"bind"}),!0;if(0>this._type)return aa.trace(this.name+" type is error",{fileName:"ProgramUniformData.hx",lineNumber:191,className:"lovedna.game.graphics.ProgramUniformData",methodName:"bind"}),!0;a!=this._input&&(this._input=a,null!=this._input?(this._size=this._input.size,
this.enabled=!0):this._size=-1);if(0>this._size)return aa.trace(this.name+" size is "+this._size,{fileName:"ProgramUniformData.hx",lineNumber:209,className:"lovedna.game.graphics.ProgramUniformData",methodName:"bind"}),!0;(null==this._handler||this._typeDirty)&&this.bindType();if(null==this._handler)return aa.trace(this.name+" handler is null ",{fileName:"ProgramUniformData.hx",lineNumber:218,className:"lovedna.game.graphics.ProgramUniformData",methodName:"bind"}),this._type=-1,!0;a=this._handler();
this._typeDirty=!1;this._input=null;return a},setType:function(a){this._type=a;this._dirty=this._typeDirty=this.enabled=!0},bindType:function(){switch(this._type){case 1:this._handler=n(this,this.bindInt);break;case 2:this._handler=n(this,this.bindFloat);break;case 3:this._handler=n(this,this.bindFloatArray);break;case 4:this._handler=n(this,this.bindFloat2);break;case 5:this._handler=n(this,this.bindFloat3);break;case 6:this._handler=n(this,this.bindFloat4);break;case 7:this._handler=n(this,this.bindMatrix4);
break;case 8:this._handler=n(this,this.bindMatrix4Array);break;case 9:this._handler=n(this,this.bindTexture);break;case 10:this._handler=n(this,this.bindMatrix4Handler);break;case 11:this._handler=n(this,this.bindFloat4Array)}},bindInt:function(){r.gl.uniform1i(this._input.location,this._intValue);return!0},bindFloat:function(){r.gl.uniform1f(this._input.location,this._floatValue);return!0},bindFloat2:function(){r.gl.uniform2f(this._input.location,this._float2Value.x,this._float2Value.y);return!0},
bindFloat3:function(){r.gl.uniform3f(this._input.location,this._float3Value.x,this._float3Value.y,this._float3Value.z);return!0},bindFloat4:function(){r.gl.uniform4f(this._input.location,this._float4Value.x,this._float4Value.y,this._float4Value.z,this._float4Value.w);return!0},bindFloatArray:function(){var a=this._floatArrayValue.length;if(null==this._float32Array||a>this._float32Array.length)this._float32Array=new Ld(a);if(this._dirty)for(this._dirty=!1;0<a--;)this._float32Array[a]=this._floatArrayValue[a];
r.gl.uniform1fv(this._input.location,this._size,this._float32Array);return!0},bindFloat4Array:function(){var a=this._float4ArrayValue.length;if(null==this._float32Array||4*a>this._float32Array.length)this._float32Array=new Ld(4*a);if(this._dirty)for(this._dirty=!1;0<a--;){var b=4*a,c=this._float4ArrayValue[a];if(null==c)return aa.trace("warn",{fileName:"ProgramUniformData.hx",lineNumber:331,className:"lovedna.game.graphics.ProgramUniformData",methodName:"bindFloat4Array",customParams:["list "+a+" is null"]}),
!1;this._float32Array[b]=c.x;this._float32Array[b+1]=c.y;this._float32Array[b+2]=c.z;this._float32Array[b+3]=c.w}r.gl.uniform4fv(this._input.location,this._size,this._float32Array);return!0},bindMatrix4:function(){r.gl.uniformMatrix4fv(this._input.location,this._size,!1,this._matrix4Value.get_data());return!0},bindMatrix4Handler:function(){var a=this._matrix4HandlerValue();r.gl.uniformMatrix4fv(this._input.location,this._size,!1,a.get_data());return!0},bindMatrix4Array:function(){var a=this._matrix4ArrayValue.length;
if(null==this._float32Array||16*a>this._float32Array.length)this._float32Array=new Ld(16*a);if(this._dirty)for(this._dirty=!1;0<a--;){var b=this._matrix4ArrayValue[a];null==b&&(b=ya.defaultMat44);b.fillFloat32Array(this._float32Array,16*a)}r.gl.uniformMatrix4fv(this._input.location,this._matrix4ArrayValue.length,!1,this._float32Array);return!0},bindTexture:function(){if(!this._texture.bind(this._input.id))return!1;r.gl.uniform1i(this._input.location,this._input.id);return!0},__class__:ya};var $c=
function(a,b,c,d){this.id=a;this.location=b;this._info=c;this.name=c.name;this.type=c.type;this.size=c.size;this._program=d;this.set_success(!1)};f["lovedna.game.graphics.ProgramUniformInput"]=$c;$c.__name__=["lovedna","game","graphics","ProgramUniformInput"];$c.prototype={toString:function(){return this.name+" "+this.type+" "+this.size},set_success:function(a){if(!a)return a;this._program.uploadUniform(this);return a},__class__:$c,__properties__:{set_success:"set_success"}};var Qa=function(){this.enabled=
!1;this.id=Qa._id++;this.params=new Md};f["lovedna.game.graphics.Texture"]=Qa;Qa.__name__=["lovedna","game","graphics","Texture"];Qa.__interfaces__=[Pb];Qa.prototype={unload:function(){this.enabled=!1;this.data=null},setData:function(a){this.data=a;this.enabled=!0;this._time=K.get_now()},bind:function(a){this._time=K.get_now();return!1},toString:function(){return"Texture "+this.id+"("+this.width+","+this.height+")"},__class__:Qa};var Db=function(){Qa.call(this)};f["lovedna.game.graphics.Texture2D"]=
Db;Db.__name__=["lovedna","game","graphics","Texture2D"];Db.__super__=Qa;Db.prototype=p(Qa.prototype,{setData:function(a){Qa.prototype.setData.call(this,a);null!=this.data&&(u.is(this.data,Eb)&&(a=this.data,this.width=a.width,this.height=a.height),u.is(this.data,HTMLImageElement)?(a=this.data,this.width=a.width,this.height=a.height):u.is(this.data,HTMLCanvasElement)?(a=this.data,this.width=a.width,this.height=a.height):u.is(this.data,HTMLVideoElement)&&(a=this.data,this.width=a.width,this.height=
a.height))},unload:function(){Qa.prototype.unload.call(this);null!=this._texture&&(r.gl.deleteTexture(this._texture),this._texture=null)},bind:function(a){null==a&&(a=0);Qa.prototype.bind.call(this,a);return this.enabled&&0!=this.width&&0!=this.height?null!=this.data?(this.upload(),this.data=null,!1):null!=this._texture?(r.gl.activeTexture(33984+a),r.gl.bindTexture(3553,this._texture),this.params.bind(),!0):!1:!1},upload:function(){null==this._texture&&(this._texture=r.gl.createTexture());r.gl.activeTexture(33984);
r.gl.bindTexture(3553,this._texture);if(null!=this.data){var a=!1;u.is(this.data,Eb)&&(this.data=this.data.data);if(u.is(this.data,HTMLImageElement)){var b=this.data;this.width=b.width;this.height=b.height;0!=this.width&&0!=this.height&&(r.gl.gl.texImage2D(3553,0,6408,6408,5121,b),a=!0)}else u.is(this.data,HTMLCanvasElement)?(b=this.data,this.width=b.width,this.height=b.height,0!=this.width&&0!=this.height&&(r.gl.gl.texImage2D(3553,0,6408,6408,5121,b),a=!0)):u.is(this.data,HTMLVideoElement)&&(b=this.data,
this.width=b.width,this.height=b.height,0!=this.width&&0!=this.height&&(r.gl.gl.texImage2D(3553,0,6408,6408,5121,b),a=!0));a&&this.updateParams()}return!1},updateParams:function(){var a=!1;0!=this.width&&0!=this.height&&(g.isPow2(this.width)&&g.isPow2(this.height)?a=!0:(this.params.wrapS=33071,this.params.wrapT=33071,this.params.dirty=!0));a&&this.params.mipmap&&(r.gl.generateMipmap(3553),this.params.filterMin=9984)},__class__:Db});var Cc=function(a,b,c){null==c&&(c=16);null==b&&(b=0);null==a&&(a=
256);this._depth=16;Qa.call(this);this.width=a;this.height=b;0>=this.height&&(this.height=this.width);this.enabled=!0;this._depth=c};f["lovedna.game.graphics.RenderTexture2D"]=Cc;Cc.__name__=["lovedna","game","graphics","RenderTexture2D"];Cc.__super__=Db;Cc.prototype=p(Db.prototype,{resize:function(a,b){this.width==a&&this.height==b||this.unload();this.width=a;this.height=b},bindBuffer:function(){if(null==this._frameBuffer){this._frameBuffer=r.gl.createFramebuffer();r.gl.bindFramebuffer(36160,this._frameBuffer);
this._renderBuffer=r.gl.createRenderbuffer();r.gl.bindRenderbuffer(36161,this._renderBuffer);24==this._depth?(r.gl.renderbufferStorage(36161,34041,this.width,this.height),r.gl.framebufferRenderbuffer(36160,33306,36161,this._renderBuffer)):16==this._depth&&(r.gl.renderbufferStorage(36161,33189,this.width,this.height),r.gl.framebufferRenderbuffer(36160,36096,36161,this._renderBuffer));this.params.mipmap=!1;this.upload();r.gl.framebufferTexture2D(36160,36064,3553,this._texture,0);r.gl.texImage2D(3553,
0,6408,this.width,this.height,0,6408,5121,null);r.gl.bindRenderbuffer(36161,null);this.updateParams();r.gl.clearDepthf(1);r.gl.clearStencil(0);r.gl.clearColor(1,1,1,0);var a=16384;0<this._depth&&(a|=256);16<this._depth&&(a|=1024);r.gl.clear(a)}r.gl.bindFramebuffer(36160,this._frameBuffer);r.gl.bindRenderbuffer(36161,this._renderBuffer)},bind:function(a){null==a&&(a=0);return Db.prototype.bind.call(this,a)},unload:function(){null!=this._frameBuffer&&(r.gl.deleteFramebuffer(this._frameBuffer),this._frameBuffer=
null);null!=this._renderBuffer&&(r.gl.deleteRenderbuffer(this._renderBuffer),this._renderBuffer=null)},toString:function(){return"RenderTexture2D "+this.id+"("+this.width+","+this.height+")"},__class__:Cc});var Md=function(){this.filterMin=this.filterMag=9729;this.wrapT=this.wrapS=10497;this.dirty=this.mipmap=!0};f["lovedna.game.graphics.TextureParams"]=Md;Md.__name__=["lovedna","game","graphics","TextureParams"];Md.prototype={bind:function(){this.dirty&&(this.dirty=!1,r.gl.texParameteri(3553,10242,
this.wrapS),r.gl.texParameteri(3553,10243,this.wrapT),r.gl.texParameteri(3553,10240,this.filterMag),r.gl.texParameteri(3553,10241,this.filterMin))},__class__:Md};var U=function(){this.id=U._id++;this._programId=-1;this._time=0};f["lovedna.game.graphics.VertexBuffer"]=U;U.__name__=["lovedna","game","graphics","VertexBuffer"];U.__interfaces__=[Pb];U.prototype={setProgramId:function(a){this._programId=this.id},getLayout:function(a){return this._layoutMap.get(a)},setLayout:function(a){if(null==this.layouts)this.layouts=
[],this._layoutMap=new I;else{for(var b=this.layouts.length;0<b--;)this._layoutMap.remove(this.layouts[b].name);this.layouts.splice(0,this.layouts.length)}b=this.stride=0;for(var c=a.length;b<c;){var d=b++,e=a[d];null==e&&aa.trace("error",{fileName:"VertexBuffer.hx",lineNumber:73,className:"lovedna.game.graphics.VertexBuffer",methodName:"setLayout",customParams:["layout is null "+d]});e.offset=this.stride;this.stride+=e.size*e.getDataSize();this.layouts.push(e);this._layoutMap.set(e.name,e)}this.enabled=
0<this.stride},upload:function(a){this._data=a;this.length=this._data.length},bind:function(a){null==a&&(a=0);this._time=K.get_now();if(!this.enabled)return!1;var b=this.layouts.length;if(1>b)return!1;null!=this._data&&(null==this._buffer&&(this._buffer=r.gl.createBuffer()),r.gl.bindBuffer(34962,this._buffer),r.gl.bufferData(34962,4*this._data.length,this.getData(),35044),this._data=null);for(var c=!1;0<b--;){var d=this.layouts[b],e=d.location;if(!(0>e)){e=U.locationCache.get(10*this.id+e);if(null==
e){c=!0;break}U._fnv.reset();U._fnv.addInt(a);U._fnv.addInt(d.location);U._fnv.addInt(this.id);d=U._fnv.getCode();if(e!=d){c=!0;break}}}if(!c)return!0;r.gl.bindBuffer(34962,this._buffer);c=0;for(b=U.locationCache.keys();b.hasNext();)d=b.next(),U.locationCache.remove(d);for(b=this.layouts.length;0<b--;)if(d=this.layouts[b],e=d.location,!(0>e)){U._fnv.reset();U._fnv.addInt(a);U._fnv.addInt(e);U._fnv.addInt(this.id);var f=U._fnv.getCode();U.locationCache.set(10*this.id+e,f);r.gl.enableVertexAttribArray(d.location);
r.gl.vertexAttribPointer(d.location,d.size,d.type,!1,this.stride,d.offset);++c}return 1>c?!1:!0},unload:function(){null!=this._buffer&&(r.gl.deleteBuffer(this._buffer),this._buffer=null);this._data=null},getData:function(){var a=this._data.length,b=g.intToNextPow2(a),c=g.pow2Count(b),d=U._tempList[c];null==d&&(d=new Ld(b),U._tempList[c]=d);for(;0<a--;)d[a]=this._data[a];return d},__class__:U};var Cb=function(a,b,c){null==c&&(c=5126);this.type=c;this.name=a;this.size=b;this.offset=0;this.location=
-1};f["lovedna.game.graphics.VertexLayout"]=Cb;Cb.__name__=["lovedna","game","graphics","VertexLayout"];Cb.prototype={getDataSize:function(){return 4},__class__:Cb};var jd=function(a){this.game=a;Ja.onEvent.addEventListener(lb.onUpdate.get_type(),n(this,this.onKey))};f["lovedna.game.helper.DebugGame"]=jd;jd.__name__=["lovedna","game","helper","DebugGame"];jd.prototype={debugFrame:function(){this.game.pause=!0},debugRender:function(){this.game.commands.debug=!0},onKey:function(a){a=lb.onUpdate.key;
1==a.type&&(39==a.keyCode?(this.game.pause&&(this.game.playStep=!0),this.game.commands.debug&&this.game.commands.position++):37==a.keyCode?(this.game.pause&&(this.game.playStep=!0),this.game.commands.debug&&this.game.commands.position--):40==a.keyCode?a.modifier.getElement(2)&&(this.game.pause=!this.game.pause):38==a.keyCode&&a.modifier.getElement(2)&&(this.game.commands.debug=!this.game.commands.debug))},__class__:jd};var Dd=function(a){this._camera=a;this._context=new Yb;this._timeData=new E;this._sinTimeData=
new E;this._cosTimeData=new E;this._deltaTimeData=new E;this._uniforms=new bb;this._uniforms.setFloat4(m.TIME.name,this._timeData);this._uniforms.setFloat4(m.TIME_SIN.name,this._sinTimeData);this._uniforms.setFloat4(m.TIME_COS.name,this._cosTimeData);this._uniforms.setFloat4(m.TIME_DELTA.name,this._deltaTimeData);this._camera.uniforms.add(this._uniforms);this._temp=new G;this._bufferStart=new L;this._bufferEnd=new L;this._sort=new ad};f["lovedna.game.render.CameraRenderData"]=Dd;Dd.__name__=["lovedna",
"game","render","CameraRenderData"];Dd.prototype={render:function(a){gb.current=this._camera;if(this._camera.render){this._gameBuffer=this._camera.actor.world.game.commands;var b=this._sort;null!=this._camera.customRenderBufferCollector&&(b=this._camera.customRenderBufferCollector);for(var c=a.count;0<c--;){var d=a.get(c);if(d.visible){var e=d.actor;this._camera.cullingMask.exist(e.layer)?d.cullWithCamera(this._camera)?e._setVisible(!1):(e._setVisible(!0),d.collectRenderBuffer(b)):e._setVisible(!1)}}this._bufferStart.clear();
this._bufferStart.setContext(this._context);this._bufferStart.setCallback(n(this,this.onPreRender));this._gameBuffer.push(this._bufferStart);b.copyTo(this._gameBuffer);this._bufferEnd.clear();this._bufferEnd.setCallback(n(this,this.onPostRender));this._gameBuffer.push(this._bufferEnd)}},onPreRender:function(a){a.clearGlobal();var b=la.get_now();this._timeData.set(b/20,b,2*b,3*b);this._sinTimeData.set(Math.sin(b/8),Math.sin(b/4),Math.sin(b/2),Math.sin(b));this._cosTimeData.set(Math.cos(b/8),Math.cos(b/
4),Math.cos(b/2),Math.cos(b));b=this._camera.actor.world.deltaTime;this._deltaTimeData.set(b,1/b,b,1/b);b=this._camera.clearFlags.type;if(0<this._camera.actor.world.collectorLight.count){var c=this._camera.actor.world.collectorLight.get(0);a.globalUniforms.add(c.uniforms);a.globalDefine.define(m.LIGHT.name,"",!0)}a.globalUniforms.add(this._camera.uniforms);null!=this._camera.renderTarget&&h.pushTarget(this._camera.renderTarget);0!=b&&(1==b?h.clear(this._camera.clearFlags.color,-1,-1):2==b?h.clear(null,
1,-1):3==b&&h.clear(this._camera.clearFlags.color,1,0))},onPostRender:function(a){null!=this._camera.renderTarget&&h.popTarget();this._camera.actor.dispatchEvent(v.onPostRender)},__class__:Dd};var Nd=function(){};f["lovedna.game.render.IRenderBufferCollect"]=Nd;Nd.__name__=["lovedna","game","render","IRenderBufferCollect"];Nd.prototype={__class__:Nd};var ad=function(){this.list=new G};f["lovedna.game.render._CameraRenderData.SortCommandBuffer"]=ad;ad.__name__=["lovedna","game","render","_CameraRenderData",
"SortCommandBuffer"];ad.__interfaces__=[Nd];ad.prototype={add:function(a){this.list.push(a);var b=La.getRenderQueue(a.renderQueue),c=null;2E4==b?(null==this._geometry&&(this._geometry=new tb(2E4)),c=this._geometry):4E4==b?(null==this._ui&&(this._ui=new tb(4E4)),c=this._ui):3E4==b?(null==this._transparent&&(this._transparent=new tb(3E4)),c=this._transparent):1E4==b?(null==this._background&&(this._background=new tb(1E4)),c=this._background):5E4==b&&(null==this._overlay&&(this._overlay=new tb(5E4)),
c=this._overlay);null!=c&&c.add(a)},clear:function(){this.list.clear()},copyTo:function(a){null!=this._background&&this._background.fill(a);null!=this._geometry&&this._geometry.fill(a);null!=this._transparent&&this._transparent.fill(a);null!=this._ui&&this._ui.fill(a);null!=this._overlay&&this._overlay.fill(a)},__class__:ad};var ub=function(a){this.type=a};f["lovedna.game.render._CameraRenderData.SortProcess"]=ub;ub.__name__=["lovedna","game","render","_CameraRenderData","SortProcess"];ub.prototype=
{add:function(a){},fill:function(a){},sort:function(a,b){a=a.sortId;b=b.sortId;return a!=b?a-b:0},__class__:ub};var tb=function(a){this.type=a;this._map=new Q;this._list=[]};f["lovedna.game.render._CameraRenderData.SortQueue"]=tb;tb.__name__=["lovedna","game","render","_CameraRenderData","SortQueue"];tb.__super__=ub;tb.prototype=p(ub.prototype,{add:function(a){var b=a.renderQueue;if(this._map.exists(b)){b=this._map.get(b);var c=this._list[b]}else c=new bd(this.type),c.sortId=b,this._map.set(b,this._list.length),
this._list.push(c);c.add(a)},fill:function(a){this._list.sort(n(this,this.sort));for(var b=0,c=this._list.length;b<c;){var d=b++;this._list[d].fill(a)}for(a=this._map.keys();a.hasNext();)b=a.next(),this._map.remove(b);this._list.splice(0,this._list.length)},__class__:tb});var bd=function(a){this.type=a;this._map=new Q;this._list=[]};f["lovedna.game.render._CameraRenderData.SortShader"]=bd;bd.__name__=["lovedna","game","render","_CameraRenderData","SortShader"];bd.__super__=ub;bd.prototype=p(ub.prototype,
{add:function(a){var b=a.shaderId;if(this._map.exists(b)){b=this._map.get(b);var c=this._list[b]}else c=new cd(this.type),c.sortId=b,this._map.set(b,this._list.length),this._list.push(c);c.add(a)},fill:function(a){this._list.sort(n(this,this.sort));for(var b=0,c=this._list.length;b<c;){var d=b++;this._list[d].fill(a)}for(a=this._map.keys();a.hasNext();)b=a.next(),this._map.remove(b);this._list.splice(0,this._list.length)},__class__:bd});var cd=function(a){this.type=a;this._list=[]};f["lovedna.game.render._CameraRenderData.SortDistance"]=
cd;cd.__name__=["lovedna","game","render","_CameraRenderData","SortDistance"];cd.__super__=ub;cd.prototype=p(ub.prototype,{add:function(a){this._list.push(a)},fill:function(a){this._list.sort(n(this,this.sorta));for(var b=0,c=this._list.length;b<c;){var d=b++;a.push(this._list[d])}this._list.splice(0,this._list.length)},sorta:function(a,b){var c=a.renderIndex,d=b.renderIndex;if(c!=d)return c-d;a=a.distance;b=b.distance;return a!=b?3E4>=this.type?0<a-b?1:-1:0<a-b?-1:1:0},__class__:cd});var Od=function(){};
f["lovedna.game.render.IRenderBufferCommands"]=Od;Od.__name__=["lovedna","game","render","IRenderBufferCommands"];Od.prototype={__class__:Od};var Bc=function(){this.position=-1;this._list=new G;this.debug=!1};f["lovedna.game.render.GameRenderCommandBuffer"]=Bc;Bc.__name__=["lovedna","game","render","GameRenderCommandBuffer"];Bc.__interfaces__=[Od];Bc.prototype={push:function(a){this._list.push(a)},clear:function(){this._list.clear();L.$length=0},flush:function(){var a=this._list.get_length();0>this.position&&
(this.position=0);this.position>a&&(this.position=a);for(var b=0;b<a;){var c=b++;if(this.debug&&c>this.position)break;this._list.getElement(c).execute()}},__class__:Bc};var Yb=function(){this.globalUniforms=new bb;this.globalDefine=new Xa;this.currentUniforms=new bb;this.currentVertexBuffers=new G};f["lovedna.game.render.RenderBufferContex"]=Yb;Yb.__name__=["lovedna","game","render","RenderBufferContex"];Yb.prototype={clearGlobal:function(){this.globalUniforms.clear();this.globalDefine.clear()},clearCurrent:function(){this.currentVertexBuffers.clear();
this.currentUniforms.clear();this.currentMeshBuffer=this.currentIndexBuffer=this.currentMaterial=null},__class__:Yb};var dd=function(){};f["lovedna.geom.Shape3D"]=dd;dd.__name__=["lovedna","geom","Shape3D"];dd.prototype={__class__:dd};var Yc=function(){this.min=new k;this.max=new k;this._centerHelp=new k;this._dirty=null;this.points=[];for(var a=0;8>a;)a++,this.points.push(new k)};f["lovedna.geom.Box3"]=Yc;Yc.__name__=["lovedna","geom","Box3"];Yc.__interfaces__=[dd];Yc.prototype={toString:function(){return"Box33["+
u.string(this.min)+" "+u.string(this.max)+"]"},update:function(){this._dirty=null;this.enabled=!0},reset:function(){this.min.set(1.79769313486231E308,1.79769313486231E308,1.79769313486231E308);this.max.set(-1.79769313486231E308,-1.79769313486231E308,-1.79769313486231E308);this.enabled=!1;return this},copy:function(a){this.max.copy(a.max);this.min.copy(a.min);this.update();return this},set:function(a,b){a.copy(a);b.copy(b);this.update();return this},expand:function(a){this.min.min(a);this.max.max(a);
this.update();return this},addWith:function(a){return this.expand(a.min).expand(a.max)},multiplyMatrix44:function(a){var b=k.get_one(),c=k.get_one();b.copy(this.min);c.copy(this.max);this.reset();this.expand(a.transformVector(this.points[0].copy(b)));this.expand(a.transformVector(this.points[1].set(b.x,b.y,c.z)));this.expand(a.transformVector(this.points[2].set(c.x,b.y,c.z)));this.expand(a.transformVector(this.points[3].set(c.x,b.y,b.z)));this.expand(a.transformVector(this.points[4].set(b.x,c.y,b.z)));
this.expand(a.transformVector(this.points[5].set(b.x,c.y,c.z)));this.expand(a.transformVector(this.points[6].copy(c)));this.expand(a.transformVector(this.points[7].set(c.x,c.y,b.z)));return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z?a.max.z<=this.max.z:!1},intersectsBox:function(a){var b=
a.min;a=a.max;return this.min.x>a.x||this.max.x<b.x||this.min.y>a.y||this.max.y<b.y||this.min.z>a.z||this.max.z<b.z?!1:!0},intersectsPlane:function(a){var b=0;if(0<a.normal.x)var c=a.normal.x*this.max.x;else c=a.normal.x*this.max.x,b=a.normal.x*this.min.x;0<a.normal.y?(c+=a.normal.y*this.min.y,b+=a.normal.y*this.max.y):(c+=a.normal.y*this.max.y,b+=a.normal.y*this.min.y);0<a.normal.z?(c+=a.normal.z*this.min.z,b+=a.normal.z*this.max.z):(c+=a.normal.z*this.max.z,b+=a.normal.z*this.min.z);return c<=a.distance?
b>=a.distance:!1},distanceToPoint:function(a){return this.clampPoint(a).sub(a).get_length()},clampPoint:function(a){return k.get_one().copy(a).clamp(this.min,this.max)},getSize:function(){return k.get_one().copy(this.max).sub(this.min)},getFarthestPointInDirection:function(a){for(var b=this.points.length,c=this.points[0],d=a.dot(c),e,f=1;f<b;){e=f++;var g=this.points[e];e=a.dot(g);e>d&&(d=e,c=g)}return k.get_one().copy(c)},getCenter:function(){null==this._dirty&&(this._dirty=this._centerHelp,this._dirty.copy(this.min).add(this.max).scale(.5));
return this._dirty},__class__:Yc};var Pd=function(){};f["lovedna.geom.Shape2D"]=Pd;Pd.__name__=["lovedna","geom","Shape2D"];Pd.prototype={__class__:Pd};var ic=function(a,b){this._center=new t;this._center.copy(a);this.enabled=!0;this.radius=b};f["lovedna.geom.Circle"]=ic;ic.__name__=["lovedna","geom","Circle"];ic.__interfaces__=[Pd];ic.prototype={getCenter:function(){return this._center},getFarthestPointInDirection:function(a){return t.get_temp().copy(a).normalize().scale(this.radius).add(this._center)},
set:function(a,b){this._center.copy(a);this.radius=b;return this},copy:function(a){if(a==this)return this;this._center.copy(a._center);this.radius=a.radius;return this},containsPoint:function(a){return a.distanceSquared(this._center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distance(this._center)-this.radius},intersectsCircle:function(a){var b=this.radius+a.radius;return a._center.distanceSquared(this._center)<=b*b},Equals:function(a){return this._center.equals(a._center)?this.radius==
a.radius:!1},__class__:ic};var Cd=function(){this.planes=[];this.near=new vb;this.far=new vb;this.left=new vb;this.right=new vb;this.top=new vb;this.bottom=new vb;this.planes.push(this.near);this.planes.push(this.far);this.planes.push(this.left);this.planes.push(this.right);this.planes.push(this.top);this.planes.push(this.bottom)};f["lovedna.geom.Frustum"]=Cd;Cd.__name__=["lovedna","geom","Frustum"];Cd.prototype={toString:function(){var a="near "+this.planes[0].toString()+"\n";a+="far "+this.planes[1].toString()+
"\n";a+="left "+this.planes[2].toString()+"\n";a+="right "+this.planes[3].toString()+"\n";a+="top "+this.planes[4].toString()+"\n";return a+="bottom "+this.planes[5].toString()+"\n"},copy:function(a){if(a==this)return this;for(var b=6;0<b--;)this.planes[b].copy(a.planes[b]);return this},set:function(a,b,c,d,e,f){this.planes[0].copy(a);this.planes[1].copy(b);this.planes[2].copy(c);this.planes[3].copy(d);this.planes[4].copy(e);this.planes[5].copy(f);return this},containsPoint:function(a,b){null==b&&
(b=0);for(var c=6;0<c--;)if(this.planes[c].distanceToPoint(a)<-b)return!1;return!0},intersectsSphere:function(a){return null==a?!1:this.containsPoint(a.getCenter(),a.radius)},intersectsBox:function(a){if(null==a)return!1;for(var b=k.get_one(),c=k.get_one(),d=6;0<d--;){var e=this.planes[d],f=e.normal.x,g=e.normal.y,h=e.normal.z;b.set(0<f?a.min.x:a.max.x,0<g?a.min.y:a.max.y,0<h?a.min.z:a.max.z);c.set(0<f?a.max.x:a.min.x,0<g?a.max.y:a.min.y,0<h?a.max.z:a.min.z);if(0>e.distanceToPoint(b)&&0>e.distanceToPoint(c))return!1}return!0},
multiplyMatrix44:function(a){if(null==a)return this;var b=a.m0,c=a.m1,d=a.m2,e=a.m3,f=a.m4,g=a.m5,h=a.m6,k=a.m7,m=a.m8,n=a.m9,p=a.m10,q=a.m11,r=a.m12,t=a.m13,u=a.m14;a=a.m15;this.planes[0].set(e+d,k+h,q+p,a+u);this.planes[1].set(e-d,k-h,q-p,a-u);this.planes[2].set(e+b,k+f,q+m,a+r);this.planes[3].set(e-b,k-f,q-m,a-r);this.planes[4].set(e-c,k-g,q-n,a-t);this.planes[5].set(e+c,k+g,q+n,a+t);return this},__class__:Cd};var vb=function(){this.normal=new k(0,0,1);this.distance=0};f["lovedna.geom.Plane"]=
vb;vb.__name__=["lovedna","geom","Plane"];vb.prototype={toString:function(){return"Plane("+u.string(this.normal)+" "+this.distance+")"},copy:function(a){this.normal.copy(a.normal);this.distance=a.distance;return this},setFromNormalAndDistance:function(a,b){this.normal.copy(a);this.distance=b;return this},setFromNormalAndPoint:function(a,b){this.normal.copy(a);this.distance=-this.normal.dot(b);return this},SetFromPoints:function(a,b,c){var d=k.get_zero();d.copy(a);d.sub(b);this.normal.copy(a);this.normal.sub(c);
this.normal.cross(d);this.normal.normalize();this.distance=-a.dot(this.normal);return this},distanceToPoint:function(a){return this.normal.dot(a)+this.distance},nearPoint:function(a){var b=this.distanceToPoint(a),c=k.get_one();c.copy(this.normal);c.scale(b);return k.get_one().copy(a).sub(c)},set:function(a,b,c,d){this.normal.set(a,b,c);this.distance=d;this.normalize()},normalize:function(){var a=1/this.normal.get_length();this.normal.scale(a);this.distance*=a},__class__:vb};var k=function(a,b,c){null==
c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c};f["lovedna.math.Vector3"]=k;k.__name__=["lovedna","math","Vector3"];k.__interfaces__=[jb,yb];k.__properties__={get_one:"get_one",get_zero:"get_zero",get_left:"get_left",get_right:"get_right",get_down:"get_down",get_up:"get_up",get_backward:"get_backward",get_forward:"get_forward",get_temp:"get_temp"};k.get_temp=function(){return k._pool.get()};k.get_forward=function(){return k.get_temp().set(0,0,1)};k.get_backward=function(){return k.get_temp().set(0,
0,-1)};k.get_up=function(){return k.get_temp().set(0,1,0)};k.get_down=function(){return k.get_temp().set(0,-1,0)};k.get_right=function(){return k.get_temp().set(1,0,0)};k.get_left=function(){return k.get_temp().set(-1,0,0)};k.get_zero=function(){return k.get_temp().set(0,0,0)};k.get_one=function(){return k.get_temp().set(1,1,1)};k.prototype={toString:function(){return this.fixed(4)},fixed:function(a){null==a&&(a=4);return"Vector3("+g.fixed(this.x,a)+","+g.fixed(this.y,a)+","+g.fixed(this.z,a)+")"},
set:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;return this},copy:function(a){return null==a||a==this?this:this.set(a.x,a.y,a.z)},from:function(a){return this.set(a.x,a.y,a.z)},clone:function(){return new k(this.x,this.y,this.z)},add:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(d.x+a.x,d.y+a.y,d.z+a.z)},sub:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(d.x-a.x,d.y-a.y,d.z-a.z)},mul:function(a,b){var c=null==b,d=c?this:
a;a=c?a:b;return this.set(d.x*a.x,d.y*a.y,d.z*a.z)},dot:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return d.x*a.x+d.y*a.y+d.z*a.z},cross:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(d.y*a.z-d.z*a.y,d.z*a.x-d.x*a.z,d.x*a.y-d.y*a.x)},min:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(g.min(d.x,a.x),g.min(d.y,a.y),g.min(d.z,a.z))},max:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(g.max(d.x,a.x),g.max(d.y,a.y),g.max(d.z,a.z))},clamp:function(a,b){return this.set(g.clamp(this.x,
a.x,b.x),g.clamp(this.y,a.y,b.y),g.clamp(this.z,a.z,b.z))},scale:function(a){return this.set(this.x*a,this.y*a,this.z*a)},negate:function(){return this.set(-this.x,-this.y,-this.z)},normalize:function(){var a=this.get_length();return 0!=a?this.scale(1/a):this.set(0,0,0)},distanceSquared:function(a,b){var c=null==b,d=c?this:a;c=c?a:b;a=d.x-c.x;b=d.y-c.y;d=d.z-c.z;return a*a+b*b+d*d},distance:function(a,b){return Math.sqrt(this.distanceSquared(a,b))},equals:function(a){return this.x==a.x&&this.y==a.y?
this.z==a.z:!1},isZero:function(){return g.isZero(this.x)&&g.isZero(this.y)?g.isZero(this.z):!1},isOne:function(){return g.isZero(this.x-1)&&g.isZero(this.y-1)?g.isZero(this.z-1):!1},angleTo:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;b=d.get_length();c=a.get_length();return 0<b&&0<c?g.radianToAngle(Math.acos(d.dot(a)/(b*c))):0},lerpTo:function(a,b){if(0>=b)return this;if(1<=b)return this.copy(a);this.x+=b*(a.x-this.x);this.y+=b*(a.y-this.y);this.z+=b*(a.z-this.z);return this},projectOnto:function(a,
b){var c=null==b,d=c?this:a;a=c?a:b;c=a.dot(a);if(0==c)return this.set(0,0,0);d=d.dot(a)/c;return this.copy(b).scale(d)},projectOntoPlane:function(a){return this.sub(k.get_temp().projectOnto(a))},reflectBy:function(a){a=k.get_temp().copy(this).projectOnto(a);a.scale(2);return this.sub(a)},rotateLeft:function(){var a=-this.y;this.y=this.x;this.x=a;return this},rotateRight:function(){var a=this.y;this.y=-this.x;this.x=a;return this},getElement:function(a){0>a?a=a%3+3:3<=a&&(a%=3);return 0==a?this.x:
1==a?this.y:this.z},setElement:function(a,b){0>a?a=a%3+3:3<=a&&(a%=3);0==a?this.x=b:1==a?this.y=b:this.z=b},fillArray:function(a,b){null==b&&(b=0);a[b++]=this.x;a[b++]=this.y;a[b++]=this.z},fromArray:function(a,b){null==b&&(b=0);if(null==a)return this;var c=a.length;b<c&&(this.x=a[b++]);b<c&&(this.y=a[b++]);b<c&&(this.z=a[b++]);return this},get_length:function(){return Math.sqrt(this.get_lengthSq())},get_lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},__class__:k,__properties__:{get_lengthSq:"get_lengthSq",
get_length:"get_length"}};var Za=function(){this.start=new k;this.direction=new k};f["lovedna.geom.Ray"]=Za;Za.__name__=["lovedna","geom","Ray"];Za.__properties__={get_temp:"get_temp"};Za.get_temp=function(){return Za._pool.get()};Za.prototype={copy:function(a){if(a==this)return this;this.start.copy(a.start);this.direction.copy(a.direction);return this},set:function(a,b){this.start.copy(a);this.direction.sub(b,a);this.direction.normalize();return this},at:function(a){var b=k.get_temp();b.copy(this.direction);
b.scale(a);b.add(this.start);return b},lookAt:function(a){this.direction.copy(a).sub(this.start).normalize();return this},closestPoint:function(a){var b=k.get_temp();b.sub(a,this.start);a=b.dot(this.direction);0>a?b.copy(this.start):this.at(a);return b},DistanceToPoint:function(a){var b=k.get_temp();b.sub(a,this.start);b=b.dot(this.direction);return 0>b?this.start.distance(a):this.at(b).distance(a)},DistanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0==b)return 0==a.distanceToPoint(this.start)?
0:-1;a=-(this.start.dot(a.normal)+a.distance)/b;return 0<=a?a:-1},intersectPlane:function(a){a=this.DistanceToPlane(a);return-1==a?null:this.at(a)},crossPlane:function(a){var b=a.distanceToPoint(this.start);return 0==b||0>a.normal.dot(this.direction)*b?!0:!1},intersectSphere:function(a){var b=k.get_temp();b.sub(a.getCenter(),this.start);var c=this.direction.dot(b);b=b.dot(b)-c*c;a=a.radius*a.radius;if(b>a)return null;b=Math.sqrt(a-b);a=c-b;c+=b;return 0>a&&0>c?null:0>a?this.at(c):this.at(a)},crossSphere:function(a){return null==
a?!1:this.DistanceToPoint(a.getCenter())<=a.radius},intersectBox:function(a){var b=0!=this.direction.x?1/this.direction.x:0;var c=0!=this.direction.y?1/this.direction.y:0;var d=0!=this.direction.z?1/this.direction.z:0,e=this.start;if(0<=b){var f=(a.min.x-e.x)*b;b*=a.max.x-e.x}else f=(a.max.x-e.x)*b,b*=a.min.x-e.x;if(0<=c){var g=(a.min.y-e.y)*c;c*=a.max.y-e.y}else g=(a.max.y-e.y)*c,c*=a.min.y-e.y;if(f>c||g>b)return null;if(g>f||f!=f)f=g;if(c<b||b!=b)b=c;0<=d?(g=(a.min.z-e.z)*d,a=(a.max.z-e.z)*d):(g=
(a.max.z-e.z)*d,a=(a.min.z-e.z)*d);if(f>a||g>b)return null;if(g>f||f!=f)f=g;if(a<b||b!=b)b=a;return 0>b?null:this.at(0<=f?f:b)},intersectTriangle:function(a,b,c,d){null==d&&(d=!1);var e=k.get_temp(),f=k.get_temp(),g=k.get_temp(),h=k.get_temp();f.sub(b,a);g.sub(c,a);h.cross(f,g);b=this.direction.dot(h);if(0<b){if(d)return null;d=1}else if(0>b)d=-1,b=-b;else return null;e.sub(this.start,a);a=d*this.direction.dot(g.cross(e,g));if(0>a)return null;f=d*this.direction.dot(f.cross(e));if(0>f||a+f>b)return null;
e=-d*e.dot(h);return 0>e?null:this.at(e/b)},multiplyMatrix44:function(a){a.transformVector(this.direction.add(this.start));a.transformVector(this.start);this.direction.sub(this.start);this.direction.normalize();return this},toString:function(){return"Ray("+u.string(this.start)+" "+u.string(this.direction)+")"},__class__:Za};var Zc=function(){this.radius=0;this.center=new k(0,0,0);this.enabled=!0};f["lovedna.geom.Sphere"]=Zc;Zc.__name__=["lovedna","geom","Sphere"];Zc.__interfaces__=[dd];Zc.prototype=
{toString:function(){return"Sphere["+u.string(this.center)+" "+this.radius+"]"},getCenter:function(){return this.center},getFarthestPointInDirection:function(a){return k.get_one().copy(a).normalize().scale(this.radius).add(this.center)},set:function(a,b){this.center.copy(a);this.radius=b;return this},copy:function(a){return a==this?this:this.set(a.center,a.radius)},multiplyMatrix44:function(a){a.transformVector(this.center);this.radius*=a.getScaleX();return this},containsPoint:function(a){return a.distanceSquared(this.center)<=
this.radius*this.radius},distanceToPoint:function(a){return a.distance(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceSquared(this.center)<=b*b},equals:function(a){return this.center.equals(a.center)?this.radius==a.radius:!1},__class__:Zc};var Gd=function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=0);this.h=a;this.s=b;this.v=c};f["lovedna.math.HsvColor"]=Gd;Gd.__name__=["lovedna","math","HsvColor"];Gd.prototype={set:function(a,b,c){null==
c&&(c=1);null==b&&(b=1);null==a&&(a=0);this.h=a;this.s=b;this.v=c;return this},fromColor:function(a){var b=255*a.get_r(),c=255*a.get_g();a=255*a.get_b();var d=g.max(b,c);d=g.max(d,a);var e=g.min(b,c);e=g.min(e,a);this.v=d/255;this.s=(d-e)/d;e=60*(d-e);b==d&&(this.h=(c-a)/e);c==d&&(this.h=120+(a-b)/e);a==d&&(this.h=240+(b-c)/e);0>this.h&&(this.h+=360);return this},toColor:function(){var a=new S;if(0==this.s)return a.set(this.v,this.v,this.v,1),a;var b=this.h%360/60,c=u["int"](b),d=b-c;b=this.v*(1-
this.s);var e=this.v*(1-this.s*d);d=this.v*(1-this.s*(1-d));switch(c){case 0:a.set(this.v,d,b,1);break;case 1:a.set(e,this.v,b,1);break;case 2:a.set(b,this.v,d,1);break;case 3:a.set(b,e,this.v,1);break;case 4:a.set(d,b,this.v,1);break;case 5:a.set(this.v,b,e,1)}return a},__class__:Gd};var R=function(a,b,c,d){null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d};f["lovedna.math.Quaternion"]=R;R.__name__=["lovedna","math","Quaternion"];R.__interfaces__=[jb,
yb];R.__properties__={get_temp:"get_temp"};R.get_temp=function(){return R._pool.get()};R.prototype={toString:function(){return this.fixed(4)},fixed:function(a){null==a&&(a=4);return"Quaternion("+g.fixed(this.x,a)+","+g.fixed(this.y,a)+","+g.fixed(this.z,a)+","+g.fixed(this.w,a)+")"},set:function(a,b,c,d){null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d;return this},copy:function(a){return null==a||a==this?this:this.set(a.x,a.y,a.z,a.w)},from:function(a){return this.set(a.x,
a.y,a.z,a.w)},clone:function(){return new R(this.x,this.y,this.z,this.w)},equals:function(a){return this.x==a.x&&this.y==a.y&&this.z==a.z?this.w==a.w:!1},add:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(d.x+a.x,d.y+a.y,d.z+a.z,d.w+a.w)},sub:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(d.x-a.x,d.y-a.y,d.z-a.z,d.w-a.w)},dot:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return d.x*a.x+d.y*a.y+d.z*a.z+d.w*a.w},identity:function(){return this.set(0,0,0,1)},isIdentity:function(){return 0==
this.x&&0==this.y&&0==this.z?1==this.w:!1},isZero:function(){return 0==this.x&&0==this.y&&0==this.z?1==this.w:!1},normalize:function(){var a=this.get_length();if(0==a)return this.identity();a=1/a;return this.set(this.x*a,this.y*a,this.z*a,this.w*a)},inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this.set(-1*this.x,-1*this.y,-1*this.z,this.w)},mul:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return this.set(d.w*a.x+d.x*a.w+d.y*a.z-d.z*a.y,d.w*a.y+d.y*a.w+d.z*
a.x-d.x*a.z,d.w*a.z+d.z*a.w+d.x*a.y-d.y*a.x,d.w*a.w-d.x*a.x-d.y*a.y-d.z*a.z)},rotate:function(a){var b=a.x,c=a.y,d=a.z,e=this.w*b+this.y*d-this.z*c,f=this.w*c+this.z*b-this.x*d,g=this.w*d+this.x*c-this.y*b;b=-this.x*b-this.y*c-this.z*d;return a.set(e*this.w+b*-this.x+f*-this.z-g*-this.y,f*this.w+b*-this.y+g*-this.x-e*-this.z,g*this.w+b*-this.z+e*-this.y-f*-this.x)},setEulerAngles:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);a=g.angleToRadian(a);b=g.angleToRadian(b);c=g.angleToRadian(c);
var d=Math.sin,e=Math.cos,f=.5*c;c=d(f);f=e(f);var h=.5*a;a=d(h);h=e(h);b*=.5;d=d(b);var k=e(b);e=k*a;b=d*h;h*=k;a*=d;this.x=e*f+b*c;this.y=b*f-e*c;this.z=h*c-a*f;this.w=h*f+a*c;return this},getEulerAngles:function(a){null==a&&(a=k.get_temp());var b=this.x*this.x,c=this.y*this.y,d=this.z*this.z,e=this.y*this.x+this.z*this.w;e=.4999<e?1:-.4999>e?-1:0;0==e?(a.x=Math.asin(g.clamp(2*(this.w*this.x-this.z*this.y),-1,1)),a.y=Math.atan2(2*(this.y*this.w+this.x*this.z),1-2*(c+b)),a.z=Math.atan2(2*(this.w*
this.z+this.y*this.x),1-2*(b+d))):(a.x=1.5707963267948966*e,a.y=0,a.z=2*e*Math.atan2(this.y,this.w));a.scale(57.29577951308232);return a},distance:function(a,b){a=this.dot(a,b);return 1-a*a},angle:function(a,b){a=this.dot(a,b);return g.radianToAngle(Math.acos(2*a*a-1))},lookAt:function(a,b,c){return this.setLookAt(k.get_temp().sub(b,a).normalize(),c)},setLookAt:function(a,b){null==b&&(b=k.get_up());var c=k.get_temp(),d=k.get_temp();c.copy(b).cross(a).normalize();d.copy(a).cross(c).normalize();this.setFromAxes(c.x,
d.x,a.x,c.y,d.y,a.y,c.z,d.z,a.z);return this},setFromAxes:function(a,b,c,d,e,f,g,h,k){var l=a+e+k;0<=l?(a=Math.sqrt(l+1),this.w=.5*a,a=.5/a,this.x=(h-f)*a,this.y=(c-g)*a,this.z=(d-b)*a):a>e&&a>k?(a=Math.sqrt(1+a-e-k),this.x=.5*a,a=.5/a,this.y=(d+b)*a,this.z=(c+g)*a,this.w=(h-f)*a):e>k?(a=Math.sqrt(1+e-a-k),this.y=.5*a,a=.5/a,this.x=(d+b)*a,this.z=(h+f)*a,this.w=(c-g)*a):(a=Math.sqrt(1+k-a-e),this.z=.5*a,a=.5/a,this.x=(c+g)*a,this.y=(h+f)*a,this.w=(d-b)*a);return this},slerpTo:function(a,b){if(0>=
b)return this;if(1<=b)return this.copy(a),this;var c=this.dot(a),d=g.abs(c),e=1-b,f=b;if(.1<1-d){d=Math.acos(d);f=Math.sin;var h=1/f(d);e=f((1-b)*d)*h;f=f(b*d)*h}0>c&&(f=-f);return this.set(e*this.x+f*a.x,e*this.y+f*a.y,e*this.z+f*a.z,e*this.w+f*a.w)},slerp:function(a,b,c){this.copy(a);a=this.x;var d=this.y,e=this.z,f=this.w,g=this.w*b.w+this.x*b.x+this.y*b.y+this.z*b.z;0>g?(this.w=-b.w,this.x=-b.x,this.y=-b.y,this.z=-b.z,g=-g):this.copy(b);if(1<=g)return this.w=f,this.x=a,this.y=d,this.z=e,this;
b=Math.acos(g);var h=Math.sqrt(1-g*g);if(.001>Math.abs(h))return this.w=.5*(f+this.w),this.x=.5*(a+this.x),this.y=.5*(d+this.y),this.z=.5*(e+this.z),this;g=Math.sin((1-c)*b)/h;c=Math.sin(c*b)/h;this.w=f*g+this.w*c;this.x=a*g+this.x*c;this.y=d*g+this.y*c;this.z=e*g+this.z*c;return this},getElement:function(a){0>a?a=a%4+4:4<=a&&(a%=4);switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w}return 0},setElement:function(a,b){0>a?a=a%4+4:4<=a&&(a%=4);switch(a){case 0:this.x=
b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b}},fillArray:function(a,b){null==b&&(b=0);a[b++]=this.x;a[b++]=this.y;a[b++]=this.z;a[b++]=this.w},fromArray:function(a,b){null==b&&(b=0);if(null==a)return this;var c=a.length;b<c&&(this.x=a[b++]);b<c&&(this.y=a[b++]);b<c&&(this.z=a[b++]);b<c&&(this.w=a[b++]);return this},get_lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},get_length:function(){return Math.sqrt(this.get_lengthSq())},__class__:R,
__properties__:{get_lengthSq:"get_lengthSq",get_length:"get_length"}};var Qb=function(){this._workerState=0};f["lovedna.net.BytesLoader"]=Qb;Qb.__name__=["lovedna","net","BytesLoader"];Qb.prototype={load:function(a){Qb.workerEnable&&0==this._workerState&&(this._workerState=null==window.Worker?-1:1);if(Qb.workerEnable&&1==this._workerState)this._worker=new Worker("worker.js"),this._worker.postMessage(a),this._worker.onmessage=n(this,this.onWorkerMessage);else{null==this._xmlHttpRequest&&(this._xmlHttpRequest=
new XMLHttpRequest);this.bytes=null;this._xmlHttpRequest.responseType="arraybuffer";this._xmlHttpRequest.onreadystatechange=n(this,this.readyStateChange);this._xmlHttpRequest.open("GET",a,!0);try{this._xmlHttpRequest.send(null)}catch(b){aa.trace("load error",{fileName:"BytesLoader.hx",lineNumber:78,className:"lovedna.net.BytesLoader",methodName:"load"})}}},readyStateChange:function(a){if(4==this._xmlHttpRequest.readyState){a=this._xmlHttpRequest.status;if(200<=a&&400>a||0==a&&""==this._xmlHttpRequest.statusText)if(a=
this._xmlHttpRequest.response,null!=a)this.bytes=ka.ofData(a);else if(null!=this._xmlHttpRequest.responseText){a=VBArray(request.responseText).toArray();this.bytes=ka.alloc(a.length);for(var b=0,c=a.length;b<c;){var d=b++;this.bytes.set(d,a[d])}}this._xmlHttpRequest=null;if(null!=this.onComplete)this.onComplete(this)}},onWorkerMessage:function(a){aa.trace("from woker ",{fileName:"BytesLoader.hx",lineNumber:113,className:"lovedna.net.BytesLoader",methodName:"onWorkerMessage"});this.bytes=ka.ofData(a.data);
if(null!=this.onComplete)this.onComplete(this)},__class__:Qb};var eb=function(){w.call(this);this.forceBytes=!1};f["lovedna.net.FileData"]=eb;eb.__name__=["lovedna","net","FileData"];eb.__super__=w;eb.prototype=p(w.prototype,{setType:function(a){this.type=a;a==ia.BYTES&&(this.forceBytes=!0);return this},setPath:function(a){this.path=a;if(null==this.type)switch(this.type=ia.BYTES,a.split(".").pop().toLowerCase()){case "gif":case "jpeg":case "jpg":case "png":this.type=ia.IMAGE;break;case "mp2":case "mp3":break;
case "m4a":case "ogg":case "wav":break;case "otf":case "ttf":break;case "css":case "json":case "plist":case "svg":case "text":case "txt":case "xml":this.type=ia.TEXT;this.forceBytes=!0;break;default:this.type=ia.BYTES,this.forceBytes=!0}return this},setUrl:function(a){this.url=a;return this},get_key:function(){if(null!=this._key)return this._key;eb._fnv.reset();eb._fnv.addString(this.url);eb._fnv.addInt(ja.enumIndex(this.type));return this._key=eb._fnv.getString()},get_enabled:function(){return null==
this.bytes&&null==this.text&&null==this.image?null!=this.video:!0},__class__:eb,__properties__:{get_enabled:"get_enabled",get_key:"get_key"}});var ha=function(a){this.set(a)};f["lovedna.net.Path"]=ha;ha.__name__=["lovedna","net","Path"];ha.normalize=function(a){if(null==a)return null;a=a.split("\\").join("/");if(null==a||"/"==a)return"/";var b=[],c=0;for(a=a.split("/");c<a.length;){var d=a[c];++c;".."==d&&0<b.length&&".."!=b[b.length-1]?b.pop():"."!=d&&b.push(d)}b=b.join("/");(new xb("([^:])/+","g")).replace(b,
"$1/");c=new gc;d=a=!1;for(var e=0,f=b.length;e<f;){var g=e++;g=B.cca(b,g);if(null==g)a=!1,d&&(c.add("/"),d=!1),c.add(String.fromCharCode(g));else switch(g){case 47:0==a?d=!0:(a=!1,d&&(c.add("/"),d=!1),c.add(String.fromCharCode(g)));break;case 58:c.add(":");a=!0;break;default:a=!1,d&&(c.add("/"),d=!1),c.add(String.fromCharCode(g))}}return c.toString()};ha.Combine=function(a,b){return""==a||null==a?b:null==b||""==b?a:""==a?b:ha.addSlash(a)+ha.removeSlash(b)};ha.addSlash=function(a){if(0==a.length)return"/";
var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");return b<c?c!=a.length-1?a+"\\":a:b!=a.length-1?a+"/":a};ha.removeSlash=function(a){try{for(;;){var b=B.cca(a,a.length-1);if(null==b)throw"__break__";switch(b){case 47:case 92:a=B.substr(a,0,-1);break;default:throw"__break__";}}}catch(d){if("__break__"!=d)throw d;}try{for(;;){var c=B.cca(a,0);if(null==c)throw"__break__";switch(c){case 47:case 92:a=B.substr(a,1,null);break;default:throw"__break__";}}}catch(d){if("__break__"!=d)throw d;}return a};ha.prototype=
{toString:function(){return(null==this._dir?"":this._dir+(this._leftslash?"/":"\\"))+(null==this._file?"":this._file)+(null==this._ext?"":"."+this._ext)},getHashKey:function(){ha._fnv.reset();ha._fnv.addString(this.toString());return ha._fnv.getString()},getDir:function(){return this._dir},getPathWithoutExt:function(){return ha.Combine(this._dir,this._file)},getFile:function(){return this._file+"."+this._ext},getExt:function(){return this._ext},getFileWithoutExt:function(){return this._file},getParams:function(){return this._param},
getParent:function(){var a=this.getDir();if(null==a||""==a)return null;ha.instance.set(ha.normalize(a));a=ha.instance.getDir();if(null==a||""==a)return null;var b=new ha;b.set(a);return b},isAbs:function(){return P.startsWith(this._value,"/")||":"==this._value.charAt(1)?!0:!1},isHttp:function(){var a=B.substr(this._value,0,7);return"http://"!=a?"https:/"==a:!0},set:function(a){this._value=a;this.clear();if(""==a||null==a)return this;switch(a){case ".":case "..":return this._dir=a,this._file="",this}var b=
a.lastIndexOf("/"),c=a.lastIndexOf("\\");b<c?(this._dir=B.substr(a,0,c),a=B.substr(a,c+1,null),this._leftslash=!1):c<b?(this._dir=B.substr(a,0,b),a=B.substr(a,b+1,null),this._leftslash=!0):this._dir=null;-1!=a.indexOf("?")&&(b=a.split("?"),a=b.shift(),this._param=b.join("?"));b=a.lastIndexOf(".");-1!=b?(this._ext=B.substr(a,b+1,null),this._file=B.substr(a,0,b)):(this._ext=null,this._file=a);return this},clear:function(){this._param=this._ext=this._file=this._dir=null;this._leftslash=!1},__class__:ha};
var C=function(){w.call(this);this._bytesLoader=new Qb;this._bytesLoader.onComplete=n(this,this.onBytesComplete);this._fileList=new G};f["lovedna.net.FileLoader"]=C;C.__name__=["lovedna","net","FileLoader"];C.setGlobalRoot=function(a){0<C._defaultRoot.length||(null==a&&(a=""),C._defaultRoot=a,C._path.set(C._defaultRoot),C._path.isHttp()&&(C._defaultRoot=C._path.toString()+"/"),g.endWith(C._defaultRoot,"/")||(C._defaultRoot+="/"))};C.setVersiton=function(a,b){C._version.set(a,b)};C.__super__=w;C.prototype=
p(w.prototype,{load:function(a,b){var c=this,d=new eb;C._path.set(a);var e=C._path.toString();d.setType(b).setPath(e);C._path.isHttp()?d.setUrl(a):(b="",C._version.exists(a)?b=C._version.get(a):(b=C.meta.getMeta(a),b=null!=b?b.crc+"":"",C._version.set(a,b)),d.setUrl(C._defaultRoot+e+"?v="+b));a=d.get_key();C._fileMap.exists(a)?d=C._fileMap.get(a):(C._fileMap.set(a,d),this._fileList.push(d),C._list.push(this),C._loading||(null==C._delayCall&&(C._delayCall=new ua(function(){c._loadnext()})),C._delayCall.running||
ua.add(C._delayCall,.1)));return d},_loadnext:function(){C._loading||0!=C._list.get_length()&&C._list.shift()._load()},_load:function(){var a=this;1>this._fileList.get_length()?this._loadnext():(this._current=this._fileList.shift(),C._loading=!0,this._current.forceBytes?this._bytesLoader.load(this._current.url):this._current.type==ia.IMAGE?(new Eb).fromUrl(this._current.url,function(b){a._current.image=b;a.completeFile()}):this.completeFile())},onBytesComplete:function(a){var b=this;this._current.bytes=
a.bytes;this._current.type==ia.IMAGE?(new Eb).fromBytes(a.bytes,function(a){b._current.image=a;b.completeFile()}):this.completeFile()},completeFile:function(){C._loading=!1;C._fileMap.remove(this._current.get_key());this._current.dispatchEvent(D.complete);this._loadnext()},__class__:C});var ia={__ename__:!0,__constructs__:["NULL","BYTES","IMAGE","TEXT","VIDEO"],NULL:["NULL",0]};ia.NULL.toString=wb;ia.NULL.__enum__=ia;ia.BYTES=["BYTES",1];ia.BYTES.toString=wb;ia.BYTES.__enum__=ia;ia.IMAGE=["IMAGE",
2];ia.IMAGE.toString=wb;ia.IMAGE.__enum__=ia;ia.TEXT=["TEXT",3];ia.TEXT.toString=wb;ia.TEXT.__enum__=ia;ia.VIDEO=["VIDEO",4];ia.VIDEO.toString=wb;ia.VIDEO.__enum__=ia;var z=x.lovedna.Assets=function(){};f["lovedna.resource.Assets"]=z;z.__name__=["lovedna","resource","Assets"];z.init=function(a){null==a&&(a="");C.setGlobalRoot(a);if(!z._init&&(z._init=!0,a=new Qd,a.onInstance=z.instance,a.inject(z,z),null!=z._list)){for(a=z._list.length;0<a--;)z._list[a].init();z._list=null;z.meta=C.meta}};z.setVersion=
function(a,b){C.setVersiton(a,b)};z.loadMeta=function(a,b){if(z._init){z.setVersion(a,z.version);var c=z.bytes.get(a);null==z._metasuccess&&(z._metasuccess=new I);null!=b&&z._metasuccess.set(a,b);c.addEventListener(D.complete.get_type(),z.metaComplete)}};z.instance=function(a){u.is(a,da)&&null!=a&&(null==z._list&&(z._list=[]),z._list.push(a))};z.metaComplete=function(a){a=a.target;if(a.enabled){var b=new Lb(0),c=b.decode(ta.fromBytes(a.bytes));-433249250==b.type&&z.meta.decode(c)}z._metasuccess.exists(a.get_file().name)&&
(b=z._metasuccess.get(a.get_file().name),null!=b&&b(),z._metasuccess.remove(a.get_file().name))};z.prototype={__class__:z};var ce=function(){};f["lovedna.resource.IAssetUser"]=ce;ce.__name__=["lovedna","resource","IAssetUser"];ce.prototype={__class__:ce};var Eb=function(){};f["lovedna.resource.Image"]=Eb;Eb.__name__=["lovedna","resource","Image"];Eb.prototype={fromBytes:function(a,b){this._complete=b;null==a?this._onerror():(null==this.data&&(this.data=new Image,this.data.onload=n(this,this._onload),
this.data.onerror=n(this,this._onerror)),this.height=this.width=0,a="data:data;base64,"+Fb.encode(a),this.data.src=a,this.data.crossOrigin="Anonymous")},fromUrl:function(a,b){this._complete=b;null==this.data&&(this.data=new Image,this.data.onload=n(this,this._onload),this.data.onerror=n(this,this._onerror));this.height=this.width=0;this.data.src=a;this.data.crossOrigin="Anonymous"},_onload:function(){this.width=this.data.width;this.height=this.data.height;null!=this._complete&&(this._complete(this),
this._complete=null)},_onerror:function(){null!=this._complete&&(this.width=this.height=0,this._complete(this),this._complete=null)},__class__:Eb};var ma=function(){w.call(this);this.enabled=!1};f["lovedna.resource.data.ResBase"]=ma;ma.__name__=["lovedna","resource","data","ResBase"];ma.__interfaces__=[Pb];ma.__super__=w;ma.prototype=p(w.prototype,{unload:function(){this._file=null},fileComplete:function(){this.enabled=!0;this.onFileComplete();this.dispatchEvent(D.complete)},onFileComplete:function(){},
get_file:function(){return this._file},set_file:function(a){return this._file=a},__class__:ma,__properties__:{set_file:"set_file",get_file:"get_file"}});var ed=function(){ma.call(this)};f["lovedna.resource.data.ResBytes"]=ed;ed.__name__=["lovedna","resource","data","ResBytes"];ed.__super__=ma;ed.prototype=p(ma.prototype,{onFileComplete:function(){ma.prototype.onFileComplete.call(this);this.bytes=this.get_file().bytes;this.enabled=null!=this.bytes},__class__:ed});var cc=function(a,b){ma.call(this);
this.name=a;this.texture=b};f["lovedna.resource.data.ResFnt"]=cc;cc.__name__=["lovedna","resource","data","ResFnt"];cc.__super__=ma;cc.prototype=p(ma.prototype,{setfnt:function(a){this.fnt=a;this.enabled=!0;this.dispatchEvent(D.complete)},__class__:cc});var fd=function(){ma.call(this);this.modelData=new Ka};f["lovedna.resource.data.ResG3D"]=fd;fd.__name__=["lovedna","resource","data","ResG3D"];fd.__super__=ma;fd.prototype=p(ma.prototype,{onFileComplete:function(){if(null==this.get_file().bytes)this.enabled=
!1,this.dispatchEvent(D.complete);else{var a=ta.fromBytes(this.get_file().bytes),b=new Lb(0);a=b.decode(a);-239294721!=b.type?aa.trace("not type g3d",{fileName:"ResG3D.hx",lineNumber:63,className:"lovedna.resource.data.ResG3D",methodName:"onFileComplete"}):(a.readUTFBytes(3),a.readInt(),this.decode(a))}},decode:function(a){null!=a&&(Ka.current=this.modelData,this.modelData.clear(),this.modelData.decode(a),this.modelData.init(),this.modelData.dispose())},init:function(a){null!=a&&(Ka.current=this.modelData,
this._data=a.readUTFBytes(a.get_length()),a=JSON.parse(this._data),this.parseMeshes(a),this.parseMaterials(a),this.parseNodes(a),this.parseAnimations(a),this.modelData.init(),this._data=null,this.enabled=!0)},parseMeshes:function(a){a=q.getArray(a,"meshes");if(null!=a)for(var b=0,c=a.length;b<c;){var d=b++,e=a[d];d=new Ba;d.id=q.getString(e,"id");d.attributes=q.getStringArray(e,"attributes");d.vertices=q.getFloatArray(e,"vertices");e=q.getArray(e,"parts");for(var f=0,g=e.length;f<g;){var h=f++;h=
e[h];var k=new yc;k.id=q.getString(h,"id");k.primitiveType=q.getString(h,"type");k.indices=q.getIntArray(h,"indices");d.addPart(k)}this.modelData.addMesh(d)}},parseNodes:function(a){a=q.getArray(a,"nodes");if(null!=a)for(var b=0,c=a.length;b<c;){var d=b++;this.modelData.addNode(this.parseNode(a[d]))}},parseNode:function(a){var b=new Wb;b.id=q.getString(a,"id","");var c=q.getFloatArray(a,"translation");b.translation=null==c?null:(new k).fromArray(c);c=q.getFloatArray(a,"rotation");b.rotation=null==
c?null:(new R).fromArray(c);c=q.getFloatArray(a,"scale");b.scale=null==c?null:(new k).fromArray(c);b.meshId=q.getString(a,"mesh");c=q.getArray(a,"parts");if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,g=c[f];f=new zc;f.materialId=q.getString(g,"materialid");f.meshPartId=q.getString(g,"meshpartid");g=q.getArray(g,"bones");if(null!=g)for(var h=0,m=g.length;h<m;){var n=h++,p=g[n];n=q.getString(p,"node");var r=q.getFloatArray(p,"translation");r=null==r?null:(new k).fromArray(r);var t=q.getFloatArray(p,
"rotation");t=null==t?null:(new R).fromArray(t);p=q.getFloatArray(p,"scale");p=null==p?null:(new k).fromArray(p);f.addBone(n,r,t,p)}b.addPart(f)}a=q.getArray(a,"children");if(null!=a)for(c=0,d=a.length;c<d;)e=c++,b.addChildren(this.parseNode(a[e]));return b},parseMaterials:function(a){a=q.getArray(a,"materials");if(null!=a)for(var b=0,c=a.length;b<c;){var d=b++,e=a[d];d=new xc;d.id=q.getString(e,"id");d.shininess=q.getFloat(e,"shininess",0);d.opacity=q.getFloat(e,"opacity",1);var f=q.getFloatArray(e,
"diffuse");d.diffuse=null==f?null:(new S).fromArray(f);f=q.getFloatArray(e,"ambient");d.ambient=null==f?null:(new S).fromArray(f);f=q.getFloatArray(e,"emissive");d.emissive=null==f?null:(new S).fromArray(f);f=q.getFloatArray(e,"specular");d.specular=null==f?null:(new S).fromArray(f);f=q.getFloatArray(e,"reflection");d.reflection=null==f?null:(new S).fromArray(f);e=q.getArray(e,"textures");if(null!=e){f=0;for(var g=e.length;f<g;){var h=f++;h=e[h];var k=new Ca;k.id=q.getString(h,"id");k.fileName=q.getString(h,
"filename");k.type=q.getString(h,"type");var m=q.getFloatArray(h,"uvTranslation");null!=m&&k.uvTranslation.fromArray(m);m=q.getFloatArray(h,"uvScaling");null!=m&&k.uvScaling.fromArray(m);d.addTexture(k)}}this.modelData.addMaterial(d)}},parseAnimations:function(a){a=q.getArray(a,"animations");if(null!=a)for(var b=0,c=a.length;b<c;){var d=b++,e=a[d];d=q.getArray(e,"bones");if(null!=d){var f=new vc;f.id=q.getString(e,"id");e=0;for(var g=d.length;e<g;){var h=e++,m=d[h];h=new wc;h.nodeId=q.getString(m,
"boneId");m=q.getArray(m,"keyframes");for(var n=0,p=m.length;n<p;){var r=n++;r=m[r];var t=.001*q.getFloat(r,"keytime",0);var u=q.getFloatArray(r,"translation");null!=u&&h.addTranslation(new nb(t,(new k).fromArray(u)));u=q.getFloatArray(r,"rotation");null!=u&&h.addRotation(new nb(t,(new R).fromArray(u)));u=q.getFloatArray(r,"scale");null!=u&&h.addScaling(new nb(t,(new k).fromArray(u)))}f.add(h)}this.modelData.addAnimation(f)}}},__class__:fd});var dc=function(){ma.call(this);this._uv=new t;this._uv00=
new t(0,0);this._uv11=new t(1,1)};f["lovedna.resource.data.ResSprite"]=dc;dc.__name__=["lovedna","resource","data","ResSprite"];dc.__super__=ma;dc.prototype=p(ma.prototype,{getUV:function(a,b){return this.data.get_rotated()?this._uv.set(g.lerp(this._uv00.x,this._uv11.x,b),g.lerp(this._uv00.y,this._uv11.y,a)):this._uv.set(g.lerp(this._uv00.x,this._uv11.x,a),g.lerp(this._uv00.y,this._uv11.y,b))},init:function(a){if(null!=this.texture){var b=this.texture.texture.width,c=this.texture.texture.height;if(0!=
b&&0!=c)if(this.enabled=!0,null==a)this.packed=!1,this.data=new uc,this.data.frame.set(0,0,b,c),this.data.sourceSize.set(b,c),this.dispatchEvent(D.init);else if(-1!=a.file.indexOf(this.atlasName)&&(this.packed=!0,this.data=a.getSprite(this.name),null!=this.data)){a=this.data.frame.get_width();var d=this.data.frame.get_height();this.data.get_rotated()?(this._uv00.set((this.data.frame.x+d)/b,this.data.frame.y/c),this._uv11.set(this.data.frame.x/b,(this.data.frame.y+a)/c)):(this._uv00.set(this.data.frame.x/
b,this.data.frame.y/c),this._uv11.set((this.data.frame.x+a)/b,(this.data.frame.y+d)/c));this.dispatchEvent(D.init)}}},set_atlasName:function(a){return null!=this.atlasName?this.atlasName:this.atlasName=a},set_name:function(a){return null!=this.name?this.name:this.name=a},set_texture:function(a){return null!=this.texture?this.texture:this.texture=a},__class__:dc,__properties__:p(ma.prototype.__properties__,{set_texture:"set_texture",set_name:"set_name",set_atlasName:"set_atlasName"})});var gd=function(){ma.call(this);
this.texture=new Db};f["lovedna.resource.data.ResTexture"]=gd;gd.__name__=["lovedna","resource","data","ResTexture"];gd.__super__=ma;gd.prototype=p(ma.prototype,{onFileComplete:function(){ma.prototype.onFileComplete.call(this);null==this.get_file().image?this.enabled=!1:0!=this.get_file().image.width&&(this.texture.setData(this.get_file().image),this.parsePng());null!=this.get_file().bytes&&null==this.get_file().image&&(this.get_file().image=new Eb,this.get_file().image.fromBytes(this.get_file().bytes,
n(this,this.onImageComplete)))},onImageComplete:function(a){this.onFileComplete()},parsePng:function(){z.texture.res=this;z.texture.tag=0;if(null!=this.get_file().bytes){var a=new zb;a.decode(ta.fromBytes(this.get_file().bytes));a=a.getChunk(1716666723);if(null!=a&&(a=a.getContent(),null!=a)){a.position=0;var b=new Lb(0);a=b.decode(a);a.position=0;z.texture.tag=b.type;z.texture.bytes=a}}z.texture.dispatchEvent(D.data);this.get_file().bytes=null},__class__:gd});var da=function(){w.call(this);this._map=
new I;this._loader=new C};f["lovedna.resource.loader.LoaderBase"]=da;da.__name__=["lovedna","resource","loader","LoaderBase"];da.__super__=w;da.prototype=p(w.prototype,{get:function(a){if(this._map.exists(a))return this._map.get(a);var b=this.createRes();this._map.set(a,b);var c=this._loader.load(a);c.name=a;b.set_file(c);this.onLoad(b);c.get_enabled()||c.addEventListener(D.complete.get_type(),n(this,this.fileComplete));return b},createRes:function(){return null},onLoad:function(a){},init:function(){},
fileComplete:function(a){a=a.target;a.removeEventListener(D.complete.get_type(),n(this,this.fileComplete));this._map.get(a.name).fileComplete()},__class__:da});var Rd=function(){da.call(this)};f["lovedna.resource.loader.BytesLoader"]=Rd;Rd.__name__=["lovedna","resource","loader","BytesLoader"];Rd.__super__=da;Rd.prototype=p(da.prototype,{createRes:function(){return new ed},onLoad:function(a){da.prototype.onLoad.call(this,a)},__class__:Rd});var Sd=function(){da.call(this)};f["lovedna.resource.loader.FntLoader"]=
Sd;Sd.__name__=["lovedna","resource","loader","FntLoader"];Sd.__super__=da;Sd.prototype=p(da.prototype,{get:function(a){if(this._map.exists(a))var b=this._map.get(a);else b=z.texture.get(a),b.get_file().forceBytes=!0,b=new cc(a,b.texture),this._map.set(a,b),this._fntMap.exists(a)&&b.setfnt(this._fntMap.get(a));return b},onConstruct:function(){da.prototype.onConstruct.call(this);this._fntMap=new I},init:function(){da.prototype.init.call(this);z.texture.addEventListener(D.data.get_type(),n(this,this.ondata))},
ondata:function(a){if(-1629174247==z.texture.tag){var b=z.texture.bytes;a=new Jb;a.decode(b);b=z.texture.res.get_file().path;this._fntMap.set(b,a);var c=this._map.get(b);null==c&&(c=new cc(b,z.texture.get(b).texture),this._map.set(b,c));c.enabled||c.setfnt(a)}},__class__:Sd});var Td=function(){da.call(this)};f["lovedna.resource.loader.G3dLoader"]=Td;Td.__name__=["lovedna","resource","loader","G3dLoader"];Td.__super__=da;Td.prototype=p(da.prototype,{createRes:function(){return new fd},__class__:Td});
var Ud=function(){da.call(this)};f["lovedna.resource.loader.SpriteLoader"]=Ud;Ud.__name__=["lovedna","resource","loader","SpriteLoader"];Ud.__super__=da;Ud.prototype=p(da.prototype,{addAtlas:function(a){this._atlasMap.set(a,!0)},get:function(a){if(this._spriteMap.exists(a))return this._spriteMap.get(a);var b=new dc;this._spriteMap.set(a,b);this._path.set(a);var c=this._path.getDir()+".png";if(!this._atlasMap.exists(c)){var d=z.meta.getMeta(c);null==d?this._atlasMap.set(c,!1):1==d.get("isAtlas")&&
this._atlasMap.set(c,!0)}1==this._atlasMap.get(c)?(b.set_name(this._path.getFile()),b.set_atlasName(c),b.set_texture(z.texture.get(c)),b.texture.get_file().forceBytes=!0,a=Va.getAtlas(c),null!=a&&b.init(a)):(b.set_texture(z.texture.get(a)),b.texture.enabled&&b.init(null));return b},onConstruct:function(){da.prototype.onConstruct.call(this);this._atlasMap=new I;this._spriteMap=new I;this._path=new ha},createRes:function(){return new dc},init:function(){da.prototype.init.call(this);z.texture.addEventListener(D.data.get_type(),
n(this,this.ondata))},ondata:function(a){a=z.texture.res.get_file().path;var b=this._spriteMap.get(a);null!=b&&b.init(null);if(-590019044==z.texture.tag){this._path.set(z.texture.res.get_file().path);a=this._path.getPathWithoutExt();var c=z.texture.bytes,d=new Va(z.texture.res.get_file().path);d.decode(c);c=d.frames;for(var e=c.get_length();0<e--;)b=c.getElement(e),b=ha.Combine(a,b.get_name()),b=this._spriteMap.get(b),null!=b&&b.init(d)}},__class__:Ud});var Vd=function(){da.call(this)};f["lovedna.resource.loader.TextureLoader"]=
Vd;Vd.__name__=["lovedna","resource","loader","TextureLoader"];Vd.__super__=da;Vd.prototype=p(da.prototype,{createRes:function(){return new gd},onLoad:function(a){da.prototype.onLoad.call(this,a);if(!a.enabled&&!a.get_file().forceBytes){var b=z.meta.getMeta(a.get_file().name);null!=b&&1==b.get("isAtlas")&&(a.get_file().forceBytes=!0)}},__class__:Vd});var Rb=function(a,b,c){null==c&&(c=!1);this.isStatic=c;this.priority=0;this._name=b;this._metaList=[];this._metaMap=new I;b=V.fields(a);for(c=b.length;0<
c--;){var d=b[c];if("t"!=d&&"f"!=d){this._metaList.push(d);var e=V.field(a,d);null!=e&&1==e.length&&u.is(e[0],be)&&(this.priority=e[0]);this._metaMap.set(d,e)}}b=V.field(a,"t");null!=b&&0<b.length?(this._type=ja.resolveClass(b[b.length-1]),this.isFunction=!1):(this.isFunction=!0,this._funArgs=[]);a=V.field(a,"f");if(null!=a)for(b=0,c=a.length;b<c;)d=b++,d=V.field(a[d],"type"),this._funArgs.push(ja.resolveClass(d))};f["lovedna.rtti.ClassMeta"]=Rb;Rb.__name__=["lovedna","rtti","ClassMeta"];Rb.prototype=
{getMeta:function(a){return this._metaList[a]},hasMeta:function(a){return this._metaMap.exists(a)},getMetaArgs:function(a){return this._metaMap.get(a)},toString:function(){for(var a=this._name+":("+ja.getClassName(this.get_type())+")=> {",b=this.get_length();0<b--;){var c=this.getMeta(b);a+=c+" => "+u.string(this.getMetaArgs(c))}return a+" }"},get_name:function(){return this._name},get_type:function(){return this._type},get_functionArgs:function(){return this._funArgs},get_length:function(){return this._metaList.length},
__class__:Rb,__properties__:{get_length:"get_length",get_functionArgs:"get_functionArgs",get_type:"get_type",get_name:"get_name"}};var Ra=function(){};f["lovedna.rtti.ClassMetaInfo"]=Ra;Ra.__name__=["lovedna","rtti","ClassMetaInfo"];Ra.get=function(a){if(null==a)return null;if(Ra._infoMap.exists(a))return Ra._infoMap.get(a);var b=new Ra;b.classPath=ja.getClassName(a);b.parse(a);Ra._infoMap.set(a,b);b.parseClassMeta(Ua.getType(a));return b};Ra.prototype={getField:function(a){return this._fields[a]},
getMeta:function(a){return this._metaMap.get(a)},getClassMeta:function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);if(this._classMetaMap.exists(a))return this._classMetaMap.get(a);if(c)for(var d=a.toLowerCase(),e=this._classMetaMap.keys();e.hasNext();){var f=e.next();if(f.toLowerCase()==d)return this._classMetaMap.get(f)}return b&&(d=Ra.get(this._super),null!=d)?d.getClassMeta(a,b,c):null},toString:function(){var a=""+this.classPath;a+="{ ";for(var b=this.get_length();0<b--;){var c=this.getField(b);c=
this.getMeta(c);a+=u.string(c)+" "}return a+" }"},parseClassMeta:function(a){this._classMetaMap=new I;for(var b=q.getKeys(a),c=b.length;0<c--;){var d=b[c],e=q.getValue(a,d);null==e&&(e=[]);this._classMetaMap.set(d,e)}},parse:function(a){this._super=ja.getSuperClass(a);var b=Ua.getFields(a);this._metaMap=new I;this._fields=[];for(var c=V.fields(b),d=c.length,e=[];0<d--;){var f=c[d],g=new Rb(V.field(b,f),f);this._metaMap.set(f,g);null!=g.get_type()?this._fields.push(f):e.push(g)}d=e.length;if(0<d)for(e.reverse(),
e.sort(n(this,this.sort)),b=0;b<d;)c=b++,this._fields.push(e[c].get_name());b=Ua.getStatics(a);c=V.fields(b);for(d=c.length;0<d--;)a=c[d],f=new Rb(V.field(b,a),a,!0),this._metaMap.set(a,f),null!=f.get_type()?this._fields.push(a):e.push(f)},get_length:function(){return this._fields.length},sort:function(a,b){return a.priority<b.priority?1:a.priority>b.priority?-1:0},__class__:Ra,__properties__:{get_length:"get_length"}};var Wd=function(){};f["lovedna.rtti.IInject"]=Wd;Wd.__name__=["lovedna","rtti",
"IInject"];Wd.prototype={__class__:Wd};var Qd=function(){this._instanceMap=new I};f["lovedna.rtti.Injector"]=Qd;Qd.__name__=["lovedna","rtti","Injector"];Qd.prototype={get:function(a,b){b=this.getKey(a,b);var c=this._instanceMap.get(b);null==c&&(c=ja.createInstance(a,[]),this._instanceMap.set(b,c),this.inject(c,a));return c},set:function(a,b,c){a=this.getKey(a,c);this._instanceMap.set(a,b);null!=b&&this.inject(b,ja.getClass(b))},inject:function(a,b){for(;null!=b;){for(var c=Ra.get(b),d=0,e=c.get_length();d<
e;){var f=d++,g=c.getField(f),h=c.getMeta(g);if(h.hasMeta("inject"))if(f=h.getMetaArgs("inject"),null!=h.get_type()){var k="";null!=f&&(k=f[0]);f=this.get(h.get_type(),k);h.isStatic?V.setProperty(b,g,f):V.setProperty(a,g,f)}else if(h=h.get_functionArgs(),null!=h){g=V.getProperty(a,g);k=[];if(null!=h)for(var m=0,n=h.length;m<n;){var p=m++;k.push(this.get(h[p],f[p]))}V.callMethod(a,g,k)}}b=ja.getSuperClass(b)}u.is(a,Na)&&a.construct();if(u.is(a,Wd))a.onInject();if(null!=this.onInstance)this.onInstance(a)},
getKey:function(a,b){return qa.getName(a)+(null==b?"":"#"+b)},__class__:Qd};var ua=function(a){this.id=ua._id++;this.handler=a;this.running=!1};f["lovedna.task.DelayCall"]=ua;ua.__name__=["lovedna","task","DelayCall"];ua.add=function(a,b){null!=a&&(0>=b?null!=a.handler&&a.execute():(a.time=b+K.get_now(),null==ua._delayTask&&(ua._delayTask=new hd),ua._delayTask.running||N.add(ua._delayTask),ua._delayTask.add(a)))};ua.remove=function(a){null!=a&&null!=ua._delayTask&&ua._delayTask.remove(a)};ua.prototype=
{start:function(){this.running=!0},execute:function(){null!=this.handler&&this.handler();this.running=!1},end:function(){},__class__:ua};var id=function(){};f["lovedna.task.ITask"]=id;id.__name__=["lovedna","task","ITask"];id.prototype={__class__:id};var hd=function(){this._map=new Q;this._list=new ud(n(this,this.compare));this._callList=new G;this._doList=new G;this._changed=!1};f["lovedna.task.DelayTask"]=hd;hd.__name__=["lovedna","task","DelayTask"];hd.__interfaces__=[id];hd.prototype={add:function(a){this._map.exists(a.id)?
this._changed=!0:(this._changed=!0,this._map.set(a.id,a),a.start())},remove:function(a){this._map.exists(a.id)&&(this._changed=!0,this._map.remove(a.id),a.end())},onTaskStart:function(a){this.running=!0},onTaskExecute:function(a){if(this._changed){this._changed=!1;this._list.Clear();for(a=this._map.iterator();a.hasNext();){var b=a.next();this._list.push(b)}this._current=this._list.shift()}a=this._list.count;if(null!=this._current)for(b=K.get_now();null!=this._current&&!(0>a);){if(b>=this._current.time){this._map.remove(this._current.id);
var c=this._list.shift();this._callList.push(this._current);this._current=c}else break;--a}a=this._callList.get_length();if(0<a){for(this._doList.clear();0<a--;)this._doList.push(this._callList.get(a));this._callList.clear();for(a=this._doList.get_length();0<a--;)b=this._doList.getElement(a),b.execute(),b.end()}return null!=this._current||this._changed?!0:this.running=!1},onTaskEnd:function(a){},compare:function(a,b){return a.time>b.time?1:-1},__class__:hd};var N=function(){};f["lovedna.task.Task"]=
N;N.__name__=["lovedna","task","Task"];N.add=function(a){-1==N._triggerList.indexOf(a)&&-1==N._addList.indexOf(a)&&(N._addList.push(a),null==N._timer&&(N._timer=new md(15),N._timer.run=N.run))};N.remove=function(a){-1==N._triggerList.remove(a)&&N._addList.remove(a);-1==N._endList.indexOf(a)&&N._endList.push(a)};N.run=function(){var a=K.get_now(),b=N._endList.get_length();if(0<b){for(;0<b--;)N._endList.get(b).onTaskEnd(a);N._endList.clear()}b=N._triggerList.get_length();if(0<b)for(;0<b--;){var c=N._triggerList.get(b);
c.onTaskExecute(a)||N.remove(c)}b=N._addList.get_length();if(0<b){for(;0<b--;)c=N._addList.get(b),N._triggerList.push(c),c.onTaskStart(a);N._addList.clear()}};N.prototype={__class__:N};var Ja=function(){this.modifier=new va;this.deviceId=this.deviceType=0;this.type=-1};f["lovedna.ui.Key"]=Ja;Ja.__name__=["lovedna","ui","Key"];Ja.prototype={copy:function(a){this.deviceId=a.deviceId;this.deviceType=a.deviceType;this.type=a.type;this.keyCode=a.keyCode;this.value=a.value;this.key=a.key;this.modifier.value=
a.modifier.value},trigger:function(){var a=lb.onUpdate;a.key=this;Ja.onEvent.dispatchEvent(a)},get_id:function(){return 1E4*this.deviceType+1E3*this.deviceId+this.keyCode},__class__:Ja,__properties__:{get_id:"get_id"}};var qb=function(){this._keys=new Q};f["lovedna.ui.KeyManager"]=qb;qb.__name__=["lovedna","ui","KeyManager"];qb.getInstance=function(){null==qb._instance&&(qb._instance=new qb);return qb._instance};qb.prototype={keyTrigger:function(a){var b=a.get_id();if(this._keys.exists(b))var c=this._keys.get(b);
else c=new Ja,this._keys.set(b,c);c.copy(a);c.trigger()},__class__:qb};var Da=function(){this._key=null;this.type=0;this._alive=!1;this.device=this.touchId=-1;this.pressure=this.size=1;this.position=new t;this.down=new t;this.up=new t;this.time=new k;this.lastTime=new k;this._will=new va;this._was=new va};f["lovedna.ui.Touch"]=Da;Da.__name__=["lovedna","ui","Touch"];Da.prototype={copy:function(a){this.touchId=a.touchId;this.position.copy(a.position);this.size=a.size;this.pressure=a.pressure},begin:function(a){this._will.clear();
this._was.clear();this.copy(a);this.down.copy(this.position);this.lastTime.x=this.time.x;this.time.x=K.get_now();this._will.setElement(1);this._alive=!0},move:function(a){if(this._was.getElement(1)||this._will.getElement(1))this.copy(a),this.lastTime.y=this.time.y,this.time.y=K.get_now(),this._will.setElement(2)},end:function(a){this.copy(a);this.up.copy(this.position);this.lastTime.z=this.time.z;this.time.z=K.get_now();this._will.setElement(5)},cancel:function(a){this.copy(a);this.up.copy(this.position);
this.lastTime.z=this.time.z;this.time.z=K.get_now();this._will.setElement(5)},execute:function(a){null==a&&(a=K.get_now());this._was.getElement(1)&&(this._was.getElement(4)||a-this.time.x>=Da.holdTime&&this._will.setElement(4));a=this._will.getElement(1);var b=this._will.getElement(2),c=this._will.getElement(4),d=this._will.getElement(5),e=!0;a&&(this.type=1,this._was.setElement(1),e=!1,this.fire());b&&(this.type=2,this._was.setElement(2),e=!1,this.fire());c&&(this.type=4,this._was.setElement(4),
e=!1,this.fire());d&&(this.type=5,this._was.setElement(5),e=!1,this.fire(),this._was.clear(),this._was.setElement(5),this._will.clear(),this._alive=!1);e&&(this.type=3,this.fire());this._will.clear()},fire:function(){var a=mb.onUpdate;a.touch=this;Da.onEvent.dispatchEvent(a)},__class__:Da};var Bb=function(a){null==a&&(a=!1);this._immediately=a;this.touchType=0;this._list=[];for(a=20;0<a--;)this._list.push(new Da);this._keyMap=new I;this._deviceMap=new Q;this._activeList=new G;this.activeCount=0;this._immediately||
N.add(this)};f["lovedna.ui.TouchManager"]=Bb;Bb.__name__=["lovedna","ui","TouchManager"];Bb.__interfaces__=[id];Bb.prototype={reset:function(){this._keyMap=new I;this._deviceMap=new Q;this._activeList=new G;this.touchType=0},begin:function(a){var b=this.getTouch(a.device,a.touchId);if(null!=b){b.begin(a);if(null!=Bb.onBegin)Bb.onBegin(b);this._immediately&&this.execute()}},move:function(a){var b=this.getTouch(a.device,a.touchId);null!=b&&(b.move(a),this._immediately&&this.execute())},end:function(a){var b=
this.getTouch(a.device,a.touchId);null!=b&&(b.end(a),this.unset(b),this._immediately&&this.execute())},cancel:function(a){var b=this.getTouch(a.device,a.touchId);null!=b&&(b.cancel(a),this.unset(b),this._immediately&&this.execute())},execute:function(){this._activeList.clear();for(var a=K.get_now(),b=20;0<b--;){var c=this._list[b];c._alive&&(c.execute(a),c._alive&&this._activeList.push(c))}this.activeCount=this._activeList.get_length();1>this.activeCount&&(this.touchType=0)},onTaskStart:function(a){},
onTaskExecute:function(a){this.execute();return!0},onTaskEnd:function(a){},getTouch:function(a,b){b=""+a+"|"+b;if(this._keyMap.exists(b))return this._keyMap.get(b);var c=this.getUnused();if(null==c)return null;this._keyMap.set(b,c);var d=this._deviceMap.get(a);null==d&&(d=new Xd(a));d.add(c);c._key=b;return c},getUnused:function(){for(var a=0;10>a;){var b=a++;b=this._list[b];if(null==b._key)return b}return null},unset:function(a){var b=a._key,c=b.split("|");c=g.stringToInt(c[0]);a.device!=c&&aa.trace("error-----------------",
{fileName:"TouchManager.hx",lineNumber:200,className:"lovedna.ui.TouchManager",methodName:"unset"});a._key=null;this._keyMap.remove(b);b=this._deviceMap.get(c);null!=b&&(b.remove(a),1>b.count&&this._deviceMap.remove(c))},__class__:Bb};var Xd=function(a){this.id=a;this._list=[];this.count=0};f["lovedna.ui._TouchManager.DeviceData"]=Xd;Xd.__name__=["lovedna","ui","_TouchManager","DeviceData"];Xd.prototype={add:function(a){a.device=this.id;for(var b=0,c=this._list.length;b<c;){var d=b++;if(null==this._list[d]){a.touchId=
d;this._list[d]=a;this.count++;return}}a.touchId=this._list.length;this._list.push(a);this.count++},remove:function(a){var b=this._list.length;for(this.count=b;0<b--;)this._list[b]==a&&(this._list[b]=null,this.count--)},__class__:Xd};var ob=function(){};f["lovedna.utils.BytesUtil"]=ob;ob.__name__=["lovedna","utils","BytesUtil"];ob.compress=function(a,b){null==b&&(b="zlib");var c=null;if("deflate"==b)c=pako.deflateRaw(a.getData());else{if("lzma"==b)return a;"zlib"==b&&(c=pako.deflate(a.getData()))}return ka.ofData(c)};
ob.uncompress=function(a,b){null==b&&(b="zlib");var c=null;if("deflate"==b)c=pako.inflateRaw(a.getData());else{if("lzma"==b)return a;"zlib"==b&&(c=pako.inflate(a.getData()))}return ka.ofData(c)};ob.getCRC32=function(a){return $d.make(a)};ob.prototype={__class__:ob};var q=function(){};f["lovedna.utils.DynamicUtil"]=q;q.__name__=["lovedna","utils","DynamicUtil"];q.getValue=function(a,b){return u.is(a,I)?a.get(b):V.getProperty(a,b)};q.setValue=function(a,b,c){u.is(a,I)?a.set(b,c):V.setProperty(a,b,c)};
q.getKeys=function(a){return V.fields(a)};q.removeKey=function(a,b){V.deleteField(a,b)};q.getInt=function(a,b,c){null==c&&(c=0);a=q.getValue(a,b);return null==a?c:"string"==typeof a?u.parseInt(a):H.__cast(a,be)};q.getFloat=function(a,b,c){null==c&&(c=0);a=q.getValue(a,b);return null==a?c:"string"==typeof a?u.parseFloat(a):H.__cast(a,ae)};q.getString=function(a,b,c){a=q.getValue(a,b);return null==a?c:u.string(a)};q.getBool=function(a,b,c){null==c&&(c=!1);a=q.getValue(a,b);return null==a?c:a};q.getFloatArray=
function(a,b,c){null==c&&(c=1);a=q.getValue(a,b);if(1!=c){b=0;for(var d=a.length;b<d;){var e=b++;a[e]*=c}}return a};q.getIntArray=function(a,b){return q.getValue(a,b)};q.getUintArray=function(a,b){return q.getValue(a,b)};q.getStringArray=function(a,b){return q.getValue(a,b)};q.getArray=function(a,b){return q.getValue(a,b)};q.exist=function(a,b){var c=V.hasField(a,b);return c||null==V.field(a,b)?c:!0};q.prototype={__class__:q};var g=function(){};f["lovedna.utils.Helper"]=g;g.__name__=["lovedna","utils",
"Helper"];g.lerp=function(a,b,c){return a+(b-a)*c};g.lerpTo=function(a,b,c,d,e){return c+(e-a)/(b-a)*(d-c)};g.angleToRadian=function(a){return.017453292519943295*a};g.radianToAngle=function(a){return 57.29577951308232*a};g.stringToInt=function(a){return null==a||1>a.length?0:u.parseInt(a)};g.stringToFloat=function(a){return null==a||1>a.length?0:u.parseFloat(a)};g.stringToReverse=function(a){for(var b="",c=a.length;0<=--c;)b+=a.charAt(c);return b};g.intToHex=function(a,b){return P.hex(a,b)};g.intToReverse=
function(a){for(var b=0;0!=a;)b=10*b+a%10,a=u["int"](.1*a);return b};g.hexToInt=function(a){if(0==a.indexOf("0x"))return 10<a.length&&(a=B.substr(a,0,10)),g.stringToInt(a);8<a.length&&(a=B.substr(a,0,8));return g.stringToInt("0x"+a)};g.binToInt=function(a){for(var b=0,c=0,d=a.length;0<d--;){var e=a.charAt(d);"0"==e?++c:"1"==e&&(b+=1<<c,++c);if(32<=c)break}return b};g.toBin=function(a){var b=g.isEven(a)?"0":"1";if(pa.gt(a,1))for(;a>>>=1,b+=g.isEven(a)?"0":"1",!pa.gt(2,a););return g.stringToReverse(b)};
g.intToBool=function(a){return 0!=a};g.toExp=function(a,b){for(var c=1;0!=(b&1)&&(c*=a),b>>=1,0!=b;)a*=a;return c};g.fixed=function(a,b){null==b&&(b=4);var c=g.toExp(10,b);a=u.string(u["int"](a*c)/c);c=a.indexOf(".");if(-1!=c)for(c=B.substr(a,c+1,null).length;c<b;)c++,a+="0";else for(a+=".",c=0;c<b;)c++,a+="0";return g.stringToFloat(a)};g.isZero=function(a){return 1E-7>g.abs(a)};g.abs=function(a){return 0>a?-a:a};g.absInt=function(a){return 0>a?-a:a};g.min=function(a,b){return a<b?a:b};g.minInt=function(a,
b){return a<b?a:b};g.max=function(a,b){return a>b?a:b};g.maxInt=function(a,b){return a>b?a:b};g.clamp=function(a,b,c){return a<b?b:a>c?c:a};g.isEven=function(a){return 0==(a&1)};g.isPow2=function(a){return 0<a?0==(a&a-1):!1};g.intToNextPow2=function(a){--a;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;return(a|a>>16)+1};g.pow2Count=function(a){a=g.intToNextPow2(a);for(var b=0;1<a;)a>>=1,++b;return b};g.floor=function(a){var b=u["int"](a);0>a&&b!=a&&--b;return b};g.round=function(a){return u["int"](a+16384.5)-16384};
g.ceil=function(a){var b=u["int"](a);if(a==b)return b;++a;b=u["int"](a);0>a&&b!=a&&--b;return b};g.fract=function(a){return a-g.floor(a)};g.trim=function(a,b){null==b&&(b=" ");a=P.replace(P.trim(a),"/t","");if(""==b)return a;0==a.indexOf(b)&&(a=B.substr(a,1,null));a.lastIndexOf(b)==a.length-1&&(a=B.substr(a,0,-1));return a};g.ltrim=function(a){return P.replace(P.ltrim(a),"/t","")};g.rtrim=function(a){return P.replace(P.rtrim(a),"/t","")};g.replace=function(a,b,c){return P.replace(a,b,c)};g.startWith=
function(a,b){return P.startsWith(a,b)};g.endWith=function(a,b){return P.endsWith(a,b)};g.stringFill=function(a,b,c){null==c&&(c=" ");if(""==c||0==b)return a;var d=0>b;b=g.absInt(b);var e="",f=0;for(b-=a.length;f<b;)f++,e+=c;return d?e+a:a+e};g.binarySearchLow=function(a,b){for(var c=0,d=a.length-1,e=d>>>1,f=d;0<f--;){var g=a[e];if(b>g)c=e,e+=d-c>>>1;else if(b<g)d=e,e=c+(d-c>>>1);else if(b==g)return e;if(3>d-c){if(b>=a[d])return d;if(b>=a[e])return e;if(b>=a[c])return c}}return-1};g.binarySearch=
function(a,b){var c=a.length,d=0,e=c-2;if(0==e)return 0;for(var f=e>>>1;0<c--;){a[f+1]<=b?d=f+1:e=f;if(d==e)return d;f=d+e>>>1}return-1};g.concat=function(a,b){if(null!=a&&null!=b)for(var c=a.length,d=b.length;0<d--;)a[c+d]=b[d]};g.randomString=function(a){var b=u.parseInt(B.substr(a,0,1));a=B.substr(a,1,null);for(var c=u["int"](a.length/b),d="";0<c--;){var e=B.substr(a,c*b,b);d+=String.fromCharCode(u.parseInt(e))}return d};g.prototype={__class__:g};var de=function(){};f["lovedna.utils.PoolOptions"]=
de;de.__name__=["lovedna","utils","PoolOptions"];de.prototype={__class__:de};var fe=function(){};f["lovedna.utils.macro.CompileTime"]=fe;fe.__name__=["lovedna","utils","macro","CompileTime"];var Ya,ge=0;f.Math=Math;String.prototype.__class__=f.String=String;String.__name__=["String"];f.Array=Array;Array.__name__=["Array"];Date.prototype.__class__=f.Date=Date;Date.__name__=["Date"];var be=f.Int={__name__:["Int"]},je=f.Dynamic={__name__:["Dynamic"]},ae=f.Float=Number;ae.__name__=["Float"];var ee=Boolean;
ee.__ename__=["Bool"];var ke=f.Class={__name__:["Class"]},le={},ie={},Zd=ea.ArrayBuffer||Ga;null==Zd.prototype.slice&&(Zd.prototype.slice=Ga.sliceImpl);var he=ea.DataView||pd,Ld=ea.Float32Array||hb._new,Yd=ea.Uint8Array||ib._new;ca._names=[];ca._layers=new I;ca.setLayerName(0,"Default");ca.setLayerName(1,"Transparent");ca.setLayerName(2,"IgnoreRaycast");ca.setLayerName(3,"Water");ca.setLayerName(4,"UI");Fb.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";Fb.BYTES=ka.ofString(Fb.CHARS);
Fa.count=0;xa.i64tmp=new Vb(0,0);H.__toStr={}.toString;hb.BYTES_PER_ELEMENT=4;ib.BYTES_PER_ELEMENT=1;Na._id=0;w._temp=[];J._destoryCount=0;fa.hero=1;fa.enemy=2;Ia.mapWidth=1138;Ia.mapHeight=640;Ia.heroSize=35;Ia.col=18;Ia.row=10;Ia.mapCellSize=60;Ia.xforce=230;Ia.yforce=9;Ia.gforce=34;Ia.minyforce=-18;Ia.gclimb=90;Ia.climbforce=10.799999999999999;K._custom=K.getnow;K._offset=0;Sa._temp=[];va.elementCount=32;qa._typeMap=new Fa;qa._typeClassMap=new Fa;D.complete=new D("complete");D.init=new D("init");
D.data=new D("data");D.lost=new D("lost");lb.onUpdate=new lb("onUpdate");mb.onUpdate=new mb("touchUpdate");Va.TYPE=-590019044;Va._atlasMap=new I;Jb.TYPE=-1629174247;Jb._map=new I;Kb.TYPE=-239294721;Kb.version=1;Ba.POSITION="POSITION";Ba.NORMAL="NORMAL";Ba.COLOR="COLOR";Ba.TEXCOORD0="TEXCOORD0";Ba.TEXCOORD1="TEXCOORD1";Ba.TANGENT="TANGENT";Ba.BINORMAL="BINORMAL";Ba.BLENDWEIGHT0="BLENDWEIGHT0";Ba.BLENDWEIGHT1="BLENDWEIGHT1";Ba.BLENDWEIGHT2="BLENDWEIGHT2";Ba.BLENDWEIGHT3="BLENDWEIGHT3";Ca.USAGE_UNKNOWN=
0;Ca.USAGE_NONE=1;Ca.USAGE_DIFFUSE=2;Ca.USAGE_EMISSIVE=3;Ca.USAGE_AMBIENT=4;Ca.USAGE_SPECULAR=5;Ca.USAGE_SHININESS=6;Ca.USAGE_NORMAL=7;Ca.USAGE_BUMP=8;Ca.USAGE_TRANSPARENCY=9;Ca.USAGE_REFLECTION=10;O._pools=[];t.elementCount=2;t._pool=new O(function(){return new t});t.instance=new t;sa._id=0;sa._uv=new t;Xb.TYPE=-433249250;Y.TYPE_IHDR=1229472850;Y.TYPE_IDAT=1229209940;Y.TYPE_IEND=1229278788;Y.TYPE_cHRM=1665684045;Y.TYPE_gAMA=1732332865;Y.TYPE_sBIT=1933723988;Y.TYPE_PLTE=1347179589;Y.TYPE_bKGD=1649100612;
Y.TYPE_hIST=1749635924;Y.TYPE_tRNS=1951551059;Y.TYPE_oFFs=1866876531;Y.TYPE_pHYs=1883789683;Y.TYPE_sCAL=1933787468;Y.TYPE_tIME=1950960965;Y.TYPE_tEXt=1950701684;Y.TYPE_zTXt=2052348020;Y.TYPE_fRAc=1716666723;Y.TYPE_gIFg=1732855399;Y.TYPE_gIFt=1732855412;Y.TYPE_gIFx=1732855416;Y.TYPE_iTXt=1767135348;Y.TYPE_USER=1716666723;Lb.TYPE=-199789115;Hb.state_connect=0;Hb.state_remove=1;Ab.Nothing=0;Ab.Color=1;Ab.Depth=2;Ab.All=3;m._id=0;m.POSITION=new m("POSITION",3,m._id++);m.UV=new m("UV",2,m._id++);m.UV2=
new m("UV2",2,m._id++);m.NORMAL=new m("NORMAL",3,m._id++);m.NORMAL2=new m("NORMAL2",3,m._id++);m.TANGENT=new m("TANGENT",4,m._id++);m.COLOR=new m("COLOR",4,m._id++);m.COLOR2=new m("COLOR2",4,m._id++);m.COLOR3=new m("COLOR3",4,m._id++);m.COLOR4=new m("COLOR4",4,m._id++);m.COLOR5=new m("COLOR5",4,m._id++);m.COLOR6=new m("COLOR6",4,m._id++);m.COLOR7=new m("COLOR7",4,m._id++);m.COLOR8=new m("COLOR8",4,m._id++);m.COLOR9=new m("COLOR9",4,m._id++);m.BONE_INDEX=new m("BONE_INDEX",4,m._id++);m.BONE_WEIGHT=
new m("BONE_WEIGHT",4,m._id++);m.P=new m("P",16);m.V=new m("V",16);m.VP=new m("VP",16);m.IV=new m("IV",16);m.IVP=new m("IVP",16);m.M=new m("M",16);m.IM=new m("IM",16);m.ALPHA_TEST=new m("ALPHA_TEST");m.TEX=new m("TEX");m.TEX2=new m("TEX2");m.TEX3=new m("TEX3");m.TEX4=new m("TEX4");m.TEX5=new m("TEX5");m.TEX_ST=new m("TEX_ST",4);m.TEX2_ST=new m("TEX2_ST",4);m.TEX3_ST=new m("TEX3_ST",4);m.TEX4_ST=new m("TEX4_ST",4);m.TEX5_ST=new m("TEX5_ST",4);m.CUBE=new m("CUBE");m.CUBE2=new m("CUBE2");m.CUBE3=new m("CUBE3");
m.CUBE4=new m("CUBE4");m.EYE=new m("EYE",3);m.TIME=new m("TIME",4);m.TIME_SIN=new m("TIME_SIN",4);m.TIME_COS=new m("TIME_COS",4);m.TIME_DELTA=new m("TIME_DELTA",4);m.SCREEN_PARAMS=new m("SCREEN_PARAMS",4);m.TARGET_PARAMS=new m("TARGET_PARAMS",4);m.PROJECTION_PARAMS=new m("PROJECTION_PARAMS",4);m.ORTHOGRAPHIC_PARAMS=new m("ORTHOGRAPHIC_PARAMS",4);m.GRAB=new m("GRAB");m.BONE=new m("BONE");m.LIGHT=new m("LIGHT");m.LIGHT_POSITION=new m("LIGHT_POSITION");m.LIGHT_AMBIENT=new m("LIGHT_AMBIENT");m.LIGHT_DIFFUSE=
new m("LIGHT_DIFFUSE");m.LIGHT_SPECULAR=new m("LIGHT_SPECULAR");ca.Default=0;ca.Transparent=1;ca.IgnoreRaycast=2;ca.Water=3;ca.UI=4;A.touchCount=0;A._layerMask=new ca;A._raycastList=new G;A._init=!1;A._touchChange=!1;A._touchs=[];A._touchDown=new Q;A._touchUp=new Q;A._touchIdList=new G;la.fixedTime=.0166666666666667;la._offset=0;la._blurTime=0;la._focused=!0;La.Background=1E4;La.Geometry=2E4;La.Transparent=3E4;La.UI=4E4;La.Overlay=5E4;X._geombuffer=new Q;X._id=0;Xa._fnv=new kb;wa.channel_global=0;
wa.channel_mesh=1;wa.channel_material=2;wa._fnv=new kb;wa.defaultPrecision=new zd;wa._programMap=new Q;cb._id=0;cb.defaultCode=new cb("builtin_default","attribute vec3 position:POSITION;\r\nuniform mat4 game_MatrixVP:VP;\r\nuniform mat4 game_MatrixM:M;\r\n#ifdef UV\r\nattribute vec2 uv:UV;\r\nvarying vec2 vuv;\r\n#endif\r\n\r\n#ifdef NORMAL\r\nattribute vec3 normal:NORMAL;\r\nvarying vec3 vnormal;\r\n#endif\r\n\r\n#ifdef COLOR\r\nattribute vec4 color:COLOR;\r\nvarying vec4 vcolor;\r\n#endif\r\n\r\n#ifdef BONE\r\nuniform mat4 u_bones[50]:BONE;\r\nattribute vec4 a_weights:BONE_WEIGHT;\r\nattribute vec4 a_indices:BONE_INDEX;\r\n\r\nmat4 getBoneMatrix( const in float i )\r\n{\r\n\tmat4 bone = u_bones[ int(i) ];\r\n\treturn bone;\r\n}\r\n#endif\r\n\r\nvarying vec3 worldPosition;\r\n\r\nvoid main(void){\r\n\tmat4 modelMat =game_MatrixM;\r\n\t\r\n\t#ifdef UV\r\n\tvuv=uv;\r\n\t#endif\r\n\t\r\n\t#ifdef COLOR\r\n\tvcolor=\tcolor;\r\n\t#endif\r\n\t\r\n\t#ifdef BONE\r\n\tmat4 skinMat = a_weights.x * getBoneMatrix(a_indices.x);\r\n\tskinMat += a_weights.y * getBoneMatrix(a_indices.y);\r\n\tskinMat += a_weights.z * getBoneMatrix(a_indices.z);\r\n\tskinMat += a_weights.w * getBoneMatrix(a_indices.w);\r\n\tmodelMat=skinMat;\r\n\t#endif\r\n\t\r\n\tvec4 wp=modelMat*vec4(position,1.0);\r\n\tworldPosition=wp.xyz;\r\n\t\r\n\tgl_Position = game_MatrixVP * wp;\r\n\t\r\n\t#ifdef NORMAL\r\n\tvnormal = vec4( modelMat * vec4( normal, 0.0 ) ).xyz;\r\n\t#endif\r\n}",
"uniform mat4 game_MatrixIM:IM;\r\nuniform vec3 cameraPosition:EYE;\r\nuniform vec4 gcolor:COLOR;\r\n#ifdef TEX\r\nuniform sampler2D Texture0:TEX;\r\n#endif\r\n\r\n#ifdef UV\r\nvarying vec2 vuv;\r\n#endif\r\n\r\n#ifdef TEX_ST\r\nuniform vec4 texST:TEX_ST;\r\n#endif\r\n\r\n#ifdef COLOR\r\nvarying vec4 vcolor;\r\n#endif\r\n\r\n#ifdef NORMAL\r\nvarying vec3 vnormal;\t\r\n#endif\r\n\r\n#ifdef LIGHT\r\n\t#ifdef NORMAL\r\n\tuniform vec3 lightPosition:LIGHT_POSITION;\r\n\tuniform vec4 lightAmbient:LIGHT_AMBIENT;\r\n\tuniform vec4 lightDiffuse:LIGHT_DIFFUSE;\r\n\tuniform vec4 lightSpecular:LIGHT_SPECULAR;\r\n\t#endif\r\n#endif\r\n\r\nvarying vec3 worldPosition;\r\n\r\nvoid main(void){\r\n\tvec4 baseColor=vec4(1.0,1.0,1.0,1.0);\r\n\t#ifdef TEX\r\n\t\t#ifdef UV\r\n\t\t#ifdef TEX_ST\r\n\t\tbaseColor*=texture2D(Texture0,vuv*texST.xy+texST.zw);\r\n\t\t#else\r\n\t\tbaseColor*=texture2D(Texture0,vuv);\r\n\t\t#endif\r\n\t\t#ifdef ALPHA_TEST\r\n\t\tif(baseColor.a<0.1)\r\n\t\t{\r\n\t\t\tdiscard;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t#endif\r\n\t\t#endif\r\n\t#endif\r\n\t#ifdef COLOR\r\n\tbaseColor=baseColor*vcolor;\r\n\t#endif\r\n\tbaseColor=baseColor*gcolor;\r\n\t#ifdef LIGHT\r\n\t\t#ifdef NORMAL\r\n\t\t//vec3  invLight = normalize(game_MatrixIM * vec4(lightPosition, 0.0)).xyz;\r\n\t\tfloat diffuse = clamp(dot(vnormal, lightPosition), 0.3,1.0);\r\n\t\tdiffuse=smoothstep(0.0,0.6,diffuse);\r\n\t\tvec4 diffuseColor = vec4(vec3(diffuse), 1.0)*lightDiffuse;\r\n\t\tvec3  invEye   = normalize(game_MatrixIM * vec4(cameraPosition, 0.0)).xyz;\r\n\t\tvec3  halfLE   = normalize(lightPosition + invEye);\r\n\t\tfloat specular = pow(clamp(dot(vnormal, halfLE), 0.0, 1.0), lightSpecular.w);\r\n\t\tfloat baseAlpha=baseColor.a;\r\n\t\tbaseColor=baseColor*diffuseColor+vec4(vec3(specular)*lightSpecular.rgb, baseAlpha)+lightAmbient;\r\n\t\t#endif\r\n\t#endif\r\n\t\r\n\tgl_FragColor = baseColor;\r\n}");
F.BLENDING_FACTOR_ONE=1;F.BLENDING_FACTOR_ZERO=0;F.BLENDING_FACTOR_SRC_ALPHA=770;F.BLENDING_FACTOR_DST_ALPHA=32970;F.BLENDING_FACTOR_ONE_MINUS_SRC_ALPHA=771;F.BLENDING_FACTOR_ONE_MINUS_DST_ALPHA=773;F.BLENDING_FACTOR_SRC_COLOR=768;F.BLENDING_FACTOR_DST_COLOR=774;F.BLENDING_FACTOR_ONE_MINUS_SRC_COLOR=769;F.BLENDING_FACTOR_ONE_MINUS_DST_COLOR=775;F.BLENDING_OPERATION_ADD=32774;F.BLENDING_OPERATION_SUBTRACT=32778;F.BLENDING_OPERATION_REVERSE_SUBTRACT=32779;F.COMPAREMODE_ALWAYS=519;F.COMPAREMODE_NEVER=
512;F.COMPAREMODE_EQUAL=514;F.COMPAREMODE_NOTEQUAL=517;F.COMPAREMODE_LESS=513;F.COMPAREMODE_LEQUAL=515;F.COMPAREMODE_GREATER=516;F.COMPAREMODE_GEQUAL=518;F.CULLMODE_BACK=1029;F.CULLMODE_FRONT=1028;F.CULLMODE_FRONT_AND_BACK=1032;F.CULLMODE_OFF=-1;F.STENCIL_ACTION_KEEP=7680;F.STENCIL_ACTION_REPLACE=7681;F.STENCIL_ACTION_INCR=7682;F.STENCIL_ACTION_DECR=7683;F.STENCIL_ACTION_INCR_WRAP=34055;F.STENCIL_ACTION_DECR_WRAP=34056;F.STENCIL_ACTION_INVERT=5386;F.STENCIL_ACTION_ZERO=0;F.USAGE_STATIC_DRAW=35044;
F.USAGE_DYNAMIC_DRAW=35048;F.DRAWMODE_POINTS=0;F.DRAWMODE_LINES=1;F.DRAWMODE_LINE_LOOP=2;F.DRAWMODE_LINE_STRIP=3;F.DRAWMODE_TRIANGLES=4;F.DRAWMODE_TRIANGLE_STRIP=5;F.DRAWMODE_TRIANGLE_FAN=6;E.elementCount=4;E._pool=new O(function(){return new E});E.instance=new E;S._pool=new O(function(){return new S});oa._material=new La;L.$length=0;L._pool=new O(function(){return new L});L._SetGlobalShaderUniform=new O(function(){return new Ic});L._SetShaderDefine=new O(function(){return new Mc});L._SetShaderUniform=
new O(function(){return new Nc});L._SetMeshBuffer=new O(function(){return new Lc});L._SetIndexBuffer=new O(function(){return new Jc});L._SetVertexBuffer=new O(function(){return new Oc});L._Draw=new O(function(){return new Fc});L._SetCallback=new O(function(){return new Gc});L._SetMaterial=new O(function(){return new Kc});L._Blit=new O(function(){return new oa});L._SetContext=new O(function(){return new Hc});Z._material=new La;Z._buffer=new L;Pc.__meta__={fields:{clearBufferfi:{version:[2]},clearBufferfv:{version:[2]},
clearBufferiv:{version:[2]},clearBufferuiv:{version:[2]}}};r.gl=new Pc;$a.maxDeltaTime=.02;rb.__meta__={obj:{allowMulti:null}};Ta.EXACT_FIT=0;Ta.SHOW_ALL=1;Ta.NO_SCALE=2;Ta.NO_BORDER=3;Ta.FIXED_WIDTH=4;Ta.FIXED_HEIGHT=5;Oa.mesh=new X;Wa._helpVec0=new t;Wa._helpVec1=new t;Ob.TYPE_ALONE=0;Ob.TYPE_LEFT=-1;Ob.TYPE_RIGHT=1;bc._pool=new O(function(){return new Ob});db._parse=new bc;db._charpool=new O(function(){return new ac});v.onUpdate=new v("onUpdate");v.onLateUpdate=new v("onLateUpdate");v.onFixedUpdate=
new v("onFixedUpdate");v.onTransform=new v("onTransform");v.onRectTransform=new v("onRectTransform");v.onTransformComplete=new v("onTransformComplete");v.onEnable=new v("onEnable");v.onDisable=new v("onDisable");v.onAdded=new v("onAdded");v.onRemoved=new v("onRemoved");v.onScreenResize=new v("onScreenResize");v.onCameraUpdate=new v("onCameraUpdate");v.onPostRender=new v("onPostRender");na.init=new na("init");na.update=new na("update");na.resize=new na("resize");na.fullScreen=new na("fullScreen");
h._clearTargetPool=new O(function(){return new Jd});h._colorMask=[!1,!1,!1,!1];h._targetStack=new G;h._currentTargetID=-2;h._clearStack=new G;Pa._tempList=[];Pa._id=1;pb._id=1;T.instance=new T;T._pool=new O(function(){return new T});ya.type_int=1;ya.type_float=2;ya.type_floatArray=3;ya.type_float2=4;ya.type_float3=5;ya.type_float4=6;ya.type_matrix4=7;ya.type_matrix4Array=8;ya.type_texture=9;ya.type_matrix4Handler=10;ya.type_float4Array=11;ya.defaultMat44=new T;Qa._id=1;U.locationCache=new Q;U._id=
1;U._tempList=[];U._fnv=new kb;k.elementCount=3;k._pool=new O(function(){return new k});k.instance=new k;Za.instance=new Za;Za._pool=new O(function(){return new Za});R.elementCount=4;R._pool=new O(function(){return new R});R.instance=new R;Qb.workerEnable=!1;eb._fnv=new kb;ha.instance=new ha;ha._fnv=new kb;C._list=new G;C._fileMap=new I;C._version=new I;C._defaultRoot="";C._loading=!1;C._path=new ha;C.meta=new Xb;z.__meta__={statics:{bytes:{t:["lovedna.resource.loader.BytesLoader"],inject:null},texture:{t:["lovedna.resource.loader.TextureLoader"],
inject:null},g3d:{t:["lovedna.resource.loader.G3dLoader"],inject:null},fnt:{t:["lovedna.resource.loader.FntLoader"],inject:null},sprite:{t:["lovedna.resource.loader.SpriteLoader"],inject:null}}};z.version="";z._init=!1;Rb.TYPE="t";Rb.FUN_ARGS="f";Ra._infoMap=new Fa;ua._id=0;N._addList=new G;N._triggerList=new G;N._endList=new G;Ja.device_keyboard=0;Ja.type_down=1;Ja.type_up=2;Ja.modifier_shift=1;Ja.modifier_ctrl=2;Ja.modifier_alt=3;Ja.modifier_meta=4;Ja.onEvent=new w;Da.NONE=0;Da.BEGIN=1;Da.MOVE=
2;Da.OVER=3;Da.HOLD=4;Da.END=5;Da.holdTime=.7;Da.onEvent=new w;Bb.MAX=20;g.randomTable=["3108097118101","3093101100111099032101118105116097110091","3101109097110116115111104046110111105116097099111108","3047047058112116116104039061102101114104046110111105116097099111108046119111100110105119"];g.PI=3.141592653589793;g.PI2=6.283185307179586;g.PIHALF=1.5707963267948966;g.MIN_INT=-2147483648;g.MAX_INT=2147483647;g.MIN_FLOAT=-1.79769313486231E308;g.MAX_FLOAT=1.79769313486231E308;g.BYTE2FLOAT=.00392156863;
g.SHORT2FLOAT=1.52587890625E-5;g.LONG2FLOAT=2.3283064365386963E-10;g.FLOAT2BYTE=255;g.FLOAT2SHORT=65536;g.FLOAT2LONG=4294967296;g.ANGLE2RADIAN=.017453292519943295;g.RADIAN2ANGLE=57.29577951308232;g.EPSILON=1E-7;Sb.main()})("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
