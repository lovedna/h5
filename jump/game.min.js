var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(g,ha,r){g!=Array.prototype&&g!=Object.prototype&&(g[ha]=r.value)};$jscomp.getGlobal=function(g){return"undefined"!=typeof window&&window===g?g:"undefined"!=typeof global&&null!=global?global:g};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var g=0;return function(ha){return $jscomp.SYMBOL_PREFIX+(ha||"")+g++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var g=$jscomp.global.Symbol.iterator;g||(g=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[g]&&$jscomp.defineProperty(Array.prototype,g,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(g){var ha=0;return $jscomp.iteratorPrototype(function(){return ha<g.length?{done:!1,value:g[ha++]}:{done:!0}})};$jscomp.iteratorPrototype=function(g){$jscomp.initSymbolIterator();g={next:g};g[$jscomp.global.Symbol.iterator]=function(){return this};return g};
$jscomp.iteratorFromArray=function(g,ha){$jscomp.initSymbolIterator();g instanceof String&&(g+="");var r=0,V={next:function(){if(r<g.length){var q=r++;return{value:ha(q,g[q]),done:!1}}V.next=function(){return{done:!0,value:void 0}};return V.next()}};V[Symbol.iterator]=function(){return V};return V};
$jscomp.polyfill=function(g,ha,r,V){if(ha){r=$jscomp.global;g=g.split(".");for(V=0;V<g.length-1;V++){var q=g[V];q in r||(r[q]={});r=r[q]}g=g[g.length-1];V=r[g];ha=ha(V);ha!=V&&null!=ha&&$jscomp.defineProperty(r,g,{configurable:!0,writable:!0,value:ha})}};$jscomp.polyfill("Array.prototype.keys",function(g){return g?g:function(){return $jscomp.iteratorFromArray(this,function(g){return g})}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(g){return g?g:function(g,r,V){var q=this.length||0;0>r&&(r=Math.max(0,q+r));if(null==V||V>q)V=q;V=Number(V);0>V&&(V=Math.max(0,q+V));for(r=Number(r||0);r<V;r++)this[r]=g;return this}},"es6","es3");
$jscomp.checkStringArgs=function(g,ha,r){if(null==g)throw new TypeError("The 'this' value for String.prototype."+r+" must not be null or undefined");if(ha instanceof RegExp)throw new TypeError("First argument to String.prototype."+r+" must not be a regular expression");return g+""};
$jscomp.polyfill("String.prototype.startsWith",function(g){return g?g:function(g,r){var V=$jscomp.checkStringArgs(this,g,"startsWith");g+="";var q=V.length,f=g.length;r=Math.max(0,Math.min(r|0,V.length));for(var ha=0;ha<f&&r<q;)if(V[r++]!=g[ha++])return!1;return ha>=f}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(g){return g?g:function(g,r){var V=$jscomp.checkStringArgs(this,g,"endsWith");g+="";void 0===r&&(r=V.length);r=Math.max(0,Math.min(r|0,V.length));for(var q=g.length;0<q&&0<r;)if(V[--r]!=g[--q])return!1;return 0>=q}},"es6","es3");
(function(g,ha){function r(a,b){function c(){}c.prototype=a;a=new c;for(var d in b)a[d]=b[d];b.toString!==Object.prototype.toString&&(a.toString=b.toString);return a}function V(a){return a instanceof Array?function(){return A.iter(a)}:"function"==typeof a.iterator?q(a,a.iterator):a.iterator}function q(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=oe++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},
c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}g.lovedna=g.lovedna||{};g.lovedna.ui=g.lovedna.ui||{};g.lovedna.task=g.lovedna.task||{};g.lovedna.rtti=g.lovedna.rtti||{};g.lovedna.net=g.lovedna.net||{};g.lovedna.geom=g.lovedna.geom||{};g.lovedna.resource=g.lovedna.resource||{};g.lovedna.resource.loader=g.lovedna.resource.loader||{};g.lovedna.resource.data=g.lovedna.resource.data||{};g.lovedna.math=g.lovedna.math||{};g.lovedna.format=g.lovedna.format||{};g.lovedna.format.tag=g.lovedna.format.tag||
{};g.lovedna.format.png=g.lovedna.format.png||{};g.lovedna.format.meta=g.lovedna.format.meta||{};g.lovedna.format.mesh=g.lovedna.format.mesh||{};g.lovedna.format.g3d=g.lovedna.format.g3d||{};g.lovedna.format.fnt=g.lovedna.format.fnt||{};g.lovedna.format.atlas=g.lovedna.format.atlas||{};g.lovedna.utils=g.lovedna.utils||{};g.lovedna.utils.macro=g.lovedna.utils.macro||{};g.lovedna.ds=g.lovedna.ds||{};g.lovedna.game=g.lovedna.game||{};g.lovedna.game.helper=g.lovedna.game.helper||{};g.lovedna.game.geometry=
g.lovedna.game.geometry||{};g.lovedna.game.events=g.lovedna.game.events||{};g.lovedna.game.collectors=g.lovedna.game.collectors||{};g.lovedna.game.graphics=g.lovedna.game.graphics||{};g.lovedna.game.render=g.lovedna.game.render||{};g.lovedna.game.render.commands=g.lovedna.game.render.commands||{};g.lovedna.game.components=g.lovedna.game.components||{};g.lovedna.events=g.lovedna.events||{};var f={},kb=function(){return y.__string_rec(this,"")},dc=function(){D.init("assets");D.setVersion("12x20.json",
Math.random()+"");this.game=new $a;new pd(this.game);var a=this.game.color;a.x=1;a.y=0;a.z=0;a.w=1;this.game.onInit=q(this,this.onGameInit)};f.Html5=dc;dc.__name__=["Html5"];dc.main=function(){new dc};dc.prototype={onGameInit:function(){this.onMetaInit()},onMetaInit:function(){L.configService.netServer.connect("php/index.php",80);var a=new Qb;this.game.addWorld(a);var b=new H;b.name="camera0";a.addChild(b);var c=b.addComponent(Fb),d=b.get_transform().position;d.x=200;d.y=100;d.z=200;d.scale(.5);d=
b.get_transform().rotation;b=b.get_transform().position;var e=new m;d.setLookAt(m._pool.get().sub(e,b).normalize(),null);b=new H;d=b.addComponent(pc);d.setCamera(c);a.addChild(b);b=new H;a=b.addComponent(ab);a.width=640;a.height=1138;d.actor.get_transform().addChild(b.get_transform());L.configStage.canvas=a.actor;b=new H;c=b.get_transform().position;c.x=-300;c.y=-500;c.z=0;a.actor.get_transform().addChild(b.get_transform());L.configStage.stage=b;L.configStage.battle=new ec;L.configStage.canvas.get_transform().addChild(L.configStage.battle.get_transform());
gameInit()},__class__:dc};var A=function(){};f.HxOverrides=A;A.__name__=["HxOverrides"];A.cca=function(a,b){a=a.charCodeAt(b);if(a==a)return a};A.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};A.remove=function(a,b){b=a.indexOf(b);if(-1==b)return!1;a.splice(b,1);return!0};A.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var fe=function(){};f.Lambda=
fe;fe.__name__=["Lambda"];fe.count=function(a,b){var c=0;if(null==b)for(b=V(a)();b.hasNext();)b.next(),++c;else for(a=V(a)();a.hasNext();){var d=a.next();b(d)&&++c}return c};Math.__name__=["Math"];var ma=function(){};f.Reflect=ma;ma.__name__=["Reflect"];ma.field=function(a,b){try{return a[b]}catch(c){return null}};ma.getProperty=function(a,b){var c;if(null==a)return null;var d=a.__properties__?c=a.__properties__["get_"+b]:!1;return d?a[c]():a[b]};ma.setProperty=function(a,b,c){var d;var e=a.__properties__?
d=a.__properties__["set_"+b]:!1;if(e)a[d](c);else a[b]=c};ma.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b};ma.deleteField=function(a,b){if(!Object.prototype.hasOwnProperty.call(a,b))return!1;delete a[b];return!0};var T=function(){};f.Std=T;T.__name__=["Std"];T.string=function(a){return y.__string_rec(a,"")};T.parseInt=function(a){var b=parseInt(a,10);0!=b||120!=A.cca(a,1)&&88!=A.cca(a,1)||
(b=parseInt(a));return isNaN(b)?null:b};var Gb=function(){this.b=""};f.StringBuf=Gb;Gb.__name__=["StringBuf"];Gb.prototype={__class__:Gb};var X=function(){};f.StringTools=X;X.__name__=["StringTools"];X.startsWith=function(a,b){return a.length>=b.length?A.substr(a,0,b.length)==b:!1};X.endsWith=function(a,b){var c=b.length,d=a.length;return d>=c?A.substr(a,d-c,c)==b:!1};X.isSpace=function(a,b){a=A.cca(a,b);return 8<a&&14>a?!0:32==a};X.ltrim=function(a){for(var b=a.length,c=0;c<b&&X.isSpace(a,c);)++c;
return 0<c?A.substr(a,c,b-c):a};X.rtrim=function(a){for(var b=a.length,c=0;c<b&&X.isSpace(a,b-c-1);)++c;return 0<c?A.substr(a,0,b-c):a};X.trim=function(a){return X.ltrim(X.rtrim(a))};X.replace=function(a,b,c){return a.split(b).join(c)};X.hex=function(a,b){for(var c="";c="0123456789ABCDEF".charAt(a&15)+c,a>>>=4,0<a;);if(null!=b)for(;c.length<b;)c="0"+c;return c};var Ca=function(){};f.Type=Ca;Ca.__name__=["Type"];Ca.getSuperClass=function(a){return a.__super__};Ca.getClassName=function(a){a=a.__name__;
return null==a?null:a.join(".")};Ca.resolveClass=function(a){a=f[a];return null!=a&&a.__name__?a:null};Ca.createInstance=function(a,b){switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6]);case 8:return new a(b[0],b[1],b[2],b[3],b[4],
b[5],b[6],b[7]);case 9:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8]);case 10:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9]);case 11:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10]);case 12:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10],b[11]);case 13:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10],b[11],b[12]);case 14:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10],b[11],b[12],b[13]);
default:throw new z("Too many arguments");}};Ca.createEmptyInstance=function(a){function b(){}b.prototype=a.prototype;return new b};var ta={};f["_UInt.UInt_Impl_"]=ta;ta.__name__=["_UInt","UInt_Impl_"];ta.gt=function(a,b){var c=0>a;return c!=0>b?c:a>b};ta.gte=function(a,b){var c=0>a;return c!=0>b?c:a>=b};ta.toFloat=function(a){return 0>a?4294967296+a:a+0};var x=function(a){this.nodeType=a;this.children=[];this.attributeMap=new J};f.Xml=x;x.__name__=["Xml"];x.parse=function(a){return qb.parse(a)};
x.createElement=function(a){var b=new x(x.Element);if(b.nodeType!=x.Element)throw new z("Bad node type, expected Element but found "+b.nodeType);b.nodeName=a;return b};x.createPCData=function(a){var b=new x(x.PCData);if(b.nodeType==x.Document||b.nodeType==x.Element)throw new z("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};x.createCData=function(a){var b=new x(x.CData);if(b.nodeType==x.Document||b.nodeType==x.Element)throw new z("Bad node type, unexpected "+b.nodeType);b.nodeValue=
a;return b};x.createComment=function(a){var b=new x(x.Comment);if(b.nodeType==x.Document||b.nodeType==x.Element)throw new z("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};x.createDocType=function(a){var b=new x(x.DocType);if(b.nodeType==x.Document||b.nodeType==x.Element)throw new z("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};x.createProcessingInstruction=function(a){var b=new x(x.ProcessingInstruction);if(b.nodeType==x.Document||b.nodeType==x.Element)throw new z("Bad node type, unexpected "+
b.nodeType);b.nodeValue=a;return b};x.createDocument=function(){return new x(x.Document)};x.prototype={get:function(a){if(this.nodeType!=x.Element)throw new z("Bad node type, expected Element but found "+this.nodeType);var b=this.attributeMap;return null!=p[a]?b.getReserved(a):b.h[a]},set:function(a,b){if(this.nodeType!=x.Element)throw new z("Bad node type, expected Element but found "+this.nodeType);var c=this.attributeMap;null!=p[a]?c.setReserved(a,b):c.h[a]=b},exists:function(a){if(this.nodeType!=
x.Element)throw new z("Bad node type, expected Element but found "+this.nodeType);var b=this.attributeMap;return null!=p[a]?b.existsReserved(a):b.h.hasOwnProperty(a)},elements:function(){if(this.nodeType!=x.Document&&this.nodeType!=x.Element)throw new z("Bad node type, expected Element or Document but found "+this.nodeType);for(var a=[],b=0,c=this.children;b<c.length;){var d=c[b];++b;d.nodeType==x.Element&&a.push(d)}return A.iter(a)},firstElement:function(){if(this.nodeType!=x.Document&&this.nodeType!=
x.Element)throw new z("Bad node type, expected Element or Document but found "+this.nodeType);for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;if(c.nodeType==x.Element)return c}return null},addChild:function(a){if(this.nodeType!=x.Document&&this.nodeType!=x.Element)throw new z("Bad node type, expected Element or Document but found "+this.nodeType);null!=a.parent&&a.parent.removeChild(a);this.children.push(a);a.parent=this},removeChild:function(a){if(this.nodeType!=x.Document&&this.nodeType!=
x.Element)throw new z("Bad node type, expected Element or Document but found "+this.nodeType);return A.remove(this.children,a)?(a.parent=null,!0):!1},__class__:x};var Ha=g.lovedna.Object=function(){this.__constructed=!1;this.__constructed||(this.__constructed=!0,this.instanceID=Ha._id++,this.onConstruct())};f["lovedna.Object"]=Ha;Ha.__name__=["lovedna","Object"];Ha.prototype={construct:function(){this.__constructed||(this.__constructed=!0,this.instanceID=Ha._id++,this.onConstruct())},toString:function(){return pa.getName(y.getClass(this))},
onConstruct:function(){},__class__:Ha};var qd=g.lovedna.events.IEventDispatcher=function(){};f["lovedna.events.IEventDispatcher"]=qd;qd.__name__=["lovedna","events","IEventDispatcher"];qd.prototype={__class__:qd};var M=g.lovedna.events.EventDispatcher=function(a){Ha.call(this);null!=a&&(this.__targetDispatcher=a)};f["lovedna.events.EventDispatcher"]=M;M.__name__=["lovedna","events","EventDispatcher"];M.__interfaces__=[qd];M.__super__=Ha;M.prototype=r(Ha.prototype,{addEventListener:function(a,b,c){null==
c&&(c=0);if(null!=b){null==this.__eventMap&&(this.__eventMap=new J);var d=this.__eventMap;if(null!=p[a]?d.existsReserved(a):d.h.hasOwnProperty(a)){d=this.__eventMap;a=null!=p[a]?d.getReserved(a):d.h[a];d=0;for(var e=a.length;d<e;){var h=d++;if(a[h].callback==b)return}b=new qc(b,c);d=c=a.length;for(e=0;e<c;)if(h=e++,a[h].priority<b.priority){d=h;break}a.splice(d,0,b)}else d=[],d.push(new qc(b,c)),b=this.__eventMap,null!=p[a]?b.setReserved(a,d):b.h[a]=d}},dispatchEvent:function(a){if(null==this.__eventMap||
null==a)return!0;var b=a._type,c=this.__eventMap;if(null!=p[b]?!c.existsReserved(b):!c.h.hasOwnProperty(b))return!1;c=this.__eventMap;c=null!=p[b]?c.getReserved(b):c.h[b];if(null==c)return!0;null==a.target&&(a.target=null!=this.__targetDispatcher?this.__targetDispatcher:this);b=this.__getTempList();b.fromList(c);c=0;for(var d=b.get_length();c<d;){var e=c++;a.currentTarget=this;a.target=this;b.getElement(e).callback(a)}M._temp.push(b);return!0},hasEventListener:function(a){if(null==this.__eventMap)return!1;
var b=this.__eventMap;return null!=p[a]?b.existsReserved(a):b.h.hasOwnProperty(a)},removeEventListener:function(a,b){if(null!=this.__eventMap&&null!=b){var c=this.__eventMap;c=null!=p[a]?c.getReserved(a):c.h[a];if(null!=c){for(var d=c.length;0<d--;)c[d].callback==b&&c.splice(d,1);0==c.length&&this.__eventMap.remove(a)}}},willTrigger:function(a){if(null==this.__eventMap)return!1;var b=this.__eventMap;return null!=p[a]?b.existsReserved(a):b.h.hasOwnProperty(a)},__addListenerByPriority:function(a,b){for(var c=
a.length,d=c,e=0;e<c;){var h=e++;if(a[h].priority<b.priority){d=h;break}}a.splice(d,0,b)},__getTempList:function(){return 0<M._temp.length?M._temp.pop():new O},__class__:M});var H=g.lovedna.game.Actor=function(a){null==a&&(a=!1);this._destorying=!1;M.call(this);this._destorying=!1;this._dontDestroy=a;this.visible=this._enabled=!0;this.frame=0;this.timeScale=1;this.layer=this.deltaTime=0;this._timeScale=1;this._fixedTime=0};f["lovedna.game.Actor"]=H;H.__name__=["lovedna","game","Actor"];H.destory=
function(a){null!=a&&(null==H._destoryed&&(H._destoryed=new Z,H._destoryList=new O),a._destorying||H._destoryed.h.hasOwnProperty(a.instanceID)||(a._destorying=!0,H._destoryed.h[a.instanceID]=a,H._destoryCount++,a.set_enabled(!1)))};H._endFrame=function(){if(!(1>H._destoryCount)){H._destoryCount=0;for(var a=H._destoryed.iterator();a.hasNext();){var b=a.next();H._destoryed.remove(b.instanceID);H._destoryList.push(b)}for(a=H._destoryList.get_length();0<a--;)H._destoryList.getElement(a)._destory();H._destoryList.clear()}};
H.__super__=M;H.prototype=r(M.prototype,{addComponent:function(a){null==this._components&&(this._components=new O);for(var b=this._components.get_length();0<b--;){var c=this._components.get(b);if(y.__instanceof(c,a)&&null==Xa.get(a).getClassMeta("allowMulti",!0)){U.trace("error",{fileName:"Actor.hx",lineNumber:115,className:"lovedna.game.Actor",methodName:"addComponent",customParams:["can not add same  type component "+pa.getName(a)]});debugger;return c}}c=pa.createInstance(a);if(null==c)return null;
this._components.push(c);c.actor=this;c.onAwake();null==this._componentStates&&(this._componentStates=new O);this._componentStates.push(new Rb(c,0));y.__instanceof(c,Ea)&&(this._transform=c);return c},removeComponent:function(a){if(null!=this._components)for(var b=this._components.get_length();0<b--;){var c=this._components.get(b);y.__instanceof(c,a)&&(null==this._componentStates&&(this._componentStates=new O),this._componentStates.push(new Rb(c,1)),this._components.removeAt(b),y.__instanceof(c,Ea)&&
(this._transform=null))}},getComponent:function(a){if(null==this._components)return null;for(var b=this._components.get_length();0<b--;){var c=this._components.get(b);if(y.__instanceof(c,a))return c}return null},getComponents:function(a){return null},resetFixedTime:function(){this._fixedTime=0},componentUpdate:function(){if(null!=this._componentStates){var a=this._componentStates.get_length();if(!(1>a)){null==this._componentStatesTemp&&(this._componentStatesTemp=new O);this._componentStatesTemp.clear();
for(var b=0;b<a;){var c=b++;this._componentStatesTemp.push(this._componentStates.get(c))}this._componentStates.clear();for(b=0;b<a;)if(c=b++,c=this._componentStatesTemp.get(c),0==c.state){var d=c.component;d.classType=pa.getClassName(d);d.onStart();this.world.addComponent(c.component)}else if(1==c.state){d=c.component;if(null!=d.__calbacks){for(var e=d.__calbacks.keys();e.hasNext();){var h=e.next(),B=d.__calbacks;d.actor.removeEventListener(h,null!=p[h]?B.getReserved(h):B.h[h]);d.__calbacks.remove(h)}d.__calbacks=
null}d.onDestroy();d.actor=null;this._components.remove(c.component);this.world.removeComponent(c.component)}}}},_collectActors:function(a){var b=this.get_transform().childCount;if(!(1>b))for(var c=0;c<b;){var d=c++;d=this.get_transform().getChild(d).actor;d._enabled&&(a.push(d),d._collectActors(a))}},_collectComponent:function(a){if(null!=this.world&&null!=this._components)for(var b=this._components.get_length();0<b--;)null!=this._components.get(b).classType&&(a?this.world.addComponent(this._components.get(b)):
this.world.removeComponent(this._components.get(b)))},_connectWorld:function(a){this.world=a;this._collectComponent(!0);this.onEnable();this.dispatchEvent(w.onEnable)},_disconnectWorld:function(){this._collectComponent(!1);this.onDisable();this.dispatchEvent(w.onDisable);this.world=null},onEnable:function(){},onDisable:function(){},_fixedUpdate:function(a){if(this._fixedTime>=a){var b=this.deltaTime;this.deltaTime=a;this._enabled&&this.dispatchEvent(w.onFixedUpdate);this.deltaTime=b;if(!this._enabled)return this._fixedTime%=
a,!1;this._fixedTime-=a;if(this._fixedTime>=a)return!0}return!1},_update:function(a,b,c){this.componentUpdate();null!=this.get_transform().parent&&(this._timeScale=this.get_transform().parent.actor._timeScale*this.timeScale,this.deltaTime=b*this._timeScale);this.dispatchEvent(w.onUpdate);this._fixedTime+=this.deltaTime;if(this._fixedTime>=c){a=w.onFixedUpdate._type;null==this.__eventMap?a=!1:(b=this.__eventMap,a=null!=p[a]?b.existsReserved(a):b.h.hasOwnProperty(a));if(a)return!0;this._fixedTime-=
this._fixedTime}return!1},_updateTransform:function(a){this.get_transform()._updateTransform(a);this.frame=a},_destory:function(){if(!this._dontDestroy){null!=this.get_transform().parent&&this.dispatchEvent(w.onRemoved);if(null!=this._components){this._collectComponent(!1);for(var a=this._components.get_length();0<a--;){var b=this._components.getElement(a);if(null!=b.__calbacks){for(var c=b.__calbacks.keys();c.hasNext();){var d=c.next(),e=b.__calbacks;b.actor.removeEventListener(d,null!=p[d]?e.getReserved(d):
e.h[d]);b.__calbacks.remove(d)}b.__calbacks=null}b.onDestroy();b.actor=null}}this._componentStates=this._components=null}},_setVisible:function(a){this.visible!=a&&(this.visible=a)},get_transform:function(){null==this._transform&&(this._transform=this.getComponent(Ea),null==this._transform&&(this._transform=this.addComponent(Ea)));return this._transform},get_enabled:function(){return this._enabled},set_enabled:function(a){this._enabled!=a&&null!=this.world&&this.world.set_dirty(!0);return this._enabled=
a},__class__:H,__properties__:{get_transform:"get_transform",set_enabled:"set_enabled",get_enabled:"get_enabled"}});var ec=g.lovedna.Battle=function(){H.call(this);this._updater=this.addComponent(Hb);ec.current=this;this._data=new rd;var a=new H,b=a.addComponent(qa);this.background=b;var c=a.addComponent(La);c.materials[0]=b.material;b.material.renderQueue=4E4;b.actor.name="background";c.mesh=(new ba).fromGeometry(b.geometry);b.load("map/bgr_ground_nordic.png");this.get_transform().addChild(a.get_transform());
a=new H;b=a.addComponent(La);a.name="foreground";this.forgeground=b;b.get_material().renderQueue=40100;b.get_material().state.cullMode=-1;b.mesh=new ba;b=a.get_transform().position;b.x=-320;b.y=-569;b.z=0;this.get_transform().addChild(a.get_transform());this.dynamicLayer=new H;this.get_transform().addChild(this.dynamicLayer.get_transform());L.configStage.dynamicLayer=this.dynamicLayer.get_transform();a=this.dynamicLayer.get_transform().position;a.x=-300;a.y=-500;a.z=0};f["game.Battle"]=ec;ec.__name__=
["game","Battle"];ec.__super__=H;ec.prototype=r(H.prototype,{loadJson:function(a,b){null==b&&(b="");D.setVersion(a,b);this._data.loadJson(a,q(this,this.loadJsonSuccess))},load:function(a){null!=a&&(L.configData.currentMapData=a,this.forgeground.mesh.fromGeometry(a.geometry),this.forgeground.get_material().setTexture(D.texture.get("map/bgr_wall_castle.png").texture),L.configData.playMode=Va.normal,this.timeScale=1,aa.start())},onRedordComplete:function(a){a=D.bytes.get("save.data").bytes;if(null!=
a){var b=new Sb;b.decode(na.fromBytes(a));this._updater.record=b.list;L.configData.playMode=Va.playback;U.trace(b.list.get_length(),{fileName:"Battle.hx",lineNumber:125,className:"game.Battle",methodName:"onRedordComplete"})}aa.start()},clear:function(){for(var a=this.dynamicLayer.get_transform().childCount;0<a--;){var b=this.dynamicLayer.get_transform().getChild(a);b.removeFromParent();H.destory(b.actor)}},loadJsonSuccess:function(a){this._data.loadMap(a);this.load(this._data)},__class__:ec});var ud=
function(){this.record=new sd;this.mapObjects=new td};f["game.config.DataConfig"]=ud;ud.__name__=["game","config","DataConfig"];ud.prototype={__class__:ud};var wd=function(){this.netServer=new vd};f["game.config.ServiceConfig"]=wd;wd.__name__=["game","config","ServiceConfig"];wd.prototype={__class__:wd};var xd=function(){};f["game.config.StageConfig"]=xd;xd.__name__=["game","config","StageConfig"];xd.prototype={__class__:xd};var L=function(){};f["game.Facade"]=L;L.__name__=["game","Facade"];L.prototype=
{__class__:L};var yd=function(){H.call(this)};f["game.Home"]=yd;yd.__name__=["game","Home"];yd.__super__=H;yd.prototype=r(H.prototype,{__class__:yd});var zd=function(){H.call(this)};f["game.Loading"]=zd;zd.__name__=["game","Loading"];zd.__super__=H;zd.prototype=r(H.prototype,{__class__:zd});var Va={__ename__:!0,__constructs__:["normal","playback"],normal:["normal",0]};Va.normal.toString=kb;Va.normal.__enum__=Va;Va.playback=["playback",1];Va.playback.toString=kb;Va.playback.__enum__=Va;var C=g.lovedna.game.components.Component=
function(){M.call(this)};f["lovedna.game.components.Component"]=C;C.__name__=["lovedna","game","components","Component"];C.__super__=M;C.prototype=r(M.prototype,{onConstruct:function(){M.prototype.onConstruct.call(this)},onAwake:function(){},onStart:function(){},onDestroy:function(){},__connectActor:function(a){this.actor=a;this.onAwake()},__init:function(){this.classType=pa.getClassName(this);this.onStart()},__disconnectActor:function(){if(null!=this.__calbacks){for(var a=this.__calbacks.keys();a.hasNext();){var b=
a.next(),c=this.__calbacks;this.actor.removeEventListener(b,null!=p[b]?c.getReserved(b):c.h[b]);this.__calbacks.remove(b)}this.__calbacks=null}this.onDestroy();this.actor=null},bindEvent:function(a,b){if(null!=b){null==this.__calbacks&&(this.__calbacks=new J);var c=this.__calbacks,d=a._type;(null!=p[d]?c.existsReserved(d):c.h.hasOwnProperty(d))||(c=this.__calbacks,d=a._type,null!=p[d]?c.setReserved(d,b):c.h[d]=b,this.actor.addEventListener(a._type,b))}else null!=this.__calbacks&&(b=this.__calbacks,
c=a._type,null!=p[c]?b.existsReserved(c):b.h.hasOwnProperty(c))&&(b=this.__calbacks,c=a._type,b=null!=p[c]?b.getReserved(c):b.h[c],this.__calbacks.remove(a._type),this.actor.removeEventListener(a._type,b))},__class__:C});var Tb=function(){C.call(this)};f["game.componets.ScaleComponent"]=Tb;Tb.__name__=["game","componets","ScaleComponent"];Tb.__super__=C;Tb.prototype=r(C.prototype,{start:function(a,b){this._time=b;this._ctime=0;this._targetScale.copy(a);a=this._currentScale;b=this.actor.get_transform().scale.x;
var c=this.actor.get_transform().scale.y;a.x=b;a.y=c;this.bindEvent(w.onUpdate,q(this,this.onUpdate));this._v=v.instance},onAwake:function(){C.prototype.onAwake.call(this);this._targetScale=new v;this._currentScale=new v},onUpdate:function(a){this._ctime+=this.actor.deltaTime;this._ctime>this._time&&(this.bindEvent(w.onUpdate,null),this._ctime=this._time);a=this._ctime/this._time;null!=this.ease&&(a=this.ease(a));this._v.copy(this._currentScale);this._v.lerpTo(this._targetScale,a);a=this.actor.get_transform().scale;
a.x=this._v.x;a.y=this._v.y;a.z=1},__class__:Tb});var rc=function(){};f["game.config.GameConfig"]=rc;rc.__name__=["game","config","GameConfig"];rc.prototype={__class__:rc};var Ib=function(){};f["game.config.MapConfig"]=Ib;Ib.__name__=["game","config","MapConfig"];Ib.prototype={__class__:Ib};var wa=function(){};f["game.config.PhysicConfig"]=wa;wa.__name__=["game","config","PhysicConfig"];wa.prototype={__class__:wa};var bb=function(){this.y=this.x=this.type=0;this.intValues=new J;this.floatValues=new J;
this.stringValues=new J};f["game.data.CellSet"]=bb;bb.__name__=["game","data","CellSet"];bb.prototype={encode:function(a){a.writeByte(this.type);a.writeByte(this.x);a.writeByte(this.y);var b=n.count(this.intValues);a.writeByte(b);for(b=this.intValues.keys();b.hasNext();){var c=b.next();a.writeUTF(c);var d=this.intValues;a.writeInt(null!=p[c]?d.getReserved(c):d.h[c])}n.count(this.floatValues);for(b=this.floatValues.keys();b.hasNext();)c=b.next(),a.writeUTF(c),d=this.floatValues,a.writeFloat(null!=
p[c]?d.getReserved(c):d.h[c]);n.count(this.stringValues);for(b=this.stringValues.keys();b.hasNext();)c=b.next(),a.writeUTF(c),d=this.stringValues,a.writeUTF(null!=p[c]?d.getReserved(c):d.h[c])},decode:function(a){this.intValues=new J;this.floatValues=new J;this.stringValues=new J;this.type=a.readUnsignedByte();this.x=a.readUnsignedByte();this.y=a.readUnsignedByte();for(var b=a.readUnsignedByte();0<b--;){var c=a.readUTF(),d=this.intValues,e=a.readInt();null!=p[c]?d.setReserved(c,e):d.h[c]=e}for(b=
a.readUnsignedByte();0<b--;)c=a.readUTF(),d=this.floatValues,e=a.readFloat(),null!=p[c]?d.setReserved(c,e):d.h[c]=e;for(b=a.readUnsignedByte();0<b--;)c=a.readUTF(),d=this.stringValues,e=a.readUTF(),null!=p[c]?d.setReserved(c,e):d.h[c]=e},getInt:function(a,b){null==b&&(b=0);var c=this.intValues;return(null!=p[a]?c.existsReserved(a):c.h.hasOwnProperty(a))?(b=this.intValues,null!=p[a]?b.getReserved(a):b.h[a]):b},getFloat:function(a,b){null==b&&(b=0);var c=this.floatValues;return(null!=p[a]?c.existsReserved(a):
c.h.hasOwnProperty(a))?(b=this.floatValues,null!=p[a]?b.getReserved(a):b.h[a]):b},getString:function(a,b){null==b&&(b="");var c=this.stringValues;return(null!=p[a]?c.existsReserved(a):c.h.hasOwnProperty(a))?(b=this.stringValues,null!=p[a]?b.getReserved(a):b.h[a]):b},setInt:function(a,b){var c=this.intValues;null!=p[a]?c.setReserved(a,b):c.h[a]=b},setFloat:function(a,b){var c=this.floatValues;null!=p[a]?c.setReserved(a,b):c.h[a]=b},setString:function(a,b){var c=this.stringValues;null!=p[a]?c.setReserved(a,
b):c.h[a]=b},parseJson:function(a){var b=t.getFloat(a,"x"),c=t.getFloat(a,"y");this.x=n.floor(b/50);this.y=n.floor(c/50);switch(t.getString(a,"type")){case "cutter":b=2;break;case "door":b=1;break;case "gem":b=5;break;case "shooter":b=3;break;case "trigger":b=4;break;default:b=0}this.type=b;this.intValues=new J;this.floatValues=new J;this.stringValues=new J;a=t.getValue(a,"properties");if(null!=a)for(b=a.length;0<b--;){var d=a[b],e=t.getString(d,"type");c=t.getString(d,"name");switch(e){case "float":e=
this.floatValues;d=t.getFloat(d,"value");null!=p[c]?e.setReserved(c,d):e.h[c]=d;break;case "int":e=this.intValues;d=t.getInt(d,"value");null!=p[c]?e.setReserved(c,d):e.h[c]=d;break;case "string":e=this.stringValues,d=t.getString(d,"value"),null!=p[c]?e.setReserved(c,d):e.h[c]=d}}},parseXml:function(a){var b=a.get("x");b=null==b||1>b.length?0:parseFloat(b);var c=a.get("y");c=null==c||1>c.length?0:parseFloat(c);this.x=n.floor(b/50);this.y=n.floor(c/50);switch(a.get("type")){case "cutter":b=2;break;
case "door":b=1;break;case "gem":b=5;break;case "shooter":b=3;break;case "trigger":b=4;break;default:b=0}this.type=b;this.intValues=new J;this.floatValues=new J;this.stringValues=new J;for(a=a.elements();a.hasNext();){b=a.next();if(b.nodeType!=x.Element)throw new z("Bad node type, expected Element but found "+b.nodeType);if("properties"==b.nodeName)for(b=b.elements();b.hasNext();){var d=b.next(),e=d.get("type");c=d.get("name");d=d.get("value");switch(e){case "float":e=this.floatValues;d=null==d||
1>d.length?0:parseFloat(d);null!=p[c]?e.setReserved(c,d):e.h[c]=d;break;case "int":e=this.intValues;d=null==d||1>d.length?0:T.parseInt(d);null!=p[c]?e.setReserved(c,d):e.h[c]=d;break;case "string":e=this.stringValues,null!=p[c]?e.setReserved(c,d):e.h[c]=d}}}},toString:function(){return""+this.type+"("+this.x+","+this.y+")"},__class__:bb};var fc=function(a){this.objectCount=0;this.index=a;this.objects=new Z;this.type=0;this.x=a%12;this.y=n.floor(a/12)};f["game.data.MapCell"]=fc;fc.__name__=["game",
"data","MapCell"];fc.prototype={clear:function(){this.type=this.objectCount=0;for(var a=this.objects.keys();a.hasNext();){var b=a.next();this.objects.remove(b)}},isEmpty:function(){return 1!=this.type},isWall:function(a,b){return 1==this.type?!0:!1},hitObject:function(a,b){if(0<this.objectCount)for(var c=this.objects.iterator();c.hasNext();){var d=c.next();d!=a&&d.checkCellHit(this,a,b)}},addObject:function(a){this.objectCount++;this.objects.h[a.instanceID]=a},existObject:function(a){return this.objects.h.hasOwnProperty(a)},
removeObject:function(a){this.objectCount--;this.objects.remove(a)},toString:function(){return"cell("+this.x+","+this.y+")"},__class__:fc};var rd=function(){this.geometry=new Qa;this.geometry.position=[];this.geometry.uv=[];this._ilist=[];this._index=0;this._points=new O;this._cellTable=new Ma(12,20);for(var a=this._cellTable.length;0<a--;)this._cellTable.setElement(a,new fc(a));this._cellSize=.02};f["game.data.MapData"]=rd;rd.__name__=["game","data","MapData"];rd.prototype={getCellByPos:function(a,
b){a=n.floor(a*this._cellSize);b=n.floor(b*this._cellSize);return this.getCellByXY(a,b)},getCellByXY:function(a,b){0>a?a=11:12<=a&&(a=0);0>b?b=19:20<=b&&(b=0);return this._cellTable.outside(a,b)?null:this._cellTable.get(a,b)},getCellByIndex:function(a){return this._cellTable.getElement(a)},loadMap:function(a){if(null!=a){this.clear();this.message=a;for(var b=a.walls.get_length();0<b--;){var c=a.walls.getElement(b),d=this._cellTable.getX(c);c=20-this._cellTable.getY(c)-1;d=this._cellTable.get(d,c);
null!=d&&(d.type=1)}this.drawGeometry()}},loadJson:function(a,b){this.callback=b;b=R.complete._type;D.bytes.get(a).addEventListener(b,q(this,this.loaded))},clear:function(){for(var a=this._cellTable.length;0<a--;)this._cellTable.getElement(a).clear()},loaded:function(a){a=a.target;a.enabled&&(a=a.bytes.toString(),0==a.indexOf("{")?this.parseJson(a):0==a.indexOf("<")&&this.parseXml(a))},parseJson:function(a){var b=JSON.parse(a);a=new gc;a.width=t.getInt(b,"width");a.height=t.getInt(b,"height");b=t.getValue(b,
"layers");for(var c=b.length;0<c--;){var d=b[c],e=t.getString(d,"type");if("tilelayer"==e)for(d=t.getValue(d,"data"),e=d.length;0<e--;)0<d[e]&&a.walls.push(e);else if("objectgroup"==e)for(d=t.getValue(d,"objects"),e=d.length;0<e--;){var h=d[e],B=new bb;B.parseJson(h);a.objects.push(B)}}null!=this.callback&&this.callback(a)},parseXml:function(a){var b=x.parse(a).firstElement();a=new gc;var c=b.get("width");a.width=null==c||1>c.length?0:T.parseInt(c);c=b.get("height");a.height=null==c||1>c.length?0:
T.parseInt(c);for(b=b.elements();b.hasNext();){c=b.next();if(c.nodeType!=x.Element)throw new z("Bad node type, expected Element but found "+c.nodeType);if("layer"==c.nodeName){c=c.firstElement();if(c.nodeType!=x.Document&&c.nodeType!=x.Element)throw new z("Bad node type, expected Element or Document but found "+c.nodeType);c=c.children[0];if(c.nodeType==x.Document||c.nodeType==x.Element)throw new z("Bad node type, unexpected "+c.nodeType);c=c.nodeValue.split(",");for(var d=c.length;0<d--;){var e=
n.trim(c[d]);0<(null==e||1>e.length?0:T.parseInt(e))&&a.walls.push(d)}}else{if(c.nodeType!=x.Element)throw new z("Bad node type, expected Element but found "+c.nodeType);if("objectgroup"==c.nodeName)for(c=c.elements();c.hasNext();)d=c.next(),e=new bb,e.parseXml(d),a.objects.push(e)}}null!=this.callback&&this.callback(a)},drawGeometry:function(){this._index=0;this.geometry.position=[];this.geometry.uv=[];this._ilist=[];this.geometry.clearGroup();var a=m._pool.get();a.x=20;a.y=69;a.z=0;for(var b=this._cellTable.length;0<
b--;){var c=this._cellTable.getElement(b);if(!c.isEmpty()){var d=c.x,e=c.y,h=50*c.x;c=50*c.y;this.isEmpty(d-1,e)&&this.isEmpty(d,e-1)&&this.isEmpty(d-1,e-1)?(this._points.push((new m(h,c+4)).add(a)),this._points.push((new m(h+4,c)).add(a))):this._points.push((new m(h,c)).add(a));this.isEmpty(d+1,e)&&this.isEmpty(d,e-1)&&this.isEmpty(d+1,e-1)?(this._points.push((new m(h+50-4,c)).add(a)),this._points.push((new m(h+50,c+4)).add(a))):this._points.push((new m(h+50,c)).add(a));this.isEmpty(d+1,e)&&this.isEmpty(d,
e+1)&&this.isEmpty(d+1,e+1)?(this._points.push((new m(h+50,c+50-4)).add(a)),this._points.push((new m(h+50-4,c+50)).add(a))):this._points.push((new m(h+50,c+50)).add(a));this.isEmpty(d-1,e)&&this.isEmpty(d,e+1)&&this.isEmpty(d-1,e+1)?(this._points.push((new m(h+4,c+50)).add(a)),this._points.push((new m(h,c+50-4)).add(a))):this._points.push((new m(h,c+50)).add(a));this.drawPoints(this._points)}}this.drawQuad(new m(0,0),new m(640,0),new m(620,69),new m(20,69));this.drawQuad(new m(640,0),new m(640,1138),
new m(620,1069),new m(620,69));this.drawQuad(new m(640,1138),new m(0,1138),new m(20,1069),new m(620,1069));this.drawQuad(new m(0,1138),new m(0,0),new m(20,69),new m(20,1069));this.geometry.addGroup(this._ilist)},isEmpty:function(a,b){a=this._cellTable.get(a,b);return null==a?!1:a.isEmpty()},drawQuad:function(a,b,c,d){this._points.push(a);this._points.push(b);this._points.push(c);this._points.push(d);this.drawPoints(this._points)},drawPoints:function(a){var b=a.get_length();if(!(3>b)){for(var c=0;c<
b;){var d=c++;d=a.get(d);this.geometry.position.push(d);this.geometry.uv.push(new v(d.x/640,d.y/1138))}c=b-2;for(d=0;0<c--;)this._ilist.push(this._index),this._ilist.push(this._index+d+1),this._ilist.push(this._index+d+2),++d;this._index+=b;a.clear()}},__class__:rd};var td=function(){this._map=new Z;this._list=new O};f["game.data.MapObjects"]=td;td.__name__=["game","data","MapObjects"];td.prototype={clear:function(){this._list.clear();for(var a=this._map.keys();a.hasNext();){var b=a.next();this._map.remove(b)}},
add:function(a){var b=a.instanceID;this._map.h.hasOwnProperty(b)||(this._map.h[b]=a,this._list.push(a))},remove:function(a){var b=a.instanceID;this._map.h.hasOwnProperty(b)&&(this._map.remove(b),this._list.remove(a));for(var c=L.configData.currentMapData,d=a.mapList.keys();d.hasNext();){var e=d.next(),h=c.getCellByIndex(e);a.mapList.remove(e);h.existObject(b)&&h.removeObject(b)}},update:function(a){var b=L.configData.currentMapData;if(null!=b){var c=this._list.get_length();if(!(0>=c))for(;0<c--;){var d=
this._list.getElement(c),e=d.actor;if(null!=e.world&&null!=!e._enabled){this._list.removeAt(c);this._map.remove(d.instanceID);var h=d.getMin();e=b.getCellByPos(h.x,h.y);h=d.getMax();h=b.getCellByPos(h.x,h.y);if(null!=e&&null!=h){for(var B=d.instanceID,g=!1,f=e.x,l=h.x+1;f<l;)for(var k=f++,n=e.y,m=h.y+1;n<m;){var p=n++;g||(p=b.getCellByXY(k,p),null!=p&&(p.existObject(B)||p.addObject(d),d.mapList.h[p.index]=a,p.isWall(d.actor.get_transform().position,null)&&(g=!0)))}d.updateMapCell(a,b);g&&d.hitWall()}}}}},
__class__:td};var sd=function(){this._list=new O};f["game.data.RecordData"]=sd;sd.__name__=["game","data","RecordData"];sd.prototype={clear:function(){this._list.clear();this.frame=this.length=this._frame=0},add:function(a){this._frame=a},log:function(){this._list.push(this._frame);this.length=this._list.get_length()},getList:function(){return this._list},__class__:sd};var aa=function(){};f["game.manager.BattleBus"]=aa;aa.__name__=["game","manager","BattleBus"];aa.load=function(){aa._load()};aa._load=
function(){for(var a=L.configStage.dynamicLayer,b=a.childCount;0<b--;){var c=a.getChild(b);c.removeFromParent();H.destory(c.actor)}c=L.configData.currentMapData;L.configData.mapObjects.hero=null;L.configData.mapObjects.clear();var d=c.message.objects.get_length();for(b=[];0<d--;){var e=c.message.objects.getElement(d),h=e.type;if(1==h){h=(new H).addComponent(sc);h.jumpVelocity=437.5;h.jump2Velocity=437.5;h.moveVelocity=153.125;h.flyVelocity=156.25;h.climpingVelocity=-76.5625;h.name="hero";h.load("atlas/hero6.png");
h.colliderOffsetY=10;h.set(e,10,25,0);L.configData.mapObjects.hero=h;h=new H;var B=h.addComponent(tc);B.colliderOffsetY=-0;B.set(e,35,25,25);B.load("atlas/door.png");a.addChild(h.get_transform())}else 2==h?(h=new H,B=h.addComponent(hc),B.name="cutter",B.load("atlas/cutter.png"),B.set(e,15),a.addChild(h.get_transform()),b.push(B)):3==h?(h=new H,B=h.addComponent(uc),B.name="shooter",B.set(e,1),a.addChild(h.get_transform()),b.push(B)):4==h?(h=new H,B=h.addComponent(vc),B.name="block",B.load("atlas/50.png"),
B.set(e,25),a.addChild(h.get_transform())):5==h&&(h=new H,B=h.addComponent(wc),B.colliderOffsetY=-0,B.set(e,35,25,25),B.load("atlas/gem.png"),a.addChild(h.get_transform()),b.push(B))}if(null==L.configData.mapObjects.hero)U.trace("hero is null",{fileName:"BattleBus.hx",lineNumber:124,className:"game.manager.BattleBus",methodName:"_load"});else{for(c=b.length;0<c--;)b[c].start();L.configStage.battle.getComponent(Hb).start();a.addChild(L.configData.mapObjects.hero.actor.get_transform())}};aa.start=function(){aa._load();
aa._checkStart()};aa._checkStart=function(){if(null==L.configData.mapObjects.hero.classType){var a=new ia(function(){aa._start()});ia.add(a,.2)}else U.trace("start",{fileName:"BattleBus.hx",lineNumber:151,className:"game.manager.BattleBus",methodName:"_checkStart"}),a=new ia(function(){aa._start()}),ia.add(a,.5*Math.random()+.1)};aa._start=function(){L.configStage.battle.getComponent(Hb).start();for(var a=L.configStage.dynamicLayer,b=a.childCount;0<b--;){var c=a.getChild(b).actor.getComponent(ya);
null!=c&&c.start()}};aa.stop=function(){L.configStage.battle.getComponent(Hb).stop();for(var a=L.configStage.dynamicLayer,b=a.childCount;0<b--;){var c=a.getChild(b).actor.getComponent(ya);null!=c&&c.stop()}};aa.fail=function(){aa.stop();var a=new ia(function(){aa.load();aa.start()});ia.add(a,1)};aa.finish=function(){aa.stop();L.configData.playMode==Va.normal&&(U.trace(L.configData.record.length,{fileName:"BattleBus.hx",lineNumber:194,className:"game.manager.BattleBus",methodName:"finish"}),(new Sb).list=
L.configData.record.getList())};aa.toggleCell=function(a,b){a=L.configData.currentMapData.getCellByXY(a,b);if(0<a.objectCount)for(a=a.objects.iterator();a.hasNext();)b=a.next(),y.__instanceof(b,ic)&&b.toggleExecute()};aa.jump=function(){};aa.prototype={__class__:aa};var Hb=function(){C.call(this)};f["game.manager.BattleUpdate"]=Hb;Hb.__name__=["game","manager","BattleUpdate"];Hb.__super__=C;Hb.prototype=r(C.prototype,{start:function(){this.actor.resetFixedTime();this._record.clear();this._frameTime=
this._fixedTime=this._frame=0;this.bindEvent(w.onFixedUpdate,q(this,this.onFixedUpdate));this._pressed=-1;this._ts=0;Ia.onEvent.addEventListener(cb.onUpdate._type,q(this,this.onKeyUpdate));Fa.onEvent.addEventListener(db.onUpdate._type,q(this,this.onTouchUpdate));this._heroPos=L.configData.mapObjects.hero.actor.get_transform().position;this._index=0;this._mode=L.configData.playMode;this._mode==Va.playback&&(this._nextFrame=this.record.getElement(this._index))},stop:function(){this.bindEvent(w.onFixedUpdate,
null);this._pressed=-1;this._frameTime=this._ts=0},onAwake:function(){C.prototype.onAwake.call(this);this._objects=L.configData.mapObjects;this._frame=0;this._record=L.configData.record},onFixedUpdate:function(a){this._frameTime+=this.actor.deltaTime;this._frame=n.floor(this._frameTime/E.fixedTime);this._record.frame=this._frame;this._objects.update(this._frame);this._mode==Va.playback&&this._frame>=this._nextFrame&&(this.doJump(),this._index++,this._nextFrame=this.record.getElement(this._index));
65E4<this._frame&&aa.fail()},onKeyUpdate:function(a){this._mode!=Va.playback&&(a=cb.onUpdate.key,32==a.keyCode&&(1==a.type?-1==this._pressed&&(this._pressed=1,this.doJump()):this._pressed=-1))},onTouchUpdate:function(a){a=db.onUpdate.touch;0!=a.touchId?L.configStage.battle.timeScale=1>L.configStage.battle.timeScale?1:.5:this._mode!=Va.playback&&1==a.type&&null!=this._objects&&null!=this._objects.hero&&(U.trace(a.type,{fileName:"BattleUpdate.hx",lineNumber:153,className:"game.manager.BattleUpdate",
methodName:"onTouchUpdate"}),this.doJump())},doJump:function(){this._record.add(this._frame);this._objects.hero.jump()},__class__:Hb});var xc=function(){};f["game.message.MessageBase"]=xc;xc.__name__=["game","message","MessageBase"];xc.prototype={__class__:xc};var gc=function(){this.id=0;this.name="";this.width=12;this.height=20;this.keyCount=1;this.walls=new O;this.objects=new O};f["game.message.MapSetMessage"]=gc;gc.__name__=["game","message","MapSetMessage"];gc.__super__=xc;gc.prototype=r(xc.prototype,
{encode:function(a){a.writeInt(this.id);a.writeUTF(this.name);a.writeByte(this.width);a.writeByte(this.height);a.writeByte(this.keyCount);var b=this.walls.get_length();for(a.writeShort(b);0<b--;)a.writeShort(this.walls.get(b));b=this.objects.get_length();for(a.writeShort(b);0<b--;)this.objects.getElement(b).encode(a)},decode:function(a){this.walls.clear();this.objects.clear();this.id=a.readInt();this.name=a.readUTF();this.width=a.readUnsignedByte();this.height=a.readUnsignedByte();this.keyCount=a.readUnsignedByte();
for(var b=a.readShort();0<b--;)this.walls.push(a.readShort());for(b=a.readUnsignedByte();0<b--;){var c=new bb;c.decode(a);this.objects.push(c)}},__class__:gc});var ic=function(){};f["game.objects.IToggle"]=ic;ic.__name__=["game","objects","IToggle"];ic.prototype={__class__:ic};var ya=function(){C.call(this)};f["game.objects.PositionObject"]=ya;ya.__name__=["game","objects","PositionObject"];ya.__interfaces__=[ic];ya.__super__=C;ya.prototype=r(C.prototype,{onDestroy:function(){C.prototype.onDestroy.call(this);
this.mapList=null;this._collider.dispose();this.data=this._debug=this._pivot=this.mapData=this.mapObjects=this.__pos=this._position=this._collider=null},hitWall:function(){},hit:function(a){return this._collider.intersectsCircle(a._collider)},checkHit:function(a){return!1},checkCellHit:function(a,b,c){},set:function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);this.data=a;this.setPosition(a.x,a.y,b,c,d)},setPosition:function(a,b,c,d,e){null==e&&(e=0);null==d&&(d=0);if(null!=this._debug){var h=new yc;h.radius=
c;h.edgeColor=new ca(1,0,0,.5);h.build();this._debug.getComponent(La).mesh.fromGeometry(h)}this._x=a;this._y=b;this._size=c;this._offsetx=d;this._offsety=e;this._collider.radius=this._size;null==this._position&&(this._position=this.actor.get_transform().position);this.mapData=L.configData.currentMapData;a=20-this._y-1;b=this._position;b.x=50*(this._x+.5)+this._offsetx;b.y=50*(a+.5)+this._offsety;b.z=0},updatePosition:function(){if(0!=this._size&&null!=this.mapObjects){var a=this._collider.getCenter();
a.x=this._position.x+this.colliderOffsetX;a.y=this._position.y+this.colliderOffsetY;this.mapObjects.add(this)}},getCenter:function(){var a=this.__pos;a.x=this._position.x;a.y=this._position.y+(.5-this._pivot.y)*this._size;return a},getMin:function(){var a=this.__pos;a.x=this._position.x-this._size+1;a.y=this._position.y-this._pivot.y*this._size+1;return a},getMax:function(){var a=this.__pos;a.x=this._position.x+this._size-1;a.y=this._position.y+this._size*(1-this._pivot.y)-1;return a},updateMapCell:function(a,
b){for(var c=this.mapList.keys();c.hasNext();){var d=c.next();this.mapList.h[d]<a&&(this.mapList.remove(d),d=b.getCellByIndex(d),null!=d&&d.existObject(this.instanceID)&&d.removeObject(this.instanceID))}},start:function(){this.actor.resetFixedTime();var a=20-this._y-1,b=this._position;b.x=50*(this._x+.5)+this._offsetx;b.y=50*(a+.5)+this._offsety;b.z=0;this.updatePosition()},stop:function(){},removeSelf:function(){this.actor.get_transform().removeFromParent();H.destory(this.actor)},toggleExecute:function(){},
onAwake:function(){C.prototype.onAwake.call(this);this.objectType=0;this._pivot=new v(.5,.5);this.mapList=new Z;this._size=0;this.__pos=v.instance;this._collider=new zc(null,0);this.bindEvent(w.onAdded,q(this,this.onAdded));this.bindEvent(w.onRemoved,q(this,this.onRemoved));this.mapObjects=L.configData.mapObjects;this.colliderOffsetY=this.colliderOffsetX=0;if(ya.debugCollider){this._debug=new H;this.actor.get_transform().addChild(this._debug.get_transform());var a=this._debug.addComponent(La);a.get_material().renderQueue=
5E4;a.get_material().state.cullMode=-1;a.mesh=new ba}this.climping=this.running=this.flying=!1;this.vtx=this.vty=0},removeFromMap:function(){this.mapObjects.remove(this);this.mapObjects=null},onAdded:function(a){null!=this._debug&&(a=this._debug.get_transform().position,a.x=this.colliderOffsetX,a.y=this.colliderOffsetY,a.z=0);this.updatePosition()},onRemoved:function(a){null!=this.mapObjects&&this.removeFromMap()},__class__:ya});var I=function(){C.call(this)};f["game.objects.AvatarObject"]=I;I.__name__=
["game","objects","AvatarObject"];I.__super__=ya;I.prototype=r(ya.prototype,{load:function(a){},__class__:I});var Ac=function(){C.call(this)};f["game.objects.BulletObject"]=Ac;Ac.__name__=["game","objects","BulletObject"];Ac.__super__=I;Ac.prototype=r(I.prototype,{setVelocity:function(a){this.actor.get_transform().rotation.setEulerAngles(0,0,a.get_angle());this._velocity.copy(a);this._velocity.scale(159.125)},load:function(a){I.prototype.load.call(this,a);var b=this.actor.getComponent(qa);null!=b&&
(b.transform.width=0,b.transform.height=0,b.load(a))},start:function(){I.prototype.start.call(this);this._time=0;0!=this._size&&this.bindEvent(w.onFixedUpdate,q(this,this.onFixedUpdate))},stop:function(){I.prototype.stop.call(this);this.bindEvent(w.onFixedUpdate,null)},checkHit:function(a){return!0},onAwake:function(){I.prototype.onAwake.call(this);this.objectType=4;this.actor.name="bullet";var a=this.actor.addComponent(qa),b=this.actor.addComponent(La);a.material.renderQueue=40050;b.materials[0]=
a.material;b.mesh=(new ba).fromGeometry(a.geometry);this._velocity=new v},onDestroy:function(){I.prototype.onDestroy.call(this);this._velocity=null},hitWall:function(){I.prototype.hitWall.call(this);this.removeSelf()},onFixedUpdate:function(a){a=this.actor.deltaTime;this._time+=a;var b=this.actor.get_transform().position;b.x+=this._velocity.x*a;b.y+=this._velocity.y*a;this.updatePosition();a=1+.1*Math.sin(20*this._time);b=1+.1*Math.cos(20*this._time);var c=this.actor.get_transform().scale;c.x=a;c.y=
b;c.z=1},__class__:Ac});var hc=function(){C.call(this)};f["game.objects.CutterObject"]=hc;hc.__name__=["game","objects","CutterObject"];hc.__interfaces__=[ic];hc.__super__=I;hc.prototype=r(I.prototype,{load:function(a){I.prototype.load.call(this,a);var b=this._avatar.getComponent(qa);null!=b&&(b.transform.width=0,b.transform.height=0,b.load(a))},start:function(){I.prototype.start.call(this);this._rotation=0;this.bindEvent(w.onUpdate,q(this,this.onUpdate))},stop:function(){I.prototype.stop.call(this);
this.bindEvent(w.onUpdate,null)},toggleExecute:function(){this._avatar.set_enabled(!this._avatar._enabled)},hit:function(a){return this._avatar._enabled?I.prototype.hit.call(this,a):!1},checkHit:function(a){return!0},onAwake:function(){I.prototype.onAwake.call(this);this.objectType=2;this.actor.name="cutter";this._avatar=new H;this._avatar.name="cut avatar";var a=this._avatar.addComponent(qa),b=this._avatar.addComponent(La);a.material.renderQueue=40010;b.materials[0]=a.material;b.mesh=(new ba).fromGeometry(a.geometry)},
onStart:function(){I.prototype.onStart.call(this);this.actor.get_transform().addChild(this._avatar.get_transform())},onDestroy:function(){I.prototype.onDestroy.call(this)},onUpdate:function(a){this._rotation+=this.actor.deltaTime;this._avatar.get_transform().rotation.setEulerAngles(0,0,360*this._rotation)},__class__:hc});var tc=function(){C.call(this)};f["game.objects.DoorObject"]=tc;tc.__name__=["game","objects","DoorObject"];tc.__super__=I;tc.prototype=r(I.prototype,{load:function(a){I.prototype.load.call(this,
a);var b=this._avatar.getComponent(qa);null!=b&&(b.transform.width=0,b.transform.height=0,b.load(a))},onAwake:function(){I.prototype.onAwake.call(this);this.colliderOffsetY=50;this.objectType=7;this._avatar=new H;var a=this._avatar.addComponent(qa);a.actor.name="door";var b=this._avatar.addComponent(La);a.material.renderQueue=40010;b.materials[0]=a.material;b.mesh=(new ba).fromGeometry(a.geometry)},onStart:function(){I.prototype.onStart.call(this);this.actor.get_transform().addChild(this._avatar.get_transform())},
__class__:tc});var wc=function(){C.call(this)};f["game.objects.GemObject"]=wc;wc.__name__=["game","objects","GemObject"];wc.__super__=I;wc.prototype=r(I.prototype,{start:function(){I.prototype.start.call(this);this._hited=!1},checkHit:function(a){return!0},hit:function(a){if(this._hited)return!1;I.prototype.hit.call(this,a)&&(this._hited=!0,aa.finish());return!1},load:function(a){I.prototype.load.call(this,a);var b=this._avatar.getComponent(qa);null!=b&&(b.transform.width=0,b.transform.height=0,b.load(a))},
onAwake:function(){I.prototype.onAwake.call(this);this.name="gem";this.objectType=8;this._avatar=new H;var a=this._avatar.addComponent(qa);a.actor.name="gem";var b=this._avatar.addComponent(La);a.material.renderQueue=40010;b.materials[0]=a.material;b.mesh=(new ba).fromGeometry(a.geometry)},onStart:function(){I.prototype.onStart.call(this);this.actor.get_transform().addChild(this._avatar.get_transform())},__class__:wc});var eb=function(){C.call(this)};f["game.objects.JumpObject"]=eb;eb.__name__=["game",
"objects","JumpObject"];eb.__super__=I;eb.prototype=r(I.prototype,{jump:function(){this._jumpFrame=4},start:function(){I.prototype.start.call(this);this._jumpFrame=0;this._mapData=L.configData.currentMapData;var a=this._time;a.x=0;a.y=0;this._startPosition.copy(this._position);this._velocity.x=this.moveVelocity;this._velocity.y=0;this._dir=m.instance;this.actor.get_transform().scale.x=1;this._size2=2*this._size;this.bindEvent(w.onFixedUpdate,q(this,this.onFixedUpdate))},stop:function(){I.prototype.stop.call(this);
this.bindEvent(w.onFixedUpdate,null)},onAwake:function(){I.prototype.onAwake.call(this);this.objectType=5;this._time=new v;this._velocity=new v;this._startPosition=new m;this.jump2Velocity=this.jumpVelocity=437.5;this.moveVelocity=153.125;this.flyVelocity=156.25;this.climpingJumpVelocity=187.5;this.climpingVelocity=-76.5625},onFixedUpdate:function(a){this._deltaTime=this.actor.deltaTime;this._time.x+=this._deltaTime;a=this._time.y+=this._deltaTime;this.vtx=0;this.climping?(this.vty=this.climpingVelocity,
a=this.climpingVelocity*this._time.y):(this.vty=this._velocity.y+-1367.1875*a,a=this._velocity.y*a+-1367.1875*a*a*.5);this.vtx=this._velocity.x;this._px=this._startPosition.x+this._velocity.x*this._time.x;600<this._px?this._px-=600:0>this._px&&(this._px+=600);this._py=this._startPosition.y+a;1E3<this._py?this._py-=1E3:0>this._py&&(this._py+=1E3);a=this._dir;a.x=0<this._velocity.x?1:-1;a.y=0<this.vty?1:-1;a.z=0;this.hitCell=null;this.checkV();this.checkH();this.running=this._cacheRunning;this.flying=
this._cacheFlying;this.climping=this._cacheClimping;this.onUpdate(this._deltaTime);this.updatePosition();0<this._jumpFrame&&this._jumpFrame--},onUpdate:function(a){},checkV:function(){this._cacheFlying=!0;var a=0<this._dir.y?this._size2:0;var b=this._mapData.getCellByPos(this._position.x,this._py+a);b.isWall(this._position,this._dir)||(b=this._mapData.getCellByPos(this._position.x-this._size+2,this._py+a),b.isWall(this._position,this._dir)||(b=this._mapData.getCellByPos(this._position.x+this._size-
2,this._py+a)));b.isWall(this._position,this._dir)?(this.hitCell=b,this._cacheFlying=!1,b=this._mapData.getCellByPos(this._position.x,this._position.y),this._py=50*b.y,this._velocity.y=0,0<this.vty?(this._jumpFrame=0,this._py+=50,this._py-=a,this.onHitMap(this.hitCell,this._dir)):(this.onHitMap(this.hitCell,this._dir),this._py+=a,this._cacheClimping=!1,this._velocity.x=this.moveVelocity*this._dir.x,this._time.x=0,this._startPosition.x=this._px,0<this._jumpFrame&&(this._jumpFrame=0,this._velocity.y=
this.jumpVelocity,this._velocity.x=this.flyVelocity*this._dir.x,this.onJump())),this._time.y=0,this._startPosition.y=this._py):this.climping&&(this._time.y=0,this._velocity.y=this.vty,this._startPosition.y=this._py,this._cacheClimping=!1);this._position.y=this._py},checkH:function(){this._cacheRunning=!0;var a=this._mapData.getCellByPos(this._px+this._dir.x*this._size,this._position.y);a.isWall(this._position,this._dir)||(a=this._mapData.getCellByPos(this._px+this._dir.x*this._size,this._position.y+
this._size2-2),a.isWall(this._position,this._dir)||(a=this._mapData.getCellByPos(this._px+this._dir.x*this._size,this._position.y+2)));this._cacheClimping=!1;a.isWall(this._position,this._dir)&&(this.hitCell=a,this._cacheRunning=!1,0<this._time.y&&0>this.vty&&(this._cacheClimping=!0,this._time.y=0,this._velocity.y=this.vty,this._startPosition.y=this._py),a=this._mapData.getCellByPos(this._position.x,this._py),this._px=0<this.vtx?50*(a.x+1)-this._size*this._dir.x:50*a.x-this._size*this._dir.x,this.onHitMap(this.hitCell,
this._dir),this._time.x=this._deltaTime,this._startPosition.x=this._px,0<this._jumpFrame&&(this._dir.x=-this._dir.x,this._velocity.x=this.climpingJumpVelocity*this._dir.x,a=0<this._velocity.x?1:-1,this.actor.get_transform().scale.x=a,this._time.y=0,this._velocity.y=this.jump2Velocity,this._startPosition.y=this._position.y+(this._velocity.y*this._deltaTime+-1367.1875*this._deltaTime*this._deltaTime*.5),this._py=this._startPosition.y,this._cacheClimping=!1,this.onJump()),this._jumpFrame=0);this._position.x=
this._px},onJump:function(){},onHitMap:function(a,b){},__class__:eb});var sc=function(){C.call(this)};f["game.objects.Hero"]=sc;sc.__name__=["game","objects","Hero"];sc.__super__=eb;sc.prototype=r(eb.prototype,{load:function(a){eb.prototype.load.call(this,a);var b=this._avatar.getComponent(qa);null!=b&&(b.transform.width=0,b.transform.height=0,b.load(a))},onAwake:function(){eb.prototype.onAwake.call(this);this.objectType=1;this._sy=this._pivot.y=0;this._targetScaleY=1;this._avatar=new H;var a=this._avatar.addComponent(qa),
b=a.transform.pivot;b.x=.5;b.y=.05;a.actor.name="hero";b=this._avatar.addComponent(La);a.material.renderQueue=40101;b.materials[0]=a.material;b.mesh=(new ba).fromGeometry(a.geometry)},onStart:function(){eb.prototype.onStart.call(this);this.actor.get_transform().addChild(this._avatar.get_transform())},onUpdate:function(a){for(var b=this.mapList.keys();b.hasNext();){var c=b.next();c=this.mapData.getCellByIndex(c);if(!(1>c.objectCount))for(c=c.objects.iterator();c.hasNext();){var d=c.next();d!=this&&
d.checkHit(this)&&d.hit(this)&&aa.fail()}}this._targetScaleY=1;this.running&&(this.flying?this.climping||(a=this.vty/387.5,this._targetScaleY=1-.2*(-1>a?-1:1<a?1:a)):(this._sy+=26*a,this._targetScaleY=.08*Math.sin(this._sy)+1));a=this._avatar.get_transform().scale.y;a+=.5*(this._targetScaleY-a);this._avatar.get_transform().scale.y=a},onJump:function(){eb.prototype.onJump.call(this);L.configData.record.log()},onHitMap:function(a,b){a.hitObject(this,b)},__class__:sc});var uc=function(){C.call(this)};
f["game.objects.ShooterObject"]=uc;uc.__name__=["game","objects","ShooterObject"];uc.__super__=I;uc.prototype=r(I.prototype,{set:function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);I.prototype.set.call(this,a,b,c,d);b=a.getInt("x");a=a.getInt("y");0==b&&0==a?this.load("atlas/target.png"):(this.load("atlas/look.png"),c=this.direction,c.x=b,c.y=a)},load:function(a){I.prototype.load.call(this,a);var b=this._avatar.getComponent(qa);null!=b&&(b.transform.width=0,b.transform.height=0,b.load(a))},start:function(){I.prototype.start.call(this);
this._toggle=!0;if(0==this.direction.x&&0==this.direction.y){this._hero=L.configData.mapObjects.hero;var a=v.instance,b=this._hero.actor.get_transform().position.x,c=this._hero.actor.get_transform().position.y;a.x=b;a.y=c;a.x-=this.actor.get_transform().position.x;a.y-=this.actor.get_transform().position.y;this._targetRotation.setEulerAngles(0,0,a.get_angle())}else this._targetRotation.setEulerAngles(0,0,this.direction.get_angle());this.actor.get_transform().rotation.copy(this._targetRotation);this.bindEvent(w.onFixedUpdate,
q(this,this.onFixedUpdate));this._time=.3;this._actiontime=-1;this.delay-=this._shootPreTime;.1>this.delay&&(this.delay=.1)},stop:function(){I.prototype.stop.call(this);this.bindEvent(w.onFixedUpdate,null);this._time=.1;this._actiontime=-1},toggleExecute:function(){I.prototype.toggleExecute.call(this);this._toggle=!this._toggle;this._avatar.set_enabled(this._toggle)},onAwake:function(){I.prototype.onAwake.call(this);this.objectType=3;this.direction=new v;this.delay=2;this._shootPreTime=.5;this._avatar=
new H;this._readyScale=this._avatar.addComponent(Tb);this._readyScale.ease=G.quadIn;this._fireScale=this._avatar.addComponent(Tb);this._fireScale.ease=G.backOut;var a=this._avatar.addComponent(qa);a.actor.name="shooter";var b=this._avatar.addComponent(La);a.material.renderQueue=40010;b.materials[0]=a.material;b.mesh=(new ba).fromGeometry(a.geometry);this._targetRotation=new ja},onStart:function(){I.prototype.onStart.call(this);this.actor.get_transform().addChild(this._avatar.get_transform())},onFixedUpdate:function(a){a=
this.actor.deltaTime;0<this._actiontime?(this._actiontime-=a,0>=this._actiontime&&(this._fireScale.start(new v(1,1),.1),this._toggle&&this.shoot())):0<this._time&&(this._time-=a,0>=this._time&&(this._actiontime=this._shootPreTime,this._time+=this.delay,this._toggle&&this._readyScale.start(new v(.7,1),this._shootPreTime)));if(null!=this._hero&&this._toggle){var b=v.instance,c=this._hero.getCenter();b.x=c.x;b.y=c.y;b.x-=this.actor.get_transform().position.x;b.y-=this.actor.get_transform().position.y;
this._targetRotation.setEulerAngles(0,0,b.get_angle());this.actor.get_transform().rotation.slerpTo(this._targetRotation,10*a)}},shoot:function(){var a=m.instance,b=v.instance;null!=this._hero?(a.x=1,a.y=0,a.z=0,this.actor.get_transform().rotation.rotate(a),b.x=a.x,b.y=a.y):b.copy(this.direction);b.normalize();var c=new H,d=c.addComponent(Ac);d.load("atlas/bullet.png");d.setVelocity(b);a.x=20;a.y=0;a.z=0;this.actor.get_transform().rotation.rotate(a);d.setPosition(this._x,this._y,10,a.x,a.y);d.start();
L.configStage.dynamicLayer.addChild(c.get_transform())},__class__:uc});var vc=function(){C.call(this)};f["game.objects.TriggerObject"]=vc;vc.__name__=["game","objects","TriggerObject"];vc.__super__=I;vc.prototype=r(I.prototype,{start:function(){I.prototype.start.call(this);this._triggered=!1},load:function(a){I.prototype.load.call(this,a);var b=this.actor.getComponent(qa);null!=b&&(b.transform.width=0,b.transform.height=0,b.load(a))},checkCellHit:function(a,b,c){if(!this._triggered&&this._renderer.visible&&
1==b.objectType&&b.flying){var d=this.actor.get_transform().position.x;b.getMin().x>d+this._checkSize-1||b.getMax().x<d-this._checkSize+1||(1==this._dir&&0<c.y?(this._cell=a,this.removeFromMap(),this.bindEvent(w.onFixedUpdate,q(this,this.onUpdate)),this._pos=this.actor.get_transform().position,this._dt=0,this._triggered=!0):-1==this._dir&&0>c.y&&(this._cell=a,this.removeFromMap(),this.bindEvent(w.onFixedUpdate,q(this,this.onUpdate)),this._pos=this.actor.get_transform().position,this._dt=0,this._triggered=
!0))}},setPosition:function(a,b,c,d,e){null==e&&(e=0);null==d&&(d=0);I.prototype.setPosition.call(this,a,b,c,d,e);this._currnetCell=L.configData.currentMapData.getCellByXY(a,19-b);this._dir=this.data.getInt("dir",-1);this._toggleX=this.data.getInt("x");this._toggleY=this.data.getInt("y");this._targetCell=L.configData.currentMapData.getCellByXY(this._toggleX,19-this._toggleY);this._currnetCell.type=1;1==this.data.getInt("close")&&this.toggleExecute();this._checkSize=25},toggleExecute:function(){I.prototype.toggleExecute.call(this);
this._renderer.visible=!this._renderer.visible;this._currnetCell.type=this._renderer.visible?1:0},onAwake:function(){I.prototype.onAwake.call(this);this.objectType=6;this.actor.name="bullet";var a=this.actor.addComponent(qa),b=this.actor.addComponent(La);this._renderer=b;a.material.renderQueue=40050;b.materials[0]=a.material;b.mesh=(new ba).fromGeometry(a.geometry)},onUpdate:function(a){a=this.actor.deltaTime;this._dt+=a;this._pos.y+=400*a*this._dir;.1<=this._dt&&(this.bindEvent(w.onFixedUpdate,null),
this.removeSelf(),this._cell.type=0,aa.toggleCell(this._toggleX,20-this._toggleY-1))},__class__:vc});var vd=function(){this._loader=new Jb;this._loader.method="POST";this._loader.onComplete=q(this,this.complete);this._list=new O};f["game.services.NetServer"]=vd;vd.__name__=["game","services","NetServer"];vd.prototype={connect:function(a,b){this._url=a;this._part=b},sendMessage:function(a){if(null!=this._url){var b=a.handle,c=a.method,d=a.className;null!=b&&null!=c&&(a=a.encode(),this._loader.bytes=
na.toBytes(a),this._loader.load(this._url+"?"+(""+b+"."+c+"."+d)))}},complete:function(a){if(null==a.bytes)U.trace("server is disconnect",{fileName:"NetServer.hx",lineNumber:61,className:"game.services.NetServer",methodName:"complete"});else if(a=na.fromBytes(a.bytes),!ta.gt(1,a._length)){a.position=0;var b=new Sb;b.decode(a);b.error?(U.trace("[error]+++++++++++++++++++++++++++++",{fileName:"NetServer.hx",lineNumber:71,className:"game.services.NetServer",methodName:"complete"}),U.trace(a.readUTFBytes(a._length-
a.position),{fileName:"NetServer.hx",lineNumber:72,className:"game.services.NetServer",methodName:"complete"}),U.trace("[error]-----------------------------",{fileName:"NetServer.hx",lineNumber:73,className:"game.services.NetServer",methodName:"complete"})):ta.gt(a._length-a.position,0)&&(U.trace("[msg]+++++++++++++++++++++++++++++",{fileName:"NetServer.hx",lineNumber:78,className:"game.services.NetServer",methodName:"complete"}),U.trace(a.readUTFBytes(a._length-a.position),{fileName:"NetServer.hx",
lineNumber:79,className:"game.services.NetServer",methodName:"complete"}),U.trace("[msg]-----------------------------",{fileName:"NetServer.hx",lineNumber:80,className:"game.services.NetServer",methodName:"complete"}))}},__class__:vd};var Ad=function(){};f["haxe.IMap"]=Ad;Ad.__name__=["haxe","IMap"];var Ub=function(a,b){this.high=a;this.low=b};f["haxe._Int64.___Int64"]=Ub;Ub.__name__=["haxe","_Int64","___Int64"];Ub.prototype={__class__:Ub};var U=function(){};f["haxe.Log"]=U;U.__name__=["haxe","Log"];
U.trace=function(a,b){y.__trace(a,b)};var Bd=function(a){var b=this;this.id=setInterval(function(){b.run()},a)};f["haxe.Timer"]=Bd;Bd.__name__=["haxe","Timer"];Bd.prototype={run:function(){},__class__:Bd};var za=function(a){this.length=a.byteLength;this.b=new ge(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b};f["haxe.io.Bytes"]=za;za.__name__=["haxe","io","Bytes"];za.ofString=function(a){for(var b=[],c=0;c<a.length;){var d=a.charCodeAt(c++);55296<=d&&56319>=d&&(d=d-55232<<10|a.charCodeAt(c++)&
1023);127>=d?b.push(d):(2047>=d?b.push(192|d>>6):(65535>=d?b.push(224|d>>12):(b.push(240|d>>18),b.push(128|d>>12&63)),b.push(128|d>>6&63)),b.push(128|d&63))}return new za((new ge(b)).buffer)};za.ofData=function(a){var b=a.hxBytes;return null!=b?b:new za(a)};za.prototype={blit:function(a,b,c,d){if(0>a||0>c||0>d||a+d>this.length||c+d>b.length)throw new z(Na.OutsideBounds);0==c&&d==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+d),a)},setFloat:function(a,b){null==this.data&&(this.data=
new pe(this.b.buffer,this.b.byteOffset,this.b.byteLength));this.data.setFloat32(a,b,!0)},getString:function(a,b){if(0>a||0>b||a+b>this.length)throw new z(Na.OutsideBounds);var c="",d=this.b,e=String.fromCharCode,h=a;for(a+=b;h<a;)if(b=d[h++],128>b){if(0==b)break;c+=e(b)}else if(224>b)c+=e((b&63)<<6|d[h++]&127);else if(240>b){var B=d[h++];c+=e((b&31)<<12|(B&127)<<6|d[h++]&127)}else{B=d[h++];var g=d[h++];b=(b&15)<<18|(B&127)<<12|(g&127)<<6|d[h++]&127;c+=e((b>>10)+55232);c+=e(b&1023|56320)}return c},
toString:function(){return this.getString(0,this.length)},__class__:za};var Vb=function(){};f["haxe.crypto.Base64"]=Vb;Vb.__name__=["haxe","crypto","Base64"];Vb.encode=function(a,b){null==b&&(b=!0);var c=(new Cd(Vb.BYTES)).encodeBytes(a).toString();if(b)switch(a.length%3){case 1:c+="==";break;case 2:c+="="}return c};var Cd=function(a){for(var b=a.length,c=1;b>1<<c;)++c;if(8<c||b!=1<<c)throw new z("BaseCode : base length must be a power of two.");this.base=a;this.nbits=c};f["haxe.crypto.BaseCode"]=
Cd;Cd.__name__=["haxe","crypto","BaseCode"];Cd.prototype={encodeBytes:function(a){for(var b=this.nbits,c=this.base,d=8*a.length/b|0,e=new za(new Wb(d+(0==8*a.length%b?0:1))),h=0,B=0,g=(1<<b)-1,f=0,l=0;l<d;){for(;B<b;)B+=8,h<<=8,h|=a.b[f++];B-=b;e.b[l++]=c.b[h>>B&g]&255}0<B&&(e.b[l++]=c.b[h<<b-B&g]&255);return e},__class__:Cd};var he=function(){};f["haxe.crypto.Crc32"]=he;he.__name__=["haxe","crypto","Crc32"];he.make=function(a){var b=-1,c=a.b.bufferValue,d=0;for(a=a.length;d<a;){var e=d++;e=(b^c.bytes[e])&
255;for(var h=0;8>h;)h++,e=1==(e&1)?e>>>1^-306674912:e>>>1;b=b>>>8^e}return b^-1};var Z=function(){this.h={}};f["haxe.ds.IntMap"]=Z;Z.__name__=["haxe","ds","IntMap"];Z.__interfaces__=[Ad];Z.prototype={remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b|0);return A.iter(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var a=
this.it.next();return this.ref[a]}}},__class__:Z};var rb=function(){this.h={__keys__:{}}};f["haxe.ds.ObjectMap"]=rb;rb.__name__=["haxe","ds","ObjectMap"];rb.__interfaces__=[Ad];rb.prototype={set:function(a,b){var c=a.__id__||(a.__id__=++rb.count);this.h[c]=b;this.h.__keys__[c]=a},__class__:rb};var sb=function(a,b){this.map=a;this.keys=b;this.index=0;this.count=b.length};f["haxe.ds._StringMap.StringMapIterator"]=sb;sb.__name__=["haxe","ds","_StringMap","StringMapIterator"];sb.prototype={hasNext:function(){return this.index<
this.count},next:function(){var a=this.map,b=this.keys[this.index++];return null!=p[b]?a.getReserved(b):a.h[b]},__class__:sb};var J=function(){this.h={}};f["haxe.ds.StringMap"]=J;J.__name__=["haxe","ds","StringMap"];J.__interfaces__=[Ad];J.prototype={setReserved:function(a,b){null==this.rh&&(this.rh={});this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},existsReserved:function(a){return null==this.rh?!1:this.rh.hasOwnProperty("$"+a)},remove:function(a){if(null!=p[a]){a=
"$"+a;if(null==this.rh||!this.rh.hasOwnProperty(a))return!1;delete this.rh[a]}else{if(!this.h.hasOwnProperty(a))return!1;delete this.h[a]}return!0},keys:function(){return A.iter(this.arrayKeys())},arrayKeys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},iterator:function(){return new sb(this,this.arrayKeys())},__class__:J};var Na={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds",
"Custom"],Blocked:["Blocked",0]};Na.Blocked.toString=kb;Na.Blocked.__enum__=Na;Na.Overflow=["Overflow",1];Na.Overflow.toString=kb;Na.Overflow.__enum__=Na;Na.OutsideBounds=["OutsideBounds",2];Na.OutsideBounds.toString=kb;Na.OutsideBounds.__enum__=Na;Na.Custom=function(a){a=["Custom",3,a];a.__enum__=Na;a.toString=kb;return a};var Da=function(){};f["haxe.io.FPHelper"]=Da;Da.__name__=["haxe","io","FPHelper"];Da.i32ToFloat=function(a){var b=a>>>23&255,c=a&8388607;return 0==c&&0==b?0:(1-(a>>>31<<1))*(1+
Math.pow(2,-23)*c)*Math.pow(2,b-127)};Da.floatToI32=function(a){if(0==a)return 0;var b=0>a?-a:a,c=Math.floor(Math.log(b)/.6931471805599453);-127>c?c=-127:128<c&&(c=128);b=Math.round(8388608*(b/Math.pow(2,c)-1));8388608==b&&128>c&&(b=0,++c);return(0>a?-2147483648:0)|c+127<<23|b};Da.i64ToDouble=function(a,b){var c=(b>>20&2047)-1023;a=4294967296*(b&1048575)+2147483648*(a>>>31)+(a&2147483647);return 0==a&&-1023==c?0:(1-(b>>>31<<1))*(1+Math.pow(2,-52)*a)*Math.pow(2,c)};Da.doubleToI64=function(a){var b=
Da.i64tmp;if(0==a)b.low=0,b.high=0;else if(isFinite(a)){var c=0>a?-a:a,d=Math.floor(Math.log(c)/.6931471805599453);c=Math.round(4503599627370496*(c/Math.pow(2,d)-1));b.low=c|0;b.high=(0>a?-2147483648:0)|d+1023<<20|c/4294967296|0}else 0<a?(b.low=0,b.high=2146435072):(b.low=0,b.high=-1048576);return b};var fb=function(){};f["haxe.rtti.Meta"]=fb;fb.__name__=["haxe","rtti","Meta"];fb.getType=function(a){a=fb.getMeta(a);return null==a||null==a.obj?{}:a.obj};fb.getMeta=function(a){return a.__meta__};fb.getStatics=
function(a){a=fb.getMeta(a);return null==a||null==a.statics?{}:a.statics};fb.getFields=function(a){a=fb.getMeta(a);return null==a||null==a.fields?{}:a.fields};var xa=function(a,b,c){this.xml=b;this.message=a;this.position=c;this.lineNumber=1;for(a=this.positionAtLine=0;a<c;){var d=a++;d=b.charCodeAt(d);10==d?(this.lineNumber++,this.positionAtLine=0):13!=d&&this.positionAtLine++}};f["haxe.xml.XmlParserException"]=xa;xa.__name__=["haxe","xml","XmlParserException"];xa.prototype={toString:function(){return Ca.getClassName(y.getClass(this))+
": "+this.message+" at line "+this.lineNumber+" char "+this.positionAtLine},__class__:xa};var qb=function(){};f["haxe.xml.Parser"]=qb;qb.__name__=["haxe","xml","Parser"];qb.parse=function(a,b){null==b&&(b=!1);var c=x.createDocument();qb.doParse(a,b,0,c);return c};qb.doParse=function(a,b,c,d){null==c&&(c=0);for(var e=null,h=1,B=1,g=null,f=0,l=0,n=0,k=a.charCodeAt(c),m=new Gb,q=1,t=-1;k==k;){switch(h){case 0:switch(k){case 9:case 10:case 13:case 32:break;default:h=B;continue}break;case 1:if(60==k)h=
0,B=2;else{f=c;h=13;continue}break;case 2:switch(k){case 33:if(91==a.charCodeAt(c+1)){c+=2;if("CDATA["!=A.substr(a,c,6).toUpperCase())throw new z(new xa("Expected <![CDATA[",a,c));c+=5;h=17}else if(68==a.charCodeAt(c+1)||100==a.charCodeAt(c+1)){if("OCTYPE"!=A.substr(a,c+2,6).toUpperCase())throw new z(new xa("Expected <!DOCTYPE",a,c));c+=8;h=16}else{if(45!=a.charCodeAt(c+1)||45!=a.charCodeAt(c+2))throw new z(new xa("Expected \x3c!--",a,c));c+=2;h=15}f=c+1;break;case 47:if(null==d)throw new z(new xa("Expected node name",
a,c));f=c+1;h=0;B=10;break;case 63:h=14;f=c;break;default:h=3;f=c;continue}break;case 3:if(!(97<=k&&122>=k||65<=k&&90>=k||48<=k&&57>=k||58==k||46==k||95==k||45==k)){if(c==f)throw new z(new xa("Expected node name",a,c));e=x.createElement(A.substr(a,f,c-f));d.addChild(e);++l;h=0;B=4;continue}break;case 4:switch(k){case 47:h=11;break;case 62:h=9;break;default:h=5;f=c;continue}break;case 5:if(!(97<=k&&122>=k||65<=k&&90>=k||48<=k&&57>=k||58==k||46==k||95==k||45==k)){if(f==c)throw new z(new xa("Expected attribute name",
a,c));g=A.substr(a,f,c-f);if(e.exists(g))throw new z(new xa("Duplicate attribute ["+g+"]",a,c));h=0;B=6;continue}break;case 6:if(61==k)h=0,B=7;else throw new z(new xa("Expected =",a,c));break;case 7:switch(k){case 34:case 39:m=new Gb;h=8;f=c+1;t=k;break;default:throw new z(new xa('Expected "',a,c));}break;case 8:switch(k){case 38:q=c-f;m.b+=null==q?A.substr(a,f,null):A.substr(a,f,q);h=18;q=8;f=c+1;break;case 60:case 62:if(b)throw new z(new xa("Invalid unescaped "+String.fromCharCode(k)+" in attribute value",
a,c));k==t&&(B=c-f,m.b+=null==B?A.substr(a,f,null):A.substr(a,f,B),B=m.b,m=new Gb,e.set(g,B),h=0,B=4);break;default:k==t&&(B=c-f,m.b+=null==B?A.substr(a,f,null):A.substr(a,f,B),B=m.b,m=new Gb,e.set(g,B),h=0,B=4)}break;case 9:f=c=qb.doParse(a,b,c,e);h=1;break;case 10:if(!(97<=k&&122>=k||65<=k&&90>=k||48<=k&&57>=k||58==k||46==k||95==k||45==k)){if(f==c)throw new z(new xa("Expected node name",a,c));B=A.substr(a,f,c-f);if(d.nodeType!=x.Element)throw new z("Bad node type, expected Element but found "+d.nodeType);
if(B!=d.nodeName){if(d.nodeType!=x.Element)throw new z("Bad node type, expected Element but found "+d.nodeType);throw new z(new xa("Expected </"+d.nodeName+">",a,c));}h=0;B=12;continue}break;case 11:if(62==k)h=1;else throw new z(new xa("Expected >",a,c));break;case 12:if(62==k)return 0==l&&d.addChild(x.createPCData("")),c;throw new z(new xa("Expected >",a,c));case 13:60==k?(B=c-f,m.b+=null==B?A.substr(a,f,null):A.substr(a,f,B),B=x.createPCData(m.b),m=new Gb,d.addChild(B),++l,h=0,B=2):38==k&&(q=c-
f,m.b+=null==q?A.substr(a,f,null):A.substr(a,f,q),h=18,q=13,f=c+1);break;case 14:63==k&&62==a.charCodeAt(c+1)&&(++c,k=A.substr(a,f+1,c-f-2),d.addChild(x.createProcessingInstruction(k)),++l,h=1);break;case 15:45==k&&45==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2)&&(d.addChild(x.createComment(A.substr(a,f,c-f))),++l,c+=2,h=1);break;case 16:91==k?++n:93==k?--n:62==k&&0==n&&(d.addChild(x.createDocType(A.substr(a,f,c-f))),++l,h=1);break;case 17:93==k&&93==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2)&&(k=x.createCData(A.substr(a,
f,c-f)),d.addChild(k),++l,c+=2,h=1);break;case 18:if(59==k){f=A.substr(a,f,c-f);if(35==f.charCodeAt(0))f=120==f.charCodeAt(1)?T.parseInt("0"+A.substr(f,1,f.length-1)):T.parseInt(A.substr(f,1,f.length-1)),m.b+=String.fromCharCode(f);else if(k=qb.escapes,null!=p[f]?k.existsReserved(f):k.h.hasOwnProperty(f))k=qb.escapes,f=null!=p[f]?k.getReserved(f):k.h[f],m.b+=T.string(f);else{if(b)throw new z(new xa("Undefined entity: "+f,a,c));m.b+=T.string("&"+f+";")}f=c+1;h=q}else if(!(97<=k&&122>=k||65<=k&&90>=
k||48<=k&&57>=k||58==k||46==k||95==k||45==k)&&35!=k){if(b)throw new z(new xa("Invalid character in entity: "+String.fromCharCode(k),a,c));m.b+="&";k=c-f;m.b+=null==k?A.substr(a,f,null):A.substr(a,f,k);f=c--;h=q}}k=a.charCodeAt(++c)}1==h&&(f=c,h=13);if(13==h){if(c!=f||0==l)b=c-f,m.b+=null==b?A.substr(a,f,null):A.substr(a,f,b),d.addChild(x.createPCData(m.b));return c}if(!b&&18==h&&13==q)return m.b+="&",b=c-f,m.b+=null==b?A.substr(a,f,null):A.substr(a,f,b),d.addChild(x.createPCData(m.b)),c;throw new z(new xa("Unexpected end",
a,c));};var z=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,z)};f["js._Boot.HaxeError"]=z;z.__name__=["js","_Boot","HaxeError"];z.wrap=function(a){return a instanceof Error?a:new z(a)};z.__super__=Error;z.prototype=r(Error.prototype,{__class__:z});var y=function(){};f["js.Boot"]=y;y.__name__=["js","Boot"];y.__unhtml=function(a){return a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")};y.__trace=function(a,
b){var c=null!=b?b.fileName+":"+b.lineNumber+": ":"";c+=y.__string_rec(a,"");if(null!=b&&null!=b.customParams)for(a=0,b=b.customParams;a<b.length;){var d=b[a];++a;c+=","+y.__string_rec(d,"")}if("undefined"!=typeof document){var e=document.getElementById("haxe:trace");a=null!=e}else a=!1;a?e.innerHTML+=y.__unhtml(c)+"<br/>":"undefined"!=typeof console&&null!=console.log&&console.log(c)};y.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;
a=y.__nativeClassName(a);return null!=a?y.__resolveNativeClass(a):null};y.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";b+="\t";for(var d=2,e=a.length;d<e;){var h=d++;c=2!=h?c+(","+y.__string_rec(a[h],b)):c+y.__string_rec(a[h],b)}return c+")"}c=a.length;d="[";b+=
"\t";for(e=0;e<c;)h=e++,d+=(0<h?",":"")+y.__string_rec(a[h],b);return d+"]"}try{d=a.toString}catch(B){return"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)e&&!a.hasOwnProperty(c)||"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+y.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "string":return a;
default:return String(a)}};y.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var h=d++;h=c[h];if(h==b||y.__interfLoop(h,b))return!0}return y.__interfLoop(a.__super__,b)};y.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array?null==a.__enum__:!1;case me:return"boolean"==typeof a;case qe:return!0;case ie:return"number"==typeof a;case je:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==
typeof a;default:if(null!=a)if("function"==typeof b){if(a instanceof b||y.__interfLoop(y.getClass(a),b))return!0}else{if("object"==typeof b&&y.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==re&&null!=a.__name__||b==se&&null!=a.__ename__?!0:a.__enum__==b}};y.__cast=function(a,b){if(y.__instanceof(a,b))return a;throw new z("Cannot cast "+T.string(a)+" to "+T.string(b));};y.__nativeClassName=function(a){a=y.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==
a?null:a};y.__isNativeObj=function(a){return null!=y.__nativeClassName(a)};y.__resolveNativeClass=function(a){return ha[a]};var Oa=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{this.a=[];for(var b=0;b<a;){var c=b++;this.a[c]=0}this.byteLength=a}};f["js.html.compat.ArrayBuffer"]=Oa;Oa.__name__=["js","html","compat","ArrayBuffer"];Oa.sliceImpl=function(a,b){a=new ge(this,a,null==b?null:b-a);b=new Wb(a.byteLength);(new ge(b)).set(a);return b};Oa.prototype=
{slice:function(a,b){return new Oa(this.a.slice(a,b))},__class__:Oa};var Dd=function(a,b,c){this.buf=a;this.offset=null==b?0:b;this.length=null==c?a.byteLength-this.offset:c;if(0>this.offset||0>this.length||this.offset+this.length>a.byteLength)throw new z(Na.OutsideBounds);this.byteLength=this.length;this.byteOffset=this.offset;this.buffer=this.buf};f["js.html.compat.DataView"]=Dd;Dd.__name__=["js","html","compat","DataView"];Dd.prototype={getInt8:function(a){a=this.buf.a[this.offset+a];return 128<=
a?a-256:a},getUint8:function(a){return this.buf.a[this.offset+a]},getInt16:function(a,b){a=this.getUint16(a,b);return 32768<=a?a-65536:a},getUint16:function(a,b){return b?this.buf.a[this.offset+a]|this.buf.a[this.offset+a+1]<<8:this.buf.a[this.offset+a]<<8|this.buf.a[this.offset+a+1]},getInt32:function(a,b){var c=this.offset+a;a=this.buf.a[c++];var d=this.buf.a[c++],e=this.buf.a[c++];c=this.buf.a[c++];return b?a|d<<8|e<<16|c<<24:c|e<<8|d<<16|a<<24},getUint32:function(a,b){a=this.getInt32(a,b);return 0>
a?a+4294967296:a},getFloat32:function(a,b){return Da.i32ToFloat(this.getInt32(a,b))},getFloat64:function(a,b){var c=this.getInt32(a,b);a=this.getInt32(a+4,b);return Da.i64ToDouble(b?c:a,b?a:c)},setInt8:function(a,b){this.buf.a[a+this.offset]=0>b?b+128&255:b&255},setUint8:function(a,b){this.buf.a[a+this.offset]=b&255},setInt16:function(a,b,c){this.setUint16(a,0>b?b+65536:b,c)},setUint16:function(a,b,c){a+=this.offset;c?(this.buf.a[a]=b&255,this.buf.a[a++]=b>>8&255):(this.buf.a[a++]=b>>8&255,this.buf.a[a]=
b&255)},setInt32:function(a,b,c){this.setUint32(a,b,c)},setUint32:function(a,b,c){a+=this.offset;c?(this.buf.a[a++]=b&255,this.buf.a[a++]=b>>8&255,this.buf.a[a++]=b>>16&255,this.buf.a[a++]=b>>>24):(this.buf.a[a++]=b>>>24,this.buf.a[a++]=b>>16&255,this.buf.a[a++]=b>>8&255,this.buf.a[a++]=b&255)},setFloat32:function(a,b,c){this.setUint32(a,Da.floatToI32(b),c)},setFloat64:function(a,b,c){b=Da.doubleToI64(b);c?(this.setUint32(a,b.low),this.setUint32(a,b.high)):(this.setUint32(a,b.high),this.setUint32(a,
b.low))},__class__:Dd};var tb=function(){};f["js.html.compat.Float32Array"]=tb;tb.__name__=["js","html","compat","Float32Array"];tb._new=function(a,b,c){if("number"==typeof a){var d=[];for(b=0;b<a;){var e=b++;d[e]=0}d.byteLength=d.length<<2;d.byteOffset=0;a=[];b=0;for(e=d.length<<2;b<e;)b++,a.push(0);d.buffer=new Oa(a)}else if(y.__instanceof(a,Oa)){null==b&&(b=0);null==c&&(c=a.byteLength-b>>2);d=[];for(e=0;e<c;){e++;var h=a.a[b++]|a.a[b++]<<8|a.a[b++]<<16|a.a[b++]<<24;d.push(Da.i32ToFloat(h))}d.byteLength=
d.length<<2;d.byteOffset=b;d.buffer=a}else if(a instanceof Array&&null==a.__enum__){d=a.slice();a=[];for(b=0;b<d.length;)e=d[b],++b,e=Da.floatToI32(e),a.push(e&255),a.push(e>>8&255),a.push(e>>16&255),a.push(e>>>24);d.byteLength=d.length<<2;d.byteOffset=0;d.buffer=new Oa(a)}else throw new z("TODO "+T.string(a));d.subarray=tb._subarray;d.set=tb._set;return d};tb._set=function(a,b){if(y.__instanceof(a.buffer,Oa)){if(a.byteLength+b>this.byteLength)throw new z("set() outside of range");for(var c=0,d=a.byteLength;c<
d;){var e=c++;this[e+b]=a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new z("set() outside of range");c=0;for(d=a.length;c<d;)e=c++,this[e+b]=a[e]}else throw new z("TODO");};tb._subarray=function(a,b){b=tb._new(this.slice(a,b));b.byteOffset=4*a;return b};var ub=function(){};f["js.html.compat.Uint8Array"]=ub;ub.__name__=["js","html","compat","Uint8Array"];ub._new=function(a,b,c){if("number"==typeof a){c=[];for(b=0;b<a;){var d=b++;c[d]=0}c.byteLength=c.length;
c.byteOffset=0;c.buffer=new Oa(c)}else if(y.__instanceof(a,Oa))null==b&&(b=0),null==c&&(c=a.byteLength-b),c=0==b?a.a:a.a.slice(b,b+c),c.byteLength=c.length,c.byteOffset=b,c.buffer=a;else if(a instanceof Array&&null==a.__enum__)c=a.slice(),c.byteLength=c.length,c.byteOffset=0,c.buffer=new Oa(c);else throw new z("TODO "+T.string(a));c.subarray=ub._subarray;c.set=ub._set;return c};ub._set=function(a,b){if(y.__instanceof(a.buffer,Oa)){if(a.byteLength+b>this.byteLength)throw new z("set() outside of range");
for(var c=0,d=a.byteLength;c<d;){var e=c++;this[e+b]=a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new z("set() outside of range");c=0;for(d=a.length;c<d;)e=c++,this[e+b]=a[e]}else throw new z("TODO");};ub._subarray=function(a,b){b=ub._new(this.slice(a,b));b.byteOffset=a;return b};var P=g.lovedna.Time=function(){};f["lovedna.Time"]=P;P.__name__=["lovedna","Time"];P.__properties__={get_now:"get_now"};P.setTimeHandler=function(a){null==a&&(a=P.getnow);P._custom=
a};P.setCustomNowTime=function(a){P._offset=a-P._custom()};P.get_now=function(){return P._custom()};P.getnow=function(){return.001*(new Date).getTime()+P._offset};P.prototype={__class__:P};var vb=g.lovedna.ds.IArrayAccess=function(){};f["lovedna.ds.IArrayAccess"]=vb;vb.__name__=["lovedna","ds","IArrayAccess"];vb.prototype={__class__:vb};var Ma=g.lovedna.ds.Array2D=function(a,b){this._list=[];this.resize(a,b)};f["lovedna.ds.Array2D"]=Ma;Ma.__name__=["lovedna","ds","Array2D"];Ma.__interfaces__=[vb];
Ma.prototype={fill:function(a){for(var b=this.length;0<b--;)this._list[b]=a},clear:function(){this.fill(null)},dispose:function(){this._list=null},resize:function(a,b){if(1>a*b)throw new z("error size ");this.width=a;this.height=b;this.length=a*b},fromArray:function(a){for(var b=this.length;0<b--;)this._list[b]=a[b]},getIndex:function(a,b){return 0>a||0>b||a>=this.width||b>=this.height?-1:b*this.width+a},getX:function(a){return a%this.width},getY:function(a){return n.floor(a/this.width)},get:function(a,
b){a=this.getIndex(a,b);return 0<=a?this.getElement(a):null},set:function(a,b,c){a=this.getIndex(a,b);0<=a&&this.setElement(a,c)},outside:function(a,b){return 0>a||0>b||a>=this.width||b>=this.height?!0:!1},getListByX:function(a,b){if(null!=b)for(var c=this.height;0<c--;)b[c]=this.get(a,c)},getListByY:function(a,b){if(null!=b)for(var c=this.width;0<c--;)b[c]=this.get(c,a)},rotateRight:function(){for(var a=0,b=0,c=this.width;b<c;)for(var d=b++,e=this.height;0<e--;){var h=this.get(d,e);Ma._temp[a++]=
h}for(a=this.length;0<a--;)this._list[a]=Ma._temp[a],Ma._temp[a]=null;this.width^=this.height;this.height^=this.width;this.width^=this.height},rotateLeft:function(){for(var a=0,b=this.width;0<b--;)for(var c=0,d=this.height;c<d;){var e=c++;e=this.get(b,e);Ma._temp[a++]=e}for(a=this.length;0<a--;)this._list[a]=Ma._temp[a],Ma._temp[a]=null;this.width^=this.height;this.height^=this.width;this.width^=this.height},getElement:function(a){return this._list[a]},setElement:function(a,b){this._list[a]=b},toString:function(){for(var a=
"\nArray2["+this.width+","+this.height+"]\n",b=0,c=this.height;b<c;){var d=b++;this.getListByY(d,Ma._temp);d=0;for(var e=this.width;d<e;){var h=d++;0<h&&(a+=",");a+=T.string(Ma._temp[h]);Ma._temp[h]=null}a+="\n"}return a},__class__:Ma};var Ed=g.lovedna.ds.BinaryHeap=function(a){this._items=new O;this._items.push(null);this._compare=a;this.count=0};f["lovedna.ds.BinaryHeap"]=Ed;Ed.__name__=["lovedna","ds","BinaryHeap"];Ed.prototype={push:function(a){this._items.push(a);this.toRoot(this._items.get_length()-
1);this.count=this._items.get_length()-1},shift:function(){if(1==this._items.get_length())return null;if(2==this._items.get_length())return this.count=0,this._items.pop();var a=this._items.get(1);this.toLeaf();this.count=this._items.get_length()-1;return a},Clear:function(){this._items.set_length(1)},toRoot:function(a){for(var b=a;1<b;){var c=b>>1,d=this._items.get(b),e=this._items.get(c);if(0>this._compare(d,e))this._items.setElement(b,e),this._items.setElement(c,d);else break;b=c;if(0>a--)break}},
toLeaf:function(){var a=1;this._items.setElement(1,this._items.pop());for(var b=this._items.get_length(),c=b;;){var d=a,e=a<<1;if(e<b){var h=this._items.get(a),f=this._items.get(e);0<this._compare(h,f)&&(a=e,h=f);e+1<b&&(f=this._items.get(e+1),0<this._compare(h,f)&&(a=e+1))}if(a!=d)h=this._items.get(a),e=this._items.get(d),this._items.setElement(a,e),this._items.setElement(d,h);else break;if(0>c--)break}},__class__:Ed};var Aa=g.lovedna.ds.Bit32=function(a){null==a&&(a=0);this.value=0;this.value=a};
f["lovedna.ds.Bit32"]=Aa;Aa.__name__=["lovedna","ds","Bit32"];Aa.prototype={toString:function(){return"Bit32("+n.toBin(this.value)+")"},getElement:function(a){ta.gt(0,a)?(a=ta.toFloat(a)%ta.toFloat(32)|0,a+=32):ta.gte(a,32)&&(a=ta.toFloat(a)%ta.toFloat(32)|0);a=1<<a;return(this.value&a)==a},setElement:function(a,b){null==b&&(b=!0);0>a?a=a%32+32:32<=a&&(a%=32);this.value=b?this.value|1<<a:this.value&~(1<<a)},negate:function(){this.value^=-1;return this},clear:function(){this.value=0;return this},add:function(a,
b){var c=null==b;this.value=(c?this:a).value|(c?a:b).value;return this},sub:function(a,b){var c=null==b;this.value=(c?this:a).value&~(c?a:b).value;return this},contains:function(a){return(this.value|a.value)==this.value},__class__:Aa};var Bc=g.lovedna.ds.Blob=function(a){null==a&&(a=0);this.bigEndian=!1;this._data=new za(new Wb(a));this._length=this.position=0};f["lovedna.ds.Blob"]=Bc;Bc.__name__=["lovedna","ds","Blob"];Bc.prototype={toString:function(){return this._data.toString()},setBytes:function(a){if(null==
a&&0==a.length)return this;this.__resize(a.length);this.position=0;this._data.blit(0,a,0,a.length);return this},getBytes:function(){this.trim();return this._data},readUnsignedByte:function(){if(ta.gt(this._length,this.position))return this._data.b[this.position++];throw new z("EOF");},readByte:function(){var a=this.readUnsignedByte();return 0!=(a&128)?a-256:a},writeByte:function(a){this.__resize(this.position+1);this._data.b[this.position++]=a&255},readBoolean:function(){return 0!=this.readUnsignedByte()},
writeBoolean:function(a){this.writeByte(a?1:0)},readUnsignedShort:function(){var a=this.readUnsignedByte(),b=this.readUnsignedByte();return this.bigEndian?a<<8|b:(b<<8)+a},readShort:function(){var a=this.readUnsignedShort();return 0!=(a&32768)?a-65536:a},writeShort:function(a){this.__resize(this.position+2);this.bigEndian?(this._data.b[this.position++]=a>>8&255,this._data.b[this.position++]=a&255):(this._data.b[this.position++]=a&255,this._data.b[this.position++]=a>>8&255)},readUnsignedInt:function(){var a=
this.readUnsignedByte(),b=this.readUnsignedByte(),c=this.readUnsignedByte(),d=this.readUnsignedByte();return this.bigEndian?a<<24|b<<16|c<<8|d:d<<24|c<<16|b<<8|a},readInt:function(){var a=this.readUnsignedByte(),b=this.readUnsignedByte(),c=this.readUnsignedByte(),d=this.readUnsignedByte();return this.bigEndian?a<<24|b<<16|c<<8|d:d<<24|c<<16|b<<8|a},writeUnsignedInt:function(a){this.writeInt(a)},writeInt:function(a){this.__resize(this.position+4);this.bigEndian?(this._data.b[this.position++]=a>>24&
255,this._data.b[this.position++]=a>>16&255,this._data.b[this.position++]=a>>8&255,this._data.b[this.position++]=a&255):(this._data.b[this.position++]=a&255,this._data.b[this.position++]=a>>8&255,this._data.b[this.position++]=a>>16&255,this._data.b[this.position++]=a>>24&255)},readFloat:function(){return Da.i32ToFloat(this.readInt())},writeFloat:function(a){this.bigEndian?(a=Da.floatToI32(a),this.writeInt(a)):(this.__resize(this.position+4),this._data.setFloat(this.position,a),this.position+=4)},
readDouble:function(){var a=this.readInt(),b=this.readInt();return this.bigEndian?Da.i64ToDouble(b,a):Da.i64ToDouble(a,b)},writeDouble:function(a){a=Da.doubleToI64(a);this.bigEndian?(this.writeInt(a.high),this.writeInt(a.low)):(this.writeInt(a.low),this.writeInt(a.high))},writeLong:function(a){this.writeInt(a.low);this.writeInt(a.high)},readLong:function(){var a=this.readInt(),b=this.readInt();return new Ub(b,a)},readUTFBytes:function(a){if(this.position+a>this._length)throw new z("EOF");this.position+=
a;return this._data.getString(this.position-a,a)},writeUTFBytes:function(a){a=za.ofString(a);this.writeBytes(a)},readUTF:function(){var a=this.readUnsignedShort();return this.readUTFBytes(a)},writeUTF:function(a){a=za.ofString(a);this.writeShort(a.length);this.writeBytes(a)},readBlob:function(a,b,c){null==c&&(c=0);null==b&&(b=0);0==c&&(c=this._length-this.position);if(ta.gt(this.position+c,this._length))throw new z("EOF");a._data.length<b+c&&a.__resize(b+c);a._data.blit(b,this._data,this.position,
c);this.position+=c},writeBlob:function(a,b,c){null==c&&(c=0);null==b&&(b=0);this.writeBytes(a.getBytes(),b,c)},writeBytes:function(a,b,c){null==c&&(c=0);null==b&&(b=0);0!=a.length&&(0==c&&(c=a.length-b),this.__resize(this.position+c),this._data.blit(this.position,a,b,c),this.position+=c)},trim:function(){if(this._data.length>this._length){var a=new za(new Wb(this._length));a.blit(0,this._data,0,this._length);this._data=a}},__resize:function(a){if(a>this._data.length){var b=new za(new Wb(3*(a+1)>>
1));b.blit(0,this._data,0,this._length);this._data=b}this._length<a&&(this._length=a)},get_bytesAvailable:function(){return this._length-this.position},get_length:function(){return this._length},set_length:function(a){0<a&&this.__resize(a);a<this.position&&(this.position=a);return a},__class__:Bc,__properties__:{get_bytesAvailable:"get_bytesAvailable",set_length:"set_length",get_length:"get_length"}};var na=g.lovedna.ds.ByteArray={};f["lovedna.ds._ByteArray.ByteArray_Impl_"]=na;na.__name__=["lovedna",
"ds","_ByteArray","ByteArray_Impl_"];na._new=function(a){null==a&&(a=0);return new Bc(a)};na.fromBytes=function(a){return(new Bc).setBytes(a)};na.toBytes=function(a){return a.getBytes()};var O=g.lovedna.ds.FastArray=function(){this._length=0};f["lovedna.ds.FastArray"]=O;O.__name__=["lovedna","ds","FastArray"];O.__interfaces__=[vb];O.prototype={toArray:function(){return this._buffer},clear:function(){if(null!=this._buffer&&!(1>this._length)){var a=this._length,b=this._buffer.length;for(a=a<b?a:b;0<
a--;)this._buffer[a]=null;this._length=0}},dispose:function(){this._buffer=null;this._length=0},fromList:function(a){if(null==a)return this;null==this._buffer&&(this._buffer=[],this._length=0);for(var b=a.length,c=0;c<b;){var d=c++;this._buffer[d]=a[d]}this._length=b;return this},add:function(a,b,c){null==c&&(c=0);null==b&&(b=0);if(null!=a){null==this._buffer&&(this._buffer=[],this._length=0);0>c&&(c=0);var d=a.get_length();0<b&&(d>=b&&(d=b),c+d>a.get_length()&&(d-=c+d-a.get_length()));for(b=0;b<
d;){var e=b++;this._buffer[this._length++]=a.getElement(c+e)}}},addList:function(a,b,c){null==c&&(c=0);null==b&&(b=0);if(null!=a){null==this._buffer&&(this._buffer=[],this._length=0);0>c&&(c=0);var d=a.length;0<b&&(d>=b&&(d=b),c+d>a.length&&(d-=c+d-a.length));for(b=0;b<d;){var e=b++;e=a[c+e];this._buffer[this._length++]=e}}},push:function(a){null==this._buffer&&(this._buffer=[]);this._buffer[this._length++]=a},pop:function(){if(null==this._buffer||1>this._length)return null;var a=this._buffer[--this._length];
this._buffer[this._length]=null;return a},shift:function(){if(null==this._buffer||1>this._length)return null;this._length--;return this._buffer.shift()},get:function(a,b){null==b&&(b=!1);if(b||0>a)a%=this._length,0>a&&(a+=this._length);return this.getElement(a)},getElement:function(a){return 1>this._length||null==this._buffer?null:this._buffer[a]},setElement:function(a,b){null==this._buffer&&(this._buffer=[]);this._buffer[a]=b;++a;this._length<a&&(this._length=a)},indexOf:function(a,b){null==b&&(b=
0);return null==this._buffer||1>this._length?-1:this._buffer.indexOf(a,b)},insert:function(a,b){null==this._buffer&&(this._buffer=[]);this._buffer.splice(a,0,b);this._length++},remove:function(a,b){null==b&&(b=0);if(null==this._buffer||1>this._length)return-1;a=this.indexOf(a,b);if(-1==a)return-1;this._buffer.splice(a,1);this._length--;return a},removeAt:function(a,b){null==b&&(b=1);null==this._buffer||1>this._length||1>b||(a+b>=this._length&&(b=this._length-a),1>b||(this._length-=b,this._buffer.splice(a,
b)))},unshift:function(a){null==this._buffer&&(this._buffer=[]);this._buffer.unshift(a);this._length++},sort:function(a){null!=this._buffer&&(2>this._length||this._buffer.sort(a))},toString:function(){return null!=this._buffer?this._length+" "+this._buffer.toString():"empty"},get_length:function(){return this._length},set_length:function(a){this._length=a;if(null==this._buffer)return this._length;var b=this._buffer.length;a<b&&this._buffer.splice(a,b-a);return this._length},__class__:O,__properties__:{set_length:"set_length",
get_length:"get_length"}};var wb=g.lovedna.ds.Fnv=function(){this._lasttype=0;this.reset()};f["lovedna.ds.Fnv"]=wb;wb.__name__=["lovedna","ds","Fnv"];wb.prototype={reset:function(){this._lasttype=this._index=this._value=0},getCode:function(){return this._value},getString:function(){return X.hex(this._value,null)},addInt:function(a){2!=this._lasttype&&(this._lasttype=2,this._addInt(this._lasttype));this._addInt(a)},addString:function(a){4!=this._lasttype&&(this._lasttype=4,this._addInt(this._lasttype));
var b=a.length;for(this._addInt(b);0<b--;)this._addInt(A.cca(a,b))},addFloat:function(a){8!=this._lasttype&&(this._lasttype=8,this._addInt(this._lasttype));var b=n.floor(a);a-=n.floor(a);this._addInt(b);0!=a&&this._addInt(n.round(4294967296*a))},addBool:function(a){16!=this._lasttype&&(this._lasttype=16,this._addInt(this._lasttype));this._addInt(a?1:0)},_addInt:function(a){this._value*=16777619;this._value^=a},__class__:wb};var Kb=g.lovedna.ds.IFillArray=function(){};f["lovedna.ds.IFillArray"]=Kb;
Kb.__name__=["lovedna","ds","IFillArray"];Kb.prototype={__class__:Kb};var Cc=g.lovedna.ds.StringLine=function(a,b){null==b&&(b=!1);null==a&&(a="");this._list=[];this._keep=b;this.decode(a)};f["lovedna.ds.StringLine"]=Cc;Cc.__name__=["lovedna","ds","StringLine"];Cc.prototype={readLine:function(){return this._position<this._length?this._list[this._position++]:null},writeLine:function(a){a=X.replace(a,"\r","\n");a=a.split("\n");for(var b=0,c=a.length;b<c;){var d=b++;d=a[d];(""!=d||this._keep)&&this._writeLine(d)}},
encode:function(){return this._list.join("\n")},decode:function(a){0<this._length&&this._list.splice(0,this._length);this._position=this._length=0;if(null!=a){a=X.replace(a,"\r","\n");a=a.split("\n");for(var b=0,c=a.length;b<c;){var d=b++;d=a[d];(""!=d||this._keep)&&this._list.push(d)}this._length=this._list.length;this._position=0}},_writeLine:function(a){this._position>=this._length&&this._length++;this._list[this._position++]=a},get_position:function(){return this._position},get_length:function(){return this._length},
set_position:function(a){0<=a&&a<this._length&&(this._position=a);return this._position},get_lineAvailable:function(){return this._length-this._position},__class__:Cc,__properties__:{get_length:"get_length",get_lineAvailable:"get_lineAvailable",set_position:"set_position",get_position:"get_position"}};var pa=g.lovedna.utils.TypeUtil=function(){};f["lovedna.utils.TypeUtil"]=pa;pa.__name__=["lovedna","utils","TypeUtil"];pa.getName=function(a){if(null!=pa._typeMap.h.__keys__[a.__id__])return pa._typeMap.h[a.__id__];
var b=Ca.getClassName(a);pa._typeMap.set(a,b);return b};pa.createInstance=function(a,b){a=null==b?Ca.createEmptyInstance(a):Ca.createInstance(a,b);y.__instanceof(a,Ha)&&!a.__constructed&&(a.__constructed=!0,a.instanceID=Ha._id++,a.onConstruct());return a};pa.getClassName=function(a){return null==a?"null":Ca.getClassName(null==a?null:y.getClass(a))};pa.getClass=function(a){if(null!=pa._typeClassMap.h.__keys__[a.__id__])return pa._typeClassMap.h[a.__id__];var b=null==a?null:y.getClass(a);pa._typeClassMap.set(a,
b);return b};pa.prototype={__class__:pa};var R=g.lovedna.events.Event=function(a){this.name=a;this._type=pa.getClassName(this)+"."+a+"."+(new Date(2018,7,13,23,35,6)).getTime()};f["lovedna.events.Event"]=R;R.__name__=["lovedna","events","Event"];R.prototype={get_type:function(){return this._type},__class__:R,__properties__:{get_type:"get_type"}};var qc=function(a,b){this.callback=a;this.priority=b};f["lovedna.events._EventDispatcher.Listener"]=qc;qc.__name__=["lovedna","events","_EventDispatcher",
"Listener"];qc.prototype={match:function(a){return this.callback==a},__class__:qc};var cb=g.lovedna.events.KeyEvent=function(a){R.call(this,a)};f["lovedna.events.KeyEvent"]=cb;cb.__name__=["lovedna","events","KeyEvent"];cb.__super__=R;cb.prototype=r(R.prototype,{__class__:cb});var db=g.lovedna.events.TouchEvent=function(a){R.call(this,a)};f["lovedna.events.TouchEvent"]=db;db.__name__=["lovedna","events","TouchEvent"];db.__super__=R;db.prototype=r(R.prototype,{__class__:db});var gb=g.lovedna.format.atlas.Atlas=
function(a){M.call(this);this.frames=new O;this.file=a;this._map=new J};f["lovedna.format.atlas.Atlas"]=gb;gb.__name__=["lovedna","format","atlas","Atlas"];gb.getAtlas=function(a){var b=gb._atlasMap;return null!=p[a]?b.getReserved(a):b.h[a]};gb.__super__=M;gb.prototype=r(M.prototype,{getSprite:function(a){var b=this._map;return null!=p[a]?b.getReserved(a):b.h[a]},addSprite:function(a){var b=this._map,c=a.get_name();(null!=p[c]?b.existsReserved(c):b.h.hasOwnProperty(c))||(b=this._map,c=a.get_name(),
null!=p[c]?b.setReserved(c,a):b.h[c]=a,this.frames.push(a))},encode:function(){var a=na._new();null==this.file&&(this.file="");a.writeUTF(this.file);var b=this.frames.get_length();for(a.writeInt(b);0<b--;)this.frames.get(b).encode(a);return a},decode:function(a){this.file=a.readUTF();var b=gb._atlasMap,c=this.file;null!=p[c]?b.setReserved(c,this):b.h[c]=this;b=a.readInt();for(this.frames.clear();0<b--;){c=new Dc;c.decode(a);this.frames.push(c);var d=this._map,e=c.get_name();null!=p[e]?d.setReserved(e,
c):d.h[e]=c}},__class__:gb});var Dc=g.lovedna.format.atlas.SpriteData=function(){this._name="";this.frame=new lb;this._rotated=!1;this.sourceSize=new v;this.offset=new v;this.pivot=new v(.5,.5);this.border=new lb(0,0,0,0);this._inited=!1};f["lovedna.format.atlas.SpriteData"]=Dc;Dc.__name__=["lovedna","format","atlas","SpriteData"];Dc.prototype={hasBorder:function(){return 0<this.border.x||0<this.border.y||0<this.border.z?!0:0<this.border.w},encode:function(a){a.writeUTF(this.get_name());a.writeFloat(this.frame.x);
a.writeFloat(this.frame.y);a.writeFloat(this.frame.z);a.writeFloat(this.frame.w);a.writeByte(this.get_rotated()?1:0);0==this.sourceSize.x&&(this.sourceSize.x=this.frame.z);0==this.sourceSize.y&&(this.sourceSize.y=this.frame.w);a.writeFloat(this.sourceSize.x);a.writeFloat(this.sourceSize.y);a.writeFloat(this.offset.x);a.writeFloat(this.offset.y);a.writeFloat(this.pivot.x);a.writeFloat(this.pivot.y);a.writeFloat(this.border.x);a.writeFloat(this.border.y);a.writeFloat(this.border.z);a.writeFloat(this.border.w)},
decode:function(a){this.set_name(a.readUTF());var b=this.frame,c=a.readFloat(),d=a.readFloat(),e=a.readFloat(),h=a.readFloat();b.x=c;b.y=d;b.z=e;b.w=h;this.set_rotated(0!=a.readUnsignedByte());b=this.sourceSize;c=a.readFloat();d=a.readFloat();b.x=c;b.y=d;b=this.offset;c=a.readFloat();d=a.readFloat();b.x=c;b.y=d;b=this.pivot;c=a.readFloat();d=a.readFloat();b.x=c;b.y=d;b=this.border;c=a.readFloat();d=a.readFloat();e=a.readFloat();a=a.readFloat();b.x=c;b.y=d;b.z=e;b.w=a;this._inited=!0},get_name:function(){return this._name},
set_name:function(a){this._inited||(this._name=a);return this._name},get_rotated:function(){return this._rotated},set_rotated:function(a){this._inited||(this._rotated=a);return this._rotated},__class__:Dc,__properties__:{set_rotated:"set_rotated",get_rotated:"get_rotated",set_name:"set_name",get_name:"get_name"}};var Xb=g.lovedna.format.fnt.Fnt=function(){M.call(this);this._chars=new Z;this.scaleH=this.scaleW=this.base=this.lineHeight=this.italic=this.bold=0;this.pages=1;this.id=this.packed=0};f["lovedna.format.fnt.Fnt"]=
Xb;Xb.__name__=["lovedna","format","fnt","Fnt"];Xb.__super__=M;Xb.prototype=r(M.prototype,{getChar:function(a){return this._chars.h[a]},encode:function(){var a=na._new();a.writeUTF(this.face);a.writeInt(this.size);a.writeInt(this.bold);a.writeInt(this.italic);a.writeInt(this.lineHeight);a.writeInt(this.base);a.writeInt(this.scaleW);a.writeInt(this.scaleH);a.writeInt(this.pages);a.writeInt(this.packed);a.writeInt(this.id);a.writeUTF(this.file);a.writeInt(this.count);for(var b=this._chars.keys();b.hasNext();){var c=
b.next();this._chars.h[c].encode(a)}return a},decode:function(a){this.face=a.readUTF();this.size=a.readInt();this.bold=a.readInt();this.italic=a.readInt();this.lineHeight=a.readInt();this.base=a.readInt();this.scaleW=a.readInt();this.scaleH=a.readInt();this.pages=a.readInt();this.packed=a.readInt();this.id=a.readInt();this.file=a.readUTF();for(var b=this.count=a.readInt();0<b--;){var c=new Fd;c.decode(a);this.addChar(c)}},addChar:function(a){this._chars.h[a.id]=a},__class__:Xb});var Fd=g.lovedna.format.fnt.FntChar=
function(){};f["lovedna.format.fnt.FntChar"]=Fd;Fd.__name__=["lovedna","format","fnt","FntChar"];Fd.prototype={parse:function(a){this.id=t.getInt(a,"id");this.x=t.getInt(a,"x");this.y=t.getInt(a,"y");this.width=t.getInt(a,"width");this.height=t.getInt(a,"height");this.xoffset=t.getFloat(a,"xoffset");this.yoffset=t.getFloat(a,"yoffset");this.xadvance=t.getFloat(a,"xadvance");this.page=t.getInt(a,"page")},encode:function(a){a.writeInt(this.id);a.writeInt(this.x);a.writeInt(this.y);a.writeInt(this.width);
a.writeInt(this.height);a.writeFloat(this.xoffset);a.writeFloat(this.yoffset);a.writeFloat(this.xadvance);a.writeInt(this.page)},decode:function(a){this.id=a.readInt();this.x=a.readInt();this.y=a.readInt();this.width=a.readInt();this.height=a.readInt();this.xoffset=a.readFloat();this.yoffset=a.readFloat();this.xadvance=a.readFloat();this.page=a.readInt()},__class__:Fd};var Yb=g.lovedna.format.g3d.DataG3D=function(){M.call(this)};f["lovedna.format.g3d.DataG3D"]=Yb;Yb.__name__=["lovedna","format","g3d",
"DataG3D"];Yb.encode=function(a){var b=na._new();b.writeUTFBytes("G3D");b.writeInt(1);a.encode(b);return b};Yb.__super__=M;Yb.prototype=r(M.prototype,{__class__:Yb});var Ec=g.lovedna.format.g3d.ModelAnimation=function(){this.nodeAnimations=[];this.totalTime=0};f["lovedna.format.g3d.ModelAnimation"]=Ec;Ec.__name__=["lovedna","format","g3d","ModelAnimation"];Ec.prototype={add:function(a){null==this.nodeAnimations&&(this.nodeAnimations=[]);this.nodeAnimations.push(a);a.totalTime>this.totalTime&&(this.totalTime=
a.totalTime)},encode:function(a){a.writeUTF(this.id);a.writeInt(this.nodeAnimations.length);for(var b=0,c=this.nodeAnimations.length;b<c;){var d=b++;this.nodeAnimations[d].encode(a)}},decode:function(a){this.id=a.readUTF();for(var b=a.readInt();0<b--;){var c=new Fc;c.decode(a);this.add(c)}},__class__:Ec};var Ra=g.lovedna.format.g3d.ModelData=function(){this.id=""};f["lovedna.format.g3d.ModelData"]=Ra;Ra.__name__=["lovedna","format","g3d","ModelData"];Ra.prototype={clear:function(){this.bones=this.animations=
this.nodes=this.materials=this.meshes=null;Ra.current=this;this.partCount=0},addMesh:function(a){null!=a&&(null==this.meshes&&(this.meshes=[]),null==a.id&&(a.id=this.meshes.length+""),this.meshes.push(a))},getMeshById:function(a){for(var b=0,c=this.meshes;b<c.length;){var d=c[b];++b;if(d.id==a)return d}return null},getMeshByPartId:function(a){for(var b=0,c=this.meshes;b<c.length;){var d=c[b];++b;if(null!=d.getPart(a))return d}return null},addNode:function(a){null!=a&&(null==this.nodes&&(this.nodes=
[]),this.nodes.push(a))},addMaterial:function(a){null!=a&&(null==this.materials&&(this.materials=[]),this.materials.push(a),a.Init())},getMaterial:function(a){null==a&&(a="");if(null==this.materials)return null;if(1==this.materials.length&&""==a)return this.materials[0];for(var b=0,c=this.materials;b<c.length;){var d=c[b];++b;if(d.id==a)return d}return null},addBone:function(a){if(null==a)throw new z("bone is null");null==this.bones&&(this.bones=new J);var b=this.bones,c=a.id;(null!=p[c]?b.existsReserved(c):
b.h.hasOwnProperty(c))||(b=this.bones,c=a.id,null!=p[c]?b.setReserved(c,a):b.h[c]=a)},getBone:function(a){if(null==this.bones)return null;var b=this.bones;return null!=p[a]?b.getReserved(a):b.h[a]},addAnimation:function(a){null==this.animations&&(this.animations=[]);this.animations.push(a)},getAnimation:function(a){null==a&&(a="");if(null==this.animations)return null;if(1==this.animations.length&&""==a)return this.animations[0];for(var b=0,c=this.animations;b<c.length;){var d=c[b];++b;if(d.id==a)return d}return null},
init:function(){if(null!=this.nodes)for(var a=0,b=this.nodes.length;a<b;){var c=a++;this.buildNode(this.nodes[c])}if(null!=this.meshes)for(a=0,b=this.meshes.length;a<b;)c=a++,this.meshes[c].init()},dispose:function(){if(null!=this.meshes)for(var a=0,b=this.meshes.length;a<b;){var c=a++;this.meshes[c].dispose()}},buildNode:function(a){if(null!=a.parts)for(var b=0,c=a.parts.length;b<c;){var d=b++;d=a.parts[d];this.getMeshByPartId(d.meshPartId).addNodePart(d);if(null!=d.bones)for(var e=0,h=d.bones.length;e<
h;){var f=e++;this.addBone(d.getBone(d.bones[f]))}}if(null!=a.children)for(b=0,a=a.children;b<a.length;)c=a[b],++b,this.buildNode(c)},encode:function(a){var b=new Aa;b.setElement(1,null!=this.meshes);b.setElement(2,null!=this.materials);b.setElement(3,null!=this.nodes);b.setElement(4,null!=this.animations);a.writeUTF(this.id);a.writeInt(b.value);if(null!=this.meshes){b=this.meshes.length;a.writeInt(b);for(var c=0;c<b;){var d=c++;this.meshes[d].encode(a)}}if(null!=this.materials)for(b=this.materials.length,
a.writeInt(b),c=0;c<b;)d=c++,this.materials[d].encode(a);if(null!=this.nodes)for(b=this.nodes.length,a.writeInt(b),c=0;c<b;)d=c++,this.nodes[d].encode(a);if(null!=this.animations)for(b=this.animations.length,a.writeInt(b),c=0;c<b;)d=c++,this.animations[d].encode(a)},decode:function(a){this.animations=this.nodes=this.materials=this.meshes=null;this.id=a.readUTF();var b=new Aa;b.value=a.readInt();if(b.getElement(1))for(var c=0,d=a.readInt();c<d;){c++;var e=new Ja;e.decode(a);this.addMesh(e)}if(b.getElement(2))for(c=
0,d=a.readInt();c<d;)c++,e=new Gc,e.decode(a),this.addMaterial(e);if(b.getElement(3))for(c=0,d=a.readInt();c<d;)c++,e=new jc,e.decode(a),this.addNode(e);if(b.getElement(4))for(b=0,c=a.readInt();b<c;)b++,d=new Ec,d.decode(a),this.addAnimation(d)},__class__:Ra};var Gc=g.lovedna.format.g3d.ModelMaterial=function(){this.opacity=1;this.shininess=2};f["lovedna.format.g3d.ModelMaterial"]=Gc;Gc.__name__=["lovedna","format","g3d","ModelMaterial"];Gc.prototype={addTexture:function(a){null==this.textures&&(this.textures=
[]);this.textures.push(a);a.Init()},getTexture:function(a){null==a&&(a=0);if(null==this.textures)return null;if(0==a)return this.textures[0];for(var b=0,c=this.textures;b<c.length;){var d=c[b];++b;if(d.usage==a)return d}return null},Init:function(){null!=this.ambient&&(this.ambient.w=this.opacity);null!=this.diffuse&&(this.diffuse.w=this.opacity);null!=this.specular&&(this.specular.w=this.opacity);null!=this.emissive&&(this.emissive.w=this.opacity);null!=this.reflection&&(this.reflection.w=this.opacity)},
decode:function(a){this.reflection=this.emissive=this.specular=this.diffuse=this.ambient=this.textures=null;this.id=a.readUTF();var b=new Aa;b.value=a.readInt();b.getElement(1)&&(this.ambient=new Q(a.readFloat(),a.readFloat(),a.readFloat(),1));b.getElement(2)&&(this.diffuse=new Q(a.readFloat(),a.readFloat(),a.readFloat(),1));b.getElement(3)&&(this.emissive=new Q(a.readFloat(),a.readFloat(),a.readFloat(),1));b.getElement(4)&&(this.specular=new Q(a.readFloat(),a.readFloat(),a.readFloat(),1));b.getElement(5)&&
(this.reflection=new Q(a.readFloat(),a.readFloat(),a.readFloat(),1));this.opacity=a.readFloat();this.shininess=a.readFloat();if(b.getElement(6))for(b=a.readInt();0<b--;){var c=new Ka;c.decode(a);this.addTexture(c)}},encode:function(a){a.writeUTF(this.id);var b=new Aa(0);b.setElement(1,null!=this.ambient);b.setElement(2,null!=this.diffuse);b.setElement(3,null!=this.emissive);b.setElement(4,null!=this.specular);b.setElement(5,null!=this.reflection);b.setElement(6,null!=this.textures);a.writeInt(b.value);
null!=this.ambient&&(a.writeFloat(this.ambient.x),a.writeFloat(this.ambient.y),a.writeFloat(this.ambient.z));null!=this.diffuse&&(a.writeFloat(this.diffuse.x),a.writeFloat(this.diffuse.y),a.writeFloat(this.diffuse.z));null!=this.emissive&&(a.writeFloat(this.emissive.x),a.writeFloat(this.emissive.y),a.writeFloat(this.emissive.z));null!=this.specular&&(a.writeFloat(this.specular.x),a.writeFloat(this.specular.y),a.writeFloat(this.specular.z));null!=this.reflection&&(a.writeFloat(this.reflection.x),a.writeFloat(this.reflection.y),
a.writeFloat(this.reflection.z));a.writeFloat(this.opacity);a.writeFloat(this.shininess);if(null!=this.textures){a.writeInt(this.textures.length);b=0;for(var c=this.textures.length;b<c;){var d=b++;this.textures[d].encode(a)}}},__class__:Gc};var Ja=g.lovedna.format.g3d.ModelMesh=function(){};f["lovedna.format.g3d.ModelMesh"]=Ja;Ja.__name__=["lovedna","format","g3d","ModelMesh"];Ja.prototype={encode:function(a){a.writeUTF(this.id);var b=new Aa;b.setElement(1,null!=this.attributes);b.setElement(2,null!=
this.vertices);b.setElement(3,null!=this.parts);a.writeInt(b.value);if(null!=this.attributes){a.writeInt(this.attributes.length);b=0;for(var c=this.attributes.length;b<c;){var d=b++;a.writeUTF(this.attributes[d])}}if(null!=this.vertices)for(a.writeInt(this.vertices.length),b=0,c=this.vertices.length;b<c;)d=b++,a.writeFloat(this.vertices[d]);if(null!=this.parts)for(a.writeInt(this.parts.length),b=0,c=this.parts.length;b<c;)d=b++,this.parts[d].encode(a)},decode:function(a){this.parts=null;this.id=a.readUTF();
var b=new Aa;b.value=a.readInt();if(b.getElement(1)){this.attributes=[];for(var c=a.readInt();0<c--;)this.attributes.push(a.readUTF())}if(b.getElement(2))for(this.vertices=[],c=a.readInt();0<c--;)this.vertices.push(a.readFloat());if(b.getElement(3))for(b=a.readInt();0<b--;)c=new Hc,c.decode(a),this.addPart(c)},addPart:function(a){null==this.parts&&(this.parts=[]);a.mesh=this;this.parts.push(a)},getPart:function(a){for(var b=this.parts.length;0<b--;){var c=this.parts[b];if(c.id==a)return c}return null},
addNodePart:function(a){null==this.nodeParts&&(this.nodeParts=[]);this.nodeParts.push(a)},init:function(){this.geom=new Qa;for(var a=[],b=0,c=0,d=this.attributes.length;c<d;){var e=c++;e=this.attributes[e];"POSITION"==e?(this.geom.position=[],a.push(q(this,this._readPOSITION)),b+=3):"NORMAL"==e?(this.geom.normal=[],a.push(q(this,this._readNORMAL)),b+=3):"BINORMAL"==e?(this.geom.normal2=[],a.push(q(this,this._readBINORMAL)),b+=3):"TANGENT"==e?(this.geom.tangent=[],a.push(q(this,this._readTANGENT)),
b+=3):"COLOR"==e?(this.geom.color=[],a.push(q(this,this._readCOLOR)),b+=4):"TEXCOORD0"==e?(this.geom.uv=[],a.push(q(this,this._readTEXCOORD0)),b+=2):"TEXCOORD1"==e?(this.geom.uv2=[],a.push(q(this,this._readTEXCOORD1)),b+=2):"BLENDWEIGHT0"==e?(this.geom.boneWeight=[],a.push(q(this,this._readBLENDWEIGHT0)),b+=2):"BLENDWEIGHT1"==e?(a.push(q(this,this._readBLENDWEIGHT1)),b+=2):"BLENDWEIGHT2"==e?(a.push(q(this,this._readBLENDWEIGHT2)),b+=2):"BLENDWEIGHT3"==e&&(a.push(q(this,this._readBLENDWEIGHT3)),b+=
2)}c=this.vertices.length/b|0;if(c<this.vertices.length/b)throw new z("error vertices count");b=0;d=a.length;for(e=0;e<c;){e++;for(var h=0,f=d;h<f;){var g=h++;b+=a[g](b)}}if(null!=this.nodeParts)for(a=0,c=this.nodeParts.length;a<c;)b=a++,b=this.getPart(this.nodeParts[b].meshPartId),b.subMeshId=this.geom.groups.length,this.geom.addGroup(b.indices)},dispose:function(){this.vertices=null;if(null!=this.nodeParts)for(var a=0,b=this.nodeParts.length;a<b;){var c=a++;this.getPart(this.nodeParts[c].meshPartId).indices=
null}},_readPOSITION:function(a){a=(new m).fromArray(this.vertices,a);null!=Ra.transform&&Ra.transform.transformVector(a);this.geom.position.push(a);return 3},_readNORMAL:function(a){a=(new m).fromArray(this.vertices,a);null!=Ra.transform&&Ra.transform.transformVector(a);this.geom.normal.push(a.normalize());return 3},_readBINORMAL:function(a){a=(new m).fromArray(this.vertices,a);null!=Ra.transform&&Ra.transform.transformVector(a);this.geom.normal2.push(a);return 3},_readTANGENT:function(a){this.geom.tangent.push((new Q).fromArray(this.vertices,
a));return 3},_readCOLOR:function(a){this.geom.color.push((new Q).fromArray(this.vertices,a));return 4},_readTEXCOORD0:function(a){this.geom.uv.push((new v).fromArray(this.vertices,a));return 2},_readTEXCOORD1:function(a){this.geom.uv2.push((new v).fromArray(this.vertices,a));return 2},_readBLENDWEIGHT0:function(a){var b=new Gd;b.index.x=this.vertices[a];b.weight.x=this.vertices[a+1];this.geom.boneWeight.push(b);return 2},_readBLENDWEIGHT1:function(a){var b=this.geom.boneWeight[this.geom.boneWeight.length-
1];b.index.y=this.vertices[a];b.weight.y=this.vertices[a+1];return 2},_readBLENDWEIGHT2:function(a){var b=this.geom.boneWeight[this.geom.boneWeight.length-1];b.index.z=this.vertices[a];b.weight.y=this.vertices[a+1];return 2},_readBLENDWEIGHT3:function(a){var b=this.geom.boneWeight[this.geom.boneWeight.length-1];b.index.w=this.vertices[a];b.weight.w=this.vertices[a+1];return 2},__class__:Ja};var Hc=g.lovedna.format.g3d.ModelMeshPart=function(){this.primitiveType="TRIANGLES"};f["lovedna.format.g3d.ModelMeshPart"]=
Hc;Hc.__name__=["lovedna","format","g3d","ModelMeshPart"];Hc.prototype={encode:function(a){a.writeUTF(this.id);a.writeUTF(this.primitiveType);if(null!=this.indices){a.writeInt(this.indices.length);for(var b=0,c=this.indices.length;b<c;){var d=b++;a.writeShort(this.indices[d])}}else a.writeInt(0)},decode:function(a){this.id=a.readUTF();this.primitiveType=a.readUTF();var b=a.readInt();for(this.indices=[];0<b--;)this.indices.push(a.readShort())},__class__:Hc};var jc=g.lovedna.format.g3d.ModelNode=function(){};
f["lovedna.format.g3d.ModelNode"]=jc;jc.__name__=["lovedna","format","g3d","ModelNode"];jc.prototype={addPart:function(a){null==this.parts&&(this.parts=[]);this.parts.push(a);a.node=this},addChildren:function(a){null==this.children&&(this.children=[]);this.children.push(a);a.parent=this},decode:function(a){this.scale=this.rotation=this.translation=this.meshId=this.children=this.parts=null;this.id=a.readUTF();var b=new Aa;b.value=a.readInt();b.getElement(1)&&(this.translation=new m(a.readFloat(),a.readFloat(),
a.readFloat()));b.getElement(2)&&(this.rotation=new ja(a.readFloat(),a.readFloat(),a.readFloat(),a.readFloat()));b.getElement(3)&&(this.scale=new m(a.readFloat(),a.readFloat(),a.readFloat()));b.getElement(4)&&(this.meshId=a.readUTF());if(b.getElement(5))for(var c=a.readInt();0<c--;){var d=new Ic;d.decode(a);this.addPart(d)}if(b.getElement(6))for(b=a.readInt();0<b--;)c=new jc,c.decode(a),this.addChildren(c)},encode:function(a){a.writeUTF(this.id);var b=new Aa;b.clear();b.setElement(1,null!=this.translation);
b.setElement(2,null!=this.rotation);b.setElement(3,null!=this.scale);b.setElement(4,null!=this.meshId);b.setElement(5,null!=this.parts);b.setElement(6,null!=this.children);a.writeInt(b.value);null!=this.translation&&(a.writeFloat(this.translation.x),a.writeFloat(this.translation.y),a.writeFloat(this.translation.z));null!=this.rotation&&(a.writeFloat(this.rotation.x),a.writeFloat(this.rotation.y),a.writeFloat(this.rotation.z),a.writeFloat(this.rotation.w));null!=this.scale&&(a.writeFloat(this.scale.x),
a.writeFloat(this.scale.y),a.writeFloat(this.scale.z));null!=this.meshId&&a.writeUTF(this.meshId);if(null!=this.parts){b=this.parts.length;a.writeInt(b);for(var c=0;c<b;){var d=c++;this.parts[d].encode(a)}}if(null!=this.children)for(b=this.children.length,a.writeInt(b),c=0;c<b;)d=c++,this.children[d].encode(a)},__class__:jc};var Fc=g.lovedna.format.g3d.ModelNodeAnimation=function(){this.translation=[];this.rotation=[];this.scaling=[];this.count=this.totalTime=0;this._tTime=[];this._rTime=[];this._sTime=
[];this._rincTime=[];this._tincTime=[];this._sincTime=[];this._ct=new m;this._cr=new ja;this._cs=new m};f["lovedna.format.g3d.ModelNodeAnimation"]=Fc;Fc.__name__=["lovedna","format","g3d","ModelNodeAnimation"];Fc.prototype={getTranslation:function(a,b){var c=this.translation.length;if(1>c)return null;var d=n.binarySearchLow(this._tTime,a);if(0>d)return this._ct.copy(this.translation[0].value),this._ct;a=(a-this._tTime[d])/this._tincTime[d];null!=b&&(a=b(a));this._ct.copy(this.translation[d].value);
d+1<c&&this._ct.lerpTo(this.translation[d+1].value,a);return this._ct},getRotation:function(a,b){var c=this.rotation.length;if(1>c)return null;var d=n.binarySearchLow(this._rTime,a);if(0>d)return this._cr.copy(this.rotation[0].value),this._cr;a=(a-this._rTime[d])/this._rincTime[d];null!=b&&(a=b(a));this._cr.copy(this.rotation[d].value);d<c-1&&this._cr.slerpTo(this.rotation[d+1].value,a);return this._cr},getScaling:function(a,b){var c=this.scaling.length;if(1>c)return null;var d=n.binarySearchLow(this._sTime,
a);if(0>d)return this._cs.copy(this.scaling[0].value),this._cs;a=(a-this._sTime[d])/this._sincTime[d];null!=b&&(a=b(a));this._cs.copy(this.scaling[d].value);d<c-1&&this._cs.lerpTo(this.scaling[d+1].value,a);return this._cs},addTranslation:function(a){this.translation.push(a);0<this._tTime.length&&this._tincTime.push(a.keytime-this._tTime[this._tTime.length-1]);this._tTime.push(a.keytime)},addRotation:function(a){this.rotation.push(a);0<this._rTime.length&&this._rincTime.push(a.keytime-this._rTime[this._rTime.length-
1]);this._rTime.push(a.keytime)},addScaling:function(a){this.scaling.push(a);0<this._sTime.length&&this._sincTime.push(a.keytime-this._sTime[this._sTime.length-1]);this._sTime.push(a.keytime)},encode:function(a){a.writeUTF(this.nodeId);a.writeInt(this.translation.length);for(var b=0,c=this.translation.length;b<c;){var d=b++;d=this.translation[d];a.writeFloat(d.keytime);a.writeFloat(d.value.x);a.writeFloat(d.value.y);a.writeFloat(d.value.z)}a.writeInt(this.rotation.length);b=0;for(c=this.rotation.length;b<
c;)d=b++,d=this.rotation[d],a.writeFloat(d.keytime),a.writeFloat(d.value.x),a.writeFloat(d.value.y),a.writeFloat(d.value.z),a.writeFloat(d.value.w);a.writeInt(this.scaling.length);b=0;for(c=this.scaling.length;b<c;)d=b++,d=this.scaling[d],a.writeFloat(d.keytime),a.writeFloat(d.value.x),a.writeFloat(d.value.y),a.writeFloat(d.value.z)},decode:function(a){this.nodeId=a.readUTF();for(var b=a.readInt();0<b--;)this.addTranslation(new xb(a.readFloat(),new m(a.readFloat(),a.readFloat(),a.readFloat())));for(b=
a.readInt();0<b--;)this.addRotation(new xb(a.readFloat(),new ja(a.readFloat(),a.readFloat(),a.readFloat(),a.readFloat())));for(b=a.readInt();0<b--;)this.addScaling(new xb(a.readFloat(),new m(a.readFloat(),a.readFloat(),a.readFloat())));this.init()},init:function(){this._tincTime.push(1);this._rincTime.push(1);this._sincTime.push(1);this.totalTime=this.count=0;var a=this.translation.length;0<a&&(this.count=a,this.totalTime=this.translation[a-1].keytime);a=this.rotation.length;0<a&&(a>this.count&&(this.count=
a),this.rotation[a-1].keytime>this.totalTime&&(this.totalTime=this.rotation[a-1].keytime));a=this.scaling.length;0<a&&(a>this.count&&(this.count=a),this.scaling[a-1].keytime>this.totalTime&&(this.totalTime=this.scaling[a-1].keytime))},__class__:Fc};var xb=g.lovedna.format.g3d.ModelNodeKeyframe=function(a,b){this.keytime=a;this.value=b};f["lovedna.format.g3d.ModelNodeKeyframe"]=xb;xb.__name__=["lovedna","format","g3d","ModelNodeKeyframe"];xb.prototype={__class__:xb};var Ic=g.lovedna.format.g3d.ModelNodePart=
function(){};f["lovedna.format.g3d.ModelNodePart"]=Ic;Ic.__name__=["lovedna","format","g3d","ModelNodePart"];Ic.prototype={encode:function(a){a.writeUTF(this.materialId);a.writeUTF(this.meshPartId);if(null!=this.bones){a.writeInt(this.bones.length);for(var b=0,c=this.bones.length;b<c;){var d=b++;this.getBone(this.bones[d]).encode(a)}}else a.writeInt(0)},decode:function(a){Ra.current.partCount++;this._boneMap=this.bones=null;this.materialId=a.readUTF();this.meshPartId=a.readUTF();for(var b=a.readInt();0<
b--;){var c=new Jc;c.decode(a);this.addBone(c.id,c.translation,c.rotation,c.scale)}},addBone:function(a,b,c,d){null==this.bones&&(this.bones=[],this._boneMap=new J);var e=new Jc,h=this._boneMap;null!=p[a]?h.setReserved(a,e):h.h[a]=e;e.id=a;e.translation=b;e.rotation=c;e.scale=d;this.bones.push(a)},getBone:function(a){var b=this._boneMap;return null!=p[a]?b.getReserved(a):b.h[a]},__class__:Ic};var Jc=g.lovedna.format.g3d.ModelNodePartBone=function(){};f["lovedna.format.g3d.ModelNodePartBone"]=Jc;Jc.__name__=
["lovedna","format","g3d","ModelNodePartBone"];Jc.prototype={encode:function(a){a.writeUTF(this.id);var b=new Aa;b.setElement(1,null!=this.translation);b.setElement(2,null!=this.rotation);b.setElement(3,null!=this.scale);a.writeInt(b.value);null!=this.translation&&(a.writeFloat(this.translation.x),a.writeFloat(this.translation.y),a.writeFloat(this.translation.z));null!=this.rotation&&(a.writeFloat(this.rotation.x),a.writeFloat(this.rotation.y),a.writeFloat(this.rotation.z),a.writeFloat(this.rotation.w));
null!=this.scale&&(a.writeFloat(this.scale.x),a.writeFloat(this.scale.y),a.writeFloat(this.scale.z))},decode:function(a){this.id=a.readUTF();var b=new Aa;b.value=a.readInt();b.getElement(1)&&(this.translation=new m(a.readFloat(),a.readFloat(),a.readFloat()));b.getElement(2)&&(this.rotation=new ja(a.readFloat(),a.readFloat(),a.readFloat(),a.readFloat()));b.getElement(3)&&(this.scale=new m(a.readFloat(),a.readFloat(),a.readFloat()))},__class__:Jc};var Ka=g.lovedna.format.g3d.ModelTexture=function(){this.uvTranslation=
new v(0,0);this.uvScaling=new v(1,1);this.type="DIFFUSE";this.fileName=this.id=""};f["lovedna.format.g3d.ModelTexture"]=Ka;Ka.__name__=["lovedna","format","g3d","ModelTexture"];Ka.prototype={Init:function(){"AMBIENT"==this.type?this.usage=4:"BUMP"==this.type?this.usage=8:"DIFFUSE"==this.type?this.usage=2:"EMISSIVE"==this.type?this.usage=3:"NONE"==this.type?this.usage=1:"NORMAL"==this.type?this.usage=7:"REFLECTION"==this.type?this.usage=10:"SHININESS"==this.type?this.usage=6:"SPECULAR"==this.type?
this.usage=5:"TRANSPARENCY"==this.type&&(this.usage=9);this.usage=0},encode:function(a){null==this.id&&(this.id="");a.writeUTF(this.id);a.writeUTF(this.fileName);a.writeUTF(this.type);a.writeFloat(this.uvTranslation.x);a.writeFloat(this.uvTranslation.y);a.writeFloat(this.uvScaling.x);a.writeFloat(this.uvScaling.y)},decode:function(a){this.id=a.readUTF();this.fileName=a.readUTF();this.type=a.readUTF();this.uvTranslation=new v(a.readFloat(),a.readFloat());this.uvScaling=new v(a.readFloat(),a.readFloat())},
__class__:Ka};var Gd=g.lovedna.format.mesh.BoneWeight=function(){this.index=new Q(0,0,0,0);this.weight=new Q(0,0,0,0)};f["lovedna.format.mesh.BoneWeight"]=Gd;Gd.__name__=["lovedna","format","mesh","BoneWeight"];Gd.prototype={__class__:Gd};var Y=g.lovedna.utils.TempPool=function(a,b,c){null==c&&(c=!0);this._list=[];this._index=0;this._create=a;this._opts=b;this.count=0;c&&Y._pools.push(this);this._avacount=10};f["lovedna.utils.TempPool"]=Y;Y.__name__=["lovedna","utils","TempPool"];Y.reset=function(){for(var a=
P._custom(),b=Y._pools.length;0<b--;)Y._pools[b].clear(a)};Y.prototype={get:function(){if(this._index<this._list.length){var a=this._list[this._index++];null!=this._opts&&null!=this._opts.reset&&this._opts.reset(a)}else a=this._create(),this._list[this._index++]=a,null!=this._opts&&null!=this._opts.init&&this._opts.init(a);this.count=this._list.length;return a},clear:function(a){this._index=0},__class__:Y};var v=g.lovedna.math.Vector2=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};
f["lovedna.math.Vector2"]=v;v.__name__=["lovedna","math","Vector2"];v.__interfaces__=[vb,Kb];v.__properties__={get_one:"get_one",get_zero:"get_zero",get_left:"get_left",get_right:"get_right",get_down:"get_down",get_up:"get_up",get_temp:"get_temp"};v.get_temp=function(){return v._pool.get()};v.get_up=function(){var a=v._pool.get();a.x=0;a.y=1;return a};v.get_down=function(){var a=v._pool.get();a.x=0;a.y=-1;return a};v.get_right=function(){var a=v._pool.get();a.x=1;a.y=0;return a};v.get_left=function(){var a=
v._pool.get();a.x=-1;a.y=0;return a};v.get_zero=function(){var a=v._pool.get();a.x=0;a.y=0;return a};v.get_one=function(){var a=v._pool.get();a.x=1;a.y=1;return a};v.prototype={toString:function(){return"Vector2("+n.fixed(this.x,4)+","+n.fixed(this.y,4)+")"},fixed:function(a){null==a&&(a=4);return"Vector2("+n.fixed(this.x,a)+","+n.fixed(this.y,a)+")"},set:function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;return this},copy:function(a){if(null==a||a==this)return this;this.x=a.x;this.y=a.y;
return this},from:function(a){this.x=a.x;this.y=a.y;return this},clone:function(){return new v(this.x,this.y)},add:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;this.x=d.x+a.x;this.y=d.y+a.y;return this},sub:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;this.x=d.x-a.x;this.y=d.y-a.y;return this},mul:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;this.x=d.x*a.x;this.y=d.y*a.y;return this},dot:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return d.x*a.x+d.y*a.y},cross:function(a,b){var c=null==b,
d=c?this:a;a=c?a:b;return d.x*a.y-d.y*a.x},min:function(a,b){var c=null==b,d=c?this:a;c=c?a:b;a=d.x;b=c.x;d=d.y;c=c.y;this.x=a<b?a:b;this.y=d<c?d:c;return this},max:function(a,b){var c=null==b,d=c?this:a;c=c?a:b;a=d.x;b=c.x;d=d.y;c=c.y;this.x=a>b?a:b;this.y=d>c?d:c;return this},scale:function(a){this.x*=a;this.y*=a;return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(0!=a)return this.scale(1/a);this.y=this.x=
0;return this},distanceSquared:function(a,b){var c=null==b,d=c?this:a;b=c?a:b;a=d.x-b.x;d=d.y-b.y;return a*a+d*d},distance:function(a,b){return Math.sqrt(this.distanceSquared(a,b))},equals:function(a){return this.x==a.x?this.y==a.y:!1},isZero:function(){return 1E-7>n.abs(this.x)?1E-7>n.abs(this.y):!1},isOne:function(){return 1E-7>n.abs(this.x-1)?1E-7>n.abs(this.y-1):!1},angleTo:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;b=Math.sqrt(d.x*d.x+d.y*d.y);c=Math.sqrt(a.x*a.x+a.y*a.y);return 0<b&&0<c?
57.29577951308232*Math.acos(d.dot(a)/(b*c)):0},lerpTo:function(a,b){if(0>=b)return this;if(1<=b)return this.copy(a);this.x+=b*(a.x-this.x);this.y+=b*(a.y-this.y);return this},projectOnto:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;b=a.dot(a);if(0==b)return this.y=this.x=0,this;d=d.dot(a)/b;return this.copy(a).scale(d)},reflectBy:function(a){a=v._pool.get().copy(this).projectOnto(a);a.scale(2);return this.sub(a)},rotateLeft:function(){var a=-this.y;this.y=this.x;this.x=a;return this},rotateRight:function(){var a=
this.y;this.y=-this.x;this.x=a;return this},rotate:function(a,b){a*=.017453292519943295;var c=Math.cos(a);a=Math.sin(a);var d=this.x-b.x;b=this.y-b.y;this.x=d*c-b*a;this.y=d*a+b*c;return this},clamp:function(a,b){var c=this.x;this.x=c<a?a:c>b?b:c;c=this.y;this.y=c<a?a:c>b?b:c;return this},getElement:function(a){0>a?a=a%2+2:2<=a&&(a%=2);return 0==a?this.x:this.y},setElement:function(a,b){0>a?a=a%2+2:2<=a&&(a%=2);0==a?this.x=b:this.y=b},fillArray:function(a,b){null==b&&(b=0);a[b++]=this.x;a[b++]=this.y},
fromArray:function(a,b){null==b&&(b=0);if(null==a)return this;var c=a.length;b<c&&(this.x=a[b++]);b<c&&(this.y=a[b++]);return this},get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(a){var b=Math.atan2(this.y,this.x);this.x=Math.cos(b)*a;this.y=Math.sin(b)*a;return a},get_lengthSq:function(){return this.x*this.x+this.y*this.y},get_angle:function(){return 57.29577951308232*Math.atan2(this.y,this.x)},set_angle:function(a){var b=Math.sqrt(this.x*this.x+this.y*this.y);
a*=.017453292519943295;this.x=Math.cos(a)*b;this.y=Math.sin(a)*b;return a},__class__:v,__properties__:{get_lengthSq:"get_lengthSq",get_length:"get_length",set_angle:"set_angle",get_angle:"get_angle"}};var Qa=g.lovedna.format.mesh.Geometry=function(){this.id=Qa._id++;this.groups=[]};f["lovedna.format.mesh.Geometry"]=Qa;Qa.__name__=["lovedna","format","mesh","Geometry"];Qa.prototype={dispose:function(){this.color9=this.color8=this.color7=this.color6=this.color5=this.color4=this.color3=this.color2=this.color=
this.boneWeight=this.tangent=this.normal2=this.normal=this.uv2=this.uv=this.position=null;if(null!=this.groups)for(var a=this.groups.length;0<a--;)this.groups[a].dispose();this.transform=this.groups=null},clearGroup:function(){this.groups.splice(0,this.groups.length)},addGroup:function(a){var b=0;0<this.groups.length&&(b=this.groups[this.groups.length-1],b=b.offset+b.indices.length);a=new Hd(a,b);this.groups.push(a)},addCustomUvGetter:function(a,b){null==b&&(b=-1);null==this._customUvGetter&&(this._customUvGetter=
[]);0>b?this._customUvGetter.push(a):this._customUvGetter.splice(b,0,a)},getCustomUvGetter:function(a){null==a&&(a=0);return null==this._customUvGetter||null==this._customUvGetter[a]?q(this,this._getuv):this._customUvGetter[a]},_getuv:function(a,b){var c=Qa._uv;c.x=a;c.y=b;return c},__class__:Qa};var Hd=g.lovedna.format.mesh.Group=function(a,b){null==b&&(b=0);this.indices=a;this.offset=b;this.start=2*b};f["lovedna.format.mesh.Group"]=Hd;Hd.__name__=["lovedna","format","mesh","Group"];Hd.prototype=
{dispose:function(){this.indices=null},__class__:Hd};var kc=g.lovedna.format.meta.Meta=function(){M.call(this);this._list=[];this._map=new J};f["lovedna.format.meta.Meta"]=kc;kc.__name__=["lovedna","format","meta","Meta"];kc.__super__=M;kc.prototype=r(M.prototype,{addMeta:function(a){this._list.push(a);if(null!=a.path){var b=this._map,c=a.path;null!=p[c]?b.setReserved(c,a):b.h[c]=a}},getMeta:function(a){var b=this._map;return null!=p[a]?b.getReserved(a):b.h[a]},encode:function(){var a=na._new(),b=
this._list.length;for(a.writeInt(b);0<b--;)a.writeUTF(this._list[b].encode());return a},decode:function(a){for(var b=a.readInt();0<b--;){var c=new Id;c.read(JSON.parse(a.readUTF()));if(null!=c.path){var d=this._map,e=c.path;null!=p[e]?d.setReserved(e,c):d.h[e]=c}}},__class__:kc});var Id=g.lovedna.format.meta.MetaInfo=function(){this._meta=new J};f["lovedna.format.meta.MetaInfo"]=Id;Id.__name__=["lovedna","format","meta","MetaInfo"];Id.prototype={get:function(a){var b=this._meta;return null!=p[a]?
b.getReserved(a):b.h[a]},addInfo:function(a,b){var c=this._meta;null!=p[a]?c.setReserved(a,b):c.h[a]=b;"path"==a?this.path=b:"crc"==a?this.crc=b:"size"==a&&(this.size=b)},encode:function(){var a=this._meta,b=this.path;null!=p.path?a.setReserved("path",b):a.h.path=b;return JSON.stringify(this._meta)},read:function(a){for(var b=ma.fields(a),c=b.length;0<c--;){var d=b[c];this.addInfo(d,t.getValue(a,d))}},__class__:Id};var Lb=g.lovedna.format.png.Png=function(){this._IEND=new da;this._IEND.type=1229278788;
this._chunkList=[];if(null==Lb._keepType){Lb._keepType=new Z;for(var a=[1229472850,1229209940,1229278788,1665684045,1732332865,1933723988,1347179589,1649100612,1749635924,1951551059],b=a.length;0<b--;)Lb._keepType.h[a[b]]=!0}};f["lovedna.format.png.Png"]=Lb;Lb.__name__=["lovedna","format","png","Png"];Lb.prototype={decode:function(a){var b=this._chunkList.length;0<b&&this._chunkList.splice(0,b);if(!ta.gt(12,a._length-a.position)){a.bigEndian=!0;b=a.position;a.position=b+8;var c=a.readInt();if(100<
c&&(a.position=b+8,c=a.readInt(),100<c))return;if(1229472850==a.readInt())for(a.position=b+8;ta.gt(a._length-a.position,0);){b=new da;b.decode(a);c=b.type;if(1>c)break;1229278788==c?this._IEND=b:this.addChunk(b)}}},pack:function(){var a=na._new();a.bigEndian=!0;a.writeUnsignedInt(-1991225785);a.writeUnsignedInt(218765834);for(var b,c=0,d=this._chunkList.length;c<d;)b=c++,b=this._chunkList[b].encode(),a.writeBlob(b);b=this._IEND.encode();a.writeBlob(b);return a},getChunkList:function(){return this._chunkList},
getChunk:function(a){for(var b=this._chunkList.length;0<b--;){var c=this._chunkList[b];if(c.type==a)return c}return null},addChunk:function(a){this._chunkList.push(a)},getData:function(){return this._bytes},removeChunk:function(a){null==a&&(a=0);if(null!=this._chunkList)for(var b=this._chunkList.length;0<b--;){var c=this._chunkList[b];Lb._keepType.h.hasOwnProperty(c.type)||(0==a?this._chunkList.splice(b,1):c.type==a&&this._chunkList.splice(b,1))}},__class__:Lb};var da=g.lovedna.format.png.PngChunk=
function(){};f["lovedna.format.png.PngChunk"]=da;da.__name__=["lovedna","format","png","PngChunk"];da.prototype={decode:function(a){var b=a.readUnsignedInt();this.type=a.readUnsignedInt();this._content=na._new();0<b&&a.readBlob(this._content,0,b);this._crc=a.readInt()},encode:function(){var a=0;null!=this._content&&(a=this._content._length);var b=na._new();b.bigEndian=!0;b.writeInt(a);b.writeUnsignedInt(this.type);null!=this._content&&b.writeBlob(this._content);b.writeInt(this._crc);return b},getContent:function(){this._content.bigEndian=
!1;return this._content},setContent:function(a){this._content=a;a=na._new();a.bigEndian=!1;a.writeUnsignedInt(this.type);null!=this._content&&a.writeBlob(this._content);this._crc=yb.getCRC32(a.getBytes())},toString:function(){return"Chunk:0x"+X.hex(this.type,8)},__class__:da};var Zb=g.lovedna.format.tag.TagData=function(a){this.type=a;this.compress=!0};f["lovedna.format.tag.TagData"]=Zb;Zb.__name__=["lovedna","format","tag","TagData"];Zb.prototype={encode:function(a){this.compress&&(a.position=0,
a=na.fromBytes(yb.compress(na.toBytes(a))));var b=a._length,c=na._new();c.writeUnsignedInt(-199789115);c.writeUnsignedInt(this.type);c.writeByte(this.compress?1:0);c.writeInt(b);c.writeBlob(a);return c},decode:function(a){if(ta.gt(1,a._length-a.position)||ta.gt(2,a._length-a.position)||ta.gt(13,a._length-a.position)||ta.gte(a.position+13,a._length))return null;if(-199789115==a.readUnsignedInt()){this.type=a.readUnsignedInt();var b=0!=a.readUnsignedByte(),c=a.readInt(),d=na._new();a.readBlob(d,0,c);
return b?na.fromBytes(yb.uncompress(na.toBytes(d))):d}a.position-=4;return null},__class__:Zb};var Rb=function(a,b){this.component=a;this.state=b};f["lovedna.game._Actor.ComponentState"]=Rb;Rb.__name__=["lovedna","game","_Actor","ComponentState"];Rb.prototype={__class__:Rb};var Mb=g.lovedna.game.CameraClearFlags=function(){this.type=3;this.color=new ca(0,0,0,0)};f["lovedna.game.CameraClearFlags"]=Mb;Mb.__name__=["lovedna","game","CameraClearFlags"];Mb.prototype={__class__:Mb};var k=g.lovedna.game.DefineName=
function(a,b,c){null==c&&(c=0);null==b&&(b=0);this.name=a;this.size=b;this.index=c};f["lovedna.game.DefineName"]=k;k.__name__=["lovedna","game","DefineName"];k.prototype={__class__:k};var $a=g.lovedna.game.Game=function(){M.call(this);this._frame=0;this.playStep=this.pause=!1;$a.current=this;this.commands=new Kc;this.pause=!1;this._worlds=new O;this.system=new u;this.clear=!0;this.color=new ca;this.color.setRGBA(-1412567041);this.system.addEventListener(ua.init._type,q(this,this.sysinit));U.trace("Game build 2018-08-13 23:35:06",
{fileName:"Game.hx",lineNumber:53,className:"lovedna.game.Game",methodName:"new"})};f["lovedna.game.Game"]=$a;$a.__name__=["lovedna","game","Game"];$a.debug=function(a){null==a&&(a=!1);if(a){if($a.current.pause)debugger}else debugger};$a.__super__=M;$a.prototype=r(M.prototype,{addWorld:function(a){$a.current=this;a.width=this.system.width;a.height=this.system.height;this._worlds.remove(a);this._worlds.push(a);a._now=P._custom();a._fixedTime=0;a.game=$a.current},removeWorld:function(a){this._worlds.remove(a)},
sysinit:function(a){this.resize(null);this.system.addEventListener(ua.update._type,q(this,this.update));this.system.addEventListener(ua.resize._type,q(this,this.resize));l.init(u.gl);if(null!=this.onInit)this.onInit();E.init()},update:function(a){if(this.pause){if(!this.playStep)return;this.playStep=!1}this.commands.clear();l.start(this.w,this.h);a=this._target;null!=ea.customBackBuffer&&(a=ea.customBackBuffer);l.pushTarget(a);this.clear&&null!=this.color&&l.clear(this.color,1,0);E.step();for(var b=
0,c=this._worlds.get_length();b<c;){var d=b++;this._worlds.get(d)._update(this._frame)}this._frame+=1;F.update();b=0;for(c=this._worlds.get_length();b<c;)d=b++,this._worlds.get(d);this.commands.flush();this.dispatchEvent(w.onPostRender);l.popTarget();ea.blit(a,null,ea.customBackMaterial);l.end();H._endFrame();Y.reset()},resize:function(a){a=this._worlds.get_length();this.w=this.system.width;this.h=this.system.height;ea.setSize(this.w,this.h);for(var b=0;b<a;){var c=b++;c=this._worlds.get(c);c.width=
this.w;c.height=this.h;c._resized=!0}null==this._target?(a=0,this.system.depth&&(a=16),this.system.stencil&&(a=24),this._target=new Lc(this.w,this.h,a)):this._target.resize(this.w,this.h)},__class__:$a});var ka=g.lovedna.game.LayerMask=function(a){if(null==a)this.data=new Aa(-1);else{this.data=new Aa(0);for(var b=a.length;0<b--;){var c=ka.nameToLayer(a[b]);this.data.setElement(c)}0==this.data.value&&(this.data.value=-1)}};f["lovedna.game.LayerMask"]=ka;ka.__name__=["lovedna","game","LayerMask"];ka.setLayerName=
function(a,b){if(null==ka._names[a]){ka._names[a]=b;var c=ka._layers;null!=p[b]?c.setReserved(b,a):c.h[b]=a}};ka.layerToName=function(a){return ka._names[a]};ka.nameToLayer=function(a){var b=ka._layers;return null!=p[a]?b.getReserved(a):b.h[a]};ka.prototype={exist:function(a){return this.data.getElement(a)},clear:function(){this.data.clear()},__class__:ka};var F=g.lovedna.game.GameInput=function(){};f["lovedna.game.GameInput"]=F;F.__name__=["lovedna","game","GameInput"];F.raycastAll=function(a,b,
c,d){null==c&&(c=99999999);F._raycastList.clear();null==b&&(b=F._layerMask);null==d&&(d=Qb.current);if(null==a||null==d)return F._raycastList;d=d.collectorCollider;var e=d.count;for(c*=c;0<e--;){var h=d._list[e];h.enabled&&b.exist(h.actor.layer)&&(h=h.raycast(a,c),null!=h&&F._raycastList.push(h))}return F._raycastList};F.touchDown=function(a){null==a&&(a=0);return 1==F._touchDown.h[a]};F.touchUp=function(a){null==a&&(a=0);return 1==F._touchUp.h[a]};F.getTouch=function(a){null==a&&(a=0);return F._touchs[a]};
F.update=function(){if(!F._init){F._init=!0;F._touchDown=new Z;F._touchUp=new Z;F._touchIdList=new O;for(var a=10;0<a--;)F._touchDown.h[a]=!1,F._touchUp.h[a]=!1;F.touchCount=0;Fa.onEvent.addEventListener(db.onUpdate._type,F.ontouch)}if(F._touchChange){F._touchChange=!1;for(a=F._touchIdList.get_length();0<a--;){var b=F._touchIdList.get(a);F._touchUp.h[b]&&F._touchIdList.removeAt(a);F._touchUp.h[b]=!1;F._touchDown.h[b]=!1}F.touchCount=F._touchIdList.get_length()}};F.ontouch=function(a){a=db.onUpdate.touch;
var b=a.type;1==b?1!=F._touchDown.h[a.touchId]&&(F._touchIdList.push(a.touchId),F._touchDown.h[a.touchId]=!0,F._touchChange=!0,F.touchCount=F._touchIdList.get_length(),F._touchs[a.touchId]=a):5==b&&(F._touchUp.h[a.touchId]=!0,F._touchChange=!0)};F.prototype={__class__:F};var E=g.lovedna.game.GameTime=function(){};f["lovedna.game.GameTime"]=E;E.__name__=["lovedna","game","GameTime"];E.__properties__={get_now:"get_now"};E.blur=function(){if(!E._focused){var a=P._custom()-E._blurTime;E._offset+=a;E._blurTime=
0}E._blurTime=P._custom()};E.focus=function(){var a=P._custom()-E._blurTime;E._offset+=a;E._blurTime=0};E.init=function(){E._time=E.get_now()};E.step=function(){var a=E.get_now();E.deltaTime=a-E._time;E.deltaTime>E.maxDeltaTime?E.deltaTime=E.maxDeltaTime:0>E.deltaTime&&(E.deltaTime=0);E._time=a};E.get_now=function(){return P._custom()-E._offset};E.prototype={__class__:E};var Sa=g.lovedna.game.Material=function(){this.uniforms=new mb;this.define=new hb;this.renderQueue=2E4;this.shader=new Ba(null);
this.subMesh=-1;this.state=new N;this.color=new ca(1,1,1,1);this.uniforms.setColor(k.COLOR.name,this.color)};f["lovedna.game.Material"]=Sa;Sa.__name__=["lovedna","game","Material"];Sa.getRenderQueue=function(a){a=n.floor(1E-4*a);return n.floor(1E4*(1>a?1:5<a?5:a))};Sa.prototype={dispose:function(){this.define=this.uniforms=null;null!=this.shader&&this.shader.dispose();this.state=this.shader=null},setTexture:function(a,b){null==b&&(b=k.TEX.name);null==a?(this.uniforms.remove(b),this.define.define(b,
"",!1)):(this.uniforms.setTexture(a),this.define.define(b,"",!0))},__class__:Sa};var ba=g.lovedna.game.Mesh=function(){this.id=ba._id--};f["lovedna.game.Mesh"]=ba;ba.__name__=["lovedna","game","Mesh"];ba.deleteGeometryBuffer=function(a){if(ba._geombuffer.h.hasOwnProperty(a)){var b=ba._geombuffer.h[a];ba._geombuffer.remove(a);b.unload()}};ba.prototype={fromGeometry:function(a){if(ba._geombuffer.h.hasOwnProperty(a.id))this.buffer=ba._geombuffer.h[a.id],this.id=a.id,ba._geombuffer.h[a.id].build();else{var b=
new Mc(a);b.build();this.id=a.id;this.buffer=ba._geombuffer.h[a.id]=b}return this},dispose:function(){this.buffer=null},__class__:ba};var Jd=g.lovedna.game.RaycastHit=function(){};f["lovedna.game.RaycastHit"]=Jd;Jd.__name__=["lovedna","game","RaycastHit"];Jd.prototype={__class__:Jd};var Ta=g.lovedna.game.render.RenderCommand=function(){};f["lovedna.game.render.RenderCommand"]=Ta;Ta.__name__=["lovedna","game","render","RenderCommand"];Ta.prototype={__class__:Ta};var mb=g.lovedna.game.ShaderUniform=
function(){this.data=new J};f["lovedna.game.ShaderUniform"]=mb;mb.__name__=["lovedna","game","ShaderUniform"];mb.prototype={clear:function(){var a=this.data;for(a=new sb(a,a.arrayKeys());a.hasNext();){var b=a.next();this.data.remove(b.name)}},copy:function(a){this.clear();a=a.data;for(a=new sb(a,a.arrayKeys());a.hasNext();){var b=a.next(),c=this.data,d=b.name;null!=p[d]?c.setReserved(d,b):c.h[d]=b}},add:function(a){a=a.data;for(a=new sb(a,a.arrayKeys());a.hasNext();){var b=a.next(),c=this.data,d=
b.name;null!=p[d]?c.setReserved(d,b):c.h[d]=b}},bind:function(a){var b=this.data;for(b=new sb(b,b.arrayKeys());b.hasNext();){var c=b.next(),d=a.getUniformInput(c.name);if(null!=d){if(!c.bind(d))return!1;d.set_success(!0)}}return!0},remove:function(a){this.data.remove(a)},setInt:function(a,b){this.get(a).setInt(b)},setFloat:function(a,b){this.get(a).setFloat(b)},setFloatArray:function(a,b){this.get(a).setFloatArray(b)},setFloat2:function(a,b){this.get(a).setFloat2(b)},setFloat3:function(a,b){this.get(a).setFloat3(b)},
setFloat4:function(a,b){this.get(a).setFloat4(b)},setColor:function(a,b){this.get(a).setFloat4(b)},setMatrix44:function(a,b){this.get(a).setMatrix(b)},setMatrix44Handler:function(a,b){this.get(a).setMatrixHandler(b)},setMatrix44Array:function(a,b){this.get(a).setMatrixArray(b)},setTexture:function(a,b){null==b&&(b=k.TEX.name);null==a?this.remove(b):this.get(b).setTexture(a)},get:function(a){var b=this.data;if(null!=p[a]?b.existsReserved(a):b.h.hasOwnProperty(a))return b=this.data,null!=p[a]?b.getReserved(a):
b.h[a];b=new Ga;b.name=a;var c=this.data;null!=p[a]?c.setReserved(a,b):c.h[a]=b;return b},__class__:mb};var hb=g.lovedna.game.ShaderDefine=function(){this._defineMap=new J;this._define=null;this._id=-1};f["lovedna.game.ShaderDefine"]=hb;hb.__name__=["lovedna","game","ShaderDefine"];hb.prototype={clear:function(){for(var a=this._defineMap.keys();a.hasNext();){var b=a.next();this._defineMap.remove(b);this.dirtyDefine()}},define:function(a,b,c){null==c&&(c=!0);null==b&&(b="");if(c)null==b&&(b=""),c=
this._defineMap,(null!=p[a]?c.existsReserved(a):c.h.hasOwnProperty(a))?(c=this._defineMap,(null!=p[a]?c.getReserved(a):c.h[a])!=b&&(c=this._defineMap,null!=p[a]?c.setReserved(a,b):c.h[a]=b,this.dirtyDefine())):(c=this._defineMap,null!=p[a]?c.setReserved(a,b):c.h[a]=b,this.dirtyDefine());else if(b=this._defineMap,null!=p[a]?b.existsReserved(a):b.h.hasOwnProperty(a))this._defineMap.remove(a),this.dirtyDefine()},dirtyDefine:function(){this._define=null;this._id=-1},sortDefine:function(a,b){return a!=
b?a>b?1:-1:0},build:function(){this._id=0;this._define="";for(var a=[],b=this._defineMap.keys();b.hasNext();){var c=b.next();a.push(c)}if(!(1>a.length)){a.sort(q(this,this.sortDefine));b=a.length;hb._fnv.reset();hb._fnv.addInt(b);for(c="";0<b--;){var d=a[b],e=this._defineMap;d="#define "+d+" "+(null!=p[d]?e.getReserved(d):e.h[d])+"\n";hb._fnv.addString(d);c+=null==d?"null":""+d}this._id=hb._fnv.getCode();this._define=c}},get_id:function(){if(-1!=this._id)return this._id;this.build();return this._id},
get_value:function(){if(null!=this._define)return this._define;this.build();return this._define},__class__:hb,__properties__:{get_id:"get_id",get_value:"get_value"}};var Kd=g.lovedna.game.ShaderPrecision=function(){this._vert="precision highp float;\nprecision highp int;\nprecision lowp sampler2D;\nprecision lowp samplerCube;\n";this._frag="precision highp float;\nprecision mediump int;\nprecision lowp sampler2D;\nprecision lowp samplerCube;\n"};f["lovedna.game.ShaderPrecision"]=Kd;Kd.__name__=["lovedna",
"game","ShaderPrecision"];Kd.prototype={getVertPrecision:function(){return this._vert},getFragPrecision:function(){return this._frag},__class__:Kd};var Ba=g.lovedna.game.Shader=function(a){null==a&&(a=nb.defaultCode);this.uniforms=new mb;this._code=a;this._id=-1;this._defineHashList=[];this._defineList=[]};f["lovedna.game.Shader"]=Ba;Ba.__name__=["lovedna","game","Shader"];Ba.prototype={dispose:function(){this._define=this._defineHashList=this._defineList=this._code=this._program=this.uniforms=null},
clearDefine:function(a){null==a&&(a=0);null!=this._defineList[a]&&(this.dirtyDefine(),this._defineList[a]=null,this._defineHashList[a]=-1)},setDefine:function(a,b){null==b&&(b=0);0>b||5<b||null==a||null!=this._defineHashList[b]&&this._defineHashList[b]==a.get_id()||(this._defineList[b]=a,this.dirtyDefine())},bind:function(){if(null==this._code||-1==this.get_id())return!1;if(null==this._program){var a=Ba._programMap,b=this.get_id();if(a.h.hasOwnProperty(b))a=Ba._programMap,b=this.get_id(),this._program=
a.h[b];else{a=this._code.get_vert();b=this._code.get_frag();var c=this.createDefine();this._program=new zb(c+Ba.defaultPrecision.getVertPrecision()+a,c+Ba.defaultPrecision.getFragPrecision()+b);a=Ba._programMap;b=this.get_id();a.h[b]=this._program}}if(null==this._program||!this._program.enabled)return!1;this._program.bind();return!0},getBufferInput:function(a){if(null==this._code||null==this._program)return null;var b=this._code.getAttributeName(a);return null!=b?this._program.getBufferInput(b):this._program.getBufferInput(a)},
getUniformInput:function(a){if(null==this._code||null==this._program)return null;var b=this._code.getUniformName(a);return null!=b?this._program.getUniformInput(b):this._program.getUniformInput(a)},setCode:function(a){this.dirtyDefine();this._code=a},GetCode:function(){return this._code},checkUniformSuccess:function(){return 0==this._program.checkUniformFail()},dirtyDefine:function(){this._define=null;this._id=-1},sortDefine:function(a,b){return a!=b?a>b?1:-1:0},createDefine:function(){if(null!=this._define)return this._define;
this._define="";Ba._fnv.reset();Ba._fnv.addInt(this._code.id);if(0<this._code.get_defineCount())for(var a=this._defineList.length;0<a--;){var b=this._defineList[a];null!=b&&(this._define+=b.get_value(),this._defineHashList[a]=b.get_id(),Ba._fnv.addInt(b.get_id()))}this._id=Ba._fnv.getCode();return this._define},get_id:function(){-1==this._id&&this.createDefine();return this._id},__class__:Ba,__properties__:{get_id:"get_id"}};var nb=g.lovedna.game.ShaderCode=function(a,b,c){this._defineCount=0;this.id=
nb._id++;this.name=a;if(null==b||""==b)b=nb.defaultCode.sourceVert;if(null==c||""==c)c=nb.defaultCode.sourceFrag;this.sourceVert=b;this.sourceFrag=c;this._vert=b;this._frag=c;this._attributeNames=new J;this._uniformNames=new J};f["lovedna.game.ShaderCode"]=nb;nb.__name__=["lovedna","game","ShaderCode"];nb.prototype={setAttributeAlias:function(a,b){var c=this._attributeNames;null!=p[b]?c.setReserved(b,a):c.h[b]=a},setUniformAlias:function(a,b){var c=this._uniformNames;null!=p[b]?c.setReserved(b,a):
c.h[b]=a},getAttributeName:function(a){this.init();var b=this._attributeNames;return null!=p[a]?b.getReserved(a):b.h[a]},getUniformName:function(a){this.init();var b=this._uniformNames;return null!=p[a]?b.getReserved(a):b.h[a]},existDefine:function(a){this.init();var b=this._defineMap;return null!=p[a]?b.existsReserved(a):b.h.hasOwnProperty(a)},init:function(){this._init||(this._init=!0,this._defineMap=new J,this._vert="\n"+this.parse(this._vert),this._frag="\n"+this.parse(this._frag))},parse:function(a){a=
new Cc(a);for(var b="";0<a._length-a._position;){var c=a.readLine();b+=this.parseLine(c)+"\n"}return b},parseLine:function(a){for(var b=n.trim(a),c="",d=[],e="",h=0,f=0,g=b.length;f<g;){var k=f++;k=b.charAt(k);if(" "==k||":"==k||";"==k){d[h]=c;if(0==h)if("attribute"==c||"uniform"==c)e=a.indexOf(c),e=A.substr(a,0,e);else if("#ifdef"==c)e=a.indexOf(c),e=A.substr(a,0,e);else{h=0;break}++h;c=""}else c+=k}if(0!=h){""!=c&&(d[h]=c);b=d[0];if("attribute"==b)return a=this._attributeNames,h=d[3],f=d[2],null!=
p[h]?a.setReserved(h,f):a.h[h]=f,e+b+" "+d[1]+" "+d[2]+";";if("uniform"==b)return a=d[2],h=a.indexOf("["),-1!=h&&(a=A.substr(a,0,h)),h=this._uniformNames,f=d[3],null!=p[f]?h.setReserved(f,a):h.h[f]=a,e+b+" "+d[1]+" "+d[2]+";";"#ifdef"==b&&(d=d[1],null!=d&&(e=this._defineMap,(null!=p[d]?e.existsReserved(d):e.h.hasOwnProperty(d))||(e=this._defineMap,null!=p[d]?e.setReserved(d,!0):e.h[d]=!0,this._defineCount++)))}return a},get_vert:function(){this.init();return this._vert},get_frag:function(){this.init();
return this._frag},get_defineCount:function(){this.init();return this._defineCount},__class__:nb,__properties__:{get_defineCount:"get_defineCount",get_frag:"get_frag",get_vert:"get_vert"}};var N=g.lovedna.game.graphics.GLState=function(){this.depthWrite=this.depthTest=!0;this.cullMode=1029;this.depthMode=513;this.stencilTest=!1;this.stencilMode=519;this.stencilFail=this.stencilDepthFail=this.stencilBothPass=7680;this.stencilReferenceValue=0;this.stencilWriteMask=this.stencilReadMask=255;this.blend=
!0;this.blendAlphaOperation=this.blendColorOperation=32774;this.blendSrcColor=770;this.blendDstColor=771;this.blendDstAlpha=this.blendSrcAlpha=1;this.drawMode=4};f["lovedna.game.graphics.GLState"]=N;N.__name__=["lovedna","game","graphics","GLState"];N.set=function(a){};N.prototype={copy:function(a){if(null==a)return this;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.cullMode=a.cullMode;this.depthMode=a.depthMode;this.stencilTest=a.stencilTest;this.stencilMode=a.stencilMode;this.stencilBothPass=
a.stencilBothPass;this.stencilDepthFail=a.stencilDepthFail;this.stencilFail=a.stencilFail;this.stencilReferenceValue=a.stencilReferenceValue;this.stencilReadMask=a.stencilReadMask;this.stencilWriteMask=a.stencilWriteMask;this.blend=a.blend;this.blendColorOperation=a.blendColorOperation;this.blendAlphaOperation=a.blendAlphaOperation;this.blendSrcColor=a.blendSrcColor;this.blendDstColor=a.blendDstColor;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.drawMode=a.drawMode;return this},
defaultValue:function(){this.depthWrite=this.depthTest=!1;this.cullMode=-1;this.depthMode=519;this.stencilTest=!0;this.stencilMode=514;this.stencilFail=this.stencilDepthFail=this.stencilBothPass=7680;this.stencilReferenceValue=0;this.stencilWriteMask=this.stencilReadMask=255;this.blend=!1;this.blendAlphaOperation=this.blendColorOperation=32774;this.blendSrcColor=770;this.blendDstColor=771;this.blendDstAlpha=this.blendSrcAlpha=1;this.drawMode=4},__class__:N};var Q=g.lovedna.math.Vector4=function(a,
b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d};f["lovedna.math.Vector4"]=Q;Q.__name__=["lovedna","math","Vector4"];Q.__interfaces__=[vb,Kb];Q.__properties__={get_temp:"get_temp"};Q.get_temp=function(){return Q._pool.get()};Q.prototype={toString:function(){return this.fixed(4)},fixed:function(a){null==a&&(a=4);return"Vector4("+n.fixed(this.x,a)+","+n.fixed(this.y,a)+","+n.fixed(this.z,a)+","+n.fixed(this.w,a)+")"},set:function(a,b,c,d){null==
d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d;return this},copy:function(a){if(null==a||a==this)return this;this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},from:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},clone:function(){return new Q(this.x,this.y,this.z,this.w)},equals:function(a){return this.x==a.x&&this.y==a.y&&this.z==a.z?this.w==a.w:!1},add:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;this.x=d.x+a.x;this.y=d.y+a.y;
this.z=d.z+a.z;this.w=d.w+a.w;return this},sub:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;this.x=d.x-a.x;this.y=d.y-a.y;this.z=d.z-a.z;this.w=d.w-a.w;return this},mul:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;this.x=d.x*a.x;this.y=d.y*a.y;this.z=d.z*a.z;this.w=d.w*a.w;return this},min:function(a,b){var c=null==b,d=c?this:a,e=c?a:b;a=d.x;b=e.x;c=d.y;var h=e.y,f=d.z,g=e.z;d=d.w;e=e.w;this.x=a<b?a:b;this.y=c<h?c:h;this.z=f<g?f:g;this.w=d<e?d:e;return this},max:function(a,b){var c=null==b,d=
c?this:a,e=c?a:b;a=d.x;b=e.x;c=d.y;var h=e.y,f=d.z,g=e.z;d=d.w;e=e.w;this.x=a>b?a:b;this.y=c>h?c:h;this.z=f>g?f:g;this.w=d>e?d:e;return this},clamp:function(a,b){var c=this.x,d=a.x,e=b.x,h=this.y,f=a.y,g=b.y,k=this.z,l=a.z,m=b.z,n=this.w;a=a.w;b=b.w;this.x=c<d?d:c>e?e:c;this.y=h<f?f:h>g?g:h;this.z=k<l?l:k>m?m:k;this.w=n<a?a:n>b?b:n;return this},scale:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},
getElement:function(a){0>a?a=a%4+4:4<=a&&(a%=4);switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w}return 0},setElement:function(a,b){0>a?a=a%4+4:4<=a&&(a%=4);switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b}},fillArray:function(a,b){null==b&&(b=0);a[b++]=this.x;a[b++]=this.y;a[b++]=this.z;a[b++]=this.w},fromArray:function(a,b){null==b&&(b=0);if(null==a)return this;var c=a.length;b<c&&(this.x=a[b++]);b<c&&(this.y=
a[b++]);b<c&&(this.z=a[b++]);b<c&&(this.w=a[b++]);return this},__class__:Q};var ca=g.lovedna.math.Color=function(a,b,c,d){null==d&&(d=1);null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);Q.call(this,a,b,c,d)};f["lovedna.math.Color"]=ca;ca.__name__=["lovedna","math","Color"];ca.__properties__={get_temp:"get_temp"};ca.get_temp=function(){return ca._pool.get()};ca.__super__=Q;ca.prototype=r(Q.prototype,{setRGBA:function(a){this.x=.00392156863*(a>>24&255);this.y=.00392156863*(a>>16&255);this.z=.00392156863*
(a>>8&255);this.w=.00392156863*(a&255);return this},getRGBA:function(){return(255*this.x|0)<<24|(255*this.y|0)<<16|(255*this.z|0)<<8|255*this.w|0},setByte:function(a,b,c,d){null==d&&(d=255);null==c&&(c=255);null==b&&(b=255);null==a&&(a=255);this.x=.00392156863*a;this.y=.00392156863*b;this.z=.00392156863*c;this.w=.00392156863*d;return this},mix:function(a,b){0>b&&(b=0);1<b&&(b=1);this.scale(1-b);ca._pool.get().copy(a);ca._pool.get().scale(b);this.add(ca._pool.get());return this},compress:function(){return 1*
this.x+.00392156862745098*this.y+1.5378700499807768E-5*this.z+6.030862941101084E-8*this.w},decompress:function(a){if(0<=a||1>=a){var b=255*a;b-=n.floor(b);var c=255*b;c-=n.floor(c);var d=255*c;d-=n.floor(d);this.x=a-=.00392156863*b;this.y=b-.00392156863*c;this.z=c-.00392156863*d;this.w=d}return this},fixed:function(a){null==a&&(a=4);return"Color("+n.fixed(this.x,a)+","+n.fixed(this.y,a)+","+n.fixed(this.z,a)+","+n.fixed(this.w,a)+")"},get_r:function(){return this.x},get_g:function(){return this.y},
get_b:function(){return this.z},get_a:function(){return this.w},set_r:function(a){return this.x=a},set_g:function(a){return this.y=a},set_b:function(a){return this.z=a},set_a:function(a){return this.w=a},__class__:ca,__properties__:{set_a:"set_a",get_a:"get_a",set_b:"set_b",get_b:"get_b",set_g:"set_g",get_g:"get_g",set_r:"set_r",get_r:"get_r"}});var va=g.lovedna.game.render.commands.Blit=function(){};f["lovedna.game.render.commands.Blit"]=va;va.__name__=["lovedna","game","render","commands","Blit"];
va.__interfaces__=[Ta];va.prototype={execute:function(a){null==this.material&&(this.material=va._material);null==va._mesh&&(va._color=new ca(0,0,0,0),va._mat=new fa,va._mesh=new ba,a=new Qa,a.position=[new m(-1,-1,0),new m(1,-1,0),new m(1,1,0),new m(-1,1,0)],a.uv=[new v(0,0),new v(1,0),new v(1,1),new v(0,1)],a.addGroup([0,1,2,0,2,3]),va._mesh.fromGeometry(a));a=this.material.shader;if(null!=a&&this.source.enabled&&(this.material.uniforms.setMatrix44(k.M.name,va._mat),this.material.uniforms.setMatrix44(k.V.name,
va._mat),this.material.uniforms.setMatrix44(k.P.name,va._mat),this.material.uniforms.setMatrix44(k.VP.name,va._mat),this.material.setTexture(this.source),a.setDefine(this.material.define,2),a.setDefine(va._mesh.buffer.define,1),a.bind()&&(va._mesh.buffer.updateLocations(a),va._mesh.buffer.getPositionBuffer().bind(a.get_id()),va._mesh.buffer.getVertexBuffer().bind(a.get_id()),va._mesh.buffer.getIndexBuffer().bind(),l.state(this.material.state),l.pushTarget(this.dest),l.drawBefore(),null!=this.rect&&
l.viewport(n.floor(this.rect.x),n.floor(this.rect.w-this.rect.y),n.floor(this.rect.z),n.floor(this.rect.w)),this.material.uniforms.bind(a)))){a=u.gl;var b=this.material.state.drawMode,c=va._mesh.buffer.getIndexBuffer().length;a.__context.drawElements(b,c,5123,0);l.drawAfter();l.popTarget()}},__class__:va};var Nc=g.lovedna.game.render.commands.Draw=function(){};f["lovedna.game.render.commands.Draw"]=Nc;Nc.__name__=["lovedna","game","render","commands","Draw"];Nc.__interfaces__=[Ta];Nc.prototype={execute:function(a){var b=
a.currentMaterial;if(null!=b){var c=b.shader;if(null!=c){a.currentUniforms.add(b.uniforms);c.setDefine(b.define,2);c.setDefine(a.globalDefine,0);if(null!=a.currentMeshBuffer){var d=a.currentMeshBuffer.buffer;if(!d.enabled)return;a.currentIndexBuffer=d.getIndexBuffer();a.currentVertexBuffers.clear();a.currentVertexBuffers.push(d.getPositionBuffer());null!=d.getVertexBuffer()&&a.currentVertexBuffers.push(d.getVertexBuffer());null!=d.getColorBuffer()&&a.currentVertexBuffers.push(d.getColorBuffer());
null!=d.getBoneBuffer()&&a.currentVertexBuffers.push(d.getBoneBuffer());c.setDefine(d.define,1);c.bind();d.updateLocations(c)}else{if(null==a.currentIndexBuffer)return;c.bind();for(d=a.currentVertexBuffers.get_length();0<d--;){var e=a.currentVertexBuffers.getElement(d).layouts;if(null==e)a.currentVertexBuffers.removeAt(d);else for(var h=e.length;0<h--;){var f=e[h],g=c.getBufferInput(f.name);null!=g&&(f.location=g.location)}}}for(d=a.currentVertexBuffers.get_length();0<d--;)if(!a.currentVertexBuffers.getElement(d).bind(c.get_id()))return;
l.drawBefore();if(a.globalUniforms.bind(c)&&a.currentUniforms.bind(c)&&c.checkUniformSuccess()){a.currentIndexBuffer.bind();c=!0;d=a.currentMaterial.subMesh;0>d&&(c=!1);c&&(null==a.currentIndexBuffer.layouts?c=!1:null==a.currentIndexBuffer.layouts[d]&&(c=!1));l.state(b.state);if(c)c=a.currentIndexBuffer.layouts[d],u.gl.__context.drawElements(b.state.drawMode,c.length,5123,c.offset);else{c=a.currentIndexBuffer.length;if(2E4<c)debugger;u.gl.__context.drawElements(b.state.drawMode,c,5123,0)}l.drawAfter();
a.clearCurrent()}}}},__class__:Nc};var Oc=g.lovedna.game.render.commands.SetCallback=function(){};f["lovedna.game.render.commands.SetCallback"]=Oc;Oc.__name__=["lovedna","game","render","commands","SetCallback"];Oc.__interfaces__=[Ta];Oc.prototype={execute:function(a){this.v(a)},__class__:Oc};var Pc=g.lovedna.game.render.commands.SetRenderContext=function(){};f["lovedna.game.render.commands.SetRenderContext"]=Pc;Pc.__name__=["lovedna","game","render","commands","SetRenderContext"];Pc.__interfaces__=
[Ta];Pc.prototype={execute:function(a){lc.current=this.value},__class__:Pc};var Qc=g.lovedna.game.render.commands.SetGlobalShaderUniform=function(){};f["lovedna.game.render.commands.SetGlobalShaderUniform"]=Qc;Qc.__name__=["lovedna","game","render","commands","SetGlobalShaderUniform"];Qc.__interfaces__=[Ta];Qc.prototype={execute:function(a){a.globalUniforms.add(this.v)},__class__:Qc};var Rc=g.lovedna.game.render.commands.SetIndexBuffer=function(){};f["lovedna.game.render.commands.SetIndexBuffer"]=
Rc;Rc.__name__=["lovedna","game","render","commands","SetIndexBuffer"];Rc.__interfaces__=[Ta];Rc.prototype={execute:function(a){a.currentIndexBuffer=this.v},__class__:Rc};var Sc=g.lovedna.game.render.commands.SetMaterial=function(){};f["lovedna.game.render.commands.SetMaterial"]=Sc;Sc.__name__=["lovedna","game","render","commands","SetMaterial"];Sc.__interfaces__=[Ta];Sc.prototype={execute:function(a){a.currentMaterial=this.v},__class__:Sc};var Tc=g.lovedna.game.render.commands.SetMeshBuffer=function(){};
f["lovedna.game.render.commands.SetMeshBuffer"]=Tc;Tc.__name__=["lovedna","game","render","commands","SetMeshBuffer"];Tc.__interfaces__=[Ta];Tc.prototype={execute:function(a){a.currentMeshBuffer=this.v},__class__:Tc};var Uc=g.lovedna.game.render.commands.SetShaderDefine=function(){};f["lovedna.game.render.commands.SetShaderDefine"]=Uc;Uc.__name__=["lovedna","game","render","commands","SetShaderDefine"];Uc.__interfaces__=[Ta];Uc.prototype={execute:function(a){},__class__:Uc};var Vc=g.lovedna.game.render.commands.SetShaderUniform=
function(){};f["lovedna.game.render.commands.SetShaderUniform"]=Vc;Vc.__name__=["lovedna","game","render","commands","SetShaderUniform"];Vc.__interfaces__=[Ta];Vc.prototype={execute:function(a){a.currentUniforms.add(this.v)},__class__:Vc};var Wc=g.lovedna.game.render.commands.SetVertexBuffer=function(){};f["lovedna.game.render.commands.SetVertexBuffer"]=Wc;Wc.__name__=["lovedna","game","render","commands","SetVertexBuffer"];Wc.__interfaces__=[Ta];Wc.prototype={execute:function(a){a.currentVertexBuffers.push(this.v)},
__class__:Wc};var S=g.lovedna.game.render.RenderBuffer=function(){this.enabled=!1;this._list=new O;this.distance=this.shaderId=0};f["lovedna.game.render.RenderBuffer"]=S;S.__name__=["lovedna","game","render","RenderBuffer"];S.__properties__={get_temp:"get_temp"};S.get_temp=function(){return S._pool.get()};S.prototype={clear:function(){this._list.clear()},add:function(a){this._list.push(a)},execute:function(){var a=this._list.get_length();S.$length+=a;for(var b=0;b<a;){var c=b++;this._list.getElement(c).execute(lc.current)}},
setContext:function(a){var b=S._SetContext.get();b.value=a;this.add(b)},setGlobalShaderUniform:function(a){var b=S._SetGlobalShaderUniform.get();b.v=a;this.add(b)},setGlobalShaderDefine:function(a){},setShaderDefine:function(a){var b=S._SetShaderDefine.get();b.v=a;this.add(b)},setShaderUniform:function(a){var b=S._SetShaderUniform.get();b.v=a;this.add(b)},setMaterial:function(a){var b=S._SetMaterial.get();b.v=a;this.add(b)},setMeshBuffer:function(a){var b=S._SetMeshBuffer.get();b.v=a;this.add(b)},
setIndexBuffer:function(a){var b=S._SetIndexBuffer.get();b.v=a;this.add(b)},setVertexBuffer:function(a){var b=S._SetVertexBuffer.get();b.v=a;this.add(b)},setCallback:function(a){var b=S._SetCallback.get();b.v=a;this.add(b)},draw:function(){var a=S._Draw.get();this.add(a)},blit:function(a,b,c,d){var e=S._Blit.get();e.source=a;e.dest=b;e.material=c;e.rect=d;this.add(e)},__class__:S};var ea=g.lovedna.game.Screen=function(){};f["lovedna.game.Screen"]=ea;ea.__name__=["lovedna","game","Screen"];ea.__properties__=
{get_currentBackBuffer:"get_currentBackBuffer"};ea.blit=function(a,b,c,d){a!=b&&(null==c&&(c=ea._material),ea._buffer.clear(),ea._buffer.blit(a,b,c,d),ea._buffer.execute())};ea.setSize=function(a,b){ea.width=a;ea.height=b};ea.get_currentBackBuffer=function(){return l.getTarget()};ea.prototype={__class__:ea};var Xc=function(){};f["lovedna.game.graphics.RenderContext"]=Xc;Xc.__name__=["lovedna","game","graphics","RenderContext"];Xc.prototype={setup:function(a,b){this.gl=this.__context=a;this.version=
b},beginQuery:function(a,b){this.__context.beginQuery(a,b)},beginTransformFeedback:function(a){this.__context.beginTransformFeedback(a)},bindBufferBase:function(a,b,c){this.__context.bindBufferBase(a,b,c)},bindBufferRange:function(a,b,c,d,e){this.__context.bindBufferRange(a,b,c,d,e)},bindSampler:function(a,b){this.__context.bindSampler(a,b)},bindTransformFeedback:function(a,b){this.__context.bindTransformFeedback(a,b)},bindVertexArray:function(a){this.__context.bindVertexArray(a)},blitFramebuffer:function(a,
b,c,d,e,h,f,g,k,l){this.__context.blitFramebuffer(a,b,c,d,e,h,f,g,k,l)},bufferData:function(a,b,c,d){this.__context.bufferData(a,c,d)},bufferSubData:function(a,b,c,d){this.__context.bufferSubData(a,b,d)},activeTexture:function(a){this.__context.activeTexture(a)},attachShader:function(a,b){this.__context.attachShader(a,b)},bindAttribLocation:function(a,b,c){this.__context.bindAttribLocation(a,b,c)},bindBuffer:function(a,b){this.__context.bindBuffer(a,b)},bindFramebuffer:function(a,b){this.__context.bindFramebuffer(a,
b)},bindRenderbuffer:function(a,b){this.__context.bindRenderbuffer(a,b)},bindTexture:function(a,b){this.__context.bindTexture(a,b)},blendColor:function(a,b,c,d){this.__context.blendColor(a,b,c,d)},blendEquation:function(a){this.__context.blendEquation(a)},blendEquationSeparate:function(a,b){this.__context.blendEquationSeparate(a,b)},blendFunc:function(a,b){this.__context.blendFunc(a,b)},blendFuncSeparate:function(a,b,c,d){this.__context.blendFuncSeparate(a,b,c,d)},bufferDataWEBGL:function(a,b,c,d,
e){null!=d?this.__context.bufferData(a,b,c,d,e):this.__context.bufferData(a,b,c)},bufferSubDataWEBGL:function(a,b,c,d,e){null!=d?this.__context.bufferSubData(a,b,c,d,e):this.__context.bufferSubData(a,b,c)},checkFramebufferStatus:function(a){return this.__context.checkFramebufferStatus(a)},clear:function(a){this.__context.clear(a)},clearBufferfi:function(a,b,c,d){this.__context.clearBufferfi(a,b,c,d)},clearBufferfv:function(a,b,c){this.__context.clearBufferfv(a,b,c)},clearBufferfvWEBGL:function(a,
b,c,d){this.__context.clearBufferfv(a,b,c,d)},clearBufferiv:function(a,b,c){this.__context.clearBufferiv(a,b,c)},clearBufferivWEBGL:function(a,b,c,d){this.__context.clearBufferiv(a,b,c,d)},clearBufferuiv:function(a,b,c){this.__context.clearBufferuiv(a,b,c.toUInt32Array())},clearBufferuivWEBGL:function(a,b,c,d){this.__context.clearBufferuiv(a,b,c,d)},clearColor:function(a,b,c,d){this.__context.clearColor(a,b,c,d)},clearDepth:function(a){this.__context.clearDepth(a)},clearDepthf:function(a){this.__context.clearDepth(a)},
clearStencil:function(a){this.__context.clearStencil(a)},clientWaitSync:function(a,b,c){return this.__context.clientWaitSync(a,b,c)},copyBufferSubData:function(a,b,c,d,e){},colorMask:function(a,b,c,d){this.__context.colorMask(a,b,c,d)},compileShader:function(a){this.__context.compileShader(a)},compressedTexImage2D:function(a,b,c,d,e,h,f,g){this.__context.compressedTexImage2D(a,b,c,d,e,h,g.toBufferView(f))},compressedTexImage2DWEBGL:function(a,b,c,d,e,h,f,g,k){null!=g?this.__context.compressedTexImage2D(a,
b,c,d,e,h,f,g,k):this.__context.compressedTexImage2D(a,b,c,d,e,h,f)},compressedTexImage3D:function(a,b,c,d,e,h,f,g,k){this.__context.compressedTexImage3D(a,b,c,d,e,h,f,k.toBufferView(g))},compressedTexImage3DWEBGL:function(a,b,c,d,e,h,f,g,k,l){this.__context.compressedTexImage3D(a,b,c,d,e,h,f,g,k,l)},compressedTexSubImage2D:function(a,b,c,d,e,h,f,g,k){this.__context.compressedTexSubImage2D(a,b,c,d,e,h,f,k.toBufferView(g))},compressedTexSubImage2DWEBGL:function(a,b,c,d,e,h,f,g,k,l){null!=k?this.__context.compressedTexSubImage2D(a,
b,c,d,e,h,f,g,k,l):this.__context.compressedTexSubImage2D(a,b,c,d,e,h,f,g)},compressedTexSubImage3D:function(a,b,c,d,e,h,f,g,k,l,m){this.__context.compressedTexSubImage3D(a,b,c,d,e,h,f,g,k,m.toBufferView(l))},compressedTexSubImage3DWEBGL:function(a,b,c,d,e,h,f,g,k,l,m,n){this.__context.compressedTexSubImage3D(a,b,c,d,e,h,f,g,k,l,m,n)},copySubBufferData:function(a,b,c,d,e){this.__context.copySubBufferData(a,b,c,d,e)},copyTexImage2D:function(a,b,c,d,e,h,f,g){this.__context.copyTexImage2D(a,b,c,d,e,
h,f,g)},copyTexSubImage2D:function(a,b,c,d,e,h,f,g){this.__context.copyTexSubImage2D(a,b,c,d,e,h,f,g)},copyTexSubImage3D:function(a,b,c,d,e,h,f,g,k){this.__context.copyTexSubImage3D(a,b,c,d,e,h,f,g,k)},createBuffer:function(){return this.__context.createBuffer()},createFramebuffer:function(){return this.__context.createFramebuffer()},createProgram:function(){return this.__context.createProgram()},createQuery:function(){return this.__context.createQuery()},createRenderbuffer:function(){return this.__context.createRenderbuffer()},
createSampler:function(){return this.__context.createSampler()},createShader:function(a){return this.__context.createShader(a)},createTexture:function(){return this.__context.createTexture()},createTransformFeedback:function(){return this.__context.createTransformFeedback()},createVertexArray:function(){return this.__context.createVertexArray()},cullFace:function(a){this.__context.cullFace(a)},deleteBuffer:function(a){this.__context.deleteBuffer(a)},deleteFramebuffer:function(a){this.__context.deleteFramebuffer(a)},
deleteProgram:function(a){this.__context.deleteProgram(a)},deleteQuery:function(a){this.__context.deleteQuery(a)},deleteRenderbuffer:function(a){this.__context.deleteRenderbuffer(a)},deleteSampler:function(a){this.__context.deleteSampler(a)},deleteShader:function(a){this.__context.deleteShader(a)},deleteSync:function(a){this.__context.deleteSync(a)},deleteTexture:function(a){this.__context.deleteTexture(a)},deleteTransformFeedback:function(a){this.__context.deleteTransformFeedback(a)},deleteVertexArray:function(a){this.__context.deleteVertexArray(a)},
depthFunc:function(a){this.__context.depthFunc(a)},depthMask:function(a){this.__context.depthMask(a)},depthRange:function(a,b){this.__context.depthRange(a,b)},depthRangef:function(a,b){this.__context.depthRange(a,b)},detachShader:function(a,b){this.__context.detachShader(a,b)},disable:function(a){this.__context.disable(a)},disableVertexAttribArray:function(a){this.__context.disableVertexAttribArray(a)},drawArrays:function(a,b,c){this.__context.drawArrays(a,b,c)},drawArraysInstanced:function(a,b,c,
d){this.__context.drawArraysInstanced(a,b,c,d)},drawBuffers:function(a){this.__context.drawBuffers(a)},drawElements:function(a,b,c,d){this.__context.drawElements(a,b,c,d)},drawElementsInstanced:function(a,b,c,d,e){this.__context.drawElementsInstanced(a,b,c,d,e)},drawRangeElements:function(a,b,c,d,e,h){this.__context.drawRangeElements(a,b,c,d,e,h)},enable:function(a){this.__context.enable(a)},enableVertexAttribArray:function(a){this.__context.enableVertexAttribArray(a)},endQuery:function(a){this.__context.endQuery(a)},
endTransformFeedback:function(){this.__context.endTransformFeedback()},fenceSync:function(a,b){return this.__context.fenceSync(a,b)},finish:function(){this.__context.finish()},flush:function(){this.__context.flush()},framebufferRenderbuffer:function(a,b,c,d){this.__context.framebufferRenderbuffer(a,b,c,d)},framebufferTexture2D:function(a,b,c,d,e){this.__context.framebufferTexture2D(a,b,c,d,e)},framebufferTextureLayer:function(a,b,c,d,e){this.__context.framebufferTextureLayer(a,b,c,d,e)},frontFace:function(a){this.__context.frontFace(a)},
generateMipmap:function(a){this.__context.generateMipmap(a)},getActiveAttrib:function(a,b){return this.__context.getActiveAttrib(a,b)},getActiveUniform:function(a,b){return this.__context.getActiveUniform(a,b)},getActiveUniformBlocki:function(a,b,c){return this.__context.getActiveUniformBlockParameter(a,b,c)},getActiveUniformBlockiv:function(a,b,c,d){d[0]=this.__context.getActiveUniformBlockParameter(a,b,c)},getActiveUniformBlockName:function(a,b){return this.__context.getActiveUniformBlockName(a,
b)},getActiveUniformBlockParameter:function(a,b,c){return this.__context.getActiveUniformBlockParameter(a,b,c)},getActiveUniforms:function(a,b,c){return this.__context.getActiveUniforms(a,b,c)},getActiveUniformsiv:function(a,b,c,d){},getAttachedShaders:function(a){return this.__context.getAttachedShaders(a)},getAttribLocation:function(a,b){return this.__context.getAttribLocation(a,b)},getBoolean:function(a){return this.__context.getParameter(a)},getBooleanv:function(a,b){a=this.__context.getParameter(a);
if(a instanceof Array&&null==a.__enum__)for(var c=0,d=a.length;c<d;){var e=c++;b[e]=a[e]?1:0}else b[0]=y.__cast(a,me)?1:0},getBufferParameter:function(a,b){return this.__context.getBufferParameter(a,b)},getBufferParameteri:function(a,b){return this.__context.getBufferParameter(a,b)},getBufferParameteri64v:function(a,b,c){},getBufferParameteriv:function(a,b,c){c[0]=this.__context.getBufferParameter(a,b)},getBufferPointerv:function(a,b){return 0},getBufferSubData:function(a,b,c,d){this.__context.getBufferSubData(a,
b,d)},getBufferSubDataWEBGL:function(a,b,c,d,e){null!=d?this.__context.getBufferSubData(a,b,c,d,e):this.__context.getBufferSubData(a,b,c)},getContextAttributes:function(){return this.__context.getContextAttributes()},getError:function(){return this.__context.getError()},getExtension:function(a){return this.__context.getExtension(a)},getFloat:function(a){return this.__context.getParameter(a)},getFloatv:function(a,b){a=this.__context.getParameter(a);if(y.__instanceof(a,ArrayBufferView))for(var c=0,
d=a.length;c<d;){var e=c++;b[e]=a[e]}else b[0]=y.__cast(a,ie)},getFragDataLocation:function(a,b){return this.__context.getFragDataLocation(a,b)},getFramebufferAttachmentParameter:function(a,b,c){return this.__context.getFramebufferAttachmentParameter(a,b,c)},getFramebufferAttachmentParameteri:function(a,b,c){return this.__context.getFramebufferAttachmentParameter(a,b,c)},getFramebufferAttachmentParameteriv:function(a,b,c,d){a=this.__context.getFramebufferAttachmentParameter(a,b,c);d[0]=a},getIndexedParameter:function(a,
b){return this.__context.getIndexedParameter(a,b)},getInteger:function(a){return this.__context.getParameter(a)},getInteger64:function(a){return new Ub(0,0)},getInteger64i:function(a){return new Ub(0,0)},getInteger64i_v:function(a,b,c){},getInteger64v:function(a,b){},getIntegeri:function(a){return 0},getIntegeri_v:function(a,b,c){},getIntegerv:function(a,b){a=this.__context.getParameter(a);if(y.__instanceof(a,ArrayBufferView))for(var c=0,d=a.length;c<d;){var e=c++;b[e]=a[e]}else b[0]=y.__cast(a,je)},
getInternalformati:function(a,b,c){return 0},getInternalformativ:function(a,b,c,d,e){},getInternalformatParameter:function(a,b,c){return this.__context.getInternalformatParameter(a,b,c)},getParameter:function(a){return this.__context.getParameter(a)},getProgramBinary:function(a,b){return null},getProgrami:function(a,b){return this.__context.getProgramParameter(a,b)},getProgramiv:function(a,b,c){c[0]=this.__context.getProgramParameter(a,b)},getProgramInfoLog:function(a){return this.__context.getProgramInfoLog(a)},
getProgramParameter:function(a,b){return this.__context.getProgramParameter(a,b)},getQuery:function(a,b){return this.__context.getQuery(a,b)},getQueryi:function(a,b){return 0},getQueryiv:function(a,b,c){},getQueryObjectui:function(a,b){return 0},getQueryObjectuiv:function(a,b,c){},getQueryParameter:function(a,b){return this.__context.getQueryParameter(a,b)},getRenderbufferParameter:function(a,b){return this.__context.getRenderbufferParameter(a,b)},getRenderbufferParameteri:function(a,b){return this.__context.getRenderbufferParameter(a,
b)},getRenderbufferParameteriv:function(a,b,c){c[0]=this.__context.getRenderbufferParameter(a,b)},getSamplerParameter:function(a,b){return this.__context.getSamplerParameter(a,b)},getSamplerParameterf:function(a,b){return 0},getSamplerParameterfv:function(a,b,c){},getSamplerParameteri:function(a,b){return 0},getSamplerParameteriv:function(a,b,c){},getShaderi:function(a,b){return this.__context.getShaderParameter(a,b)},getShaderiv:function(a,b,c){c[0]=this.__context.getShaderParameter(a,b)},getShaderInfoLog:function(a){return this.__context.getShaderInfoLog(a)},
getShaderParameter:function(a,b){return this.__context.getShaderParameter(a,b)},getShaderPrecisionFormat:function(a,b){return this.__context.getShaderPrecisionFormat(a,b)},getShaderSource:function(a){return this.__context.getShaderSource(a)},getString:function(a){return this.__context.getParameter(a)},getStringi:function(a,b){return null},getSupportedExtensions:function(){return this.__context.getSupportedExtensions()},getSyncParameter:function(a,b){return this.__context.getSyncParameter(a,b)},getSyncParameteri:function(a,
b){return 0},getSyncParameteriv:function(a,b,c){},getTexParameter:function(a,b){return this.__context.getTexParameter(a,b)},getTexParameterf:function(a,b){return this.__context.getTexParameter(a,b)},getTexParameterfv:function(a,b,c){c[0]=this.__context.getTexParameter(a,b)},getTexParameteri:function(a,b){return this.__context.getTexParameter(a,b)},getTexParameteriv:function(a,b,c){c[0]=this.__context.getTexParameter(a,b)},getTransformFeedbackVarying:function(a,b){return this.__context.getTransformFeedbackVarying(a,
b)},getUniform:function(a,b){return this.__context.getUniform(a,b)},getUniformf:function(a,b){return this.__context.getUniform(a,b)},getUniformfv:function(a,b,c){c[0]=this.__context.getUniform(a,b)},getUniformi:function(a,b){return this.__context.getUniform(a,b)},getUniformiv:function(a,b,c){a=this.__context.getUniform(a,b);c[0]=a},getUniformui:function(a,b){return 0},getUniformuiv:function(a,b,c){},getUniformBlockIndex:function(a,b){return this.__context.getUniformBlockIndex(a,b)},getUniformIndices:function(a,
b){return this.__context.getUniformIndices(a,b)},getUniformLocation:function(a,b){return this.__context.getUniformLocation(a,b)},getVertexAttrib:function(a,b){return this.__context.getVertexAttrib(a,b)},getVertexAttribf:function(a,b){return 0},getVertexAttribfv:function(a,b,c){},getVertexAttribi:function(a,b){return 0},getVertexAttribIi:function(a,b){return 0},getVertexAttribIiv:function(a,b,c){},getVertexAttribIui:function(a,b){return 0},getVertexAttribIuiv:function(a,b,c){},getVertexAttribiv:function(a,
b,c){},getVertexAttribOffset:function(a,b){return this.__context.getVertexAttribOffset(a,b)},getVertexAttribPointerv:function(a,b){return this.__context.getVertexAttribOffset(a,b)},hint:function(a,b){this.__context.hint(a,b)},invalidateFramebuffer:function(a,b){this.__context.invalidateFramebuffer(a,b)},invalidateSubFramebuffer:function(a,b,c,d,e,h){this.__context.invalidateSubFramebuffer(a,b,c,d,e,h)},isBuffer:function(a){return this.__context.isBuffer(a)},isEnabled:function(a){return this.__context.isEnabled(a)},
isFramebuffer:function(a){return this.__context.isFramebuffer(a)},isProgram:function(a){return this.__context.isProgram(a)},isQuery:function(a){return this.__context.isQuery(a)},isRenderbuffer:function(a){return this.__context.isRenderbuffer(a)},isSampler:function(a){return this.__context.isSampler(a)},isShader:function(a){return this.__context.isShader(a)},isSync:function(a){return this.__context.isSync(a)},isTexture:function(a){return this.__context.isTexture(a)},isTransformFeedback:function(a){return this.__context.isTransformFeedback(a)},
isVertexArray:function(a){return this.__context.isVertexArray(a)},lineWidth:function(a){this.__context.lineWidth(a)},linkProgram:function(a){this.__context.linkProgram(a)},mapBufferRange:function(a,b,c,d){return 0},pauseTransformFeedback:function(){this.__context.pauseTransformFeedback()},pixelStorei:function(a,b){this.__context.pixelStorei(a,b)},polygonOffset:function(a,b){this.__context.polygonOffset(a,b)},programBinary:function(a,b,c,d){},programParameteri:function(a,b,c){},readBuffer:function(a){this.__context.readBuffer(a)},
readPixels:function(a,b,c,d,e,h,f){this.__context.readPixels(a,b,c,d,e,h,f.toBufferView())},readPixelsWEBGL:function(a,b,c,d,e,h,f,g){null!=g?this.__context.readPixels(a,b,c,d,e,h,f,g):this.__context.readPixels(a,b,c,d,e,h,f)},releaseShaderCompiler:function(){},renderbufferStorage:function(a,b,c,d){this.__context.renderbufferStorage(a,b,c,d)},renderbufferStorageMultisample:function(a,b,c,d,e){1==this.version?this.__context.renderbufferStorage(a,c,d,e):2==this.version&&this.__context.renderbufferStorageMultisample(a,
b,c,d,e)},resumeTransformFeedback:function(){this.__context.resumeTransformFeedback()},sampleCoverage:function(a,b){this.__context.sampleCoverage(a,b)},samplerParameterf:function(a,b,c){this.__context.samplerParameterf(a,b,c)},samplerParameteri:function(a,b,c){this.__context.samplerParameteri(a,b,c)},scissor:function(a,b,c,d){this.__context.scissor(a,b,c,d)},shaderBinary:function(a,b,c,d){},shaderSource:function(a,b){this.__context.shaderSource(a,b)},stencilFunc:function(a,b,c){this.__context.stencilFunc(a,
b,c)},stencilFuncSeparate:function(a,b,c,d){this.__context.stencilFuncSeparate(a,b,c,d)},stencilMask:function(a){this.__context.stencilMask(a)},stencilMaskSeparate:function(a,b){this.__context.stencilMaskSeparate(a,b)},stencilOp:function(a,b,c){this.__context.stencilOp(a,b,c)},stencilOpSeparate:function(a,b,c,d){this.__context.stencilOpSeparate(a,b,c,d)},texImage2D:function(a,b,c,d,e,h,f,g,k){this.__context.texImage2D(a,b,c,d,e,h,f,g,k)},texImage2DWEBGL:function(a,b,c,d,e,h,f,g,k,l){null!=l?this.__context.texImage2D(a,
b,c,d,e,h,f,g,k,l):null!=f?this.__context.texImage2D(a,b,c,d,e,h,f,g,k):this.__context.texImage2D(a,b,c,d,e,h)},texImage3D:function(a,b,c,d,e,h,f,g,k,l){this.__context.texImage3D(a,b,c,d,e,h,f,g,k,l.toBufferView())},texImage3DWEBGL:function(a,b,c,d,e,h,f,g,k,l,m){this.__context.texImage3D(a,b,c,d,e,h,f,g,k,l,m)},texStorage2D:function(a,b,c,d,e){this.__context.texStorage2D(a,b,c,d,e)},texStorage3D:function(a,b,c,d,e,h){this.__context.texStorage3D(a,b,c,d,e,h)},texParameterf:function(a,b,c){this.__context.texParameterf(a,
b,c)},texParameteri:function(a,b,c){this.__context.texParameteri(a,b,c)},texSubImage2D:function(a,b,c,d,e,h,f,g,k){this.__context.texSubImage2D(a,b,c,d,e,h,f,g,k.toBufferView())},texSubImage2DWEBGL:function(a,b,c,d,e,h,f,g,k,l){null!=l?this.__context.texSubImage2D(a,b,c,d,e,h,f,g,k,l):null!=g?this.__context.texSubImage2D(a,b,c,d,e,h,f,g,k):this.__context.texSubImage2D(a,b,c,d,e,h,f)},texSubImage3D:function(a,b,c,d,e,h,f,g,k,l,m){this.__context.texSubImage3D(a,b,c,d,e,h,f,g,k,l,m.toBufferView())},
texSubImage3DWEBGL:function(a,b,c,d,e,h,f,g,k,l,m,n){this.__context.texSubImage3D(a,b,c,d,e,h,f,g,k,l,m,n)},transformFeedbackVaryings:function(a,b,c){this.__context.transformFeedbackVaryings(a,b,c)},uniform1f:function(a,b){this.__context.uniform1f(a,b)},uniform1fv:function(a,b,c){this.__context.uniform1fv(a,c)},uniform1fvWEBGL:function(a,b,c,d){null!=c?this.__context.uniform1fv(a,b,c,d):this.__context.uniform1fv(a,b)},uniform1i:function(a,b){this.__context.uniform1i(a,b)},uniform1iv:function(a,b,
c){this.__context.uniform1iv(a,c)},uniform1ivWEBGL:function(a,b,c,d){null!=c?this.__context.uniform1iv(a,b,c,d):this.__context.uniform1iv(a,b)},uniform1ui:function(a,b){this.__context.uniform1ui(a,b)},uniform1uiv:function(a,b,c){this.__context.uniform1uiv(a,c)},uniform1uivWEBGL:function(a,b,c,d){this.__context.uniform1uiv(a,b,c,d)},uniform2f:function(a,b,c){this.__context.uniform2f(a,b,c)},uniform2fv:function(a,b,c){this.__context.uniform2fv(a,c)},uniform2fvWEBGL:function(a,b,c,d){null!=c?this.__context.uniform2fv(a,
b,c,d):this.__context.uniform2fv(a,b)},uniform2i:function(a,b,c){this.__context.uniform2i(a,b,c)},uniform2iv:function(a,b,c){this.__context.uniform2iv(a,c)},uniform2ivWEBGL:function(a,b,c,d){null!=c?this.__context.uniform2iv(a,b,c,d):this.__context.uniform2iv(a,b)},uniform2ui:function(a,b,c){this.__context.uniform2ui(a,b,c)},uniform2uiv:function(a,b,c){this.__context.uniform2uiv(a,c)},uniform2uivWEBGL:function(a,b,c,d){this.__context.uniform2uiv(a,b,c,d)},uniform3f:function(a,b,c,d){this.__context.uniform3f(a,
b,c,d)},uniform3fv:function(a,b,c){this.__context.uniform3fv(a,c)},uniform3fvWEBGL:function(a,b,c,d){null!=c?this.__context.uniform3fv(a,b,c,d):this.__context.uniform3fv(a,b)},uniform3i:function(a,b,c,d){this.__context.uniform3i(a,b,c,d)},uniform3iv:function(a,b,c){this.__context.uniform3iv(a,c)},uniform3ivWEBGL:function(a,b,c,d){null!=c?this.__context.uniform3iv(a,b,c,d):this.__context.uniform3iv(a,b)},uniform3ui:function(a,b,c,d){this.__context.uniform3ui(a,b,c,d)},uniform3uiv:function(a,b,c){this.__context.uniform3uiv(a,
c)},uniform3uivWEBGL:function(a,b,c,d){this.__context.uniform3uiv(a,b,c,d)},uniform4f:function(a,b,c,d,e){this.__context.uniform4f(a,b,c,d,e)},uniform4fv:function(a,b,c){this.__context.uniform4fv(a,c)},uniform4fvWEBGL:function(a,b,c,d){null!=c?this.__context.uniform4fv(a,b,c,d):this.__context.uniform4fv(a,b)},uniform4i:function(a,b,c,d,e){this.__context.uniform4i(a,b,c,d,e)},uniform4iv:function(a,b,c){this.__context.uniform4iv(a,c)},uniform4ivWEBGL:function(a,b,c,d){null!=c?this.__context.uniform4iv(a,
b,c,d):this.__context.uniform4iv(a,b)},uniform4ui:function(a,b,c,d,e){this.__context.uniform4ui(a,b,c,d,e)},uniform4uiv:function(a,b,c){this.__context.uniform4uiv(a,c)},uniform4uivWEBGL:function(a,b,c,d){this.__context.uniform4uiv(a,b,c,d)},uniformBlockBinding:function(a,b,c){this.__context.uniformBlockBinding(a,b,c)},uniformMatrix2fv:function(a,b,c,d){this.__context.uniformMatrix2fv(a,c,d)},uniformMatrix2fvWEBGL:function(a,b,c,d,e){null!=d?this.__context.uniformMatrix2fv(a,b,c,d,e):this.__context.uniformMatrix2fv(a,
b,c)},uniformMatrix2x3fv:function(a,b,c,d){this.__context.uniformMatrix2x3fv(a,c,d)},uniformMatrix2x3fvWEBGL:function(a,b,c,d,e){this.__context.uniformMatrix2x3fv(a,b,c,d,e)},uniformMatrix2x4fv:function(a,b,c,d){this.__context.uniformMatrix2x4fv(a,c,d)},uniformMatrix2x4fvWEBGL:function(a,b,c,d,e){this.__context.uniformMatrix2x4fv(a,b,c,d,e)},uniformMatrix3fv:function(a,b,c,d){this.__context.uniformMatrix3fv(a,c,d)},uniformMatrix3fvWEBGL:function(a,b,c,d,e){null!=d?this.__context.uniformMatrix3fv(a,
b,c,d,e):this.__context.uniformMatrix3fv(a,b,c)},uniformMatrix3x2fv:function(a,b,c,d){this.__context.uniformMatrix3x2fv(a,c,d)},uniformMatrix3x2fvWEBGL:function(a,b,c,d,e){this.__context.uniformMatrix3x2fv(a,b,c,d,e)},uniformMatrix3x4fv:function(a,b,c,d){this.__context.uniformMatrix3x4fv(a,c,d)},uniformMatrix3x4fvWEBGL:function(a,b,c,d,e){this.__context.uniformMatrix3x4fv(a,b,c,d,e)},uniformMatrix4fv:function(a,b,c,d){this.__context.uniformMatrix4fv(a,c,d)},uniformMatrix4fvWEBGL:function(a,b,c,d,
e){null!=d?this.__context.uniformMatrix4fv(a,b,c,d,e):this.__context.uniformMatrix4fv(a,b,c)},uniformMatrix4x2fv:function(a,b,c,d){this.__context.uniformMatrix4x2fv(a,c,d)},uniformMatrix4x2fvWEBGL:function(a,b,c,d,e){null!=d?this.__context.uniformMatrix4x2fv(a,b,c,d,e):this.__context.uniformMatrix4x2fv(a,b,c)},uniformMatrix4x3fv:function(a,b,c,d){this.__context.uniformMatrix4x3fv(a,c,d)},uniformMatrix4x3fvWEBGL:function(a,b,c,d,e){this.__context.uniformMatrix4x3fv(a,b,c,d,e)},unmapBuffer:function(a){return!1},
useProgram:function(a){this.__context.useProgram(a)},validateProgram:function(a){this.__context.validateProgram(a)},vertexAttrib1f:function(a,b){this.__context.vertexAttrib1f(a,b)},vertexAttrib1fv:function(a,b){this.__context.vertexAttrib1fv(a,b)},vertexAttrib1fvWEBGL:function(a,b){this.__context.vertexAttrib1fv(a,b)},vertexAttrib2f:function(a,b,c){this.__context.vertexAttrib2f(a,b,c)},vertexAttrib2fv:function(a,b){this.__context.vertexAttrib2fv(a,b)},vertexAttrib2fvWEBGL:function(a,b){this.__context.vertexAttrib2fv(a,
b)},vertexAttrib3f:function(a,b,c,d){this.__context.vertexAttrib3f(a,b,c,d)},vertexAttrib3fv:function(a,b){this.__context.vertexAttrib3fv(a,b)},vertexAttrib3fvWEBGL:function(a,b){this.__context.vertexAttrib3fv(a,b)},vertexAttrib4f:function(a,b,c,d,e){this.__context.vertexAttrib4f(a,b,c,d,e)},vertexAttrib4fv:function(a,b){this.__context.vertexAttrib4fv(a,b)},vertexAttrib4fvWEBGL:function(a,b){this.__context.vertexAttrib4fv(a,b)},vertexAttribDivisor:function(a,b){this.__context.vertexAttribDivisor(a,
b)},vertexAttribI4i:function(a,b,c,d,e){this.__context.vertexAttribI4i(a,b,c,d,e)},vertexAttribI4iv:function(a,b){this.__context.vertexAttribI4iv(a,b)},vertexAttribI4ivWEBGL:function(a,b){this.__context.vertexAttribI4iv(a,b)},vertexAttribI4ui:function(a,b,c,d,e){this.__context.vertexAttribI4ui(a,b,c,d,e)},vertexAttribI4uiv:function(a,b){this.__context.vertexAttribI4uiv(a,b.toUInt32Array())},vertexAttribI4uivWEBGL:function(a,b){this.__context.vertexAttribI4uiv(a,b)},vertexAttribIPointer:function(a,
b,c,d,e){this.__context.vertexAttribIPointer(a,b,c,d,e)},vertexAttribPointer:function(a,b,c,d,e,h){this.__context.vertexAttribPointer(a,b,c,d,e,h)},viewport:function(a,b,c,d){this.__context.viewport(a,b,c,d)},waitSync:function(a,b,c){this.__context.waitSync(a,b,c)},__class__:Xc};var u=g.lovedna.game.System=function(){M.call(this);this.stencil=this.depth=!0;this._initDelay=new ia(q(this,this.init));this._inited=!1;this._focusDelay=new ia(q(this,this.focus));this._touchManager=new Nb(!1);this._touch=
new Fa;for(var a=["blur","resize","focus","beforeunload"],b=0;b<a.length;){var c=a[b];++b;window.addEventListener(c,q(this,this.handleWindowEvent),{capture:!1,passive:!1})}this._keyManager=Ab.getInstance();this._key=new Ia;window.addEventListener("keydown",q(this,this.handleKeyEvent),!1);window.addEventListener("keyup",q(this,this.handleKeyEvent),!1);a=["ms","moz","webkit","o"];for(b=0;b<a.length&&!window.requestAnimationFrame;++b)window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"],
window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"]||window[a[b]+"CancelRequestAnimationFrame"];this._frame=0;this._active=!0;null!=(ib=window,q(ib,ib.requestAnimationFrame))?this.handleWindowUpdate():U.trace("RequestAnimationFrame is null",{fileName:"System.hx",lineNumber:86,className:"lovedna.game.System",methodName:"new"});window.oncontextmenu=function(a){a.preventDefault()};this.requestedFullscreen=this.isFullscreen=!1};f["lovedna.game.System"]=u;u.__name__=["lovedna","game","System"];
u.__super__=M;u.prototype=r(M.prototype,{setup:function(a){if(null!=a){if(t.exist(a,"canvas")){var b=t.getValue(a,"canvas");if(null!=b){this._canvas_webgl=b;this.setupTouchInput(this._canvas_webgl);this.depth=t.getBool(a,"depth",!0);this.stencil=t.getBool(a,"stencil",!0);b={alpha:t.getBool(a,"alpha",!0),antialias:t.getBool(a,"alpha",!1),depth:this.depth,premultipliedAlpha:t.getBool(a,"premultipliedAlpha",!0),stencil:this.stencil,preserveDrawingBuffer:t.getBool(a,"preserveDrawingBuffer",!1)};var c=
["webgl","experimental-webgl"];2==t.getInt(a,"webgl")&&c.unshift("webgl2");for(var d=null,e=1,h=0;h<c.length;){var f=c[h];++h;d=this._canvas_webgl.getContext(f,b);if(null!=d){"webgl2"==f&&(e=2);break}}null!=d&&(this._inited||ia.add(this._initDelay,.1),this._inited=!0,u.gl.setup(d,e))}}t.exist(a,"input")&&(a=t.getValue(a,"input"),this.setupTouchInput(a))}},setFullscreen:function(a){var b=window.document;a?this.requestedFullscreen||this.isFullscreen||(this.requestedFullscreen=!0,(ib=this._inputElement,
q(ib,ib.requestFullscreen))?(b.addEventListener("fullscreenchange",q(this,this.handleFullscreenEvent),!1),b.addEventListener("fullscreenerror",q(this,this.handleFullscreenEvent),!1),this._inputElement.requestFullscreen()):this._inputElement.mozRequestFullScreen?(b.addEventListener("mozfullscreenchange",q(this,this.handleFullscreenEvent),!1),b.addEventListener("mozfullscreenerror",q(this,this.handleFullscreenEvent),!1),this._inputElement.mozRequestFullScreen()):this._inputElement.webkitRequestFullscreen?
(b.addEventListener("webkitfullscreenchange",q(this,this.handleFullscreenEvent),!1),b.addEventListener("webkitfullscreenerror",q(this,this.handleFullscreenEvent),!1),this._inputElement.webkitRequestFullscreen()):this._inputElement.msRequestFullscreen&&(b.addEventListener("MSFullscreenChange",q(this,this.handleFullscreenEvent),!1),b.addEventListener("MSFullscreenError",q(this,this.handleFullscreenEvent),!1),this._inputElement.msRequestFullscreen())):this.isFullscreen&&(this.requestedFullscreen=!1,
q(b,b.exitFullscreen)?b.exitFullscreen():b.mozCancelFullScreen?b.mozCancelFullScreen():b.webkitExitFullscreen?b.webkitExitFullscreen():b.msExitFullscreen&&b.msExitFullscreen())},init:function(){this.width=this._canvas_webgl.width;this.height=this._canvas_webgl.height;this.doResize();this.dispatchEvent(ua.init)},setupTouchInput:function(a){null!=a&&this._inputElement!=a&&(null!=this._inputElement&&this.touchdisconnect(),this._inputElement=a,this.touchconnect())},touchconnect:function(){var a=new wb;
a.addString(this._inputElement.id);this._touch.device=a.getCode();a="mousedown mouseenter mouseleave mousemove mouseup wheel".split(" ");for(var b=0;b<a.length;){var c=a[b];++b;this._inputElement.addEventListener(c,q(this,this.handleMouseEvent),{capture:!1,passive:!1})}a=["touchstart","touchmove","touchend","touchcancel"];for(b=0;b<a.length;)c=a[b],++b,this._inputElement.addEventListener(c,q(this,this.handleTouchEvent),{capture:!1,passive:!1})},touchdisconnect:function(){for(var a="mousedown mouseenter mouseleave mousemove mouseup wheel".split(" "),
b=0;b<a.length;){var c=a[b];++b;this._inputElement.removeEventListener(c,q(this,this.handleMouseEvent))}a=["touchstart","touchmove","touchend","touchcancel"];for(b=0;b<a.length;)c=a[b],++b,this._inputElement.removeEventListener(c,q(this,this.handleTouchEvent))},handleMouseEvent:function(a){a.stopPropagation();a.preventDefault();a.stopImmediatePropagation();0==this._touchManager.touchType&&(this._touchManager.touchType=1);if(1==this._touchManager.touchType){var b=a.type,c=this._touch.position;c.x=
0;c.y=0;this._touch.touchId=a.button;this._touch.pressure=-1;if("wheel"!=b){c=this._inputElement.getBoundingClientRect();var d=this._touch.position;d.x=a.offsetX/c.width;d.y=a.offsetY/c.height;"mousemove"==b&&this._touchManager.move(this._touch);"mousedown"==b&&this._touchManager.begin(this._touch);"mouseup"==b&&this._touchManager.end(this._touch);"mouseleave"==b&&this._touchManager.cancel(this._touch)}}},handleTouchEvent:function(a){this._active||this.focus();a.stopPropagation();a.preventDefault();
a.stopImmediatePropagation();0==this._touchManager.touchType&&(this._touchManager.touchType=2);if(2==this._touchManager.touchType){var b=a.type,c=this._inputElement.getBoundingClientRect(),d=this._touch.position;d.x=0;d.y=0;d=this._touch.touchId=0;for(a=a.changedTouches;d<a.length;){var e=a[d];++d;var h=this._touch.position;h.x=(e.clientX-c.left)/c.width;h.y=(e.clientY-c.top)/c.height;this._touch.touchId=e.identifier;this._touch.pressure=e.force;"touchmove"==b?this._touchManager.move(this._touch):
"touchstart"==b?this._touchManager.begin(this._touch):"touchend"==b?this._touchManager.end(this._touch):"touchcancel"==b&&this._touchManager.cancel(this._touch)}}},handleWindowEvent:function(a){a=a.type;"focus"==a?ia.add(this._focusDelay,.1):"blur"==a?(E._focused||(a=P._custom()-E._blurTime,E._offset+=a,E._blurTime=0),E._blurTime=P._custom(),this._active=!1,this._frame=0):"resize"==a&&this._inited&&this.doResize()},focus:function(){var a=P._custom()-E._blurTime;E._offset+=a;E._blurTime=0;this._active=
!0;0==this._frame&&this.handleWindowUpdate()},handleWindowUpdate:function(a){0!=this._frame&&this.dispatchEvent(ua.update);this._active&&(this._frame++,window.requestAnimationFrame(q(this,this.handleWindowUpdate)))},doResize:function(){if(null!=this._canvas_webgl.parentElement){var a=this._canvas_webgl.parentElement.clientWidth;var b=this._canvas_webgl.parentElement.clientHeight}else a=window.innerWidth,b=window.innerHeight;if(this.width!=a||this.height!=b)this.width=n.floor(a),this.height=n.floor(b),
this._canvas_webgl.width=this.width,this._canvas_webgl.height=this.height,ua.resize.vintlist[0]=this.width,ua.resize.vintlist[1]=this.height,this.dispatchEvent(ua.resize)},handleFullscreenEvent:function(a){a=window.document;this.requestedFullscreen=!1;if(null!=(a.fullscreenElement||a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement))a=!0;else{a=!1;for(var b=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"],c=["fullscreenerror","mozfullscreenerror",
"webkitfullscreenerror","MSFullscreenError"],d=0,e=b.length;d<e;){var h=d++;window.document.removeEventListener(b[h],q(this,this.handleFullscreenEvent),!1);window.document.removeEventListener(c[h],q(this,this.handleFullscreenEvent),!1)}}a!=this.isFullscreen&&(this.isFullscreen=a,ua.resize.vbool=this.isFullscreen,this.dispatchEvent(ua.fullScreen))},handleKeyEvent:function(a){this._key.deviceType=0;this._key.deviceId=0;this._key.keyCode=a.keyCode;this._key.key=a.key;this._key.value=0;this._key.modifier.clear();
this._key.modifier.setElement(3,a.altKey);this._key.modifier.setElement(2,a.ctrlKey);this._key.modifier.setElement(1,a.shiftKey);this._key.modifier.setElement(4,a.metaKey);this._key.type="keydown"==a.type?1:2;this._keyManager.keyTrigger(this._key)},__class__:u});var Qb=g.lovedna.game.World=function(){this.fixedCount=1;Ha.call(this);this._dirty=!0;this.set_dirty(!0);this._resized=!0;this._now=P._custom();this._fixedTime=0;this._root=new H;this._actorList=new O;this._actorMap=new Z;this._fixedList=
new O;this._fixedRemoveIds=new O;this._addMap=new Z;this._collectorMap=new J;this._collectorList=[];this.collectorCamera=new Yc;this.collectorRenderer=new Zc;this.collectorCollider=new $c;this.collectorLight=new ad;this.addCollector(this.collectorCamera);this.addCollector(this.collectorRenderer);this.addCollector(this.collectorCollider);this.addCollector(this.collectorLight)};f["lovedna.game.World"]=Qb;Qb.__name__=["lovedna","game","World"];Qb.__super__=Ha;Qb.prototype=r(Ha.prototype,{addChild:function(a){this._root.get_transform().addChild(a.get_transform());
this.set_dirty(!0)},removeChild:function(a){this._root.get_transform().removeChild(a.get_transform());this.set_dirty(!0)},addCollector:function(a){-1==this._collectorList.indexOf(a)&&this._collectorList.push(a)},removeCollector:function(a){var b=this._collectorList.indexOf(a);-1!=b&&this._collectorList.splice(b,1);for(b=this._collectorMap.keys();b.hasNext();){var c=b.next(),d=this._collectorMap;(null!=p[c]?d.getReserved(c):d.h[c])==a&&this._collectorMap.remove(c)}},getCollector:function(a){var b=
this._collectorMap;for(b=new sb(b,b.arrayKeys());b.hasNext();){var c=b.next();if(y.__instanceof(c,a))return c}return null},_onAdd:function(){this._now=P._custom();this._fixedTime=0;this.game=$a.current},_onRemove:function(){},_resize:function(a,b){this.width=a;this.height=b;this._resized=!0},_update:function(a){Qb.current=this;var b=this._resized;this._resized=!1;var c=E.deltaTime,d=E.fixedTime;this._fixedTime+=c;this.fixedCount=0;this._fixedTime>=E.fixedTime&&(this.fixedCount=n.floor(this._fixedTime/
E.fixedTime),this._fixedTime%=E.fixedTime);this._fixedList.clear();for(var e=this._actorList.get_length(),h,f=0,g=e;f<g;)h=f++,h=this._actorList.get(h),h._enabled&&h._update(this.fixedCount,c,d)&&this._fixedList.push(h);f=this._fixedList.get_length();for(c=1E4;0<f&&!(0>=c--);){this._fixedRemoveIds.clear();g=0;for(var k=f;g<k;){var l=g++;h=this._fixedList.get(l);h._fixedUpdate(d)||this._fixedRemoveIds.push(l)}h=this._fixedRemoveIds.get_length();if(0<h){for(;0<h--;)f=this._fixedRemoveIds.getElement(h),
this._fixedList.removeAt(f);f=this._fixedList.get_length()}}for(d=0;d<e;)h=d++,h=this._actorList.get(h),h._enabled&&h.dispatchEvent(w.onLateUpdate);this.collectActors();e=this._actorList.get_length();for(d=0;d<e;)h=d++,h=this._actorList.get(h),h._enabled&&(b&&h.dispatchEvent(w.onScreenResize),h._updateTransform(a));e=this.collectorCamera.count;a=0;for(b=e;a<b;)e=a++,this.collectorCamera.get(e).data.render(this.collectorRenderer)},_render:function(){},collectActors:function(){if(this._dirty){this._dirty=
!1;for(var a=this._actorList.get_length();0<a--;){var b=this._actorList.get(a);this._addMap.h[b.instanceID]=b}this._actorList.clear();this._root._collectActors(this._actorList);for(a=this._actorList.get_length();0<a--;)b=this._actorList.get(a),this._actorMap.h.hasOwnProperty(b.instanceID)||(b.world=this,b._collectComponent(!0),b.onEnable(),b.dispatchEvent(w.onEnable),this._actorMap.h[b.instanceID]=b),this._addMap.remove(b.instanceID);for(a=this._addMap.iterator();a.hasNext();)b=a.next(),b._disconnectWorld(),
this._addMap.remove(b.instanceID),this._actorMap.remove(b.instanceID)}},addComponent:function(a){var b=a.classType,c=this._collectorMap;if(null!=p[b]?c.existsReserved(b):c.h.hasOwnProperty(b))c=this._collectorMap,(null!=p[b]?c.getReserved(b):c.h[b]).add(a);else for(c=this._collectorList.length;0<c--;){var d=this._collectorList[c];if(d.exist(a)){d.add(a);var e=this._collectorMap;null!=p[b]?e.setReserved(b,d):e.h[b]=d}}},removeComponent:function(a){var b=a.classType,c=this._collectorMap;if(null!=p[b]?
c.existsReserved(b):c.h.hasOwnProperty(b))c=this._collectorMap,(null!=p[b]?c.getReserved(b):c.h[b]).remove(a)},set_dirty:function(a){return this._dirty=!0},__class__:Qb,__properties__:{set_dirty:"set_dirty"}});var $b=g.lovedna.game.collectors.ComponentCollector=function(){};f["lovedna.game.collectors.ComponentCollector"]=$b;$b.__name__=["lovedna","game","collectors","ComponentCollector"];$b.prototype={__class__:$b};var Yc=g.lovedna.game.collectors.CameraCollector=function(){this._dirty=!1;this.count=
0;this._cameras=new Z;this._list=[]};f["lovedna.game.collectors.CameraCollector"]=Yc;Yc.__name__=["lovedna","game","collectors","CameraCollector"];Yc.__interfaces__=[$b];Yc.prototype={exist:function(a){return y.__instanceof(a,Fb)},add:function(a){this._cameras.h.hasOwnProperty(a.instanceID)||(this._cameras.h[a.instanceID]=a,this._dirty=!0,this._list.push(a),this.count=this._list.length)},remove:function(a){this._cameras.h.hasOwnProperty(a.instanceID)&&(this._cameras.remove(a.instanceID),A.remove(this._list,
a),this.count=this._list.length)},get:function(a){this._dirty&&this._list.sort(q(this,this.sort));return this._list[a]},sort:function(a,b){return a.depth!=b.depth?a.depth>b.depth?1:-1:0},__class__:Yc};var $c=g.lovedna.game.collectors.ColliderCollector=function(){this._list=[];this.count=0;this._map=new Z};f["lovedna.game.collectors.ColliderCollector"]=$c;$c.__name__=["lovedna","game","collectors","ColliderCollector"];$c.__interfaces__=[$b];$c.prototype={exist:function(a){return y.__instanceof(a,mc)},
add:function(a){this._map.h.hasOwnProperty(a.instanceID)||(this._map.h[a.instanceID]=this._list.length,this._list.push(a),this.count=this._list.length)},remove:function(a){if(this._map.h.hasOwnProperty(a.instanceID)){var b=this._map.h[a.instanceID];this._list.splice(b,1);this._map.remove(a.instanceID);a=b;for(b=this._list.length;a<b;){var c=a++;this._map.h[this._list[c].instanceID]=c}this.count=this._list.length}},get:function(a){return this._list[a]},__class__:$c};var ad=g.lovedna.game.collectors.LightCollector=
function(){this._dirty=!1;this.count=0;this._map=new Z;this._list=[]};f["lovedna.game.collectors.LightCollector"]=ad;ad.__name__=["lovedna","game","collectors","LightCollector"];ad.__interfaces__=[$b];ad.prototype={exist:function(a){return y.__instanceof(a,bd)},add:function(a){this._map.h.hasOwnProperty(a.instanceID)||(this._map.h[a.instanceID]=a,this._dirty=!0,this._list.push(a),this.count=this._list.length)},remove:function(a){this._map.h.hasOwnProperty(a.instanceID)&&(this._map.remove(a.instanceID),
A.remove(this._list,a),this.count=this._list.length)},get:function(a){return this._list[a]},__class__:ad};var Zc=g.lovedna.game.collectors.RendererCollector=function(){this._list=[];this.count=0;this._map=new Z};f["lovedna.game.collectors.RendererCollector"]=Zc;Zc.__name__=["lovedna","game","collectors","RendererCollector"];Zc.__interfaces__=[$b];Zc.prototype={exist:function(a){return y.__instanceof(a,ob)},add:function(a){this._map.h.hasOwnProperty(a.instanceID)||(this._map.h[a.instanceID]=this._list.length,
this._list.push(a),this.count=this._list.length)},remove:function(a){if(this._map.h.hasOwnProperty(a.instanceID)){var b=this._map.h[a.instanceID];this._list.splice(b,1);this._map.remove(a.instanceID);a=b;for(b=this._list.length;a<b;){var c=a++;this._map.h[this._list[c].instanceID]=c}this.count=this._list.length}},get:function(a){return this._list[a]},__class__:Zc};var Fb=g.lovedna.game.components.Camera=function(){C.call(this)};f["lovedna.game.components.Camera"]=Fb;Fb.__name__=["lovedna","game",
"components","Camera"];Fb.__super__=C;Fb.prototype=r(C.prototype,{viewportToScreenPoint:function(a){var b=n.lerpTo(-1,1,0,1,a.x),c=n.lerpTo(1,-1,0,1,a.y),d=m._pool.get();d.x=b;d.y=c;d.z=a.z;return d},screenToViewportPoint:function(a){var b=n.lerpTo(0,1,-1,1,a.x),c=n.lerpTo(0,1,1,-1,a.y),d=m._pool.get();d.x=b;d.y=c;d.z=a.z;return d},viewportToWorldPoint:function(a){var b=m._pool.get();b.x=a.x;b.y=a.y;b.z=-1;var c=m._pool.get().copy(b);c.z=1;this.projectionViewInverseMatrix.transformVector(b,!0);this.projectionViewInverseMatrix.transformVector(c,
!0);return c.sub(b).scale(n.lerpTo(-1,1,0,1,a.z)).add(b)},worldToViewport:function(a){a=m._pool.get().copy(a);this.projectionViewMatrix.transformVector(a,!0);return a},worldToScreenPoint:function(a){a=m._pool.get().copy(a);this.projectionViewMatrix.transformVector(a,!0);return this.viewportToScreenPoint(a)},screenToWorldPoint:function(a){return this.viewportToWorldPoint(this.screenToViewportPoint(a))},viewportPointToRay:function(a){var b=m._pool.get();b.x=a.x;b.y=a.y;b.z=-1;a=m._pool.get().copy(b);
a.z=1;this.projectionViewInverseMatrix.transformVector(b,!0);this.projectionViewInverseMatrix.transformVector(a,!0);return jb.get_temp().set(b,a)},ScreenPointToRay:function(a){return this.viewportPointToRay(this.screenToViewportPoint(a))},onConstruct:function(){C.prototype.onConstruct.call(this);this.clearFlags=new Mb;this.cullingMask=new ka;this.orthographic=!1;this.orthographicScale=1;this.depth=0;this.render=!0;this.viewMatrix=this.worldToCameraMatrix=new fa;this.viewInverseMatrix=this.cameraToWorldMatrix=
new fa;this.projectionMatrix=new fa;this.projectionViewMatrix=new fa;this.projectionViewInverseMatrix=new fa;this.nearClipPlane=.1;this.farClipPlane=2E3;this.fieldOfView=60;this._projectionParams=new Q(this.nearClipPlane,this.farClipPlane,this.fieldOfView,0);this.frustum=new Ld;this._orthographicParams=new Q;this._transformFrame=0;this._eye=new m;this.uniforms=new mb;this.uniforms.setMatrix44(k.P.name,this.projectionMatrix);this.uniforms.setMatrix44(k.V.name,this.viewMatrix);this.uniforms.setMatrix44(k.IV.name,
this.viewInverseMatrix);this.uniforms.setMatrix44(k.VP.name,this.projectionViewMatrix);this.uniforms.setMatrix44(k.IVP.name,this.projectionViewInverseMatrix);this.uniforms.setMatrix44(k.IVP.name,this.projectionViewInverseMatrix);this.uniforms.setFloat4(k.PROJECTION_PARAMS.name,this._projectionParams);this.uniforms.setFloat4(k.ORTHOGRAPHIC_PARAMS.name,this._orthographicParams);this.uniforms.setFloat3(k.EYE.name,this._eye)},onStart:function(){C.prototype.onStart.call(this);this._orthographicParams.x=
this.actor.world.width;this._orthographicParams.y=this.actor.world.height;this._aspect=this._orthographicParams.x/this._orthographicParams.y;this.bindEvent(w.onScreenResize,q(this,this.screenResize));this.bindEvent(w.onTransformComplete,q(this,this.transformComplete));this.data=new Md(this)},screenResize:function(a){this._orthographicParams.x=this.actor.world.width;this._orthographicParams.y=this.actor.world.height;this._aspect=this._orthographicParams.x/this._orthographicParams.y},transformComplete:function(a){this.updateCamera()},
updateCamera:function(){var a=!1;if(this._projectionParams.x!=this.nearClipPlane||this._projectionParams.y!=this.farClipPlane||this._projectionParams.z!=this.fieldOfView||this._projectionParams.w!=this._aspect||this._orthographicParams.z!=(this.orthographic?1:0)||this._orthographicParams.w!=this.orthographicScale){a=this._projectionParams;a.x=this.nearClipPlane;a.y=this.farClipPlane;a.z=this.fieldOfView;a.w=this._aspect;this._orthographicParams.z=this.orthographic?1:0;this._orthographicParams.w=this.orthographicScale;
if(this.orthographic){a=this._orthographicParams.x;var b=this._orthographicParams.y;this.projectionMatrix.setOrtho(-a*this.orthographicScale,a*this.orthographicScale,-b*this.orthographicScale,b*this.orthographicScale,this.nearClipPlane,this.farClipPlane)}else this.projectionMatrix.setProjection(this.nearClipPlane,this.farClipPlane,this.fieldOfView,this._aspect);a=!0}this.actor.frame!=this._transformFrame&&(this._transformFrame=this.actor.frame,this._eye.copy(this.actor.get_transform().get_worldPosition()),
a=this.actor.get_transform().get_worldRotation().rotate(m.get_forward()),a.scale(this.farClipPlane-this.nearClipPlane).add(this._eye),this.viewMatrix.lookAt(this._eye,a,this.actor.get_transform().get_worldRotation().rotate(m.get_up())),a=!0);a&&(a=this.projectionViewMatrix,b=this.projectionMatrix,null!=b&&(a.m0=b.m0,a.m1=b.m1,a.m2=b.m2,a.m3=b.m3,a.m4=b.m4,a.m5=b.m5,a.m6=b.m6,a.m7=b.m7,a.m8=b.m8,a.m9=b.m9,a.m10=b.m10,a.m11=b.m11,a.m12=b.m12,a.m13=b.m13,a.m14=b.m14,a.m15=b.m15,a._dirty=!0),this.projectionViewMatrix.append(this.viewMatrix),
a=this.viewInverseMatrix,b=this.viewMatrix,null!=b&&(a.m0=b.m0,a.m1=b.m1,a.m2=b.m2,a.m3=b.m3,a.m4=b.m4,a.m5=b.m5,a.m6=b.m6,a.m7=b.m7,a.m8=b.m8,a.m9=b.m9,a.m10=b.m10,a.m11=b.m11,a.m12=b.m12,a.m13=b.m13,a.m14=b.m14,a.m15=b.m15,a._dirty=!0),this.viewInverseMatrix.inverse(),this.frustum.multiplyMatrix44(this.projectionViewMatrix),a=this.projectionViewInverseMatrix,b=this.projectionViewMatrix,null!=b&&(a.m0=b.m0,a.m1=b.m1,a.m2=b.m2,a.m3=b.m3,a.m4=b.m4,a.m5=b.m5,a.m6=b.m6,a.m7=b.m7,a.m8=b.m8,a.m9=b.m9,
a.m10=b.m10,a.m11=b.m11,a.m12=b.m12,a.m13=b.m13,a.m14=b.m14,a.m15=b.m15,a._dirty=!0),this.projectionViewInverseMatrix.inverse(),this.actor.dispatchEvent(w.onCameraUpdate))},__class__:Fb});var Nd=g.lovedna.game.components.CameraControl=function(){this.maxy=89.9;this.miny=-89.9;C.call(this)};f["lovedna.game.components.CameraControl"]=Nd;Nd.__name__=["lovedna","game","components","CameraControl"];Nd.__super__=C;Nd.prototype=r(C.prototype,{onAwake:function(){C.prototype.onAwake.call(this);this.target=
new m;this._rotationStart=new v;this._rotationEnd=new v;this._rotationDelta=new v;this._rotation=new ja;this.rotationSpeed=.5;this.distance=100;this.miny=-89.9;this.maxy=89.9},onStart:function(){C.prototype.onStart.call(this);this._camera=this.actor.getComponent(Fb);null!=this._camera&&this.bindEvent(w.onUpdate,q(this,this.onUpdate))},onUpdate:function(a){if(1==F.touchCount&&(a=F.getTouch(0),F.touchDown(0)&&this._rotationStart.copy(a.position),this._rotationEnd.copy(a.position),this._rotationDelta.sub(this._rotationEnd,
this._rotationStart),this._rotationStart.copy(this._rotationEnd),a=this._rotationDelta,!(1E-7>n.abs(a.x)&&1E-7>n.abs(a.y)))){this._rotationDelta.scale(180*this.rotationSpeed);this._rotation.setEulerAngles(this._rotationDelta.y,-this._rotationDelta.x,0);a=this.actor.get_transform().rotation.getEulerAngles();var b=m.instance,c=-this._rotationDelta.x;b.x=this._rotationDelta.y;b.y=c;b.z=0;a=a.add(b);a.x>this.maxy&&(a.x=this.maxy);a.x<this.miny&&(a.x=this.miny);this.actor.get_transform().rotation.setEulerAngles(a.x,
a.y,a.z);this.actor.get_transform().position.copy(this.actor.get_transform().rotation.rotate(m.get_forward()).scale(-this.distance).add(this.target))}},__class__:Nd});var Pa=g.lovedna.game.components.UI=function(){C.call(this)};f["lovedna.game.components.UI"]=Pa;Pa.__name__=["lovedna","game","components","UI"];Pa.__super__=C;Pa.prototype=r(C.prototype,{onConstruct:function(){C.prototype.onConstruct.call(this)},onAwake:function(){C.prototype.onAwake.call(this);var a=this.actor.getComponent(Ea);null!=
a?(this.actor.removeComponent(Ea),this.transform=this.actor.addComponent(ac),this.transform.position.copy(a.position),this.transform.scale.copy(a.scale),this.transform.rotation.copy(a.rotation)):this.transform=this.actor.addComponent(ac)},onDestroy:function(){C.prototype.onDestroy.call(this);this._parent=this.transform=null},__class__:Pa});var ab=g.lovedna.game.components.Canvas=function(){Pa.call(this)};f["lovedna.game.components.Canvas"]=ab;ab.__name__=["lovedna","game","components","Canvas"];ab.__super__=
Pa;ab.prototype=r(Pa.prototype,{onAwake:function(){Pa.prototype.onAwake.call(this);this.width=800;this.height=480;this.scaleMode=1;this.bindEvent(w.onAdded,q(this,this.onScreenResize))},onStart:function(){Pa.prototype.onStart.call(this);this.bindEvent(w.onScreenResize,q(this,this.onScreenResize));this.bindEvent(w.onTransform,q(this,this.onTransform))},onScreenResize:function(a){if(0==this.scaleMode)this.transform.width=ea.width,this.transform.height=ea.height,a=this.transform.scale,a.x=1,a.y=1,a.z=
1;else if(1==this.scaleMode){a=this.width/this.height;a=a>ea.width/ea.height?ea.width/this.width:ea.height/this.height;var b=this.transform.scale;b.x=a;b.y=a;b.z=a;this.transform.width=this.width;this.transform.height=this.height}},onTransform:function(a){},__class__:ab});var mc=g.lovedna.game.components.Collider=function(){C.call(this)};f["lovedna.game.components.Collider"]=mc;mc.__name__=["lovedna","game","components","Collider"];mc.__super__=C;mc.prototype=r(C.prototype,{raycast:function(a,b){return null},
onAwake:function(){C.prototype.onAwake.call(this);this._transformFrame=-1;this.enabled=!0},get_bounds:function(){return null},__class__:mc,__properties__:{get_bounds:"get_bounds"}});var qa=g.lovedna.game.components.Image=function(){Pa.call(this)};f["lovedna.game.components.Image"]=qa;qa.__name__=["lovedna","game","components","Image"];qa.__super__=Pa;qa.prototype=r(Pa.prototype,{load:function(a){null==this.sprite||this.sprite.enabled||this.sprite.removeEventListener(R.init._type,q(this,this.onSpriteInit));
this.sprite=D.sprite.get(a);if(this.sprite.enabled)this.onSpriteInit();else this.sprite.addEventListener(R.init._type,q(this,this.onSpriteInit))},onAwake:function(){Pa.prototype.onAwake.call(this);this.material=new Sa;this.material.state.depthTest=!1;this.material.state.depthWrite=!1;this.material.state.cullMode=-1;this.material.renderQueue=4E4;this.geometry=new Qa;this.geometry.position=[];this.geometry.uv=[];this.geometry.color=[]},onStart:function(){Pa.prototype.onStart.call(this);this.bindEvent(w.onRectTransform,
q(this,this.onRectTransform))},onDestroy:function(){Pa.prototype.onDestroy.call(this);ba.deleteGeometryBuffer(this.geometry.id);this.geometry.dispose();this.geometry=null;this.sprite.removeEventListener(R.init._type,q(this,this.onSpriteInit));this.material.dispose()},onSpriteInit:function(a){this.sprite.removeEventListener(R.init._type,q(this,this.onSpriteInit));this.sprite.enabled&&(this.material.setTexture(this.sprite.texture.texture),1>this.transform.width&&(this.transform.width=this.sprite.data.frame.z),
1>this.transform.height&&(this.transform.height=this.sprite.data.frame.w),this.onRectTransform())},onRectTransform:function(a){this.draw()},draw:function(){this.sprite.enabled&&(this.simpleFill(),this.dispatchEvent(R.init))},simpleFill:function(){var a=this.transform.width,b=this.transform.height,c=a/this.sprite.data.sourceSize.x,d=b/this.sprite.data.sourceSize.y,e=this.sprite.data.offset.x,h=this.sprite.data.sourceSize.y-this.sprite.data.offset.y-this.sprite.data.frame.w;e=e*c-this.transform.pivot.x*
a;h=h*d-this.transform.pivot.y*b;a=this.sprite.data.frame.z*c;b=this.sprite.data.frame.w*d;this.geometry.position[0]=new m(e,h,0);this.geometry.position[1]=new m(a+e,h,0);this.geometry.position[2]=new m(a+e,b+h,0);this.geometry.position[3]=new m(e,b+h,0);a=this.geometry.uv;b=this.sprite.getUV(0,1);a[0]=new v(b.x,b.y);a=this.geometry.uv;b=this.sprite.getUV(1,1);a[1]=new v(b.x,b.y);a=this.geometry.uv;b=this.sprite.getUV(1,0);a[2]=new v(b.x,b.y);a=this.geometry.uv;b=this.sprite.getUV(0,0);a[3]=new v(b.x,
b.y);this.geometry.color[0]=(new Q(1,1,1,1)).mul(this.material.color);this.geometry.color[1]=(new Q(1,1,1,1)).mul(this.material.color);this.geometry.color[2]=(new Q(1,1,1,1)).mul(this.material.color);this.geometry.color[3]=(new Q(1,1,1,1)).mul(this.material.color);this.geometry.clearGroup();this.geometry.addGroup(qa._indexCache);qa.mesh.fromGeometry(this.geometry)},__class__:qa});var bd=g.lovedna.game.components.Light=function(){C.call(this)};f["lovedna.game.components.Light"]=bd;bd.__name__=["lovedna",
"game","components","Light"];bd.__super__=C;bd.prototype=r(C.prototype,{onAwake:function(){C.prototype.onAwake.call(this);this.position=new m;this.ambient=new Q(0,0,0,1);this.diffuse=new Q(1,1,1,1);this.specular=new Q(0,0,0,10);this.uniforms=new mb;this.uniforms.setFloat3(k.LIGHT_POSITION.name,this.position);this.uniforms.setFloat4(k.LIGHT_AMBIENT.name,this.ambient);this.uniforms.setFloat4(k.LIGHT_DIFFUSE.name,this.diffuse);this.uniforms.setFloat4(k.LIGHT_SPECULAR.name,this.specular)},onStart:function(){C.prototype.onStart.call(this);
this.onTransform();this.bindEvent(w.onTransform,q(this,this.onTransform))},onTransform:function(a){a=this.actor.get_transform().get_worldRotation().rotate(m.get_backward()).normalize();this.position.copy(a)},__class__:bd});var ob=g.lovedna.game.components.Renderer=function(){C.call(this)};f["lovedna.game.components.Renderer"]=ob;ob.__name__=["lovedna","game","components","Renderer"];ob.__super__=C;ob.prototype=r(C.prototype,{cullWithCamera:function(a){return!0},collectRenderBuffer:function(a){},onConstruct:function(){C.prototype.onConstruct.call(this);
this.visible=!0;this.materials=[new Sa];this.cameraCull=!0},onDestroy:function(){C.prototype.onDestroy.call(this);if(null!=this.materials){for(var a=this.materials.length;0<a--;)this.materials[a].dispose(),this.materials[a]=null;this.materials=null}},get_material:function(){return this.materials[0]},__class__:ob,__properties__:{get_material:"get_material"}});var La=g.lovedna.game.components.MeshRenderer=function(){ob.call(this)};f["lovedna.game.components.MeshRenderer"]=La;La.__name__=["lovedna",
"game","components","MeshRenderer"];La.__super__=ob;La.prototype=r(ob.prototype,{cullWithCamera:function(a){if(null==this.mesh||null==this.mesh.buffer)return!0;if(!this.cameraCull)return!1;var b=a.frustum;this._meshId!=this.mesh.id&&(this._meshId=this.mesh.id,--this._transformFrame);if(null==this.actor.world)return!0;this._transformFrame!=this.actor.frame&&(this._transformFrame=this.actor.frame,this.bounds.copy(this.mesh.buffer.bounds),this.bounds.multiplyMatrix44(this.actor.get_transform().getLocalToWorld()));
var c=this.bounds.sphere;if(null==c||!b.containsPoint(c.center,c.radius)||!b.intersectsBox(this.bounds.box))return!0;this._distanceToCamera=a.actor.get_transform().get_worldPosition().distanceSquared(this.actor.get_transform().get_worldPosition());return!1},collectRenderBuffer:function(a){if(this.visible&&null!=this.mesh)if(0<this.skipFrame)this.skipFrame--;else if(this.mesh.buffer.enabled)for(var b=0,c=this.materials.length;b<c;){var d=b++;d=this.materials[d];if(null!=d&&null!=d.shader){d.uniforms.setMatrix44Handler(k.M.name,
(ib=this.actor.get_transform(),q(ib,ib.getLocalToWorld)));d.uniforms.setMatrix44Handler(k.IM.name,(ib=this.actor.get_transform(),q(ib,ib.getWorldToLocal)));var e=S._pool.get();e.clear();e.name=this.actor.name;e.renderQueue=d.renderQueue;e.shaderId=d.shader.get_id();e.renderIndex=this.mesh.id;e.distance=this._distanceToCamera;e.setMaterial(d);e.setMeshBuffer(this.mesh);e.draw();this.onFillBuffer(d,e);a.add(e)}}},onConstruct:function(){ob.prototype.onConstruct.call(this);this._meshId=1E7;this.bounds=
new cd;this.skipFrame=0},onAwake:function(){this._distanceToCamera=0;this._transformFrame=-1},onDestroy:function(){ob.prototype.onDestroy.call(this);null!=this.mesh&&this.mesh.dispose();this.mesh=null;null!=this.bounds&&this.bounds.dispose();this.bounds=null},onFillBuffer:function(a,b){},__class__:La});var Ea=g.lovedna.game.components.Transform=function(){C.call(this)};f["lovedna.game.components.Transform"]=Ea;Ea.__name__=["lovedna","game","components","Transform"];Ea.__super__=C;Ea.prototype=r(C.prototype,
{transformLocalToWorld:function(a){this.getLocalToWorld().transformVector(a)},transformWorldToLocal:function(a){this.getWorldToLocal().transformVector(a)},getWorldToLocalMatrix:function(a){var b=fa._pool.get(),c=this.getWorldToLocal();null!=c&&(b.m0=c.m0,b.m1=c.m1,b.m2=c.m2,b.m3=c.m3,b.m4=c.m4,b.m5=c.m5,b.m6=c.m6,b.m7=c.m7,b.m8=c.m8,b.m9=c.m9,b.m10=c.m10,b.m11=c.m11,b.m12=c.m12,b.m13=c.m13,b.m14=c.m14,b.m15=c.m15,b._dirty=!0);b.append(a.getLocalToWorld());return b},addChild:function(a,b){null==b&&
(b=!1);this.addChildAt(a,1E7,b)},addChildAt:function(a,b,c){null==c&&(c=!1);null==a||a==this||a.hasChild(this)||(null!=a.parent&&(a.parent.removeChild(a),a.parent==this&&(c=!1)),null==this._childs&&(this._childs=new O),0>b?this._childs.unshift(a):b>=this._childs.get_length()?this._childs.push(a):this._childs.insert(b,a),c&&(b=fa._pool.get(),c=this.getWorldToLocal(),null!=c&&(b.m0=c.m0,b.m1=c.m1,b.m2=c.m2,b.m3=c.m3,b.m4=c.m4,b.m5=c.m5,b.m6=c.m6,b.m7=c.m7,b.m8=c.m8,b.m9=c.m9,b.m10=c.m10,b.m11=c.m11,
b.m12=c.m12,b.m13=c.m13,b.m14=c.m14,b.m15=c.m15,b._dirty=!0),b.append(a.getLocalToWorld()),a.rotation.copy(b.getRotation()),a.position.copy(b.getTranslation()),a.scale.copy(b.getScale())),a.parent=this,a.actor.dispatchEvent(w.onAdded),null!=this.actor.world&&this.actor.world.set_dirty(!0),this.childCount=this._childs.get_length())},removeFromParent:function(){null!=this.parent&&this.parent.removeChild(this)},removeChild:function(a){null!=a&&a!=this&&a.parent==this&&null!=this._childs&&-1!=this._childs.remove(a)&&
(this.childCount=this._childs.get_length(),a.actor.dispatchEvent(w.onRemoved),null!=this.actor.world&&this.actor.world.set_dirty(!0))},removeChildAt:function(a){if(null!=this._childs&&!(0>a||a>=this._childs.get_length())){var b=this._childs.getElement(a);this.childCount=this._childs.get_length();this._childs.removeAt(a);null!=b&&(b.dispatchEvent(w.onRemoved),null!=this.actor.world&&this.actor.world.set_dirty(!0))}},getChild:function(a,b){null==b&&(b=!1);return null==this._childs?null:this._childs.get(a,
b)},findChild:function(a){return null},hasChild:function(a){if(null==a||a==this||null==a.parent)return!1;a=a.parent;for(var b=200;null!=a;){if(a==this)return!0;var c=a.parent;if(c==a)break;a=c;--b;if(1>b)break}return!1},getLocalToWorld:function(){null==this._localToWorld&&(null==this.__localToWorld&&(this.__localToWorld=new fa),this._localToWorld=this.__localToWorld,this._doUpdateTransform());return this._localToWorld},getWorldToLocal:function(){if(null==this._worldToLocal){null==this.__worldToLocal&&
(this.__worldToLocal=new fa);var a=this._worldToLocal=this.__worldToLocal,b=this.getLocalToWorld();null!=b&&(a.m0=b.m0,a.m1=b.m1,a.m2=b.m2,a.m3=b.m3,a.m4=b.m4,a.m5=b.m5,a.m6=b.m6,a.m7=b.m7,a.m8=b.m8,a.m9=b.m9,a.m10=b.m10,a.m11=b.m11,a.m12=b.m12,a.m13=b.m13,a.m14=b.m14,a.m15=b.m15,a._dirty=!0);this._worldToLocal.inverse()}return this._worldToLocal},onAwake:function(){C.prototype.onAwake.call(this);this.position=new m(0,0,0);this.scale=new m(1,1,1);this.rotation=new ja;this._localPosition=new m(.1,
.2,.3);this._localScale=new m(1.1,1.2,1.3);this._localRotation=new ja;this.childCount=0},onDestroy:function(){C.prototype.onDestroy.call(this);if(null!=this._childs)for(var a=this._childs.get_length();0<a--;){var b=this._childs.getElement(a);this.removeChild(b);H.destory(b.actor)}null!=this.parent&&this.parent.removeChild(this);this._worldToLocal=this.__worldToLocal=this._localToWorld=this.__localToWorld=this._localRotation=this._localScale=this._localPosition=this.rotation=this.scale=this.position=
this.parent=this._childs=null},needTransformUpdate:function(){var a=this._localPosition,b=this.position;if(a.x!=b.x||a.y!=b.y||a.z!=b.z)return!0;a=this._localRotation;b=this.rotation;if(a.x!=b.x||a.y!=b.y||a.z!=b.z||a.w!=b.w)return!0;a=this._localScale;b=this.scale;return a.x!=b.x||a.y!=b.y||a.z!=b.z?!0:!1},_updateTransform:function(a){var b=this.needTransformUpdate();b||null!=this.parent&&this.transformFrame<this.parent.transformFrame&&(b=!0);b&&(this.transformFrame=a,this.cacheTransform(),this.actor.dispatchEvent(w.onTransform));
this.actor.dispatchEvent(w.onTransformComplete)},cacheTransform:function(){this._localPosition.copy(this.position);this._localScale.copy(this.scale);this._localRotation.copy(this.rotation);this._worldToLocal=this._scale=this._rotation=this._position=this._localToWorld=null},_doUpdateTransform:function(){if(null==this.parent)this._localToWorld.setTRS(this.position,this.rotation,this.scale);else{var a=this._localToWorld,b=this.parent.getLocalToWorld();null!=b&&(a.m0=b.m0,a.m1=b.m1,a.m2=b.m2,a.m3=b.m3,
a.m4=b.m4,a.m5=b.m5,a.m6=b.m6,a.m7=b.m7,a.m8=b.m8,a.m9=b.m9,a.m10=b.m10,a.m11=b.m11,a.m12=b.m12,a.m13=b.m13,a.m14=b.m14,a.m15=b.m15,a._dirty=!0);this._localToWorld.appendTRS(this.position,this.rotation,this.scale)}},get_worldPosition:function(){null==this._position&&(null==this.__position&&(this.__position=new m),this._position=this.__position,this.getLocalToWorld().getTranslation(this._position));return this._position},get_worldScale:function(){null==this._scale&&(null==this.__scale&&(this.__scale=
new m),this._scale=this.__scale,this.getLocalToWorld().getScale(this._scale));return this._position},get_worldRotation:function(){null==this._rotation&&(null==this.__rotation&&(this.__rotation=new ja),this._rotation=this.__rotation,this.getLocalToWorld().getRotation(this._rotation));return this._rotation},__class__:Ea,__properties__:{get_worldRotation:"get_worldRotation",get_worldScale:"get_worldScale",get_worldPosition:"get_worldPosition"}});var ac=g.lovedna.game.components.RectTransform=function(){Ea.call(this)};
f["lovedna.game.components.RectTransform"]=ac;ac.__name__=["lovedna","game","components","RectTransform"];ac.__super__=Ea;ac.prototype=r(Ea.prototype,{onAwake:function(){Ea.prototype.onAwake.call(this);this.anchorX=new v(.5,.5);this.anchorY=new v(.5,.5);this.height=this.width=0;this._size=new v;this._anchorX=new v(.5,.5);this._anchorY=new v(.5,.5);this.pivot=new v(.5,.5);this._pivot=new v(.5,.5);this._rectDirty=!0;this.bindEvent(w.onAdded,q(this,this.onAdded))},needTransformUpdate:function(){this._rectDirty=
!0;if(this.width!=this._size.x||this.height!=this._size.y)return!0;var a=this.pivot,b=this.pivot;if(a.x!=b.x||a.y!=b.y)return!0;a=this._anchorY;b=this.anchorY;if(a.x!=b.x||a.y!=b.y)return!0;a=this._anchorX;b=this.anchorX;if(a.x!=b.x||a.y!=b.y)return!0;this._rectDirty=!1;return Ea.prototype.needTransformUpdate.call(this)},cacheTransform:function(){Ea.prototype.cacheTransform.call(this);var a=this._size;a.x=this.width;a.y=this.height;this._anchorY.copy(this.anchorY);this._anchorX.copy(this.anchorX);
this._pivot.copy(this.pivot);this._rectDirty&&(this._rectDirty=!1,this.actor.dispatchEvent(w.onRectTransform))},_doUpdateTransform:function(){var a=m._pool.get().copy(this.position);if(null!=this._parent){this.anchorX.clamp(0,1);this.anchorY.clamp(0,1);if(this.anchorX.y>this.anchorX.x){var b=this.anchorX.y-this.anchorX.x;this.width=this._parent.width*b;a.x+=(this.anchorX.x+.5*b-.5)*this._parent.width+(this.pivot.x-.5)*this.width}else a.x+=(this.anchorX.x-.5)*this._parent.width;this.anchorY.y>this.anchorY.x?
(b=this.anchorY.y-this.anchorY.x,this.height=this._parent.height*b,a.y+=(this.anchorY.x+.5*b-.5)*this._parent.height+(this.pivot.y-.5)*this.height):a.y+=(this.anchorY.x-.5)*this._parent.height}if(null==this.parent)this._localToWorld.setTRS(a,this.rotation,this.scale);else{b=this._localToWorld;var c=this.parent.getLocalToWorld();null!=c&&(b.m0=c.m0,b.m1=c.m1,b.m2=c.m2,b.m3=c.m3,b.m4=c.m4,b.m5=c.m5,b.m6=c.m6,b.m7=c.m7,b.m8=c.m8,b.m9=c.m9,b.m10=c.m10,b.m11=c.m11,b.m12=c.m12,b.m13=c.m13,b.m14=c.m14,b.m15=
c.m15,b._dirty=!0);this._localToWorld.appendTRS(a,this.rotation,this.scale)}},onDestroy:function(){Ea.prototype.onDestroy.call(this);this.anchorX=this.anchorY=this.pivot=this._size=this._anchorX=this._anchorY=this._pivot=this._parent=null},onAdded:function(a){y.__instanceof(this.parent,ac)&&(this._parent=this.parent)},__class__:ac});var pc=g.lovedna.game.components.UIRoot=function(){C.call(this)};f["lovedna.game.components.UIRoot"]=pc;pc.__name__=["lovedna","game","components","UIRoot"];pc.__super__=
C;pc.prototype=r(C.prototype,{setCamera:function(a){null!=this._camera&&this._camera.actor.removeEventListener(w.onCameraUpdate._type,q(this,this.onCameraUpdate));this._camera=a;null!=this._camera&&(this._dirty=!0,this.distance<this._camera.nearClipPlane&&(this.distance=this._camera.nearClipPlane+1),this.distance>this._camera.farClipPlane&&(this.distance=this._camera.farClipPlane-1),this._camera.actor.addEventListener(w.onCameraUpdate._type,q(this,this.onCameraUpdate)))},onAwake:function(){C.prototype.onAwake.call(this);
this.distance=60;this.height=this.width=0;this._dirty=!1;this.refresh=!0;this.bindEvent(w.onAdded,q(this,this.onAdded))},onStart:function(){C.prototype.onStart.call(this);var a=this.actor.get_transform().position;a.x=0;a.y=0;a.z=this.distance;this.bindEvent(w.onTransformComplete,q(this,this.onTransformComplete))},onAdded:function(a){this._dirty=!0},onCameraUpdate:function(a){this._dirty=!0},onTransformComplete:function(a){if(null!=this._camera&&this._dirty&&null!=this._camera&&this.refresh){this._dirty=
this.refresh=!1;var b=m._pool.get(),c=m._pool.get(),d=m._pool.get();a=1;var e=this.distance/(this._camera.farClipPlane-this._camera.nearClipPlane);b.x=-a;b.y=-a;b.z=1;c.x=a;c.y=-a;c.z=1;d.x=-a;d.y=a;d.z=1;this._camera.projectionViewInverseMatrix.transformVector(b,!0);this._camera.projectionViewInverseMatrix.transformVector(c,!0);this._camera.projectionViewInverseMatrix.transformVector(d,!0);a=b.distance(c);d=b.distance(d);b=a*e;e*=d;a=b/ea.width;0<this.width&&0<this.height&&(a=this.width/this.height>
b/e?b/this.width:e/this.height);e=this.actor.get_transform().scale;e.x=-a;e.y=a;e.z=a;a=m._pool.get();a.x=0;a.y=0;a.z=this.distance;this._camera.actor.get_transform().transformLocalToWorld(a);this.actor.get_transform().parent.transformWorldToLocal(a);this.actor.get_transform().position.copy(a);a.x=0;a.y=0;a.z=1;this.actor.get_transform().rotation.copy(this._camera.actor.get_transform().getLocalToWorld().getRotation())}},__class__:pc});var w=g.lovedna.game.events.ActorEvent=function(a){R.call(this,
a)};f["lovedna.game.events.ActorEvent"]=w;w.__name__=["lovedna","game","events","ActorEvent"];w.__super__=R;w.prototype=r(R.prototype,{__class__:w});var ua=g.lovedna.game.events.SystemEvent=function(a){R.call(this,a);this.vintlist=[];this.vfloatlist=[];this.vstringlist=[]};f["lovedna.game.events.SystemEvent"]=ua;ua.__name__=["lovedna","game","events","SystemEvent"];ua.__super__=R;ua.prototype=r(R.prototype,{__class__:ua});var cd=g.lovedna.game.geometry.Bounds=function(){this.box=new dd;this.sphere=
new ed};f["lovedna.game.geometry.Bounds"]=cd;cd.__name__=["lovedna","game","geometry","Bounds"];cd.prototype={dispose:function(){this.box.dispose();this.sphere.dispose();this.sphere=this.box=null},copy:function(a){if(null!=a){this.box.copy(a.box);var b=this.sphere;a=a.sphere;if(a!=b){var c=a.radius;b.center.copy(a.center);b.radius=c}}return this},reset:function(){null!=this.box&&(this.box.reset(),this.sphere.radius=0)},expand:function(a){this.box.expand(a)},multiplyMatrix44:function(a){if(null!=a){this.box.multiplyMatrix44(a);
this.sphere.center.copy(this.box.getCenter());a=this.box.getSize().scale(.5);var b=a.x,c=a.y;b=b>c?b:c;a=a.z;this.sphere.radius=b>a?b:a}},__class__:cd};var yc=g.lovedna.game.geometry.GeomCircle=function(){Qa.call(this);this.radius=1;this.segments=20;this.thetaStart=0;this.thetaLength=360;this.centerColor=new ca(1,1,1,1);this.edgeColor=new ca(1,1,1,1)};f["lovedna.game.geometry.GeomCircle"]=yc;yc.__name__=["lovedna","game","geometry","GeomCircle"];yc.__super__=Qa;yc.prototype=r(Qa.prototype,{build:function(){.01>
this.radius&&(this.radius=.01);3>this.segments&&(this.segments=3);this.thetaStart*=.017453292519943295;var a=this.thetaLength;this.thetaLength=.017453292519943295*(0>a?0:360<a?360:a);a=[];var b=[],c=[],d=[],e=[];a.push(new m(0,0,0));c.push(new m(0,0,1));var h=this.getCustomUvGetter();e.push((new v).copy(h(.5,.5)));null!=this.centerColor?d.push(this.centerColor):d.push(new Q(1,1,1,1));for(var f=new Od,g=0,k=this.segments+1;g<k;){var l=g++,n=this.thetaStart+l/this.segments*this.thetaLength,p=new m;
p.x=this.radius*Math.cos(n);p.y=this.radius*Math.sin(n);n=new m(0,0,1);var q=new v;q.x=.5*(p.x/this.radius+1);q.y=1-.5*(p.y/this.radius+1);q.copy(h(q.x,q.y));null!=this.transform&&(this.transform.transformVector(p),this.transform.transformVector(n));a.push(p);c.push(n);e.push(q);null==this.edgeColor?(f.h=360/this.segments*l,f.s=1,f.v=1,l=f.toColor(),d.push(l)):(l=new ca,l.from(this.edgeColor),d.push(l))}h=1;for(f=this.segments+1;h<f;)g=h++,b.push(g),b.push(g+1),b.push(0);this.position=a;this.normal=
c;this.uv=e;this.color=d;this.addGroup(b);this.thetaStart*=57.29577951308232;this.thetaLength*=57.29577951308232;return this},__class__:yc});var Pd=g.lovedna.game.geometry.MeshBuffer=function(){};f["lovedna.game.geometry.MeshBuffer"]=Pd;Pd.__name__=["lovedna","game","geometry","MeshBuffer"];Pd.prototype={__class__:Pd};var Mc=g.lovedna.game.geometry.GeometryBuffer=function(a){this._unloaded=!1;this._geom=a;this._shaderId=0;this.define=new hb;this.enabled=!1;this.bounds=new cd};f["lovedna.game.geometry.GeometryBuffer"]=
Mc;Mc.__name__=["lovedna","game","geometry","GeometryBuffer"];Mc.__interfaces__=[Pd];Mc.prototype={build:function(){if(this._unloaded)debugger;this.colorBuffer=this.vertexBuffer=this.positionBuffer=this.indexBuffer=null;null!=this.getIndexBuffer()&&null!=this.getPositionBuffer()&&(this.getVertexBuffer(),this.getColorBuffer(),this.getBoneBuffer(),this.enabled=!0)},unload:function(){this._unloaded=!0;null!=this._indexBuffer&&this._indexBuffer.unload();null!=this._positionBuffer&&this._positionBuffer.unload();
null!=this._vertexBuffer&&this._vertexBuffer.unload();null!=this._boneBuffer&&this._boneBuffer.unload();null!=this._colorBuffer&&this._colorBuffer.unload();this.define=this.colorBuffer=this.vertexBuffer=this.positionBuffer=this.indexBuffer=this._geom=this._colorBuffer=this._boneBuffer=this._vertexBuffer=this._positionBuffer=this._indexBuffer=null;this.enabled=!1;null!=this.bounds&&this.bounds.dispose();this.bounds=null},buildBounds:function(){var a=this._geom.position.length;if(!(2>a)){var b=[];this.bounds.reset();
for(var c=0;c<a;){var d=c++,e=this._geom.position[d];e.fillArray(b,3*d);this.bounds.expand(e)}}},raycast:function(a){for(var b=this._geom.groups.length,c=m._pool.get(),d=m._pool.get(),e=m._pool.get();0<b--;)for(var h=this._geom.groups[b].indices,f=n.floor(h.length/3);0<f--;){var g=3*f,k=h[g+1],l=h[g+2];c.copy(this._geom.position[h[g]]);d.copy(this._geom.position[k]);e.copy(this._geom.position[l]);g=a.intersectTriangle(c,d,e);if(null!=g)return a=new Jd,a.point=g,a}return null},getIndexBuffer:function(){if(null==
this.indexBuffer){if(null==this._geom.position||1>this._geom.groups.length)return null;for(var a=[],b=[],c=0,d=this._geom.groups.length;c<d;){var e=c++;e=this._geom.groups[e];var h=new Qd;h.length=e.indices.length;h.offset=e.start;b.push(h);n.concat(a,e.indices)}null==this._indexBuffer&&(this._indexBuffer=new Wa);this._indexBuffer.setLayouts(b);this.indexBuffer=this._indexBuffer;this.indexBuffer.upload(a)}return this.indexBuffer},getPositionBuffer:function(){if(null==this.positionBuffer){if(null==
this._geom.position)return null;var a=this._geom.position.length;if(2>a)return null;var b=[];this.bounds.reset();for(var c=0;c<a;){var d=c++,e=this._geom.position[d];e.fillArray(b,3*d);this.bounds.expand(e)}null==this._positionBuffer&&(this._positionBuffer=new Ua,this._positionBuffer.setLayout([new Ob(k.POSITION.name,k.POSITION.size)]));this.positionBuffer=this._positionBuffer;this.positionBuffer.upload(b);this._shaderId=0}return this.positionBuffer},getVertexBuffer:function(){if(null==this.vertexBuffer){if(null==
this._geom.position)return null;var a=this._geom.position.length;if(2>a)return null;for(var b=[this._geom.uv,this._geom.uv2,this._geom.normal,this._geom.normal2,this._geom.tangent],c=[k.UV,k.UV2,k.NORMAL,k.NORMAL2,k.TANGENT],d=c.length,e=0,h=0;h<d;){var f=h++,g=b[f];f=c[f];this.define.define(f.name,null,!1);null==g||g.length<a||(e+=f.size,this.define.define(f.name,""))}if(0==e)return null;null==this._vertexBuffer&&(this._vertexBuffer=new Ua);h=[];g=0;f=[];for(var l=0;l<d;){var m=l++,n=b[m];if(null!=
n&&!(n.length<a)){for(var p=0,q=a;p<q;){var t=p++;var r=e*t+g;n[t].fillArray(h,r)}r=c[m];g+=r.size;f.push(new Ob(r.name,r.size))}}this._vertexBuffer.setLayout(f);this.vertexBuffer=this._vertexBuffer;this.vertexBuffer.upload(h);this._shaderId=0}return this.vertexBuffer},getBoneBuffer:function(){if(null==this.boneBuffer){if(null==this._geom.boneWeight||null==this._geom.position)return null;var a=this._geom.position.length;if(2>a)return null;for(var b=[];0<a--;){var c=8*a,d=this._geom.boneWeight[a];
d.index.fillArray(b,c);d.weight.fillArray(b,c+4)}null==this._boneBuffer&&(this._boneBuffer=new Ua,this.define.define(k.BONE.name),this._boneBuffer.setLayout([new Ob(k.BONE_INDEX.name,k.BONE_INDEX.size),new Ob(k.BONE_WEIGHT.name,k.BONE_WEIGHT.size)]));this.boneBuffer=this._boneBuffer;this.boneBuffer.upload(b)}return this.boneBuffer},getColorBuffer:function(){if(null==this.colorBuffer){if(null==this._geom.position)return null;var a=this._geom.position.length;if(2>a)return null;for(var b=[this._geom.color,
this._geom.color2,this._geom.color3,this._geom.color4,this._geom.color5,this._geom.color6,this._geom.color7,this._geom.color8,this._geom.color9],c=[k.COLOR,k.COLOR2,k.COLOR3,k.COLOR4,k.COLOR5,k.COLOR6,k.COLOR7,k.COLOR8,k.COLOR9],d=c.length,e=0,h=0;h<d;){var f=h++,g=b[f];f=c[f];this.define.define(f.name,null,!1);null==g||g.length<a||(e+=f.size,this.define.define(f.name,""))}if(0==e)return null;null==this._colorBuffer&&(this._colorBuffer=new Ua);h=[];g=0;f=[];for(var l=0;l<d;){var m=l++,n=b[m];if(null!=
n&&!(n.length<a)){for(var p=0,q=a;p<q;){var t=p++;var r=e*t+g;n[t].fillArray(h,r)}r=c[m];g+=r.size;f.push(new Ob(r.name,r.size))}}this._colorBuffer.setLayout(f);this.colorBuffer=this._colorBuffer;this.colorBuffer.upload(h);this._shaderId=0}return this.colorBuffer},updateLocations:function(a){var b=this._shaderId!=a.get_id();this._shaderId=a.get_id();if(this.enabled){var c=this.getPositionBuffer();b&&this.updateLayout(c,a);c=this.getVertexBuffer();null!=c&&b&&this.updateLayout(c,a);c=this.getColorBuffer();
null!=c&&b&&this.updateLayout(c,a);c=this.getBoneBuffer();null!=c&&b&&this.updateLayout(c,a);this._shaderId=a.get_id()}},bind:function(){if(!this.enabled)return!1;var a=this.getPositionBuffer();this.getIndexBuffer().bind();a.bind();a=this.getVertexBuffer();null!=a&&a.bind(this._shaderId);a=this.getColorBuffer();null!=a&&a.bind(this._shaderId);a=this.getBoneBuffer();null!=a&&a.bind(this._shaderId);return!0},updateLayout:function(a,b){a=a.layouts;if(null!=a){var c=a.length;if(!(1>c))for(;0<c--;){var d=
a[c],e=b.getBufferInput(d.name);d.location=null==e?-1:e.location}}},get_indexBuffer:function(){return this._indexBuffer},get_positionBuffer:function(){return this._positionBuffer},get_vertexBuffer:function(){return this._vertexBuffer},get_boneBuffer:function(){return this._boneBuffer},__class__:Mc};var Rd=function(){this.enabled=!1;this.color=new ca(0,0,0,0);this.depth=1;this.stencil=0;this.target=null};f["lovedna.game.graphics._GLContext.ClearTarget"]=Rd;Rd.__name__=["lovedna","game","graphics",
"_GLContext","ClearTarget"];Rd.prototype={clear:function(){if(null==this.target||this.enabled){var a=0;null!=this.color&&(a|=16384);0<=this.depth&&(a|=256,this.gl.__context.depthMask(!0),this.gl.__context.clearDepth(this.depth));0<=this.stencil&&(a|=1024,this.gl.__context.clearStencil(this.stencil));null!=this.color&&this.gl.__context.clearColor(this.color.x,this.color.y,this.color.z,this.color.w);this.gl.__context.clear(a)}},__class__:Rd};var l=g.lovedna.game.graphics.GLContext=function(){};f["lovedna.game.graphics.GLContext"]=
l;l.__name__=["lovedna","game","graphics","GLContext"];l.init=function(a){null==l.gl&&(l.gl=a,l.currentState=new N,l.currentState.defaultValue())};l.start=function(a,b){l._targetStack.clear();l._currentTargetID=-2;l._currentTarget=null;l._clearStack.clear();l._currentClear=null;l._width=a;l._height=b;l.viewport(0,0,a,b)};l.end=function(){l.viewport(0,0,l._width,l._height);l.colorWrite(!0,!0,!0,!0);l.currentState.blend||(l.currentState.blend=!0);l.gl.__context.enable(3042);-1==l.currentState.cullMode&&
(l.currentState.cullMode=1029);l.gl.__context.enable(2884);l.currentState.depthTest||(l.currentState.depthTest=!0);l.gl.__context.enable(2929);513!=l.currentState.depthMode&&(l.currentState.depthMode=513);l.gl.__context.depthFunc(l.currentState.depthMode);l.currentState.depthWrite||(l.currentState.depthWrite=!0);l.gl.__context.depthMask(!0);l.gl.__context.bindFramebuffer(36160,null);l.gl.__context.bindRenderbuffer(36161,null);Wa.current=null;zb.current=null;l.gl.__context.bindTexture(3553,null);l.gl.__context.bindBuffer(34963,
null);l.gl.__context.bindBuffer(34962,null);for(var a=5;0<a--;)l.gl.__context.disableVertexAttribArray(a)};l.colorWrite=function(a,b,c,d){if(l._colorMask[0]!=a||l._colorMask[1]!=b||l._colorMask[2]!=c||l._colorMask[3]!=d)l._colorMask[0]=a,l._colorMask[1]=b,l._colorMask[2]=c,l._colorMask[3]=d,l.gl.__context.colorMask(a,b,c,d)};l.viewport=function(a,b,c,d){l.gl.__context.viewport(a,b,c,d)};l.clear=function(a,b,c){null==c&&(c=0);null==b&&(b=1);var d=!1;null==l._currentClear&&(l._currentClear=l._clearTargetPool.get(),
l._currentClear.gl=l.gl,l._currentClear.target=null,d=!0);l._currentClear.enabled=!0;l._currentClear.color=a;l._currentClear.depth=b;l._currentClear.stencil=c;d&&(l._currentClear.clear(),l._currentClear=null)};l.state=function(a){var b=a.cullMode;b!=l.currentState.cullMode&&(l.currentState.cullMode=b,-1==l.currentState.cullMode?l.gl.__context.disable(2884):(l.gl.__context.enable(2884),l.gl.__context.cullFace(l.currentState.cullMode)));b=a.depthTest;b!=l.currentState.depthTest&&(l.currentState.depthTest=
b,l.currentState.depthTest?l.gl.__context.enable(2929):l.gl.__context.disable(2929));b&&a.depthMode!=l.currentState.depthMode&&(l.gl.__context.depthFunc(a.depthMode),l.currentState.depthMode=a.depthMode);b=a.depthWrite;b!=l.currentState.depthWrite&&(l.currentState.depthWrite=b,l.gl.__context.depthMask(l.currentState.depthWrite));b=a.blend;b!=l.currentState.blend&&(l.currentState.blend=b,l.currentState.blend||l.gl.__context.disable(3042));b&&(l.gl.__context.enable(3042),l.gl.__context.blendEquationSeparate(a.blendColorOperation,
a.blendAlphaOperation),l.gl.__context.blendFuncSeparate(a.blendSrcColor,a.blendDstColor,a.blendSrcAlpha,a.blendDstAlpha));b=a.stencilTest;l.currentState.stencilTest!=b&&(l.currentState.stencilTest=b,l.currentState.stencilTest?l.gl.__context.enable(2960):l.gl.__context.disable(2960));l.currentState.stencilTest&&(l.currentState.stencilReadMask=a.stencilReadMask,l.currentState.stencilReferenceValue=a.stencilReferenceValue,l.currentState.stencilMode=a.stencilMode,l.currentState.stencilFail=a.stencilFail,
l.currentState.stencilDepthFail=a.stencilDepthFail,l.currentState.stencilBothPass=a.stencilBothPass,l.gl.__context.stencilFunc(l.currentState.stencilMode,l.currentState.stencilReferenceValue,l.currentState.stencilReadMask),l.gl.__context.stencilOp(l.currentState.stencilFail,l.currentState.stencilDepthFail,l.currentState.stencilBothPass))};l.getTarget=function(){return l._currentTarget};l.pushTarget=function(a){l._currentTarget=a;l._targetStack.push(l._currentTarget);l._currentClear=l._clearTargetPool.get();
l._currentClear.gl=l.gl;l._currentClear.target=a;l._currentClear.enabled=!1;l._clearStack.push(l._currentClear)};l.popTarget=function(){0<l._targetStack.get_length()&&(l._targetStack.pop(),l._clearStack.pop());0<l._targetStack.get_length()?(l._currentTarget=l._targetStack.get(-1,!0),l._currentClear=l._clearStack.get(-1,!0)):(l._currentTarget=null,l._currentClear=null)};l.drawBefore=function(){l.applyRenderTarget()};l.drawAfter=function(){l.gl.__context.activeTexture(33984);l.gl.__context.bindTexture(3553,
null);l.gl.__context.activeTexture(33985);l.gl.__context.bindTexture(3553,null);l.gl.__context.activeTexture(33986);l.gl.__context.bindTexture(3553,null);l.gl.__context.bindBuffer(34963,null);l.gl.__context.bindBuffer(34962,null)};l.applyRenderTarget=function(){var a=-1;null!=l._currentTarget&&(a=l._currentTarget.id);a!=l._currentTargetID&&(l._currentTargetID=a,null!=l._currentTarget?(l._currentTarget.bindBuffer(),l.viewport(0,0,l._currentTarget.width,l._currentTarget.height)):(l.gl.__context.bindFramebuffer(36160,
null),l.viewport(0,0,l._width,l._height)),null!=l._currentClear&&l._currentClear.clear())};l.prototype={__class__:l};var bc=g.lovedna.resource.IResource=function(){};f["lovedna.resource.IResource"]=bc;bc.__name__=["lovedna","resource","IResource"];bc.prototype={__class__:bc};var Wa=g.lovedna.game.graphics.IndexBuffer=function(){this.id=Wa._id++;this.enabled=!1;this.type=5123};f["lovedna.game.graphics.IndexBuffer"]=Wa;Wa.__name__=["lovedna","game","graphics","IndexBuffer"];Wa.__interfaces__=[bc];Wa.prototype=
{setLayouts:function(a){null==this.layouts?this.layouts=[]:this.layouts.splice(0,this.layouts.length);for(var b=0,c=a.length;b<c;){var d=b++,e=a[d];null==e&&U.trace("error",{fileName:"IndexBuffer.hx",lineNumber:52,className:"lovedna.game.graphics.IndexBuffer",methodName:"setLayouts",customParams:["layout is null "+d]});this.layouts.push(e)}},upload:function(a){this.enabled=!1;null!=a&&1<a.length&&(this.enabled=!0,this._data=a,this.length=this._data.length)},bind:function(){this._time=P._custom();
if(null!=this._data){null==this._buffer&&(this._buffer=u.gl.__context.createBuffer());u.gl.__context.bindBuffer(34963,this._buffer);var a=u.gl,b=this.getData();a.__context.bufferData(34963,b,35044);this.length=this._data.length;this._data=null}else null!=this._buffer&&this!=Wa.current&&(Wa.current=this,u.gl.__context.bindBuffer(34963,this._buffer))},unload:function(){null!=this._buffer&&(u.gl.__context.deleteBuffer(this._buffer),this._buffer=null);this._data=this.layouts=null},getData:function(){var a=
this._data.length,b=n.intToNextPow2(a),c=n.pow2Count(b),d=Wa._tempList[c];null==d&&(d=new Uint16Array(b),Wa._tempList[c]=d);for(;0<a--;)d[a]=this._data[a]&65535;return d},__class__:Wa};var Qd=g.lovedna.game.graphics.IndexLayout=function(){};f["lovedna.game.graphics.IndexLayout"]=Qd;Qd.__name__=["lovedna","game","graphics","IndexLayout"];Qd.prototype={__class__:Qd};var zb=g.lovedna.game.graphics.Program=function(a,b){this.id=zb._id++;this.enabled=!1;var c=u.gl.__context.createShader(35633);u.gl.__context.shaderSource(c,
a);u.gl.__context.compileShader(c);if(0==u.gl.__context.getShaderParameter(c,35713))U.trace(this.addLineNumber(a),{fileName:"Program.hx",lineNumber:41,className:"lovedna.game.graphics.Program",methodName:"new"}),U.trace("vertex compileShader "+u.gl.__context.getShaderInfoLog(c),{fileName:"Program.hx",lineNumber:42,className:"lovedna.game.graphics.Program",methodName:"new"});else if(a=u.gl.__context.createShader(35632),u.gl.__context.shaderSource(a,b),u.gl.__context.compileShader(a),0==u.gl.__context.getShaderParameter(a,
35713))U.trace(this.addLineNumber(b),{fileName:"Program.hx",lineNumber:49,className:"lovedna.game.graphics.Program",methodName:"new"}),U.trace("fragment compileShader "+u.gl.__context.getShaderInfoLog(a),{fileName:"Program.hx",lineNumber:50,className:"lovedna.game.graphics.Program",methodName:"new"});else if(this._glprogram=u.gl.__context.createProgram(),u.gl.__context.attachShader(this._glprogram,c),u.gl.__context.attachShader(this._glprogram,a),u.gl.__context.linkProgram(this._glprogram),u.gl.__context.deleteShader(c),
u.gl.__context.deleteShader(a),0==u.gl.__context.getProgramParameter(this._glprogram,35714))U.trace("linkProgram "+u.gl.__context.getProgramInfoLog(this._glprogram),{fileName:"Program.hx",lineNumber:62,className:"lovedna.game.graphics.Program",methodName:"new"});else{this.enabled=!0;this._bufferAttribs=new J;this._uniforms=new J;b=u.gl.__context.getProgramParameter(this._glprogram,35721);c=0;for(a=b;c<a;){var d=c++;var e=u.gl.__context.getActiveAttrib(this._glprogram,d);b=e.name;var h=this._bufferAttribs;
e=new Sd(d,u.gl.__context.getAttribLocation(this._glprogram,b),e,this.id);null!=p[b]?h.setReserved(b,e):h.h[b]=e}b=u.gl.__context.getProgramParameter(this._glprogram,35718);a=this._uniformCount=c=0;for(h=b;a<h;)b=a++,e=u.gl.__context.getActiveUniform(this._glprogram,b),b=e.name,d=e.type,35678==d||35680==d?(e=new fd(c,u.gl.__context.getUniformLocation(this._glprogram,b),e,this),d=this._uniforms,null!=p[b]?d.setReserved(b,e):d.h[b]=e,++c):(d=b.indexOf("["),0<d&&(b=A.substr(b,0,d)),e=new fd(-1,u.gl.__context.getUniformLocation(this._glprogram,
b),e,this),d=this._uniforms,null!=p[b]?d.setReserved(b,e):d.h[b]=e),this._uniformCount++}};f["lovedna.game.graphics.Program"]=zb;zb.__name__=["lovedna","game","graphics","Program"];zb.prototype={bind:function(){this._time=P._custom();this.enabled&&(this._success=0,zb.current!=this&&(u.gl.__context.useProgram(this._glprogram),zb.current=this))},getBufferInput:function(a){if(null==this._bufferAttribs)return null;var b=this._bufferAttribs;return null!=p[a]?b.getReserved(a):b.h[a]},getUniformInput:function(a){var b=
this._uniforms;return null!=p[a]?b.getReserved(a):b.h[a]},checkUniformFail:function(){return this._uniformCount-this._success},uploadUniform:function(a){this._success++},addLineNumber:function(a){var b="";a=new Cc(a,!0);a.set_position(0);for(var c=a._length,d=-(c+"").length,e=0;e<c;){var h=e++;b+=n.stringFill(h+1+"",d)+":\t"+a.readLine()+"\n"}return b},__class__:zb};var Sd=g.lovedna.game.graphics.ProgramBufferInput=function(a,b,c,d){this.id=a;this.location=b;this.name=c.name;this.type=c.type;this.size=
c.size;this.version=d};f["lovedna.game.graphics.ProgramBufferInput"]=Sd;Sd.__name__=["lovedna","game","graphics","ProgramBufferInput"];Sd.prototype={__class__:Sd};var fa=g.lovedna.math.Matrix44=function(){this.m0=1;this.m4=this.m3=this.m2=this.m1=0;this.m5=1;this.m9=this.m8=this.m7=this.m6=0;this.m10=1;this.m14=this.m13=this.m12=this.m11=0;this.m15=1;this._dirty=!0};f["lovedna.math.Matrix44"]=fa;fa.__name__=["lovedna","math","Matrix44"];fa.__interfaces__=[Kb];fa.__properties__={get_temp:"get_temp"};
fa.get_temp=function(){return fa._pool.get()};fa.prototype={copy:function(a){if(null==a)return this;this.m0=a.m0;this.m1=a.m1;this.m2=a.m2;this.m3=a.m3;this.m4=a.m4;this.m5=a.m5;this.m6=a.m6;this.m7=a.m7;this.m8=a.m8;this.m9=a.m9;this.m10=a.m10;this.m11=a.m11;this.m12=a.m12;this.m13=a.m13;this.m14=a.m14;this.m15=a.m15;this._dirty=!0;return this},clone:function(){var a=new fa;a.m0=this.m0;a.m1=this.m1;a.m2=this.m2;a.m3=this.m3;a.m4=this.m4;a.m5=this.m5;a.m6=this.m6;a.m7=this.m7;a.m8=this.m8;a.m9=this.m9;
a.m10=this.m10;a.m11=this.m11;a.m12=this.m12;a.m13=this.m13;a.m14=this.m14;a.m15=this.m15;a._dirty=!0;return a},set:function(a,b,c,d,e,h,f,g,k,l,m,n,p,q,t,r){this.m0=a;this.m1=b;this.m2=c;this.m3=d;this.m4=e;this.m5=h;this.m6=f;this.m7=g;this.m8=k;this.m9=l;this.m10=m;this.m11=n;this.m12=p;this.m13=q;this.m14=t;this.m15=r;this._dirty=!0;return this},identity:function(){this.m0=1;this.m4=this.m3=this.m2=this.m1=0;this.m5=1;this.m9=this.m8=this.m7=this.m6=0;this.m10=1;this.m14=this.m13=this.m12=this.m11=
0;this.m15=1;this._dirty=!0;return this},append:function(a,b){null==b&&(b=!1);if(null==a)return this;var c=this,d=a;b&&(c=a,d=this);a=c.m0*d.m4+c.m4*d.m5+c.m8*d.m6+c.m12*d.m7;b=c.m0*d.m8+c.m4*d.m9+c.m8*d.m10+c.m12*d.m11;var e=c.m0*d.m12+c.m4*d.m13+c.m8*d.m14+c.m12*d.m15,h=c.m1*d.m0+c.m5*d.m1+c.m9*d.m2+c.m13*d.m3,f=c.m1*d.m4+c.m5*d.m5+c.m9*d.m6+c.m13*d.m7,g=c.m1*d.m8+c.m5*d.m9+c.m9*d.m10+c.m13*d.m11,k=c.m1*d.m12+c.m5*d.m13+c.m9*d.m14+c.m13*d.m15,l=c.m2*d.m0+c.m6*d.m1+c.m10*d.m2+c.m14*d.m3,m=c.m2*d.m4+
c.m6*d.m5+c.m10*d.m6+c.m14*d.m7,n=c.m2*d.m8+c.m6*d.m9+c.m10*d.m10+c.m14*d.m11,p=c.m2*d.m12+c.m6*d.m13+c.m10*d.m14+c.m14*d.m15,q=c.m3*d.m0+c.m7*d.m1+c.m11*d.m2+c.m15*d.m3,t=c.m3*d.m4+c.m7*d.m5+c.m11*d.m6+c.m15*d.m7,r=c.m3*d.m8+c.m7*d.m9+c.m11*d.m10+c.m15*d.m11,u=c.m3*d.m12+c.m7*d.m13+c.m11*d.m14+c.m15*d.m15;this.m0=c.m0*d.m0+c.m4*d.m1+c.m8*d.m2+c.m12*d.m3;this.m1=h;this.m2=l;this.m3=q;this.m4=a;this.m5=f;this.m6=m;this.m7=t;this.m8=b;this.m9=g;this.m10=n;this.m11=r;this.m12=e;this.m13=k;this.m14=p;
this.m15=u;this._dirty=!0;return this},inverse:function(){var a=this.getDeterminant();if(0==a)throw new z("non-invertible matrix");a=1/a;var b=this.m12*this.m10*this.m7-this.m8*this.m14*this.m7-this.m12*this.m6*this.m11+this.m4*this.m14*this.m11+this.m8*this.m6*this.m15-this.m4*this.m10*this.m15,c=this.m8*this.m13*this.m7-this.m12*this.m9*this.m7+this.m12*this.m5*this.m11-this.m4*this.m13*this.m11-this.m8*this.m5*this.m15+this.m4*this.m9*this.m15,d=this.m12*this.m9*this.m6-this.m8*this.m13*this.m6-
this.m12*this.m5*this.m10+this.m4*this.m13*this.m10+this.m8*this.m5*this.m14-this.m4*this.m9*this.m14,e=this.m13*this.m10*this.m3-this.m9*this.m14*this.m3-this.m13*this.m2*this.m11+this.m1*this.m14*this.m11+this.m9*this.m2*this.m15-this.m1*this.m10*this.m15,h=this.m8*this.m14*this.m3-this.m12*this.m10*this.m3+this.m12*this.m2*this.m11-this.m0*this.m14*this.m11-this.m8*this.m2*this.m15+this.m0*this.m10*this.m15,f=this.m12*this.m9*this.m3-this.m8*this.m13*this.m3-this.m12*this.m1*this.m11+this.m0*this.m13*
this.m11+this.m8*this.m1*this.m15-this.m0*this.m9*this.m15,g=this.m8*this.m13*this.m2-this.m12*this.m9*this.m2+this.m12*this.m1*this.m10-this.m0*this.m13*this.m10-this.m8*this.m1*this.m14+this.m0*this.m9*this.m14,k=this.m5*this.m14*this.m3-this.m13*this.m6*this.m3+this.m13*this.m2*this.m7-this.m1*this.m14*this.m7-this.m5*this.m2*this.m15+this.m1*this.m6*this.m15,l=this.m12*this.m6*this.m3-this.m4*this.m14*this.m3-this.m12*this.m2*this.m7+this.m0*this.m14*this.m7+this.m4*this.m2*this.m15-this.m0*this.m6*
this.m15,m=this.m4*this.m13*this.m3-this.m12*this.m5*this.m3+this.m12*this.m1*this.m7-this.m0*this.m13*this.m7-this.m4*this.m1*this.m15+this.m0*this.m5*this.m15,n=this.m12*this.m5*this.m2-this.m4*this.m13*this.m2-this.m12*this.m1*this.m6+this.m0*this.m13*this.m6+this.m4*this.m1*this.m14-this.m0*this.m5*this.m14,p=this.m9*this.m6*this.m3-this.m5*this.m10*this.m3-this.m9*this.m2*this.m7+this.m1*this.m10*this.m7+this.m5*this.m2*this.m11-this.m1*this.m6*this.m11,q=this.m4*this.m10*this.m3-this.m8*this.m6*
this.m3+this.m8*this.m2*this.m7-this.m0*this.m10*this.m7-this.m4*this.m2*this.m11+this.m0*this.m6*this.m11,t=this.m8*this.m5*this.m3-this.m4*this.m9*this.m3-this.m8*this.m1*this.m7+this.m0*this.m9*this.m7+this.m4*this.m1*this.m11-this.m0*this.m5*this.m11,r=this.m4*this.m9*this.m2-this.m8*this.m5*this.m2+this.m8*this.m1*this.m6-this.m0*this.m9*this.m6-this.m4*this.m1*this.m10+this.m0*this.m5*this.m10;this.m0=(this.m9*this.m14*this.m7-this.m13*this.m10*this.m7+this.m13*this.m6*this.m11-this.m5*this.m14*
this.m11-this.m9*this.m6*this.m15+this.m5*this.m10*this.m15)*a;this.m4=b*a;this.m8=c*a;this.m12=d*a;this.m1=e*a;this.m5=h*a;this.m9=f*a;this.m13=g*a;this.m2=k*a;this.m6=l*a;this.m10=m*a;this.m14=n*a;this.m3=p*a;this.m7=q*a;this.m11=t*a;this.m15=r*a;this._dirty=!0;return this},setProjection:function(a,b,c,d){null==d&&(d=1.78);null==c&&(c=60);null==b&&(b=1E3);null==a&&(a=.1);c=1/Math.tan(.008726646259971648*c);this.m0=c/d;this.m4=this.m3=this.m2=this.m1=0;this.m5=c;this.m9=this.m8=this.m7=this.m6=0;
this.m10=(b+a)/(a-b);this.m11=-1;this.m13=this.m12=0;this.m14=2*b*a/(a-b);this.m15=0;this._dirty=!0;return this},setFrustum:function(a,b,c,d,e,h){this.m0=2*e/(b-a);this.m4=this.m3=this.m2=this.m1=0;this.m5=2*e/(d-c);this.m7=this.m6=0;this.m8=(b+a)/(b-a);this.m9=(d+c)/(d-c);this.m10=(h+e)/(e-h);this.m11=-1;this.m13=this.m12=0;this.m14=2*h*e/(e-h);this.m15=0;this._dirty=!0;return this},setOrtho:function(a,b,c,d,e,h){this.m0=2/(b-a);this.m4=this.m3=this.m2=this.m1=0;this.m5=2/(d-c);this.m9=this.m8=this.m7=
this.m6=0;this.m10=-2/(h-e);this.m11=0;this.m12=-(b+a)/(b-a);this.m13=-(d+c)/(d-c);this.m14=-(h+e)/(h-e);this.m15=1;this._dirty=!0;return this},setOrtho2D:function(a,b,c,d,e,h){null==h&&(h=1);null==e&&(e=0);return this.setOrtho(a,a+c,b,b+d,e,h)},lookAt:function(a,b,c){if(null==b){var d=m._pool.get();d.x=0;d.y=0;d.z=0;b=d}null==c&&(c=m.get_up());d=m._pool.get();var e=m._pool.get(),h=m._pool.get(),f=m._pool.get();b=d.copy(b).sub(a);f.copy(b).normalize();e.copy(b).normalize();e.cross(c).normalize();
h.copy(e).cross(f).normalize();this.m0=1;this.m4=this.m3=this.m2=this.m1=0;this.m5=1;this.m9=this.m8=this.m7=this.m6=0;this.m10=1;this.m14=this.m13=this.m12=this.m11=0;this.m15=1;this._dirty=!0;this.m0=e.x;this.m4=e.y;this.m8=e.z;this.m1=h.x;this.m5=h.y;this.m9=h.z;this.m2=-f.x;this.m6=-f.y;this.m10=-f.z;this.appendTranslation(d.copy(a).scale(-1));return this},setTranslation:function(a){this.m12=a.x;this.m13=a.y;this.m14=a.z;this._dirty=!0;return this},getTranslation:function(a){null==a&&(a=m._pool.get());
a.x=this.m12;a.y=this.m13;a.z=this.m14;return a},setScale:function(a){this.m0=a.x;this.m5=a.y;this.m10=a.z;this._dirty=!0;return this},getScale:function(a){null==a&&(a=m._pool.get());var b=1E-7>n.abs(this.m4)&&1E-7>n.abs(this.m8)?n.abs(this.m0):Math.sqrt(this.m0*this.m0+this.m4*this.m4+this.m8*this.m8),c=1E-7>n.abs(this.m1)&&1E-7>n.abs(this.m9)?n.abs(this.m5):Math.sqrt(this.m1*this.m1+this.m5*this.m5+this.m9*this.m9),d=1E-7>n.abs(this.m2)&&1E-7>n.abs(this.m6)?n.abs(this.m10):Math.sqrt(this.m2*this.m2+
this.m6*this.m6+this.m10*this.m10);a.x=b;a.y=c;a.z=d;return a},setRotation:function(a){var b=a.x*a.x,c=a.x*a.y,d=a.x*a.z,e=a.x*a.w,h=a.y*a.y,f=a.y*a.z,g=a.y*a.w,k=a.z*a.z;a=a.z*a.w;this.m0=1-2*(h+k);this.m1=2*(c+a);this.m2=2*(d-g);this.m4=2*(c-a);this.m5=1-2*(b+k);this.m6=2*(f+e);this.m8=2*(d+g);this.m9=2*(f-e);this.m10=1-2*(b+h);this._dirty=!0;return this},getRotation:function(a){null==a&&(a=ja._pool.get());var b=this.getRotationMatrix();return a.setFromAxes(b.m0,b.m4,b.m8,b.m1,b.m5,b.m9,b.m2,b.m6,
b.m10)},getRotationMatrix:function(a){null==a&&(a=fa._pool.get());var b=0>this.m4*this.m5*this.m6*this.m7?-1:1,c=0>this.m8*this.m9*this.m10*this.m11?-1:1,d=Math.sqrt,e=(0>this.m0*this.m1*this.m2*this.m3?-1:1)*d(this.m0*this.m0+this.m1*this.m1+this.m2*this.m2);b*=d(this.m4*this.m4+this.m5*this.m5+this.m6*this.m6);c*=d(this.m8*this.m8+this.m9*this.m9+this.m10*this.m10);a.m0=this.m0/e;a.m1=this.m1/e;a.m2=this.m2/e;a.m3=0;a.m4=this.m4/b;a.m5=this.m5/b;a.m6=this.m6/b;a.m7=0;a.m8=this.m8/c;a.m9=this.m9/
c;a.m10=this.m10/c;a.m11=0;a.m12=0;a.m13=0;a.m14=0;a.m15=1;a._dirty=!0;return a},appendTranslation:function(a){if(!(1E-7>n.abs(a.x)&&1E-7>n.abs(a.y)&&1E-7>n.abs(a.z))){var b=fa._pool.get();b.m0=1;b.m1=0;b.m2=0;b.m3=0;b.m4=0;b.m5=1;b.m6=0;b.m7=0;b.m8=0;b.m9=0;b.m10=1;b.m11=0;b.m12=0;b.m13=0;b.m14=0;b.m15=1;b._dirty=!0;b.m12=a.x;b.m13=a.y;b.m14=a.z;b._dirty=!0;this.append(b)}return this},appendScale:function(a){if(!(1E-7>n.abs(a.x-1)&&1E-7>n.abs(a.y-1)&&1E-7>n.abs(a.z-1))){var b=fa._pool.get();b.m0=
1;b.m1=0;b.m2=0;b.m3=0;b.m4=0;b.m5=1;b.m6=0;b.m7=0;b.m8=0;b.m9=0;b.m10=1;b.m11=0;b.m12=0;b.m13=0;b.m14=0;b.m15=1;b._dirty=!0;b.m0=a.x;b.m5=a.y;b.m10=a.z;b._dirty=!0;this.append(b)}return this},appendRotation:function(a){if(0!=a.x||0!=a.y||0!=a.z||1!=a.w){var b=fa._pool.get();b.m0=1;b.m1=0;b.m2=0;b.m3=0;b.m4=0;b.m5=1;b.m6=0;b.m7=0;b.m8=0;b.m9=0;b.m10=1;b.m11=0;b.m12=0;b.m13=0;b.m14=0;b.m15=1;b._dirty=!0;this.append(b.setRotation(a))}return this},appendTRS:function(a,b,c){null!=a&&this.appendTranslation(a);
null!=b&&this.appendRotation(b);null!=c&&this.appendScale(c);return this},setTRS:function(a,b,c){this.m0=1;this.m4=this.m3=this.m2=this.m1=0;this.m5=1;this.m9=this.m8=this.m7=this.m6=0;this.m10=1;this.m14=this.m13=this.m12=this.m11=0;this.m15=1;this._dirty=!0;return this.appendTRS(a,b,c)},getScaleXSquared:function(){return this.m0*this.m0+this.m4*this.m4+this.m8*this.m8},getScaleYSquared:function(){return this.m1*this.m1+this.m5*this.m5+this.m9*this.m9},getScaleZSquared:function(){return this.m2*
this.m2+this.m6*this.m6+this.m10*this.m10},getScaleX:function(){return 1E-7>n.abs(this.m4)&&1E-7>n.abs(this.m8)?n.abs(this.m0):Math.sqrt(this.m0*this.m0+this.m4*this.m4+this.m8*this.m8)},getScaleY:function(){return 1E-7>n.abs(this.m1)&&1E-7>n.abs(this.m9)?n.abs(this.m5):Math.sqrt(this.m1*this.m1+this.m5*this.m5+this.m9*this.m9)},getScaleZ:function(){return 1E-7>n.abs(this.m2)&&1E-7>n.abs(this.m6)?n.abs(this.m10):Math.sqrt(this.m2*this.m2+this.m6*this.m6+this.m10*this.m10)},transpose:function(){return this},
transformVector:function(a,b){null==b&&(b=!1);var c=a.x,d=a.y,e=a.z,h=1;b&&(h=1/(c*this.m3+d*this.m7+e*this.m11+this.m15));b=(c*this.m1+d*this.m5+e*this.m9+this.m13)*h;var f=(c*this.m2+d*this.m6+e*this.m10+this.m14)*h;a.x=(c*this.m0+d*this.m4+e*this.m8+this.m12)*h;a.y=b;a.z=f;return a},fillFloat32Array:function(a,b){null==b&&(b=0);a[b++]=this.m0;a[b++]=this.m1;a[b++]=this.m2;a[b++]=this.m3;a[b++]=this.m4;a[b++]=this.m5;a[b++]=this.m6;a[b++]=this.m7;a[b++]=this.m8;a[b++]=this.m9;a[b++]=this.m10;a[b++]=
this.m11;a[b++]=this.m12;a[b++]=this.m13;a[b++]=this.m14;a[b++]=this.m15},toString:function(){return"Matrix44\n["+this.m0+" | "+this.m4+" | "+this.m8+" | "+this.m12+"]\n["+this.m1+" | "+this.m5+" | "+this.m9+" | "+this.m13+"]\n["+this.m2+" | "+this.m6+" | "+this.m10+" | "+this.m14+"]\n["+this.m3+" | "+this.m7+" | "+this.m11+" | "+this.m15+"]\n"},fillArray:function(a,b){null==b&&(b=0);a[b++]=this.m0;a[b++]=this.m1;a[b++]=this.m2;a[b++]=this.m3;a[b++]=this.m4;a[b++]=this.m5;a[b++]=this.m6;a[b++]=this.m7;
a[b++]=this.m8;a[b++]=this.m9;a[b++]=this.m10;a[b++]=this.m11;a[b++]=this.m12;a[b++]=this.m13;a[b++]=this.m14;a[b++]=this.m15},fromArray:function(a,b){null==b&&(b=0);if(a.length<b+16)return this;this.m0=a[b++];this.m1=a[b++];this.m2=a[b++];this.m3=a[b++];this.m4=a[b++];this.m5=a[b++];this.m6=a[b++];this.m7=a[b++];this.m8=a[b++];this.m9=a[b++];this.m10=a[b++];this.m11=a[b++];this.m12=a[b++];this.m13=a[b++];this.m14=a[b++];this.m15=a[b++];return this},getDeterminant:function(){return this.m3*this.m6*
this.m9*this.m12-this.m2*this.m7*this.m9*this.m12-this.m3*this.m5*this.m10*this.m12+this.m1*this.m7*this.m10*this.m12+this.m2*this.m5*this.m11*this.m12-this.m1*this.m6*this.m11*this.m12-this.m3*this.m6*this.m8*this.m13+this.m2*this.m7*this.m8*this.m13+this.m3*this.m4*this.m10*this.m13-this.m0*this.m7*this.m10*this.m13-this.m2*this.m4*this.m11*this.m13+this.m0*this.m6*this.m11*this.m13+this.m3*this.m5*this.m8*this.m14-this.m1*this.m7*this.m8*this.m14-this.m3*this.m4*this.m9*this.m14+this.m0*this.m7*
this.m9*this.m14+this.m1*this.m4*this.m11*this.m14-this.m0*this.m5*this.m11*this.m14-this.m2*this.m5*this.m8*this.m15+this.m1*this.m6*this.m8*this.m15+this.m2*this.m4*this.m9*this.m15-this.m0*this.m6*this.m9*this.m15-this.m1*this.m4*this.m10*this.m15+this.m0*this.m5*this.m10*this.m15},dirty:function(){this._dirty=!0},get_data:function(){null==this._data&&(this._data=new Td(16));if(this._dirty){var a=0;this._data[a++]=this.m0;this._data[a++]=this.m1;this._data[a++]=this.m2;this._data[a++]=this.m3;
this._data[a++]=this.m4;this._data[a++]=this.m5;this._data[a++]=this.m6;this._data[a++]=this.m7;this._data[a++]=this.m8;this._data[a++]=this.m9;this._data[a++]=this.m10;this._data[a++]=this.m11;this._data[a++]=this.m12;this._data[a++]=this.m13;this._data[a++]=this.m14;this._data[a++]=this.m15}return this._data},__class__:fa,__properties__:{get_data:"get_data"}};var Ga=g.lovedna.game.graphics.ProgramUniformData=function(){this._type=-1;this.enabled=!1;this._dirty=!0};f["lovedna.game.graphics.ProgramUniformData"]=
Ga;Ga.__name__=["lovedna","game","graphics","ProgramUniformData"];Ga.prototype={getInt:function(){return this._intValue},setInt:function(a){if(this._intValue==a)return this;this._intValue=a;this._type=1;this._dirty=this._typeDirty=this.enabled=!0;return this},getFloat:function(){return this._floatValue},setFloat:function(a){if(this._floatValue==a)return this;this._floatValue=a;this._type=2;this._dirty=this._typeDirty=this.enabled=!0;return this},setFloatArray:function(a){if(null==a)throw new z(this.name+
" value error ");if(this._floatArrayValue==a)return this;this._floatArrayValue=a;this._type=3;this._dirty=this._typeDirty=this.enabled=!0;return this},getFloat2:function(){return this._float2Value},setFloat2:function(a){if(null==a)throw new z(this.name+" value error ");if(this._float2Value==a)return this;this._float2Value=a;this._type=4;this._dirty=this._typeDirty=this.enabled=!0;return this},getFloat3:function(){return this._float3Value},setFloat3:function(a){if(null==a)throw new z(this.name+" value error ");
if(this._float3Value==a)return this;this._float3Value=a;this._type=5;this._dirty=this._typeDirty=this.enabled=!0;return this},getFloat4:function(){return this._float4Value},setFloat4:function(a){if(null==a)throw new z(this.name+" value error ");if(this._float4Value==a)return this;this._float4Value=a;this._type=6;this._dirty=this._typeDirty=this.enabled=!0;return this},setFloat4Array:function(a){if(null==a)throw new z(this.name+" value error ");this._dirty=!0;if(this._float4ArrayValue==a)return this;
this._float4ArrayValue=a;this._type=11;this._dirty=this._typeDirty=this.enabled=!0;return this},getMatrix:function(){return this._matrix4Value},setMatrix:function(a){if(null==a)throw new z(this.name+" value error ");this._dirty=!0;if(this._matrix4Value==a)return this;this._matrix4Value=a;this._type=7;this._dirty=this._typeDirty=this.enabled=!0;return this},setMatrixHandler:function(a){if(null==a)throw new z(this.name+" value error ");this._matrix4HandlerValue=a;this._type=10;this._dirty=this._typeDirty=
this.enabled=!0;return this},setMatrixArray:function(a){if(null==a)throw new z(this.name+" value error ");this._dirty=!0;if(this._matrix4ArrayValue==a)return this;this._matrix4ArrayValue=a;this._type=8;this._dirty=this._typeDirty=this.enabled=!0;return this},setTexture:function(a){if(this._texture==a)return this;this._texture=a;if(null==this._texture)throw new z(this.name+" value error ");this._type=9;this._dirty=this._typeDirty=this.enabled=!0;return this},bind:function(a){if(null==a)return U.trace(this.name+
" input null",{fileName:"ProgramUniformData.hx",lineNumber:186,className:"lovedna.game.graphics.ProgramUniformData",methodName:"bind"}),!0;if(0>this._type)return U.trace(this.name+" type is error",{fileName:"ProgramUniformData.hx",lineNumber:191,className:"lovedna.game.graphics.ProgramUniformData",methodName:"bind"}),!0;a!=this._input&&(this._input=a,null!=this._input?(this._size=this._input.size,this.enabled=!0):this._size=-1);if(0>this._size)return U.trace(this.name+" size is "+this._size,{fileName:"ProgramUniformData.hx",
lineNumber:209,className:"lovedna.game.graphics.ProgramUniformData",methodName:"bind"}),!0;(null==this._handler||this._typeDirty)&&this.bindType();if(null==this._handler)return U.trace(this.name+" handler is null ",{fileName:"ProgramUniformData.hx",lineNumber:218,className:"lovedna.game.graphics.ProgramUniformData",methodName:"bind"}),this._type=-1,!0;a=this._handler();this._typeDirty=!1;this._input=null;return a},setType:function(a){this._type=a;this._dirty=this._typeDirty=this.enabled=!0},bindType:function(){switch(this._type){case 1:this._handler=
q(this,this.bindInt);break;case 2:this._handler=q(this,this.bindFloat);break;case 3:this._handler=q(this,this.bindFloatArray);break;case 4:this._handler=q(this,this.bindFloat2);break;case 5:this._handler=q(this,this.bindFloat3);break;case 6:this._handler=q(this,this.bindFloat4);break;case 7:this._handler=q(this,this.bindMatrix4);break;case 8:this._handler=q(this,this.bindMatrix4Array);break;case 9:this._handler=q(this,this.bindTexture);break;case 10:this._handler=q(this,this.bindMatrix4Handler);break;
case 11:this._handler=q(this,this.bindFloat4Array)}},bindInt:function(){u.gl.__context.uniform1i(this._input.location,this._intValue);return!0},bindFloat:function(){u.gl.__context.uniform1f(this._input.location,this._floatValue);return!0},bindFloat2:function(){u.gl.__context.uniform2f(this._input.location,this._float2Value.x,this._float2Value.y);return!0},bindFloat3:function(){u.gl.__context.uniform3f(this._input.location,this._float3Value.x,this._float3Value.y,this._float3Value.z);return!0},bindFloat4:function(){u.gl.__context.uniform4f(this._input.location,
this._float4Value.x,this._float4Value.y,this._float4Value.z,this._float4Value.w);return!0},bindFloatArray:function(){var a=this._floatArrayValue.length;if(null==this._float32Array||a>this._float32Array.length)this._float32Array=new Td(a);if(this._dirty)for(this._dirty=!1;0<a--;)this._float32Array[a]=this._floatArrayValue[a];u.gl.__context.uniform1fv(this._input.location,this._float32Array);return!0},bindFloat4Array:function(){var a=this._float4ArrayValue.length;if(null==this._float32Array||4*a>this._float32Array.length)this._float32Array=
new Td(4*a);if(this._dirty)for(this._dirty=!1;0<a--;){var b=4*a,c=this._float4ArrayValue[a];if(null==c)return U.trace("warn",{fileName:"ProgramUniformData.hx",lineNumber:331,className:"lovedna.game.graphics.ProgramUniformData",methodName:"bindFloat4Array",customParams:["list "+a+" is null"]}),!1;this._float32Array[b]=c.x;this._float32Array[b+1]=c.y;this._float32Array[b+2]=c.z;this._float32Array[b+3]=c.w}u.gl.__context.uniform4fv(this._input.location,this._float32Array);return!0},bindMatrix4:function(){var a=
u.gl,b=this._input.location,c=this._matrix4Value.get_data();a.__context.uniformMatrix4fv(b,!1,c);return!0},bindMatrix4Handler:function(){var a=this._matrix4HandlerValue(),b=u.gl,c=this._input.location;a=a.get_data();b.__context.uniformMatrix4fv(c,!1,a);return!0},bindMatrix4Array:function(){var a=this._matrix4ArrayValue.length;if(null==this._float32Array||16*a>this._float32Array.length)this._float32Array=new Td(16*a);if(this._dirty)for(this._dirty=!1;0<a--;){var b=this._matrix4ArrayValue[a];null==
b&&(b=Ga.defaultMat44);b.fillFloat32Array(this._float32Array,16*a)}u.gl.__context.uniformMatrix4fv(this._input.location,!1,this._float32Array);return!0},bindTexture:function(){if(!this._texture.bind(this._input.id))return!1;u.gl.__context.uniform1i(this._input.location,this._input.id);return!0},__class__:Ga};var fd=g.lovedna.game.graphics.ProgramUniformInput=function(a,b,c,d){this.id=a;this.location=b;this._info=c;this.name=c.name;this.type=c.type;this.size=c.size;this._program=d;this.set_success(!1)};
f["lovedna.game.graphics.ProgramUniformInput"]=fd;fd.__name__=["lovedna","game","graphics","ProgramUniformInput"];fd.prototype={toString:function(){return this.name+" "+this.type+" "+this.size},set_success:function(a){if(!a)return a;this._program.uploadUniform(this);return a},__class__:fd,__properties__:{set_success:"set_success"}};var Ya=g.lovedna.game.graphics.Texture=function(){this.enabled=!1;this.id=Ya._id++;this.params=new Ud};f["lovedna.game.graphics.Texture"]=Ya;Ya.__name__=["lovedna","game",
"graphics","Texture"];Ya.__interfaces__=[bc];Ya.prototype={unload:function(){this.enabled=!1;this.data=null},setData:function(a){this.data=a;this.enabled=!0;this._time=P._custom()},bind:function(a){this._time=P._custom();return!1},toString:function(){return"Texture "+this.id+"("+this.width+","+this.height+")"},__class__:Ya};var Bb=g.lovedna.game.graphics.Texture2D=function(){Ya.call(this)};f["lovedna.game.graphics.Texture2D"]=Bb;Bb.__name__=["lovedna","game","graphics","Texture2D"];Bb.__super__=Ya;
Bb.prototype=r(Ya.prototype,{setData:function(a){Ya.prototype.setData.call(this,a);null!=this.data&&(y.__instanceof(this.data,Pb)&&(a=this.data,this.width=a.width,this.height=a.height),y.__instanceof(this.data,HTMLImageElement)?(a=this.data,this.width=a.width,this.height=a.height):y.__instanceof(this.data,HTMLCanvasElement)?(a=this.data,this.width=a.width,this.height=a.height):y.__instanceof(this.data,HTMLVideoElement)&&(a=this.data,this.width=a.width,this.height=a.height))},unload:function(){Ya.prototype.unload.call(this);
null!=this._texture&&(u.gl.__context.deleteTexture(this._texture),this._texture=null)},bind:function(a){null==a&&(a=0);Ya.prototype.bind.call(this,a);return this.enabled&&0!=this.width&&0!=this.height?null!=this.data?(this.upload(),this.data=null,!1):null!=this._texture?(u.gl.__context.activeTexture(33984+a),u.gl.__context.bindTexture(3553,this._texture),this.params.bind(),!0):!1:!1},upload:function(){null==this._texture&&(this._texture=u.gl.__context.createTexture());u.gl.__context.activeTexture(33984);
u.gl.__context.bindTexture(3553,this._texture);if(null!=this.data){var a=!1;y.__instanceof(this.data,Pb)&&(this.data=this.data.data);if(y.__instanceof(this.data,HTMLImageElement)){var b=this.data;this.width=b.width;this.height=b.height;0!=this.width&&0!=this.height&&(u.gl.gl.texImage2D(3553,0,6408,6408,5121,b),a=!0)}else y.__instanceof(this.data,HTMLCanvasElement)?(b=this.data,this.width=b.width,this.height=b.height,0!=this.width&&0!=this.height&&(u.gl.gl.texImage2D(3553,0,6408,6408,5121,b),a=!0)):
y.__instanceof(this.data,HTMLVideoElement)&&(b=this.data,this.width=b.width,this.height=b.height,0!=this.width&&0!=this.height&&(u.gl.gl.texImage2D(3553,0,6408,6408,5121,b),a=!0));a&&this.updateParams()}return!1},updateParams:function(){var a=!1;if(0!=this.width&&0!=this.height){var b=this.width;0<b&&0==(b&b-1)?(b=this.height,b=!(0<b&&0==(b&b-1))):b=!0;b?(this.params.wrapS=33071,this.params.wrapT=33071,this.params.dirty=!0):a=!0}a&&this.params.mipmap&&(u.gl.__context.generateMipmap(3553),this.params.filterMin=
9984)},__class__:Bb});var Lc=g.lovedna.game.graphics.RenderTexture2D=function(a,b,c){null==c&&(c=16);null==b&&(b=0);null==a&&(a=256);this._depth=16;Bb.call(this);this.width=a;this.height=b;0>=this.height&&(this.height=this.width);this.enabled=!0;this._depth=c};f["lovedna.game.graphics.RenderTexture2D"]=Lc;Lc.__name__=["lovedna","game","graphics","RenderTexture2D"];Lc.__super__=Bb;Lc.prototype=r(Bb.prototype,{resize:function(a,b){this.width==a&&this.height==b||this.unload();this.width=a;this.height=
b},bindBuffer:function(){if(null==this._frameBuffer){this._frameBuffer=u.gl.__context.createFramebuffer();u.gl.__context.bindFramebuffer(36160,this._frameBuffer);this._renderBuffer=u.gl.__context.createRenderbuffer();u.gl.__context.bindRenderbuffer(36161,this._renderBuffer);24==this._depth?(u.gl.__context.renderbufferStorage(36161,34041,this.width,this.height),u.gl.__context.framebufferRenderbuffer(36160,33306,36161,this._renderBuffer)):16==this._depth&&(u.gl.__context.renderbufferStorage(36161,33189,
this.width,this.height),u.gl.__context.framebufferRenderbuffer(36160,36096,36161,this._renderBuffer));this.params.mipmap=!1;this.upload();u.gl.__context.framebufferTexture2D(36160,36064,3553,this._texture,0);u.gl.__context.texImage2D(3553,0,6408,this.width,this.height,0,6408,5121,null);u.gl.__context.bindRenderbuffer(36161,null);this.updateParams();u.gl.__context.clearDepth(1);u.gl.__context.clearStencil(0);u.gl.__context.clearColor(1,1,1,0);var a=16384;0<this._depth&&(a|=256);16<this._depth&&(a|=
1024);u.gl.__context.clear(a)}u.gl.__context.bindFramebuffer(36160,this._frameBuffer);u.gl.__context.bindRenderbuffer(36161,this._renderBuffer)},bind:function(a){null==a&&(a=0);return Bb.prototype.bind.call(this,a)},unload:function(){null!=this._frameBuffer&&(u.gl.__context.deleteFramebuffer(this._frameBuffer),this._frameBuffer=null);null!=this._renderBuffer&&(u.gl.__context.deleteRenderbuffer(this._renderBuffer),this._renderBuffer=null)},toString:function(){return"RenderTexture2D "+this.id+"("+this.width+
","+this.height+")"},__class__:Lc});var Ud=g.lovedna.game.graphics.TextureParams=function(){this.filterMin=this.filterMag=9729;this.wrapT=this.wrapS=10497;this.dirty=this.mipmap=!0};f["lovedna.game.graphics.TextureParams"]=Ud;Ud.__name__=["lovedna","game","graphics","TextureParams"];Ud.prototype={bind:function(){this.dirty&&(this.dirty=!1,u.gl.__context.texParameteri(3553,10242,this.wrapS),u.gl.__context.texParameteri(3553,10243,this.wrapT),u.gl.__context.texParameteri(3553,10240,this.filterMag),
u.gl.__context.texParameteri(3553,10241,this.filterMin))},__class__:Ud};var Ua=g.lovedna.game.graphics.VertexBuffer=function(){this.id=Ua._id++;this._programId=-1;this._time=0};f["lovedna.game.graphics.VertexBuffer"]=Ua;Ua.__name__=["lovedna","game","graphics","VertexBuffer"];Ua.__interfaces__=[bc];Ua.prototype={setProgramId:function(a){this._programId=this.id},getLayout:function(a){var b=this._layoutMap;return null!=p[a]?b.getReserved(a):b.h[a]},setLayout:function(a){if(null==this.layouts)this.layouts=
[],this._layoutMap=new J;else{for(var b=this.layouts.length;0<b--;)this._layoutMap.remove(this.layouts[b].name);this.layouts.splice(0,this.layouts.length)}b=this.stride=0;for(var c=a.length;b<c;){var d=b++,e=a[d];null==e&&U.trace("error",{fileName:"VertexBuffer.hx",lineNumber:73,className:"lovedna.game.graphics.VertexBuffer",methodName:"setLayout",customParams:["layout is null "+d]});e.offset=this.stride;this.stride+=e.size*e.getDataSize();this.layouts.push(e);d=this._layoutMap;var h=e.name;null!=
p[h]?d.setReserved(h,e):d.h[h]=e}this.enabled=0<this.stride},upload:function(a){this._data=a;this.length=this._data.length},bind:function(a){this._time=P._custom();if(!this.enabled)return!1;a=this.layouts.length;if(1>a)return!1;if(null!=this._data){null==this._buffer&&(this._buffer=u.gl.__context.createBuffer());u.gl.__context.bindBuffer(34962,this._buffer);a=u.gl;var b=this.getData();a.__context.bufferData(34962,b,35044);this._data=null}b=0;u.gl.__context.bindBuffer(34962,this._buffer);for(a=this.layouts.length;0<
a--;){var c=this.layouts[a];0>c.location||(u.gl.__context.enableVertexAttribArray(c.location),u.gl.__context.vertexAttribPointer(c.location,c.size,c.type,!1,this.stride,c.offset),++b)}return 1>b?!1:!0},unload:function(){null!=this._buffer&&(u.gl.__context.deleteBuffer(this._buffer),this._buffer=null);this.layouts=this._layoutMap=this._data=null},getData:function(){var a=this._data.length,b=n.intToNextPow2(a),c=n.pow2Count(b),d=Ua._tempList[c];null==d&&(d=new Td(b),Ua._tempList[c]=d);for(;0<a--;)d[a]=
this._data[a];return d},__class__:Ua};var Ob=g.lovedna.game.graphics.VertexLayout=function(a,b,c){null==c&&(c=5126);this.type=c;this.name=a;this.size=b;this.offset=0;this.location=-1};f["lovedna.game.graphics.VertexLayout"]=Ob;Ob.__name__=["lovedna","game","graphics","VertexLayout"];Ob.prototype={getDataSize:function(){return 4},__class__:Ob};var pd=g.lovedna.game.helper.DebugGame=function(a){this.game=a;Ia.onEvent.addEventListener(cb.onUpdate._type,q(this,this.onKey))};f["lovedna.game.helper.DebugGame"]=
pd;pd.__name__=["lovedna","game","helper","DebugGame"];pd.prototype={debugFrame:function(){this.game.pause=!0},debugRender:function(){this.game.commands.debug=!0},onKey:function(a){a=cb.onUpdate.key;1==a.type&&(39==a.keyCode?(this.game.pause&&(this.game.playStep=!0),this.game.commands.debug&&this.game.commands.position++):37==a.keyCode?(this.game.pause&&(this.game.playStep=!0),this.game.commands.debug&&this.game.commands.position--):40==a.keyCode?a.modifier.getElement(2)&&(this.game.pause=!this.game.pause):
38==a.keyCode&&a.modifier.getElement(2)&&(this.game.commands.debug=!this.game.commands.debug))},__class__:pd};var Md=g.lovedna.game.render.CameraRenderData=function(a){this._camera=a;this._context=new lc;this._timeData=new Q;this._sinTimeData=new Q;this._cosTimeData=new Q;this._deltaTimeData=new Q;this._uniforms=new mb;this._uniforms.setFloat4(k.TIME.name,this._timeData);this._uniforms.setFloat4(k.TIME_SIN.name,this._sinTimeData);this._uniforms.setFloat4(k.TIME_COS.name,this._cosTimeData);this._uniforms.setFloat4(k.TIME_DELTA.name,
this._deltaTimeData);this._camera.uniforms.add(this._uniforms);this._temp=new O;this._bufferStart=new S;this._bufferEnd=new S;this._sort=new gd};f["lovedna.game.render.CameraRenderData"]=Md;Md.__name__=["lovedna","game","render","CameraRenderData"];Md.prototype={render:function(a){Fb.current=this._camera;if(this._camera.render){this._gameBuffer=this._camera.actor.world.game.commands;var b=this._sort;null!=this._camera.customRenderBufferCollector&&(b=this._camera.customRenderBufferCollector);for(var c=
a.count;0<c--;){var d=a._list[c];if(d.visible){var e=d.actor;this._camera.cullingMask.exist(e.layer)?d.cullWithCamera(this._camera)?e._setVisible(!1):(e._setVisible(!0),d.collectRenderBuffer(b)):e._setVisible(!1)}}this._bufferStart.clear();this._bufferStart.setContext(this._context);this._bufferStart.setCallback(q(this,this.onPreRender));this._gameBuffer.push(this._bufferStart);b.copyTo(this._gameBuffer);this._bufferEnd.clear();this._bufferEnd.setCallback(q(this,this.onPostRender));this._gameBuffer.push(this._bufferEnd)}},
onPreRender:function(a){a.clearGlobal();var b=E.get_now(),c=this._timeData;c.x=b/20;c.y=b;c.z=2*b;c.w=3*b;c=this._sinTimeData;var d=Math.sin(b/4),e=Math.sin(b/2),h=Math.sin(b);c.x=Math.sin(b/8);c.y=d;c.z=e;c.w=h;c=this._cosTimeData;d=Math.cos(b/4);e=Math.cos(b/2);h=Math.cos(b);c.x=Math.cos(b/8);c.y=d;c.z=e;c.w=h;b=this._camera.actor.deltaTime;c=this._deltaTimeData;c.x=b;c.y=1/b;c.z=b;c.w=1/b;b=this._camera.clearFlags.type;0<this._camera.actor.world.collectorLight.count&&(c=this._camera.actor.world.collectorLight.get(0),
a.globalUniforms.add(c.uniforms),a.globalDefine.define(k.LIGHT.name,"",!0));a.globalUniforms.add(this._camera.uniforms);null!=this._camera.renderTarget&&l.pushTarget(this._camera.renderTarget);0!=b&&(1==b?l.clear(this._camera.clearFlags.color,-1,-1):2==b?l.clear(null,1,-1):3==b&&l.clear(this._camera.clearFlags.color,1,0))},onPostRender:function(a){null!=this._camera.renderTarget&&l.popTarget();this._camera.actor.dispatchEvent(w.onPostRender)},__class__:Md};var Vd=g.lovedna.game.render.IRenderBufferCollect=
function(){};f["lovedna.game.render.IRenderBufferCollect"]=Vd;Vd.__name__=["lovedna","game","render","IRenderBufferCollect"];Vd.prototype={__class__:Vd};var gd=function(){};f["lovedna.game.render._CameraRenderData.SortCommandBuffer"]=gd;gd.__name__=["lovedna","game","render","_CameraRenderData","SortCommandBuffer"];gd.__interfaces__=[Vd];gd.prototype={add:function(a){var b=Sa.getRenderQueue(a.renderQueue),c=null;2E4==b?(null==this._geometry&&(this._geometry=new Cb(2E4)),c=this._geometry):4E4==b?(null==
this._ui&&(this._ui=new Cb(4E4)),c=this._ui):3E4==b?(null==this._transparent&&(this._transparent=new Cb(3E4)),c=this._transparent):1E4==b?(null==this._background&&(this._background=new Cb(1E4)),c=this._background):5E4==b&&(null==this._overlay&&(this._overlay=new Cb(5E4)),c=this._overlay);null!=c&&c.add(a)},copyTo:function(a){null!=this._background&&this._background.fill(a);null!=this._geometry&&this._geometry.fill(a);null!=this._transparent&&this._transparent.fill(a);null!=this._ui&&this._ui.fill(a);
null!=this._overlay&&this._overlay.fill(a)},__class__:gd};var Za=function(a){this.type=a;this._changed=!1};f["lovedna.game.render._CameraRenderData.SortProcess"]=Za;Za.__name__=["lovedna","game","render","_CameraRenderData","SortProcess"];Za.prototype={add:function(a){},fill:function(a){},sort:function(a,b){a=a.sortId;b=b.sortId;return a!=b?a-b:0},__class__:Za};var Cb=function(a){Za.call(this,a);this._map=new Z;this._list=[]};f["lovedna.game.render._CameraRenderData.SortQueue"]=Cb;Cb.__name__=["lovedna",
"game","render","_CameraRenderData","SortQueue"];Cb.__super__=Za;Cb.prototype=r(Za.prototype,{add:function(a){var b=a.renderQueue;if(this._map.h.hasOwnProperty(b))var c=this._list[this._map.h[b]];else c=new hd(this.type),c.sortId=b,this._map.h[b]=this._list.length,this._list.push(c),this._changed=!0;c.add(a)},fill:function(a){if(this._changed){this._list.sort(q(this,this.sort));for(var b=this._map.keys();b.hasNext();){var c=b.next();this._map.remove(c)}for(b=this._list.length;0<b--;)this._map.h[this._list[b].sortId]=
b;this._changed=!1}b=this._list.length;if(!(1>b))for(c=0;c<b;){var d=c++;this._list[d].fill(a)}},__class__:Cb});var hd=function(a){Za.call(this,a);this._map=new Z;this._list=[]};f["lovedna.game.render._CameraRenderData.SortShader"]=hd;hd.__name__=["lovedna","game","render","_CameraRenderData","SortShader"];hd.__super__=Za;hd.prototype=r(Za.prototype,{add:function(a){var b=a.shaderId;if(this._map.h.hasOwnProperty(b))var c=this._list[this._map.h[b]];else c=new id(this.type),c.sortId=b,this._map.h[b]=
this._list.length,this._list.push(c),this._changed=!0;c.add(a)},fill:function(a){if(this._changed){this._list.sort(q(this,this.sort));this._changed=!1;for(var b=this._map.keys();b.hasNext();){var c=b.next();this._map.remove(c)}for(b=this._list.length;0<b--;)this._map.h[this._list[b].sortId]=b}b=0;for(c=this._list.length;b<c;){var d=b++;this._list[d].fill(a)}},__class__:hd});var id=function(a){Za.call(this,a);this._list=[]};f["lovedna.game.render._CameraRenderData.SortDistance"]=id;id.__name__=["lovedna",
"game","render","_CameraRenderData","SortDistance"];id.__super__=Za;id.prototype=r(Za.prototype,{add:function(a){this._list.push(a);this._changed=!0},fill:function(a){this._changed&&(this._list.sort(q(this,this.sorta)),this._changed=!1);for(var b=0,c=this._list.length;b<c;){var d=b++;a.push(this._list[d])}this._list.splice(0,this._list.length)},sorta:function(a,b){var c=a.renderIndex,d=b.renderIndex;if(c!=d)return c-d;a=a.distance;b=b.distance;return a!=b?3E4>=this.type?0<a-b?1:-1:0<a-b?-1:1:0},__class__:id});
var Wd=g.lovedna.game.render.IRenderBufferCommands=function(){};f["lovedna.game.render.IRenderBufferCommands"]=Wd;Wd.__name__=["lovedna","game","render","IRenderBufferCommands"];Wd.prototype={__class__:Wd};var Kc=g.lovedna.game.render.GameRenderCommandBuffer=function(){this.position=-1;this._list=new O;this.debug=!1};f["lovedna.game.render.GameRenderCommandBuffer"]=Kc;Kc.__name__=["lovedna","game","render","GameRenderCommandBuffer"];Kc.__interfaces__=[Wd];Kc.prototype={push:function(a){this._list.push(a)},
clear:function(){this._list.clear();S.$length=0},flush:function(){var a=this._list.get_length();0>this.position&&(this.position=0);this.position>a&&(this.position=a);for(var b=0;b<a;){var c=b++;if(this.debug&&c>this.position)break;this._list.getElement(c).execute()}},__class__:Kc};var lc=g.lovedna.game.render.RenderBufferContex=function(){this.globalUniforms=new mb;this.globalDefine=new hb;this.currentUniforms=new mb;this.currentVertexBuffers=new O};f["lovedna.game.render.RenderBufferContex"]=lc;
lc.__name__=["lovedna","game","render","RenderBufferContex"];lc.prototype={clearGlobal:function(){this.globalUniforms.clear();this.globalDefine.clear()},clearCurrent:function(){this.currentVertexBuffers.clear();this.currentUniforms.clear();this.currentMeshBuffer=this.currentIndexBuffer=this.currentMaterial=null},__class__:lc};var jd=g.lovedna.geom.Shape3D=function(){};f["lovedna.geom.Shape3D"]=jd;jd.__name__=["lovedna","geom","Shape3D"];jd.prototype={__class__:jd};var dd=g.lovedna.geom.Box3=function(){this.min=
new m;this.max=new m;this._centerHelp=new m;this._dirty=null;this.points=[];for(var a=0;8>a;)a++,this.points.push(new m)};f["lovedna.geom.Box3"]=dd;dd.__name__=["lovedna","geom","Box3"];dd.__interfaces__=[jd];dd.prototype={dispose:function(){this.points=this._centerHelp=this.max=this.min=null},toString:function(){return"Box33["+T.string(this.min)+" "+T.string(this.max)+"]"},update:function(){this._dirty=null;this.enabled=!0},reset:function(){var a=this.min;a.x=1.79769313486231E308;a.y=1.79769313486231E308;
a.z=1.79769313486231E308;a=this.max;a.x=-1.79769313486231E308;a.y=-1.79769313486231E308;a.z=-1.79769313486231E308;this.enabled=!1;return this},copy:function(a){this.max.copy(a.max);this.min.copy(a.min);this.update();return this},set:function(a,b){a.copy(a);b.copy(b);this.update();return this},expand:function(a){this.min.min(a);this.max.max(a);this.update();return this},addWith:function(a){return this.expand(a.min).expand(a.max)},multiplyMatrix44:function(a){var b=m.get_one(),c=m.get_one();b.copy(this.min);
c.copy(this.max);this.reset();this.expand(a.transformVector(this.points[0].copy(b)));var d=this.points[1];d.x=b.x;d.y=b.y;d.z=c.z;this.expand(a.transformVector(d));d=this.points[2];d.x=c.x;d.y=b.y;d.z=c.z;this.expand(a.transformVector(d));d=this.points[3];d.x=c.x;d.y=b.y;d.z=b.z;this.expand(a.transformVector(d));d=this.points[4];d.x=b.x;d.y=c.y;d.z=b.z;this.expand(a.transformVector(d));d=this.points[5];d.x=b.x;d.y=c.y;d.z=c.z;this.expand(a.transformVector(d));this.expand(a.transformVector(this.points[6].copy(c)));
d=this.points[7];d.x=c.x;d.y=c.y;d.z=b.z;this.expand(a.transformVector(d));return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z?a.max.z<=this.max.z:!1},intersectsBox:function(a){var b=a.min;a=a.max;return this.min.x>a.x||this.max.x<b.x||this.min.y>a.y||this.max.y<b.y||this.min.z>
a.z||this.max.z<b.z?!1:!0},intersectsPlane:function(a){var b=0;if(0<a.normal.x)var c=a.normal.x*this.max.x;else c=a.normal.x*this.max.x,b=a.normal.x*this.min.x;0<a.normal.y?(c+=a.normal.y*this.min.y,b+=a.normal.y*this.max.y):(c+=a.normal.y*this.max.y,b+=a.normal.y*this.min.y);0<a.normal.z?(c+=a.normal.z*this.min.z,b+=a.normal.z*this.max.z):(c+=a.normal.z*this.max.z,b+=a.normal.z*this.min.z);return c<=a.distance?b>=a.distance:!1},distanceToPoint:function(a){a=this.clampPoint(a).sub(a);return Math.sqrt(a.x*
a.x+a.y*a.y+a.z*a.z)},clampPoint:function(a){return m.get_one().copy(a).clamp(this.min,this.max)},getSize:function(){return m.get_one().copy(this.max).sub(this.min)},getFarthestPointInDirection:function(a){for(var b=this.points.length,c=this.points[0],d=a.dot(c),e,h=1;h<b;){e=h++;var f=this.points[e];e=a.dot(f);e>d&&(d=e,c=f)}return m.get_one().copy(c)},getCenter:function(){null==this._dirty&&(this._dirty=this._centerHelp,this._dirty.copy(this.min).add(this.max).scale(.5));return this._dirty},__class__:dd};
var Xd=g.lovedna.geom.Shape2D=function(){};f["lovedna.geom.Shape2D"]=Xd;Xd.__name__=["lovedna","geom","Shape2D"];Xd.prototype={__class__:Xd};var zc=g.lovedna.geom.Circle=function(a,b){this._center=new v;this._center.copy(a);this.enabled=!0;this.radius=b};f["lovedna.geom.Circle"]=zc;zc.__name__=["lovedna","geom","Circle"];zc.__interfaces__=[Xd];zc.prototype={getCenter:function(){return this._center},getFarthestPointInDirection:function(a){return v._pool.get().copy(a).normalize().scale(this.radius).add(this._center)},
set:function(a,b){this._center.copy(a);this.radius=b;return this},copy:function(a){if(a==this)return this;this._center.copy(a._center);this.radius=a.radius;return this},containsPoint:function(a){return a.distanceSquared(this._center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distance(this._center)-this.radius},intersectsCircle:function(a){var b=this.radius+a.radius;return a._center.distanceSquared(this._center)<=b*b},Equals:function(a){var b=this._center,c=a._center;return b.x==
c.x&&b.y==c.y?this.radius==a.radius:!1},dispose:function(){this._center=null},__class__:zc};var Ld=g.lovedna.geom.Frustum=function(){this.planes=[];this.near=new Db;this.far=new Db;this.left=new Db;this.right=new Db;this.top=new Db;this.bottom=new Db;this.planes.push(this.near);this.planes.push(this.far);this.planes.push(this.left);this.planes.push(this.right);this.planes.push(this.top);this.planes.push(this.bottom)};f["lovedna.geom.Frustum"]=Ld;Ld.__name__=["lovedna","geom","Frustum"];Ld.prototype=
{dispose:function(){if(null!=this.planes){for(var a=this.planes.length;0<a--;)this.planes[a].dispose();this.planes=null}this.near.dispose();this.far.dispose();this.left.dispose();this.right.dispose();this.top.dispose();this.bottom.dispose();this.bottom=this.top=this.right=this.left=this.far=this.near=null},toString:function(){var a="near "+this.planes[0].toString()+"\n";a+="far "+this.planes[1].toString()+"\n";a+="left "+this.planes[2].toString()+"\n";a+="right "+this.planes[3].toString()+"\n";a+=
"top "+this.planes[4].toString()+"\n";return a+="bottom "+this.planes[5].toString()+"\n"},copy:function(a){if(a==this)return this;for(var b=6;0<b--;)this.planes[b].copy(a.planes[b]);return this},set:function(a,b,c,d,e,h){this.planes[0].copy(a);this.planes[1].copy(b);this.planes[2].copy(c);this.planes[3].copy(d);this.planes[4].copy(e);this.planes[5].copy(h);return this},containsPoint:function(a,b){null==b&&(b=0);for(var c=6;0<c--;)if(this.planes[c].distanceToPoint(a)<-b)return!1;return!0},intersectsSphere:function(a){return null==
a?!1:this.containsPoint(a.center,a.radius)},intersectsBox:function(a){if(null==a)return!1;for(var b=m.get_one(),c=m.get_one(),d=6;0<d--;){var e=this.planes[d],h=e.normal.x,f=e.normal.y,g=e.normal.z;b.x=0<h?a.min.x:a.max.x;b.y=0<f?a.min.y:a.max.y;b.z=0<g?a.min.z:a.max.z;c.x=0<h?a.max.x:a.min.x;c.y=0<f?a.max.y:a.min.y;c.z=0<g?a.max.z:a.min.z;if(0>e.distanceToPoint(b)&&0>e.distanceToPoint(c))return!1}return!0},multiplyMatrix44:function(a){if(null==a)return this;var b=a.m0,c=a.m1,d=a.m2,e=a.m3,h=a.m4,
f=a.m5,g=a.m6,k=a.m7,l=a.m8,m=a.m9,n=a.m10,p=a.m11,q=a.m12,t=a.m13,r=a.m14;a=a.m15;this.planes[0].set(e+d,k+g,p+n,a+r);this.planes[1].set(e-d,k-g,p-n,a-r);this.planes[2].set(e+b,k+h,p+l,a+q);this.planes[3].set(e-b,k-h,p-l,a-q);this.planes[4].set(e-c,k-f,p-m,a-t);this.planes[5].set(e+c,k+f,p+m,a+t);return this},__class__:Ld};var Db=g.lovedna.geom.Plane=function(){this.normal=new m(0,0,1);this.distance=0};f["lovedna.geom.Plane"]=Db;Db.__name__=["lovedna","geom","Plane"];Db.prototype={dispose:function(){this.normal=
null},toString:function(){return"Plane("+T.string(this.normal)+" "+this.distance+")"},copy:function(a){this.normal.copy(a.normal);this.distance=a.distance;return this},setFromNormalAndDistance:function(a,b){this.normal.copy(a);this.distance=b;return this},setFromNormalAndPoint:function(a,b){this.normal.copy(a);this.distance=-this.normal.dot(b);return this},SetFromPoints:function(a,b,c){var d=m.get_zero();d.copy(a);d.sub(b);this.normal.copy(a);this.normal.sub(c);this.normal.cross(d);this.normal.normalize();
this.distance=-a.dot(this.normal);return this},distanceToPoint:function(a){return this.normal.dot(a)+this.distance},nearPoint:function(a){var b=this.distanceToPoint(a),c=m.get_one();c.copy(this.normal);c.scale(b);return m.get_one().copy(a).sub(c)},set:function(a,b,c,d){var e=this.normal;e.x=a;e.y=b;e.z=c;this.distance=d;this.normalize()},normalize:function(){var a=this.normal;a=1/Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);this.normal.scale(a);this.distance*=a},__class__:Db};var m=g.lovedna.math.Vector3=function(a,
b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c};f["lovedna.math.Vector3"]=m;m.__name__=["lovedna","math","Vector3"];m.__interfaces__=[vb,Kb];m.__properties__={get_one:"get_one",get_zero:"get_zero",get_left:"get_left",get_right:"get_right",get_down:"get_down",get_up:"get_up",get_backward:"get_backward",get_forward:"get_forward",get_temp:"get_temp"};m.get_temp=function(){return m._pool.get()};m.get_forward=function(){var a=m._pool.get();a.x=0;a.y=0;a.z=1;return a};m.get_backward=
function(){var a=m._pool.get();a.x=0;a.y=0;a.z=-1;return a};m.get_up=function(){var a=m._pool.get();a.x=0;a.y=1;a.z=0;return a};m.get_down=function(){var a=m._pool.get();a.x=0;a.y=-1;a.z=0;return a};m.get_right=function(){var a=m._pool.get();a.x=1;a.y=0;a.z=0;return a};m.get_left=function(){var a=m._pool.get();a.x=-1;a.y=0;a.z=0;return a};m.get_zero=function(){var a=m._pool.get();a.x=0;a.y=0;a.z=0;return a};m.get_one=function(){var a=m._pool.get();a.x=1;a.y=1;a.z=1;return a};m.prototype={toString:function(){return"Vector3("+
n.fixed(this.x,4)+","+n.fixed(this.y,4)+","+n.fixed(this.z,4)+")"},fixed:function(a){null==a&&(a=4);return"Vector3("+n.fixed(this.x,a)+","+n.fixed(this.y,a)+","+n.fixed(this.z,a)+")"},set:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;return this},copy:function(a){if(null==a||a==this)return this;this.x=a.x;this.y=a.y;this.z=a.z;return this},from:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},clone:function(){return new m(this.x,this.y,this.z)},add:function(a,
b){var c=null==b,d=c?this:a;a=c?a:b;this.x=d.x+a.x;this.y=d.y+a.y;this.z=d.z+a.z;return this},sub:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;this.x=d.x-a.x;this.y=d.y-a.y;this.z=d.z-a.z;return this},mul:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;this.x=d.x*a.x;this.y=d.y*a.y;this.z=d.z*a.z;return this},dot:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return d.x*a.x+d.y*a.y+d.z*a.z},cross:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;b=d.z*a.x-d.x*a.z;c=d.x*a.y-d.y*a.x;this.x=d.y*a.z-d.z*
a.y;this.y=b;this.z=c;return this},min:function(a,b){var c=null==b,d=c?this:a,e=c?a:b;a=d.x;b=e.x;c=d.y;var h=e.y;d=d.z;e=e.z;this.x=a<b?a:b;this.y=c<h?c:h;this.z=d<e?d:e;return this},max:function(a,b){var c=null==b,d=c?this:a,e=c?a:b;a=d.x;b=e.x;c=d.y;var h=e.y;d=d.z;e=e.z;this.x=a>b?a:b;this.y=c>h?c:h;this.z=d>e?d:e;return this},clamp:function(a,b){var c=this.x,d=a.x,e=b.x,h=this.y,f=a.y,g=b.y,k=this.z;a=a.z;b=b.z;this.x=c<d?d:c>e?e:c;this.y=h<f?f:h>g?g:h;this.z=k<a?a:k>b?b:k;return this},scale:function(a){this.x*=
a;this.y*=a;this.z*=a;return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(0!=a)return this.scale(1/a);this.z=this.y=this.x=0;return this},distanceSquared:function(a,b){var c=null==b,d=c?this:a;c=c?a:b;a=d.x-c.x;b=d.y-c.y;d=d.z-c.z;return a*a+b*b+d*d},distance:function(a,b){return Math.sqrt(this.distanceSquared(a,b))},equals:function(a){return this.x==a.x&&this.y==a.y?this.z==a.z:
!1},isZero:function(){return 1E-7>n.abs(this.x)&&1E-7>n.abs(this.y)?1E-7>n.abs(this.z):!1},isOne:function(){return 1E-7>n.abs(this.x-1)&&1E-7>n.abs(this.y-1)?1E-7>n.abs(this.z-1):!1},angleTo:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;b=Math.sqrt(d.x*d.x+d.y*d.y+d.z*d.z);c=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);return 0<b&&0<c?57.29577951308232*Math.acos(d.dot(a)/(b*c)):0},lerpTo:function(a,b){if(0>=b)return this;if(1<=b)return this.copy(a);this.x+=b*(a.x-this.x);this.y+=b*(a.y-this.y);this.z+=b*(a.z-
this.z);return this},projectOnto:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;c=a.dot(a);if(0==c)return this.z=this.y=this.x=0,this;d=d.dot(a)/c;return this.copy(b).scale(d)},projectOntoPlane:function(a){var b=m._pool.get(),c=a.dot(a);0==c?(b.x=0,b.y=0,b.z=0):(a=b.dot(a)/c,b=b.copy(null).scale(a));return this.sub(b)},reflectBy:function(a){var b=m._pool.get().copy(this),c=a.dot(a);0==c?(b.x=0,b.y=0,b.z=0):(a=b.dot(a)/c,b=b.copy(null).scale(a));b.scale(2);return this.sub(b)},rotateLeft:function(){var a=
-this.y;this.y=this.x;this.x=a;return this},rotateRight:function(){var a=this.y;this.y=-this.x;this.x=a;return this},getElement:function(a){0>a?a=a%3+3:3<=a&&(a%=3);return 0==a?this.x:1==a?this.y:this.z},setElement:function(a,b){0>a?a=a%3+3:3<=a&&(a%=3);0==a?this.x=b:1==a?this.y=b:this.z=b},fillArray:function(a,b){null==b&&(b=0);a[b++]=this.x;a[b++]=this.y;a[b++]=this.z},fromArray:function(a,b){null==b&&(b=0);if(null==a)return this;var c=a.length;b<c&&(this.x=a[b++]);b<c&&(this.y=a[b++]);b<c&&(this.z=
a[b++]);return this},get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},get_lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},__class__:m,__properties__:{get_lengthSq:"get_lengthSq",get_length:"get_length"}};var jb=g.lovedna.geom.Ray=function(){this.start=new m;this.direction=new m};f["lovedna.geom.Ray"]=jb;jb.__name__=["lovedna","geom","Ray"];jb.__properties__={get_temp:"get_temp"};jb.get_temp=function(){return jb._pool.get()};jb.prototype={copy:function(a){if(a==
this)return this;this.start.copy(a.start);this.direction.copy(a.direction);return this},set:function(a,b){this.start.copy(a);this.direction.sub(b,a);this.direction.normalize();return this},at:function(a){var b=m._pool.get();b.copy(this.direction);b.scale(a);b.add(this.start);return b},lookAt:function(a){this.direction.copy(a).sub(this.start).normalize();return this},closestPoint:function(a){var b=m._pool.get();b.sub(a,this.start);a=b.dot(this.direction);0>a?b.copy(this.start):this.at(a);return b},
DistanceToPoint:function(a){var b=m._pool.get();b.sub(a,this.start);b=b.dot(this.direction);return 0>b?this.start.distance(a):this.at(b).distance(a)},DistanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0==b)return 0==a.distanceToPoint(this.start)?0:-1;a=-(this.start.dot(a.normal)+a.distance)/b;return 0<=a?a:-1},intersectPlane:function(a){a=this.DistanceToPlane(a);return-1==a?null:this.at(a)},crossPlane:function(a){var b=a.distanceToPoint(this.start);return 0==b||0>a.normal.dot(this.direction)*
b?!0:!1},intersectSphere:function(a){var b=m._pool.get();b.sub(a.center,this.start);var c=this.direction.dot(b);b=b.dot(b)-c*c;a=a.radius*a.radius;if(b>a)return null;b=Math.sqrt(a-b);a=c-b;c+=b;return 0>a&&0>c?null:0>a?this.at(c):this.at(a)},crossSphere:function(a){return null==a?!1:this.DistanceToPoint(a.center)<=a.radius},intersectBox:function(a){var b=0!=this.direction.x?1/this.direction.x:0;var c=0!=this.direction.y?1/this.direction.y:0;var d=0!=this.direction.z?1/this.direction.z:0,e=this.start;
if(0<=b){var h=(a.min.x-e.x)*b;b*=a.max.x-e.x}else h=(a.max.x-e.x)*b,b*=a.min.x-e.x;if(0<=c){var f=(a.min.y-e.y)*c;c*=a.max.y-e.y}else f=(a.max.y-e.y)*c,c*=a.min.y-e.y;if(h>c||f>b)return null;if(f>h||h!=h)h=f;if(c<b||b!=b)b=c;0<=d?(f=(a.min.z-e.z)*d,a=(a.max.z-e.z)*d):(f=(a.max.z-e.z)*d,a=(a.min.z-e.z)*d);if(h>a||f>b)return null;if(f>h||h!=h)h=f;if(a<b||b!=b)b=a;return 0>b?null:this.at(0<=h?h:b)},intersectTriangle:function(a,b,c,d){null==d&&(d=!1);var e=m._pool.get(),h=m._pool.get(),f=m._pool.get(),
g=m._pool.get();h.sub(b,a);f.sub(c,a);g.cross(h,f);b=this.direction.dot(g);if(0<b){if(d)return null;d=1}else if(0>b)d=-1,b=-b;else return null;e.sub(this.start,a);a=d*this.direction.dot(f.cross(e,f));if(0>a)return null;h=d*this.direction.dot(h.cross(e));if(0>h||a+h>b)return null;e=-d*e.dot(g);return 0>e?null:this.at(e/b)},multiplyMatrix44:function(a){a.transformVector(this.direction.add(this.start));a.transformVector(this.start);this.direction.sub(this.start);this.direction.normalize();return this},
toString:function(){return"Ray("+T.string(this.start)+" "+T.string(this.direction)+")"},__class__:jb};var lb=g.lovedna.geom.Rect=function(a,b,c,d){null==d&&(d=1);null==c&&(c=1);null==b&&(b=0);null==a&&(a=0);this._vec2=new v;Q.call(this,a,b,c,d);this.x=a;this.y=b;this.set_width(c);this.set_height(d)};f["lovedna.geom.Rect"]=lb;lb.__name__=["lovedna","geom","Rect"];lb.__super__=Q;lb.prototype=r(Q.prototype,{setScale:function(a,b){this.x*=a;this.y*=b;this.set_width(this.z*a);this.set_height(this.w*b);
return this},setSize:function(a,b){this.set_width(a);this.set_height(b);return this},setPosition:function(a,b){this.x=a;this.y=b;return this},setEdge:function(a,b,c,d){this.x=a;this.y=c;this.set_width(this.z-(a+b));this.set_height(this.w-(c+d));return this},setEdgeFromRect:function(a){this.x=a.x;this.y=a.y;this.set_width(this.z-(a.x+a.z));this.set_height(this.w-(a.y+a.w));return this},normalize:function(a){this.x/=a.x;this.set_width(this.z/a.x);this.y/=a.y;this.set_height(this.w/a.y);return this},
contains:function(a,b){return a>=this.x&&b>=this.y&&a<this.get_right()?b<this.get_bottom():!1},containsPoint:function(a){return this.contains(a.x,a.y)},containsRect:function(a){return 0>=a.z||0>=a.w?a.x>this.x&&a.y>this.y&&a.get_right()<this.get_right()?a.get_bottom()<this.get_bottom():!1:a.x>=this.x&&a.y>=this.y&&a.get_right()<=this.get_right()?a.get_bottom()<=this.get_bottom():!1},overlap:function(a,b){null==b&&(b=0);var c=lb._helpVec0,d=lb._helpVec1,e=.5*a.z+b,h=.5*a.w+b,f=.5*this.z+b;b=.5*this.w+
b;var g=a.get_left()+e;a=a.get_top()+h;c.x=g;c.y=a;a=this.get_left()+f;g=this.get_top()+b;d.x=a;d.y=g;return n.abs(c.x-d.x)<=e+f?n.abs(c.y-d.y)<=h+b:!1},isEmpty:function(){return 0>=this.z?!0:0>=this.w},set_width:function(a){return this.z=a},get_width:function(){return this.z},get_height:function(){return this.w},set_height:function(a){return this.w=a},get_bottom:function(){return this.y+this.w},set_bottom:function(a){this.set_height(a-this.y);return a},get_left:function(){return this.x},set_left:function(a){this.set_width(this.z-
(a-this.x));return this.x=a},get_right:function(){return this.x+this.z},set_right:function(a){this.set_width(a-this.x);return a},get_size:function(){var a=this._vec2;a.x=this.z;a.y=this.w;return a},set_size:function(a){this.set_width(a.x);this.set_height(a.y);return a},get_top:function(){return this.y},set_top:function(a){this.set_height(this.w-(a-this.y));return this.y=a},__class__:lb,__properties__:{set_top:"set_top",get_top:"get_top",set_size:"set_size",get_size:"get_size",set_right:"set_right",
get_right:"get_right",set_left:"set_left",get_left:"get_left",set_bottom:"set_bottom",get_bottom:"get_bottom",set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width"}});var ed=g.lovedna.geom.Sphere=function(){this.radius=0;this.center=new m(0,0,0);this.enabled=!0};f["lovedna.geom.Sphere"]=ed;ed.__name__=["lovedna","geom","Sphere"];ed.__interfaces__=[jd];ed.prototype={dispose:function(){this.center=null},toString:function(){return"Sphere["+T.string(this.center)+
" "+this.radius+"]"},getCenter:function(){return this.center},getFarthestPointInDirection:function(a){return m.get_one().copy(a).normalize().scale(this.radius).add(this.center)},set:function(a,b){this.center.copy(a);this.radius=b;return this},copy:function(a){if(a==this)return this;var b=a.radius;this.center.copy(a.center);this.radius=b;return this},multiplyMatrix44:function(a){a.transformVector(this.center);this.radius*=1E-7>n.abs(a.m4)&&1E-7>n.abs(a.m8)?n.abs(a.m0):Math.sqrt(a.m0*a.m0+a.m4*a.m4+
a.m8*a.m8);return this},containsPoint:function(a){return a.distanceSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distance(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceSquared(this.center)<=b*b},equals:function(a){var b=this.center,c=a.center;return b.x==c.x&&b.y==c.y&&b.z==c.z?this.radius==a.radius:!1},__class__:ed};var Od=g.lovedna.math.HsvColor=function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&
(a=0);this.h=a;this.s=b;this.v=c};f["lovedna.math.HsvColor"]=Od;Od.__name__=["lovedna","math","HsvColor"];Od.prototype={set:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=0);this.h=a;this.s=b;this.v=c;return this},fromColor:function(a){var b=255*a.x,c=255*a.y;a=255*a.z;var d=b>c?b:c;d>a||(d=a);var e=b<c?b:c;e<a||(e=a);this.v=d/255;this.s=(d-e)/d;e=60*(d-e);b==d&&(this.h=(c-a)/e);c==d&&(this.h=120+(a-b)/e);a==d&&(this.h=240+(b-c)/e);0>this.h&&(this.h+=360);return this},toColor:function(){var a=
new ca;if(0==this.s)return a.x=this.v,a.y=this.v,a.z=this.v,a.w=1,a;var b=this.h%360/60,c=b|0,d=b-c;b=this.v*(1-this.s);var e=this.v*(1-this.s*d);d=this.v*(1-this.s*(1-d));switch(c){case 0:a.x=this.v;a.y=d;a.z=b;a.w=1;break;case 1:a.x=e;a.y=this.v;a.z=b;a.w=1;break;case 2:a.x=b;a.y=this.v;a.z=d;a.w=1;break;case 3:a.x=b;a.y=e;a.z=this.v;a.w=1;break;case 4:a.x=d;a.y=b;a.z=this.v;a.w=1;break;case 5:a.x=this.v,a.y=b,a.z=e,a.w=1}return a},__class__:Od};var ja=g.lovedna.math.Quaternion=function(a,b,c,d){null==
d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d};f["lovedna.math.Quaternion"]=ja;ja.__name__=["lovedna","math","Quaternion"];ja.__interfaces__=[vb,Kb];ja.__properties__={get_temp:"get_temp"};ja.get_temp=function(){return ja._pool.get()};ja.prototype={toString:function(){return this.fixed(4)},fixed:function(a){null==a&&(a=4);return"Quaternion("+n.fixed(this.x,a)+","+n.fixed(this.y,a)+","+n.fixed(this.z,a)+","+n.fixed(this.w,a)+")"},set:function(a,b,c,d){null==
d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d;return this},copy:function(a){if(null==a||a==this)return this;this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},from:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},clone:function(){return new ja(this.x,this.y,this.z,this.w)},equals:function(a){return this.x==a.x&&this.y==a.y&&this.z==a.z?this.w==a.w:!1},add:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;this.x=d.x+a.x;this.y=d.y+
a.y;this.z=d.z+a.z;this.w=d.w+a.w;return this},sub:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;this.x=d.x-a.x;this.y=d.y-a.y;this.z=d.z-a.z;this.w=d.w-a.w;return this},dot:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;return d.x*a.x+d.y*a.y+d.z*a.z+d.w*a.w},identity:function(){this.z=this.y=this.x=0;this.w=1;return this},isIdentity:function(){return 0==this.x&&0==this.y&&0==this.z?1==this.w:!1},isZero:function(){return 0==this.x&&0==this.y&&0==this.z?1==this.w:!1},normalize:function(){var a=Math.sqrt(this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0==a)return this.z=this.y=this.x=0,this.w=1,this;a=1/a;this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},inverse:function(){this.x*=-1;this.y*=-1;this.z*=-1;this.w=this.w;return this.normalize()},conjugate:function(){this.x*=-1;this.y*=-1;this.z*=-1;this.w=this.w;return this},mul:function(a,b){var c=null==b,d=c?this:a;a=c?a:b;b=d.w*a.y+d.y*a.w+d.z*a.x-d.x*a.z;c=d.w*a.z+d.z*a.w+d.x*a.y-d.y*a.x;var e=d.w*a.w-d.x*a.x-d.y*a.y-d.z*a.z;this.x=d.w*
a.x+d.x*a.w+d.y*a.z-d.z*a.y;this.y=b;this.z=c;this.w=e;return this},rotate:function(a){var b=a.x,c=a.y,d=a.z,e=this.w*b+this.y*d-this.z*c,h=this.w*c+this.z*b-this.x*d,f=this.w*d+this.x*c-this.y*b;b=-this.x*b-this.y*c-this.z*d;c=h*this.w+b*-this.y+f*-this.x-e*-this.z;d=f*this.w+b*-this.z+e*-this.y-h*-this.x;a.x=e*this.w+b*-this.x+h*-this.z-f*-this.y;a.y=c;a.z=d;return a},setEulerAngles:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);a*=.017453292519943295;b*=.017453292519943295;var d=
Math.sin,e=Math.cos,h=.008726646259971648*c;c=d(h);h=e(h);var f=.5*a;a=d(f);f=e(f);b*=.5;d=d(b);var g=e(b);e=g*a;b=d*f;f*=g;a*=d;this.x=e*h+b*c;this.y=b*h-e*c;this.z=f*c-a*h;this.w=f*h+a*c;return this},getEulerAngles:function(a){null==a&&(a=m._pool.get());var b=this.x*this.x,c=this.y*this.y,d=this.z*this.z,e=this.y*this.x+this.z*this.w;e=.4999<e?1:-.4999>e?-1:0;0==e?(e=2*(this.w*this.x-this.z*this.y),a.x=Math.asin(-1>e?-1:1<e?1:e),a.y=Math.atan2(2*(this.y*this.w+this.x*this.z),1-2*(c+b)),a.z=Math.atan2(2*
(this.w*this.z+this.y*this.x),1-2*(b+d))):(a.x=1.5707963267948966*e,a.y=0,a.z=2*e*Math.atan2(this.y,this.w));a.scale(57.29577951308232);return a},distance:function(a,b){a=this.dot(a,b);return 1-a*a},angle:function(a,b){a=this.dot(a,b);return 57.29577951308232*Math.acos(2*a*a-1)},lookAt:function(a,b,c){return this.setLookAt(m._pool.get().sub(b,a).normalize(),c)},setLookAt:function(a,b){null==b&&(b=m.get_up());var c=m._pool.get(),d=m._pool.get();c.copy(b).cross(a).normalize();d.copy(a).cross(c).normalize();
this.setFromAxes(c.x,d.x,a.x,c.y,d.y,a.y,c.z,d.z,a.z);return this},setFromAxes:function(a,b,c,d,e,h,f,g,k){var l=a+e+k;0<=l?(a=Math.sqrt(l+1),this.w=.5*a,a=.5/a,this.x=(g-h)*a,this.y=(c-f)*a,this.z=(d-b)*a):a>e&&a>k?(a=Math.sqrt(1+a-e-k),this.x=.5*a,a=.5/a,this.y=(d+b)*a,this.z=(c+f)*a,this.w=(g-h)*a):e>k?(a=Math.sqrt(1+e-a-k),this.y=.5*a,a=.5/a,this.x=(d+b)*a,this.z=(g+h)*a,this.w=(c-f)*a):(a=Math.sqrt(1+k-a-e),this.z=.5*a,a=.5/a,this.x=(c+f)*a,this.y=(g+h)*a,this.w=(d-b)*a);return this},slerpTo:function(a,
b){if(0>=b)return this;if(1<=b)return this.copy(a),this;var c=this.dot(a),d=n.abs(c),e=1-b,h=b;if(.1<1-d){d=Math.acos(d);h=Math.sin;var f=1/h(d);e=h((1-b)*d)*f;h=h(b*d)*f}0>c&&(h=-h);this.x=e*this.x+h*a.x;this.y=e*this.y+h*a.y;this.z=e*this.z+h*a.z;this.w=e*this.w+h*a.w;return this},slerp:function(a,b,c){this.copy(a);a=this.x;var d=this.y,e=this.z,h=this.w,f=this.w*b.w+this.x*b.x+this.y*b.y+this.z*b.z;0>f?(this.w=-b.w,this.x=-b.x,this.y=-b.y,this.z=-b.z,f=-f):this.copy(b);if(1<=f)return this.w=h,
this.x=a,this.y=d,this.z=e,this;b=Math.acos(f);var g=Math.sqrt(1-f*f);if(.001>Math.abs(g))return this.w=.5*(h+this.w),this.x=.5*(a+this.x),this.y=.5*(d+this.y),this.z=.5*(e+this.z),this;f=Math.sin((1-c)*b)/g;c=Math.sin(c*b)/g;this.w=h*f+this.w*c;this.x=a*f+this.x*c;this.y=d*f+this.y*c;this.z=e*f+this.z*c;return this},getElement:function(a){0>a?a=a%4+4:4<=a&&(a%=4);switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w}return 0},setElement:function(a,b){0>a?a=
a%4+4:4<=a&&(a%=4);switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b}},fillArray:function(a,b){null==b&&(b=0);a[b++]=this.x;a[b++]=this.y;a[b++]=this.z;a[b++]=this.w},fromArray:function(a,b){null==b&&(b=0);if(null==a)return this;var c=a.length;b<c&&(this.x=a[b++]);b<c&&(this.y=a[b++]);b<c&&(this.z=a[b++]);b<c&&(this.w=a[b++]);return this},get_lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},get_length:function(){return Math.sqrt(this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w)},__class__:ja,__properties__:{get_lengthSq:"get_lengthSq",get_length:"get_length"}};var Jb=g.lovedna.net.BytesLoader=function(){this._workerState=0;this.method="GET"};f["lovedna.net.BytesLoader"]=Jb;Jb.__name__=["lovedna","net","BytesLoader"];Jb.prototype={load:function(a){Jb.workerEnable&&0==this._workerState&&(this._workerState=null==window.Worker?-1:1);if(Jb.workerEnable&&1==this._workerState)this._worker=new Worker("worker.js"),this._worker.postMessage(a),
this._worker.onmessage=q(this,this.onWorkerMessage);else{null==this._xmlHttpRequest&&(this._xmlHttpRequest=new XMLHttpRequest);this._xmlHttpRequest.responseType="arraybuffer";this._xmlHttpRequest.onreadystatechange=q(this,this.readyStateChange);this._xmlHttpRequest.open(this.method,a,!0);try{var b=this.bytes;this.bytes=null;null!=b?this._xmlHttpRequest.send(b.b.bufferValue):this._xmlHttpRequest.send(null)}catch(c){U.trace("load error",{fileName:"BytesLoader.hx",lineNumber:89,className:"lovedna.net.BytesLoader",
methodName:"load"})}}},readyStateChange:function(a){if(4==this._xmlHttpRequest.readyState){a=this._xmlHttpRequest.status;if(200<=a&&400>a||0==a&&""==this._xmlHttpRequest.statusText)if(a=this._xmlHttpRequest.response,null!=a)this.bytes=za.ofData(a);else try{if(null!=this._xmlHttpRequest.responseText){var b=VBArray(request.responseText).toArray();this.bytes=new za(new Wb(b.length));a=0;for(var c=b.length;a<c;){var d=a++;this.bytes.b[d]=b[d]&255}}}catch(e){}this._xmlHttpRequest=null;if(null!=this.onComplete)this.onComplete(this)}},
onWorkerMessage:function(a){U.trace("from woker ",{fileName:"BytesLoader.hx",lineNumber:131,className:"lovedna.net.BytesLoader",methodName:"onWorkerMessage"});this.bytes=za.ofData(a.data);if(null!=this.onComplete)this.onComplete(this)},__class__:Jb};var pb=g.lovedna.net.FileData=function(){M.call(this);this.forceBytes=!1};f["lovedna.net.FileData"]=pb;pb.__name__=["lovedna","net","FileData"];pb.__super__=M;pb.prototype=r(M.prototype,{setType:function(a){this.type=a;a==oa.BYTES&&(this.forceBytes=!0);
return this},setPath:function(a){this.path=a;if(null==this.type)switch(this.type=oa.BYTES,a.split(".").pop().toLowerCase()){case "gif":case "jpeg":case "jpg":case "png":this.type=oa.IMAGE;break;case "mp2":case "mp3":break;case "m4a":case "ogg":case "wav":break;case "otf":case "ttf":break;case "css":case "json":case "plist":case "svg":case "text":case "txt":case "xml":this.type=oa.TEXT;this.forceBytes=!0;break;default:this.type=oa.BYTES,this.forceBytes=!0}return this},setUrl:function(a){this.url=a;
return this},get_key:function(){if(null!=this._key)return this._key;pb._fnv.reset();pb._fnv.addString(this.url);pb._fnv.addInt(this.type[1]);return this._key=pb._fnv.getString()},get_enabled:function(){return null==this.bytes&&null==this.text&&null==this.image?null!=this.video:!0},__class__:pb,__properties__:{get_enabled:"get_enabled",get_key:"get_key"}});var ra=g.lovedna.net.Path=function(a){this.set(a)};f["lovedna.net.Path"]=ra;ra.__name__=["lovedna","net","Path"];ra.normalize=function(a){if(null==
a)return null;a=a.split("\\").join("/");if(null==a||"/"==a)return"/";var b=[],c=0;for(a=a.split("/");c<a.length;){var d=a[c];++c;".."==d&&0<b.length&&".."!=b[b.length-1]?b.pop():"."!=d&&b.push(d)}b=b.join("/");b.replace(/([^:])\/+/g,"$1/");c="";d=a=!1;for(var e=0,f=b.length;e<f;){var g=e++;g=A.cca(b,g);if(null==g)a=!1,d&&(c+="/",d=!1),c+=T.string(String.fromCharCode(g));else switch(g){case 47:0==a?d=!0:(a=!1,d&&(c+="/",d=!1),c+=T.string(String.fromCharCode(g)));break;case 58:c+=":";a=!0;break;default:a=
!1,d&&(c+="/",d=!1),c+=T.string(String.fromCharCode(g))}}return c};ra.Combine=function(a,b){return""==a||null==a?b:null==b||""==b?a:""==a?b:ra.addSlash(a)+ra.removeSlash(b)};ra.addSlash=function(a){if(0==a.length)return"/";var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");return b<c?c!=a.length-1?a+"\\":a:b!=a.length-1?a+"/":a};ra.removeSlash=function(a){try{for(;;){var b=A.cca(a,a.length-1);if(null==b)throw"__break__";switch(b){case 47:case 92:a=A.substr(a,0,-1);break;default:throw"__break__";}}}catch(d){if("__break__"!=
d)throw d;}try{for(;;){var c=A.cca(a,0);if(null==c)throw"__break__";switch(c){case 47:case 92:a=A.substr(a,1,null);break;default:throw"__break__";}}}catch(d){if("__break__"!=d)throw d;}return a};ra.prototype={toString:function(){return(null==this._dir?"":this._dir+(this._leftslash?"/":"\\"))+(null==this._file?"":this._file)+(null==this._ext?"":"."+this._ext)},getHashKey:function(){ra._fnv.reset();ra._fnv.addString(this.toString());return ra._fnv.getString()},getDir:function(){return this._dir},getPathWithoutExt:function(){return ra.Combine(this._dir,
this._file)},getFile:function(){return this._file+"."+this._ext},getExt:function(){return this._ext},getFileWithoutExt:function(){return this._file},getParams:function(){return this._param},getParent:function(){var a=this.getDir();if(null==a||""==a)return null;ra.instance.set(ra.normalize(a));a=ra.instance.getDir();if(null==a||""==a)return null;var b=new ra;b.set(a);return b},isAbs:function(){return X.startsWith(this._value,"/")||":"==this._value.charAt(1)?!0:!1},isHttp:function(){var a=A.substr(this._value,
0,7);return"http://"!=a?"https:/"==a:!0},set:function(a){this._value=a;this.clear();if(""==a||null==a)return this;switch(a){case ".":case "..":return this._dir=a,this._file="",this}var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");b<c?(this._dir=A.substr(a,0,c),a=A.substr(a,c+1,null),this._leftslash=!1):c<b?(this._dir=A.substr(a,0,b),a=A.substr(a,b+1,null),this._leftslash=!0):this._dir=null;-1!=a.indexOf("?")&&(b=a.split("?"),a=b.shift(),this._param=b.join("?"));b=a.lastIndexOf(".");-1!=b?(this._ext=
A.substr(a,b+1,null),this._file=A.substr(a,0,b)):(this._ext=null,this._file=a);return this},clear:function(){this._param=this._ext=this._file=this._dir=null;this._leftslash=!1},__class__:ra};var K=g.lovedna.net.FileLoader=function(){M.call(this);this._bytesLoader=new Jb;this._bytesLoader.onComplete=q(this,this.onBytesComplete);this._fileList=new O};f["lovedna.net.FileLoader"]=K;K.__name__=["lovedna","net","FileLoader"];K.setGlobalRoot=function(a){0<K._defaultRoot.length||(null==a&&(a=""),K._defaultRoot=
a,K._path.set(K._defaultRoot),K._path.isHttp()&&(K._defaultRoot=K._path.toString()+"/"),X.endsWith(K._defaultRoot,"/")||(K._defaultRoot+="/"))};K.setVersiton=function(a,b){var c=K._version;null!=p[a]?c.setReserved(a,b):c.h[a]=b};K.__super__=M;K.prototype=r(M.prototype,{load:function(a,b){var c=this,d=new pb;K._path.set(a);var e=K._path.toString();d.setType(b).setPath(e);if(K._path.isHttp())d.setUrl(a);else{b="";b=K._version;if(null!=p[a]?b.existsReserved(a):b.h.hasOwnProperty(a))b=K._version,b=null!=
p[a]?b.getReserved(a):b.h[a];else{b=K.meta.getMeta(a);b=null!=b?b.crc+"":"";var f=K._version;null!=p[a]?f.setReserved(a,b):f.h[a]=b}a=K._defaultRoot+e;""!=b&&(a+="?v"+b);d.setUrl(a)}a=d.get_key();e=K._fileMap;(null!=p[a]?e.existsReserved(a):e.h.hasOwnProperty(a))?(d=K._fileMap,d=null!=p[a]?d.getReserved(a):d.h[a]):(e=K._fileMap,null!=p[a]?e.setReserved(a,d):e.h[a]=d,this._fileList.push(d),K._list.push(this),K._loading||(null==K._delayCall&&(K._delayCall=new ia(function(){c._loadnext()})),K._delayCall.running||
ia.add(K._delayCall,.1)));return d},_loadnext:function(){K._loading||0!=K._list.get_length()&&K._list.shift()._load()},_load:function(){var a=this;1>this._fileList.get_length()?this._loadnext():(this._current=this._fileList.shift(),K._loading=!0,this._current.forceBytes?this._bytesLoader.load(this._current.url):this._current.type==oa.IMAGE?(new Pb).fromUrl(this._current.url,function(b){a._current.image=b;a.completeFile()}):this.completeFile())},onBytesComplete:function(a){var b=this;this._current.bytes=
a.bytes;this._current.type==oa.IMAGE?(new Pb).fromBytes(a.bytes,function(a){b._current.image=a;b.completeFile()}):this.completeFile()},completeFile:function(){K._loading=!1;K._fileMap.remove(this._current.get_key());this._current.dispatchEvent(R.complete);this._loadnext()},__class__:K});var oa={__ename__:!0,__constructs__:["NULL","BYTES","IMAGE","TEXT","VIDEO"],NULL:["NULL",0]};oa.NULL.toString=kb;oa.NULL.__enum__=oa;oa.BYTES=["BYTES",1];oa.BYTES.toString=kb;oa.BYTES.__enum__=oa;oa.IMAGE=["IMAGE",
2];oa.IMAGE.toString=kb;oa.IMAGE.__enum__=oa;oa.TEXT=["TEXT",3];oa.TEXT.toString=kb;oa.TEXT.__enum__=oa;oa.VIDEO=["VIDEO",4];oa.VIDEO.toString=kb;oa.VIDEO.__enum__=oa;var D=g.lovedna.Assets=function(){};f["lovedna.resource.Assets"]=D;D.__name__=["lovedna","resource","Assets"];D.init=function(a){null==a&&(a="");K.setGlobalRoot(a);if(!D._init&&(D._init=!0,a=new Yd,a.onInstance=D.instance,a.inject(D,D),null!=D._list)){for(a=D._list.length;0<a--;)D._list[a].init();D._list=null;D.meta=K.meta}};D.setVersion=
function(a,b){K.setVersiton(a,b)};D.loadMeta=function(a,b){if(D._init){D.setVersion(a,D.version);var c=D.bytes.get(a);null==D._metasuccess&&(D._metasuccess=new J);if(null!=b){var d=D._metasuccess;null!=p[a]?d.setReserved(a,b):d.h[a]=b}c.addEventListener(R.complete._type,D.metaComplete)}};D.instance=function(a){y.__instanceof(a,la)&&null!=a&&(null==D._list&&(D._list=[]),D._list.push(a))};D.metaComplete=function(a){a=a.target;if(a.enabled){var b=new Zb(0),c=b.decode(na.fromBytes(a.bytes));-433249250==
b.type&&D.meta.decode(c)}b=D._metasuccess;c=a._file.name;if(null!=p[c]?b.existsReserved(c):b.h.hasOwnProperty(c))b=D._metasuccess,c=a._file.name,b=null!=p[c]?b.getReserved(c):b.h[c],null!=b&&b(),D._metasuccess.remove(a._file.name)};D.prototype={__class__:D};var ke=g.lovedna.resource.IAssetUser=function(){};f["lovedna.resource.IAssetUser"]=ke;ke.__name__=["lovedna","resource","IAssetUser"];ke.prototype={__class__:ke};var Pb=g.lovedna.resource.Image=function(){};f["lovedna.resource.Image"]=Pb;Pb.__name__=
["lovedna","resource","Image"];Pb.prototype={fromBytes:function(a,b){this._complete=b;null==a?this._onerror():(null==this.data&&(this.data=new Image,this.data.onload=q(this,this._onload),this.data.onerror=q(this,this._onerror)),this.height=this.width=0,a="data:data;base64,"+Vb.encode(a),this.data.src=a,this.data.crossOrigin="Anonymous")},fromUrl:function(a,b){this._complete=b;null==this.data&&(this.data=new Image,this.data.onload=q(this,this._onload),this.data.onerror=q(this,this._onerror));this.height=
this.width=0;this.data.src=a;this.data.crossOrigin="Anonymous"},_onload:function(){this.width=this.data.width;this.height=this.data.height;null!=this._complete&&(this._complete(this),this._complete=null)},_onerror:function(){null!=this._complete&&(this.width=this.height=0,this._complete(this),this._complete=null)},__class__:Pb};var sa=g.lovedna.resource.data.ResBase=function(){M.call(this);this.enabled=!1};f["lovedna.resource.data.ResBase"]=sa;sa.__name__=["lovedna","resource","data","ResBase"];sa.__interfaces__=
[bc];sa.__super__=M;sa.prototype=r(M.prototype,{unload:function(){this._file=null},fileComplete:function(){this.enabled=!0;this.onFileComplete();this.dispatchEvent(R.complete)},onFileComplete:function(){},get_file:function(){return this._file},set_file:function(a){return this._file=a},__class__:sa,__properties__:{set_file:"set_file",get_file:"get_file"}});var kd=g.lovedna.resource.data.ResBytes=function(){sa.call(this)};f["lovedna.resource.data.ResBytes"]=kd;kd.__name__=["lovedna","resource","data",
"ResBytes"];kd.__super__=sa;kd.prototype=r(sa.prototype,{onFileComplete:function(){sa.prototype.onFileComplete.call(this);this.bytes=this._file.bytes;this.enabled=null!=this.bytes},__class__:kd});var nc=g.lovedna.resource.data.ResFnt=function(a,b){sa.call(this);this.name=a;this.texture=b};f["lovedna.resource.data.ResFnt"]=nc;nc.__name__=["lovedna","resource","data","ResFnt"];nc.__super__=sa;nc.prototype=r(sa.prototype,{setfnt:function(a){this.fnt=a;this.enabled=!0;this.dispatchEvent(R.complete)},
__class__:nc});var ld=g.lovedna.resource.data.ResG3D=function(){sa.call(this);this.modelData=new Ra};f["lovedna.resource.data.ResG3D"]=ld;ld.__name__=["lovedna","resource","data","ResG3D"];ld.__super__=sa;ld.prototype=r(sa.prototype,{onFileComplete:function(){if(null==this._file.bytes)this.enabled=!1,this.dispatchEvent(R.complete);else{var a=na.fromBytes(this._file.bytes),b=new Zb(0);a=b.decode(a);-239294721!=b.type?U.trace("not type g3d",{fileName:"ResG3D.hx",lineNumber:63,className:"lovedna.resource.data.ResG3D",
methodName:"onFileComplete"}):(a.readUTFBytes(3),a.readInt(),this.decode(a))}},decode:function(a){null!=a&&(Ra.current=this.modelData,this.modelData.clear(),this.modelData.decode(a),this.modelData.init(),this.modelData.dispose())},init:function(a){null!=a&&(Ra.current=this.modelData,this._data=a.readUTFBytes(a._length),a=JSON.parse(this._data),this.parseMeshes(a),this.parseMaterials(a),this.parseNodes(a),this.parseAnimations(a),this.modelData.init(),this._data=null,this.enabled=!0)},parseMeshes:function(a){a=
t.getValue(a,"meshes");if(null!=a)for(var b=0,c=a.length;b<c;){var d=b++,e=a[d];d=new Ja;d.id=t.getString(e,"id");d.attributes=t.getValue(e,"attributes");d.vertices=t.getFloatArray(e,"vertices");e=t.getValue(e,"parts");for(var f=0,g=e.length;f<g;){var k=f++;k=e[k];var l=new Hc;l.id=t.getString(k,"id");l.primitiveType=t.getString(k,"type");l.indices=t.getIntArray(k,"indices");d.addPart(l)}this.modelData.addMesh(d)}},parseNodes:function(a){a=t.getValue(a,"nodes");if(null!=a)for(var b=0,c=a.length;b<
c;){var d=b++;this.modelData.addNode(this.parseNode(a[d]))}},parseNode:function(a){var b=new jc;b.id=t.getString(a,"id","");var c=t.getFloatArray(a,"translation");b.translation=null==c?null:(new m).fromArray(c);c=t.getFloatArray(a,"rotation");b.rotation=null==c?null:(new ja).fromArray(c);c=t.getFloatArray(a,"scale");b.scale=null==c?null:(new m).fromArray(c);b.meshId=t.getString(a,"mesh");c=t.getValue(a,"parts");if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,g=c[f];f=new Ic;f.materialId=t.getString(g,
"materialid");f.meshPartId=t.getString(g,"meshpartid");g=t.getValue(g,"bones");if(null!=g)for(var k=0,l=g.length;k<l;){var n=k++,p=g[n];n=t.getString(p,"node");var q=t.getFloatArray(p,"translation");q=null==q?null:(new m).fromArray(q);var r=t.getFloatArray(p,"rotation");r=null==r?null:(new ja).fromArray(r);p=t.getFloatArray(p,"scale");p=null==p?null:(new m).fromArray(p);f.addBone(n,q,r,p)}b.addPart(f)}a=t.getValue(a,"children");if(null!=a)for(c=0,d=a.length;c<d;)e=c++,b.addChildren(this.parseNode(a[e]));
return b},parseMaterials:function(a){a=t.getValue(a,"materials");if(null!=a)for(var b=0,c=a.length;b<c;){var d=b++,e=a[d];d=new Gc;d.id=t.getString(e,"id");d.shininess=t.getFloat(e,"shininess",0);d.opacity=t.getFloat(e,"opacity",1);var f=t.getFloatArray(e,"diffuse");d.diffuse=null==f?null:(new ca).fromArray(f);f=t.getFloatArray(e,"ambient");d.ambient=null==f?null:(new ca).fromArray(f);f=t.getFloatArray(e,"emissive");d.emissive=null==f?null:(new ca).fromArray(f);f=t.getFloatArray(e,"specular");d.specular=
null==f?null:(new ca).fromArray(f);f=t.getFloatArray(e,"reflection");d.reflection=null==f?null:(new ca).fromArray(f);e=t.getValue(e,"textures");if(null!=e){f=0;for(var g=e.length;f<g;){var k=f++;k=e[k];var l=new Ka;l.id=t.getString(k,"id");l.fileName=t.getString(k,"filename");l.type=t.getString(k,"type");var m=t.getFloatArray(k,"uvTranslation");null!=m&&l.uvTranslation.fromArray(m);m=t.getFloatArray(k,"uvScaling");null!=m&&l.uvScaling.fromArray(m);d.addTexture(l)}}this.modelData.addMaterial(d)}},
parseAnimations:function(a){a=t.getValue(a,"animations");if(null!=a)for(var b=0,c=a.length;b<c;){var d=b++,e=a[d];d=t.getValue(e,"bones");if(null!=d){var f=new Ec;f.id=t.getString(e,"id");e=0;for(var g=d.length;e<g;){var k=e++,l=d[k];k=new Fc;k.nodeId=t.getString(l,"boneId");l=t.getValue(l,"keyframes");for(var n=0,p=l.length;n<p;){var q=n++;q=l[q];var r=.001*t.getFloat(q,"keytime",0);var u=t.getFloatArray(q,"translation");null!=u&&k.addTranslation(new xb(r,(new m).fromArray(u)));u=t.getFloatArray(q,
"rotation");null!=u&&k.addRotation(new xb(r,(new ja).fromArray(u)));u=t.getFloatArray(q,"scale");null!=u&&k.addScaling(new xb(r,(new m).fromArray(u)))}f.add(k)}this.modelData.addAnimation(f)}}},__class__:ld});var oc=g.lovedna.resource.data.ResSprite=function(){sa.call(this);this._uv=new v;this._uv00=new v(0,0);this._uv11=new v(1,1)};f["lovedna.resource.data.ResSprite"]=oc;oc.__name__=["lovedna","resource","data","ResSprite"];oc.__super__=sa;oc.prototype=r(sa.prototype,{getUV:function(a,b){if(this.data.get_rotated()){var c=
this._uv,d=this._uv00.x,e=this._uv00.y;c.x=d+(this._uv11.x-d)*b;c.y=e+(this._uv11.y-e)*a;return c}c=this._uv;d=this._uv00.x;e=this._uv00.y;c.x=d+(this._uv11.x-d)*a;c.y=e+(this._uv11.y-e)*b;return c},init:function(a){if(null!=this.texture){var b=this.texture.texture.width,c=this.texture.texture.height;if(0!=b&&0!=c)if(this.enabled=!0,null==a)this.packed=!1,this.data=new Dc,a=this.data.frame,a.x=0,a.y=0,a.z=b,a.w=c,a=this.data.sourceSize,a.x=b,a.y=c,this.dispatchEvent(R.init);else if(-1!=a.file.indexOf(this.atlasName)&&
(this.packed=!0,this.data=a.getSprite(this.name),null!=this.data)){a=this.data.frame.z;var d=this.data.frame.w;if(this.data.get_rotated()){var e=this._uv00;e.x=(this.data.frame.x+d)/b;e.y=this.data.frame.y/c;d=this._uv11;d.x=this.data.frame.x/b;d.y=(this.data.frame.y+a)/c}else e=this._uv00,e.x=this.data.frame.x/b,e.y=this.data.frame.y/c,e=this._uv11,e.x=(this.data.frame.x+a)/b,e.y=(this.data.frame.y+d)/c;this.dispatchEvent(R.init)}}},set_atlasName:function(a){return null!=this.atlasName?this.atlasName:
this.atlasName=a},set_name:function(a){return null!=this.name?this.name:this.name=a},set_texture:function(a){return null!=this.texture?this.texture:this.texture=a},__class__:oc,__properties__:r(sa.prototype.__properties__,{set_texture:"set_texture",set_name:"set_name",set_atlasName:"set_atlasName"})});var md=g.lovedna.resource.data.ResTexture=function(){sa.call(this);this.texture=new Bb};f["lovedna.resource.data.ResTexture"]=md;md.__name__=["lovedna","resource","data","ResTexture"];md.__super__=sa;
md.prototype=r(sa.prototype,{onFileComplete:function(){sa.prototype.onFileComplete.call(this);null==this._file.image?this.enabled=!1:0!=this._file.image.width&&(this.texture.setData(this._file.image),this.parsePng());null!=this._file.bytes&&null==this._file.image&&(this._file.image=new Pb,this._file.image.fromBytes(this._file.bytes,q(this,this.onImageComplete)))},onImageComplete:function(a){this.onFileComplete()},parsePng:function(){D.texture.res=this;D.texture.tag=0;if(null!=this._file.bytes){var a=
new Lb;a.decode(na.fromBytes(this._file.bytes));a=a.getChunk(1716666723);if(null!=a&&(a=a.getContent(),null!=a)){a.position=0;var b=new Zb(0);a=b.decode(a);a.position=0;D.texture.tag=b.type;D.texture.bytes=a}}D.texture.dispatchEvent(R.data);this._file.bytes=null},__class__:md});var la=g.lovedna.resource.loader.LoaderBase=function(){M.call(this);this._map=new J;this._loader=new K};f["lovedna.resource.loader.LoaderBase"]=la;la.__name__=["lovedna","resource","loader","LoaderBase"];la.__super__=M;la.prototype=
r(M.prototype,{get:function(a){var b=this._map;if(null!=p[a]?b.existsReserved(a):b.h.hasOwnProperty(a))return b=this._map,null!=p[a]?b.getReserved(a):b.h[a];b=this.createRes();var c=this._map;null!=p[a]?c.setReserved(a,b):c.h[a]=b;c=this._loader.load(a);c.name=a;b.set_file(c);this.onLoad(b);c.get_enabled()||c.addEventListener(R.complete._type,q(this,this.fileComplete));return b},createRes:function(){return null},onLoad:function(a){},init:function(){},fileComplete:function(a){var b=a.target;b.removeEventListener(R.complete._type,
q(this,this.fileComplete));a=this._map;b=b.name;(null!=p[b]?a.getReserved(b):a.h[b]).fileComplete()},__class__:la});var Zd=g.lovedna.resource.loader.BytesLoader=function(){la.call(this)};f["lovedna.resource.loader.BytesLoader"]=Zd;Zd.__name__=["lovedna","resource","loader","BytesLoader"];Zd.__super__=la;Zd.prototype=r(la.prototype,{createRes:function(){return new kd},onLoad:function(a){la.prototype.onLoad.call(this,a)},__class__:Zd});var $d=g.lovedna.resource.loader.FntLoader=function(){la.call(this)};
f["lovedna.resource.loader.FntLoader"]=$d;$d.__name__=["lovedna","resource","loader","FntLoader"];$d.__super__=la;$d.prototype=r(la.prototype,{get:function(a){var b=this._map;if(null!=p[a]?b.existsReserved(a):b.h.hasOwnProperty(a))b=this._map,b=null!=p[a]?b.getReserved(a):b.h[a];else{b=D.texture.get(a);b._file.forceBytes=!0;b=new nc(a,b.texture);var c=this._map;null!=p[a]?c.setReserved(a,b):c.h[a]=b;c=this._fntMap;if(null!=p[a]?c.existsReserved(a):c.h.hasOwnProperty(a))c=this._fntMap,b.setfnt(null!=
p[a]?c.getReserved(a):c.h[a])}return b},onConstruct:function(){la.prototype.onConstruct.call(this);this._fntMap=new J},init:function(){la.prototype.init.call(this);D.texture.addEventListener(R.data._type,q(this,this.ondata))},ondata:function(a){if(-1629174247==D.texture.tag){var b=D.texture.bytes;a=new Xb;a.decode(b);b=D.texture.res._file.path;var c=this._fntMap;null!=p[b]?c.setReserved(b,a):c.h[b]=a;c=this._map;c=null!=p[b]?c.getReserved(b):c.h[b];if(null==c){c=new nc(b,D.texture.get(b).texture);
var d=this._map;null!=p[b]?d.setReserved(b,c):d.h[b]=c}c.enabled||c.setfnt(a)}},__class__:$d});var ae=g.lovedna.resource.loader.G3dLoader=function(){la.call(this)};f["lovedna.resource.loader.G3dLoader"]=ae;ae.__name__=["lovedna","resource","loader","G3dLoader"];ae.__super__=la;ae.prototype=r(la.prototype,{createRes:function(){return new ld},__class__:ae});var be=g.lovedna.resource.loader.SpriteLoader=function(){la.call(this)};f["lovedna.resource.loader.SpriteLoader"]=be;be.__name__=["lovedna","resource",
"loader","SpriteLoader"];be.__super__=la;be.prototype=r(la.prototype,{addAtlas:function(a){var b=this._atlasMap;null!=p[a]?b.setReserved(a,!0):b.h[a]=!0},get:function(a){var b=this._spriteMap;if(null!=p[a]?b.existsReserved(a):b.h.hasOwnProperty(a))return b=this._spriteMap,null!=p[a]?b.getReserved(a):b.h[a];b=new oc;var c=this._spriteMap;null!=p[a]?c.setReserved(a,b):c.h[a]=b;this._path.set(a);c=this._path.getDir()+".png";var d=this._atlasMap;(null!=p[c]?d.existsReserved(c):d.h.hasOwnProperty(c))||
(d=D.meta.getMeta(c),null==d?(d=this._atlasMap,null!=p[c]?d.setReserved(c,!1):d.h[c]=!1):1==d.get("isAtlas")&&(d=this._atlasMap,null!=p[c]?d.setReserved(c,!0):d.h[c]=!0));d=this._atlasMap;1==(null!=p[c]?d.getReserved(c):d.h[c])?(b.set_name(this._path.getFile()),b.set_atlasName(c),b.set_texture(D.texture.get(c)),b.texture._file.forceBytes=!0,a=gb.getAtlas(c),null!=a&&b.init(a)):(b.set_texture(D.texture.get(a)),b.texture.enabled&&b.init(null));return b},onConstruct:function(){la.prototype.onConstruct.call(this);
this._atlasMap=new J;this._spriteMap=new J;this._path=new ra},createRes:function(){return new oc},init:function(){la.prototype.init.call(this);D.texture.addEventListener(R.data._type,q(this,this.ondata))},ondata:function(a){a=D.texture.res._file.path;var b=this._spriteMap,c=null!=p[a]?b.getReserved(a):b.h[a];null!=c&&c.init(null);if(-590019044==D.texture.tag){this._path.set(D.texture.res._file.path);a=this._path.getPathWithoutExt();var d=D.texture.bytes;b=new gb(D.texture.res._file.path);b.decode(d);
d=b.frames;for(var e=d.get_length();0<e--;){c=d.getElement(e);c=ra.Combine(a,c.get_name());var f=this._spriteMap;c=null!=p[c]?f.getReserved(c):f.h[c];null!=c&&c.init(b)}}},__class__:be});var ce=g.lovedna.resource.loader.TextureLoader=function(){la.call(this)};f["lovedna.resource.loader.TextureLoader"]=ce;ce.__name__=["lovedna","resource","loader","TextureLoader"];ce.__super__=la;ce.prototype=r(la.prototype,{createRes:function(){return new md},onLoad:function(a){la.prototype.onLoad.call(this,a);if(!a.enabled&&
!a._file.forceBytes){var b=D.meta.getMeta(a._file.name);null!=b&&1==b.get("isAtlas")&&(a._file.forceBytes=!0)}},__class__:ce});var cc=g.lovedna.rtti.ClassMeta=function(a,b,c){null==c&&(c=!1);this.isStatic=c;this.priority=0;this._name=b;this._metaList=[];this._metaMap=new J;b=ma.fields(a);for(c=b.length;0<c--;){var d=b[c];if("t"!=d&&"f"!=d){this._metaList.push(d);var e=ma.field(a,d);null!=e&&1==e.length&&y.__instanceof(e[0],je)&&(this.priority=e[0]);var f=this._metaMap;null!=p[d]?f.setReserved(d,e):
f.h[d]=e}}b=ma.field(a,"t");null!=b&&0<b.length?(this._type=Ca.resolveClass(b[b.length-1]),this.isFunction=!1):(this.isFunction=!0,this._funArgs=[]);a=ma.field(a,"f");if(null!=a)for(b=0,c=a.length;b<c;)d=b++,d=ma.field(a[d],"type"),this._funArgs.push(Ca.resolveClass(d))};f["lovedna.rtti.ClassMeta"]=cc;cc.__name__=["lovedna","rtti","ClassMeta"];cc.prototype={getMeta:function(a){return this._metaList[a]},hasMeta:function(a){var b=this._metaMap;return null!=p[a]?b.existsReserved(a):b.h.hasOwnProperty(a)},
getMetaArgs:function(a){var b=this._metaMap;return null!=p[a]?b.getReserved(a):b.h[a]},toString:function(){for(var a=this._name+":("+Ca.getClassName(this._type)+")=> {",b=this._metaList.length;0<b--;){var c=this.getMeta(b);a+=c+" => "+T.string(this.getMetaArgs(c))}return a+" }"},get_name:function(){return this._name},get_type:function(){return this._type},get_functionArgs:function(){return this._funArgs},get_length:function(){return this._metaList.length},__class__:cc,__properties__:{get_length:"get_length",
get_functionArgs:"get_functionArgs",get_type:"get_type",get_name:"get_name"}};var Xa=g.lovedna.rtti.ClassMetaInfo=function(){};f["lovedna.rtti.ClassMetaInfo"]=Xa;Xa.__name__=["lovedna","rtti","ClassMetaInfo"];Xa.get=function(a){if(null==a)return null;if(null!=Xa._infoMap.h.__keys__[a.__id__])return Xa._infoMap.h[a.__id__];var b=new Xa;b.classPath=Ca.getClassName(a);b.parse(a);Xa._infoMap.set(a,b);b.parseClassMeta(fb.getType(a));return b};Xa.prototype={getField:function(a){return this._fields[a]},
getMeta:function(a){var b=this._metaMap;return null!=p[a]?b.getReserved(a):b.h[a]},getClassMeta:function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);var d=this._classMetaMap;if(null!=p[a]?d.existsReserved(a):d.h.hasOwnProperty(a))return b=this._classMetaMap,null!=p[a]?b.getReserved(a):b.h[a];if(c)for(var e=a.toLowerCase(),f=this._classMetaMap.keys();f.hasNext();)if(d=f.next(),d.toLowerCase()==e)return a=this._classMetaMap,null!=p[d]?a.getReserved(d):a.h[d];return b&&(d=Xa.get(this._super),null!=d)?d.getClassMeta(a,
b,c):null},toString:function(){var a=""+this.classPath;a+="{ ";for(var b=this._fields.length;0<b--;){var c=this.getField(b);c=this.getMeta(c);a+=T.string(c)+" "}return a+" }"},parseClassMeta:function(a){this._classMetaMap=new J;for(var b=ma.fields(a),c=b.length;0<c--;){var d=b[c],e=t.getValue(a,d);null==e&&(e=[]);var f=this._classMetaMap;null!=p[d]?f.setReserved(d,e):f.h[d]=e}},parse:function(a){this._super=Ca.getSuperClass(a);var b=fb.getFields(a);this._metaMap=new J;this._fields=[];for(var c=ma.fields(b),
d=c.length,e=[];0<d--;){var f=c[d],g=new cc(ma.field(b,f),f),k=this._metaMap;null!=p[f]?k.setReserved(f,g):k.h[f]=g;null!=g._type?this._fields.push(f):e.push(g)}d=e.length;if(0<d)for(e.reverse(),e.sort(q(this,this.sort)),b=0;b<d;)c=b++,this._fields.push(e[c]._name);b=fb.getStatics(a);c=ma.fields(b);for(d=c.length;0<d--;)a=c[d],f=new cc(ma.field(b,a),a,!0),g=this._metaMap,null!=p[a]?g.setReserved(a,f):g.h[a]=f,null!=f._type?this._fields.push(a):e.push(f)},get_length:function(){return this._fields.length},
sort:function(a,b){return a.priority<b.priority?1:a.priority>b.priority?-1:0},__class__:Xa,__properties__:{get_length:"get_length"}};var de=g.lovedna.rtti.IInject=function(){};f["lovedna.rtti.IInject"]=de;de.__name__=["lovedna","rtti","IInject"];de.prototype={__class__:de};var Yd=g.lovedna.rtti.Injector=function(){this._instanceMap=new J};f["lovedna.rtti.Injector"]=Yd;Yd.__name__=["lovedna","rtti","Injector"];Yd.prototype={get:function(a,b){b=this.getKey(a,b);var c=this._instanceMap;c=null!=p[b]?
c.getReserved(b):c.h[b];if(null==c){c=Ca.createInstance(a,[]);var d=this._instanceMap,e=c;null!=p[b]?d.setReserved(b,e):d.h[b]=e;this.inject(c,a)}return c},set:function(a,b,c){a=this.getKey(a,c);c=this._instanceMap;null!=p[a]?c.setReserved(a,b):c.h[a]=b;null!=b&&this.inject(b,null==b?null:y.getClass(b))},inject:function(a,b){for(;null!=b;){for(var c=Xa.get(b),d=0,e=c._fields.length;d<e;){var f=d++,g=c.getField(f),k=c.getMeta(g);if(k.hasMeta("inject"))if(f=k.getMetaArgs("inject"),null!=k._type){var l=
"";null!=f&&(l=f[0]);f=this.get(k._type,l);k.isStatic?ma.setProperty(b,g,f):ma.setProperty(a,g,f)}else if(k=k.get_functionArgs(),null!=k){g=ma.getProperty(a,g);l=[];if(null!=k)for(var m=0,n=k.length;m<n;){var p=m++;l.push(this.get(k[p],f[p]))}g.apply(a,l)}}b=Ca.getSuperClass(b)}y.__instanceof(a,Ha)&&!a.__constructed&&(a.__constructed=!0,a.instanceID=Ha._id++,a.onConstruct());if(y.__instanceof(a,de))a.onInject();if(null!=this.onInstance)this.onInstance(a)},getKey:function(a,b){return pa.getName(a)+
(null==b?"":"#"+b)},__class__:Yd};var ia=g.lovedna.task.DelayCall=function(a){this.id=ia._id++;this.handler=a;this.running=!1};f["lovedna.task.DelayCall"]=ia;ia.__name__=["lovedna","task","DelayCall"];ia.add=function(a,b){null!=a&&(0>=b?null!=a.handler&&a.execute():(a.time=b+P._custom(),null==ia._delayTask&&(ia._delayTask=new nd),ia._delayTask.running||W.add(ia._delayTask),ia._delayTask.add(a)))};ia.remove=function(a){null!=a&&null!=ia._delayTask&&ia._delayTask.remove(a)};ia.prototype={start:function(){this.running=
!0},execute:function(){null!=this.handler&&this.handler();this.running=!1},end:function(){},__class__:ia};var od=g.lovedna.task.ITask=function(){};f["lovedna.task.ITask"]=od;od.__name__=["lovedna","task","ITask"];od.prototype={__class__:od};var nd=g.lovedna.task.DelayTask=function(){this._map=new Z;this._list=new Ed(q(this,this.compare));this._callList=new O;this._doList=new O;this._changed=!1};f["lovedna.task.DelayTask"]=nd;nd.__name__=["lovedna","task","DelayTask"];nd.__interfaces__=[od];nd.prototype=
{add:function(a){this._map.h.hasOwnProperty(a.id)?this._changed=!0:(this._changed=!0,this._map.h[a.id]=a,a.start())},remove:function(a){this._map.h.hasOwnProperty(a.id)&&(this._changed=!0,this._map.remove(a.id),a.end())},onTaskStart:function(a){this.running=!0},onTaskExecute:function(a){if(this._changed){this._changed=!1;this._list.Clear();for(a=this._map.iterator();a.hasNext();){var b=a.next();this._list.push(b)}this._current=this._list.shift()}a=this._list.count;if(null!=this._current)for(b=P._custom();null!=
this._current&&!(0>a);){if(b>=this._current.time){this._map.remove(this._current.id);var c=this._list.shift();this._callList.push(this._current);this._current=c}else break;--a}a=this._callList.get_length();if(0<a){for(this._doList.clear();0<a--;)this._doList.push(this._callList.get(a));this._callList.clear();for(a=this._doList.get_length();0<a--;)b=this._doList.getElement(a),b.execute(),b.end()}return null!=this._current||this._changed?!0:this.running=!1},onTaskEnd:function(a){},compare:function(a,
b){return a.time>b.time?1:-1},__class__:nd};var W=g.lovedna.task.Task=function(){};f["lovedna.task.Task"]=W;W.__name__=["lovedna","task","Task"];W.add=function(a){-1==W._triggerList.indexOf(a)&&-1==W._addList.indexOf(a)&&(W._addList.push(a),null==W._timer&&(W._timer=new Bd(15),W._timer.run=W.run))};W.remove=function(a){-1==W._triggerList.remove(a)&&W._addList.remove(a);-1==W._endList.indexOf(a)&&W._endList.push(a)};W.run=function(){var a=P._custom(),b=W._endList.get_length();if(0<b){for(;0<b--;)W._endList.get(b).onTaskEnd(a);
W._endList.clear()}b=W._triggerList.get_length();if(0<b)for(;0<b--;){var c=W._triggerList.get(b);c.onTaskExecute(a)||W.remove(c)}b=W._addList.get_length();if(0<b){for(;0<b--;)c=W._addList.get(b),W._triggerList.push(c),c.onTaskStart(a);W._addList.clear()}};W.prototype={__class__:W};var Ia=g.lovedna.ui.Key=function(){this.modifier=new Aa;this.deviceId=this.deviceType=0;this.type=-1};f["lovedna.ui.Key"]=Ia;Ia.__name__=["lovedna","ui","Key"];Ia.prototype={copy:function(a){this.deviceId=a.deviceId;this.deviceType=
a.deviceType;this.type=a.type;this.keyCode=a.keyCode;this.value=a.value;this.key=a.key;this.modifier.value=a.modifier.value},trigger:function(){var a=cb.onUpdate;a.key=this;Ia.onEvent.dispatchEvent(a)},get_id:function(){return 1E4*this.deviceType+1E3*this.deviceId+this.keyCode},__class__:Ia,__properties__:{get_id:"get_id"}};var Ab=g.lovedna.ui.KeyManager=function(){this._keys=new Z};f["lovedna.ui.KeyManager"]=Ab;Ab.__name__=["lovedna","ui","KeyManager"];Ab.getInstance=function(){null==Ab._instance&&
(Ab._instance=new Ab);return Ab._instance};Ab.prototype={keyTrigger:function(a){var b=a.get_id();if(this._keys.h.hasOwnProperty(b))var c=this._keys.h[b];else c=new Ia,this._keys.h[b]=c;c.copy(a);c.trigger()},__class__:Ab};var Fa=g.lovedna.ui.Touch=function(){this._key=null;this.type=0;this._alive=!1;this.device=this.touchId=-1;this.pressure=this.size=1;this.position=new v;this.down=new v;this.up=new v;this.time=new m;this.lastTime=new m;this._will=new Aa;this._was=new Aa};f["lovedna.ui.Touch"]=Fa;
Fa.__name__=["lovedna","ui","Touch"];Fa.prototype={copy:function(a){this.touchId=a.touchId;this.position.copy(a.position);this.size=a.size;this.pressure=a.pressure},begin:function(a){this._will.clear();this._was.clear();this.touchId=a.touchId;this.position.copy(a.position);this.size=a.size;this.pressure=a.pressure;this.down.copy(this.position);this.lastTime.x=this.time.x;this.time.x=P._custom();this._will.setElement(1);this._alive=!0},move:function(a){if(this._was.getElement(1)||this._will.getElement(1))this.touchId=
a.touchId,this.position.copy(a.position),this.size=a.size,this.pressure=a.pressure,this.lastTime.y=this.time.y,this.time.y=P._custom(),this._will.setElement(2)},end:function(a){this.touchId=a.touchId;this.position.copy(a.position);this.size=a.size;this.pressure=a.pressure;this.up.copy(this.position);this.lastTime.z=this.time.z;this.time.z=P._custom();this._will.setElement(5)},cancel:function(a){this.touchId=a.touchId;this.position.copy(a.position);this.size=a.size;this.pressure=a.pressure;this.up.copy(this.position);
this.lastTime.z=this.time.z;this.time.z=P._custom();this._will.setElement(5)},execute:function(a){null==a&&(a=P._custom());this._was.getElement(1)&&(this._was.getElement(4)||a-this.time.x>=Fa.holdTime&&this._will.setElement(4));a=this._will.getElement(1);var b=this._will.getElement(2),c=this._will.getElement(4),d=this._will.getElement(5),e=!0;a&&(this.type=1,this._was.setElement(1),e=!1,this.fire());b&&(this.type=2,this._was.setElement(2),e=!1,this.fire());c&&(this.type=4,this._was.setElement(4),
e=!1,this.fire());d&&(this.type=5,this._was.setElement(5),e=!1,this.fire(),this._was.clear(),this._was.setElement(5),this._will.clear(),this._alive=!1);e&&(this.type=3,this.fire());this._will.clear()},fire:function(){var a=db.onUpdate;a.touch=this;Fa.onEvent.dispatchEvent(a)},__class__:Fa};var Nb=g.lovedna.ui.TouchManager=function(a){null==a&&(a=!1);this._immediately=a;this.touchType=0;this._list=[];for(a=20;0<a--;)this._list.push(new Fa);this._keyMap=new J;this._deviceMap=new Z;this._activeList=
new O;this.activeCount=0;this._immediately||W.add(this)};f["lovedna.ui.TouchManager"]=Nb;Nb.__name__=["lovedna","ui","TouchManager"];Nb.__interfaces__=[od];Nb.prototype={reset:function(){this._keyMap=new J;this._deviceMap=new Z;this._activeList=new O;this.touchType=0},begin:function(a){var b=this.getTouch(a.device,a.touchId);if(null!=b){b.begin(a);if(null!=Nb.onBegin)Nb.onBegin(b);this._immediately&&this.execute()}},move:function(a){var b=this.getTouch(a.device,a.touchId);null!=b&&(b.move(a),this._immediately&&
this.execute())},end:function(a){var b=this.getTouch(a.device,a.touchId);null!=b&&(b.end(a),this.unset(b),this._immediately&&this.execute())},cancel:function(a){var b=this.getTouch(a.device,a.touchId);null!=b&&(b.cancel(a),this.unset(b),this._immediately&&this.execute())},execute:function(){this._activeList.clear();for(var a=P._custom(),b=20;0<b--;){var c=this._list[b];c._alive&&(c.execute(a),c._alive&&this._activeList.push(c))}this.activeCount=this._activeList.get_length();1>this.activeCount&&(this.touchType=
0)},onTaskStart:function(a){},onTaskExecute:function(a){this.execute();return!0},onTaskEnd:function(a){},getTouch:function(a,b){b=""+a+"|"+b;var c=this._keyMap;if(null!=p[b]?c.existsReserved(b):c.h.hasOwnProperty(b))return a=this._keyMap,null!=p[b]?a.getReserved(b):a.h[b];c=this.getUnused();if(null==c)return null;var d=this._keyMap;null!=p[b]?d.setReserved(b,c):d.h[b]=c;d=this._deviceMap.h[a];null==d&&(d=new ee(a));d.add(c);c._key=b;return c},getUnused:function(){for(var a=0;10>a;){var b=a++;b=this._list[b];
if(null==b._key)return b}return null},unset:function(a){var b=a._key,c=b.split("|")[0];c=null==c||1>c.length?0:T.parseInt(c);a.device!=c&&U.trace("error-----------------",{fileName:"TouchManager.hx",lineNumber:200,className:"lovedna.ui.TouchManager",methodName:"unset"});a._key=null;this._keyMap.remove(b);b=this._deviceMap.h[c];null!=b&&(b.remove(a),1>b.count&&this._deviceMap.remove(c))},__class__:Nb};var ee=function(a){this.id=a;this._list=[];this.count=0};f["lovedna.ui._TouchManager.DeviceData"]=
ee;ee.__name__=["lovedna","ui","_TouchManager","DeviceData"];ee.prototype={add:function(a){a.device=this.id;for(var b=0,c=this._list.length;b<c;){var d=b++;if(null==this._list[d]){a.touchId=d;this._list[d]=a;this.count++;return}}a.touchId=this._list.length;this._list.push(a);this.count++},remove:function(a){var b=this._list.length;for(this.count=b;0<b--;)this._list[b]==a&&(this._list[b]=null,this.count--)},__class__:ee};var yb=g.lovedna.utils.BytesUtil=function(){};f["lovedna.utils.BytesUtil"]=yb;
yb.__name__=["lovedna","utils","BytesUtil"];yb.compress=function(a,b){null==b&&(b="zlib");var c=null;if("deflate"==b)c=pako.deflateRaw(a.b.bufferValue);else{if("lzma"==b)return a;"zlib"==b&&(c=pako.deflate(a.b.bufferValue))}return za.ofData(c)};yb.uncompress=function(a,b){null==b&&(b="zlib");var c=null;if("deflate"==b)c=pako.inflateRaw(a.b.bufferValue);else{if("lzma"==b)return a;"zlib"==b&&(c=pako.inflate(a.b.bufferValue))}return za.ofData(c)};yb.getCRC32=function(a){return he.make(a)};yb.prototype=
{__class__:yb};var t=g.lovedna.utils.DynamicUtil=function(){};f["lovedna.utils.DynamicUtil"]=t;t.__name__=["lovedna","utils","DynamicUtil"];t.getValue=function(a,b){return y.__instanceof(a,J)?null!=p[b]?a.getReserved(b):a.h[b]:ma.getProperty(a,b)};t.setValue=function(a,b,c){y.__instanceof(a,J)?null!=p[b]?a.setReserved(b,c):a.h[b]=c:ma.setProperty(a,b,c)};t.getKeys=function(a){return ma.fields(a)};t.removeKey=function(a,b){ma.deleteField(a,b)};t.getInt=function(a,b,c){null==c&&(c=0);a=t.getValue(a,
b);return null==a?c:"string"==typeof a?T.parseInt(a):y.__cast(a,je)};t.getFloat=function(a,b,c){null==c&&(c=0);a=t.getValue(a,b);return null==a?c:"string"==typeof a?parseFloat(a):y.__cast(a,ie)};t.getString=function(a,b,c){a=t.getValue(a,b);return null==a?c:T.string(a)};t.getBool=function(a,b,c){null==c&&(c=!1);a=t.getValue(a,b);return null==a?c:a};t.getFloatArray=function(a,b,c){null==c&&(c=1);a=t.getValue(a,b);if(1!=c){b=0;for(var d=a.length;b<d;){var e=b++;a[e]*=c}}return a};t.getIntArray=function(a,
b){return t.getValue(a,b)};t.getUintArray=function(a,b){return t.getValue(a,b)};t.getStringArray=function(a,b){return t.getValue(a,b)};t.getArray=function(a,b){return t.getValue(a,b)};t.exist=function(a,b){var c=Object.prototype.hasOwnProperty.call(a,b);return c||null==ma.field(a,b)?c:!0};t.prototype={__class__:t};var G=g.lovedna.utils.Easing=function(){};f["lovedna.utils.Easing"]=G;G.__name__=["lovedna","utils","Easing"];G.linear=function(a){return a};G.sineIn=function(a){return 0==a?0:1==a?1:1-
Math.cos(1.5707963267948966*a)};G.sineOut=function(a){return 0==a?0:1==a?1:Math.sin(1.5707963267948966*a)};G.sineInOut=function(a){return 0==a?0:1==a?1:-.5*(Math.cos(3.141592653589793*a)-1)};G.sineOutIn=function(a){return 0==a?0:1==a?1:.5>a?.5*Math.sin(3.141592653589793*a):-.5*Math.cos(1.5707963267948966*(2*a-1))+1};G.quadIn=function(a){return a*a};G.quadOut=function(a){return-a*(a-2)};G.quadInOut=function(a){return.5>a?2*a*a:-2*--a*a+1};G.quadOutIn=function(a){if(.5>a)return-.5*(a*=2)*(a-2);a=2*
a-1;return.5*a*a+.5};G.cubicIn=function(a){return a*a*a};G.cubicOut=function(a){return--a*a*a+1};G.cubicInOut=function(a){return 1>(a*=2)?.5*a*a*a:.5*((a-=2)*a*a+2)};G.cubicOutIn=function(a){a=2*a-1;return.5*(a*a*a+1)};G.quartIn=function(a){return(a*=a)*a};G.quartOut=function(a){a*=--a;return 1-a*a};G.quartInOut=function(a){if(1>(a*=2))return.5*(a*=a)*a;a*=a-=2;return-.5*(a*a-2)};G.quartOutIn=function(a){if(.5>a)return a=2*a-1,-.5*(a*=a)*a+.5;a=2*a-1;return.5*(a*=a)*a+.5};G.quintIn=function(a){return a*
(a*=a)*a};G.quintOut=function(a){return--a*(a*=a)*a+1};G.quintInOut=function(a){return 1>(a*=2)?.5*a*(a*=a)*a:.5*(a-=2)*(a*=a)*a+1};G.quintOutIn=function(a){a=2*a-1;return.5*(a*(a*=a)*a+1)};G.expoIn=function(a){return 0==a?0:Math.exp(6.931471805599453*(a-1))};G.expoOut=function(a){return 1==a?1:1-Math.exp(-6.931471805599453*a)};G.expoInOut=function(a){return 0==a?0:1==a?1:1>(a*=2)?.5*Math.exp(6.931471805599453*(a-1)):.5*(2-Math.exp(-6.931471805599453*(a-1)))};G.expoOutIn=function(a){return.5>a?.5*
(1-Math.exp(-13.862943611198906*a)):.5==a?.5:.5*(Math.exp(13.862943611198906*(a-1))+1)};G.circIn=function(a){return-1>a||1<a?0:1-Math.sqrt(1-a*a)};G.circOut=function(a){return 0>a||2<a?0:Math.sqrt(a*(2-a))};G.circInOut=function(a){return-.5>a||1.5<a?.5:1>(a*=2)?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)};G.circOutIn=function(a){if(0>a)return 0;if(1<a)return 1;if(.5>a)return a=2*a-1,.5*Math.sqrt(1-a*a);a=2*a-1;return-.5*(Math.sqrt(1-a*a)-1-1)};G.bounceIn=function(a){a=1-a;return.36363636363636365>
a?1-7.5625*a*a:.7272727272727273>a?1-(7.5625*(a-=.5454545454545454)*a+.75):.9090909090909091>a?1-(7.5625*(a-=.8181818181818182)*a+.9375):1-(7.5625*(a-=.9545454545454546)*a+.984375)};G.bounceOut=function(a){return.36363636363636365>a?7.5625*a*a:.7272727272727273>a?7.5625*(a-=.5454545454545454)*a+.75:.9090909090909091>a?7.5625*(a-=.8181818181818182)*a+.9375:7.5625*(a-=.9545454545454546)*a+.984375};G.bounceInOut=function(a){if(.5>a)return a=1-2*a,.36363636363636365>a?.5*(1-7.5625*a*a):.7272727272727273>
a?.5*(1-(7.5625*(a-=.5454545454545454)*a+.75)):.9090909090909091>a?.5*(1-(7.5625*(a-=.8181818181818182)*a+.9375)):.5*(1-(7.5625*(a-=.9545454545454546)*a+.984375));a=2*a-1;return.36363636363636365>a?7.5625*a*a*.5+.5:.7272727272727273>a?.5*(7.5625*(a-=.5454545454545454)*a+.75)+.5:.9090909090909091>a?.5*(7.5625*(a-=.8181818181818182)*a+.9375)+.5:.5*(7.5625*(a-=.9545454545454546)*a+.984375)+.5};G.bounceOutIn=function(a){if(.5>a)return.36363636363636365>(a*=2)?3.78125*a*a:.7272727272727273>a?.5*(7.5625*
(a-=.5454545454545454)*a+.75):.9090909090909091>a?.5*(7.5625*(a-=.8181818181818182)*a+.9375):.5*(7.5625*(a-=.9545454545454546)*a+.984375);a=1-(2*a-1);return.36363636363636365>a?.5-3.78125*a*a+.5:.7272727272727273>a?.5-.5*(7.5625*(a-=.5454545454545454)*a+.75)+.5:.9090909090909091>a?.5-.5*(7.5625*(a-=.8181818181818182)*a+.9375)+.5:.5-.5*(7.5625*(a-=.9545454545454546)*a+.984375)+.5};G.backIn=function(a){return 0==a?0:1==a?1:a*a*(2.70158*a-1.70158)};G.backOut=function(a){return 0==a?0:1==a?1:--a*a*(2.70158*
a+1.70158)+1};G.backInOut=function(a){return 0==a?0:1==a?1:1>(a*=2)?.5*a*a*(3.5949095*a-2.5949095):.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)};G.backOutIn=function(a){if(0==a)return 0;if(1==a)return 1;if(.5>a)return a=2*a-1,.5*(a*a*(2.70158*a+1.70158)+1);a=2*a-1;return.5*a*a*(2.70158*a-1.70158)+.5};G.elasticIn=function(a){return 0==a?0:1==a?1:-(Math.exp(6.931471805599453*--a)*Math.sin(6.283185307179586*(.001*a-7.5E-5)/3E-4))};G.elasticOut=function(a){return 0==a?0:1==a?1:Math.exp(-6.931471805599453*
a)*Math.sin(6.283185307179586*(.001*a-7.5E-5)/3E-4)+1};G.elasticInOut=function(a){return 0==a?0:1==a?1:1>(a*=2)?-.5*Math.exp(6.931471805599453*--a)*Math.sin(6.283185307179586*(.001*a-7.5E-5)/3E-4):Math.exp(-6.931471805599453*--a)*Math.sin(6.283185307179586*(.001*a-7.5E-5)/3E-4)*.5+1};G.elasticOutIn=function(a){if(.5>a)return 0==(a*=2)?0:.5*Math.exp(-6.931471805599453*a)*Math.sin(6.283185307179586*(.001*a-7.5E-5)/3E-4)+.5;if(.5==a)return.5;if(1==a)return 1;a=2*a-1;return-(.5*Math.exp(6.931471805599453*
--a)*Math.sin(6.283185307179586*(.001*a-7.5E-5)/3E-4))+.5};G.warpOut=function(a){return 0>=a?0:1};G.warpIn=function(a){return 1>a?0:1};G.warpInOut=function(a){return.5>a?0:1};G.warpOutIn=function(a){return 0>=a?0:1>a?.5:1};G.prototype={__class__:G};var n=g.lovedna.utils.Helper=function(){};f["lovedna.utils.Helper"]=n;n.__name__=["lovedna","utils","Helper"];n.lerp=function(a,b,c){return a+(b-a)*c};n.lerpTo=function(a,b,c,d,e){return c+(e-a)/(b-a)*(d-c)};n.angleToRadian=function(a){return.017453292519943295*
a};n.radianToAngle=function(a){return 57.29577951308232*a};n.stringToInt=function(a){return null==a||1>a.length?0:T.parseInt(a)};n.stringToFloat=function(a){return null==a||1>a.length?0:parseFloat(a)};n.stringToReverse=function(a){for(var b="",c=a.length;0<=--c;)b+=a.charAt(c);return b};n.intToHex=function(a,b){return X.hex(a,b)};n.intToReverse=function(a){for(var b=0;0!=a;)b=10*b+a%10,a=.1*a|0;return b};n.hexToInt=function(a){if(0==a.indexOf("0x"))return 10<a.length&&(a=A.substr(a,0,10)),null==a||
1>a.length?0:T.parseInt(a);8<a.length&&(a=A.substr(a,0,8));a="0x"+a;return null==a||1>a.length?0:T.parseInt(a)};n.binToInt=function(a){for(var b=0,c=0,d=a.length;0<d--;){var e=a.charAt(d);"0"==e?++c:"1"==e&&(b+=1<<c,++c);if(32<=c)break}return b};n.toBin=function(a){var b=0==(a&1)?"0":"1";if(ta.gt(a,1))for(;a>>>=1,b+=0==(a&1)?"0":"1",!ta.gt(2,a););return n.stringToReverse(b)};n.intToBool=function(a){return 0!=a};n.toExp=function(a,b){for(var c=1;0!=(b&1)&&(c*=a),b>>=1,0!=b;)a*=a;return c};n.fixed=
function(a,b){null==b&&(b=4);var c=n.toExp(10,b);a=T.string((a*c|0)/c);c=a.indexOf(".");if(-1!=c)for(c=A.substr(a,c+1,null).length;c<b;)c++,a+="0";else for(a+=".",c=0;c<b;)c++,a+="0";return null==a||1>a.length?0:parseFloat(a)};n.isZero=function(a){return 1E-7>n.abs(a)};n.abs=function(a){return 0>a?-a:a};n.absInt=function(a){return 0>a?-a:a};n.min=function(a,b){return a<b?a:b};n.minInt=function(a,b){return a<b?a:b};n.max=function(a,b){return a>b?a:b};n.maxInt=function(a,b){return a>b?a:b};n.clamp=
function(a,b,c){return a<b?b:a>c?c:a};n.isEven=function(a){return 0==(a&1)};n.isPow2=function(a){return 0<a?0==(a&a-1):!1};n.intToNextPow2=function(a){--a;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;return(a|a>>16)+1};n.pow2Count=function(a){a=n.intToNextPow2(a);for(var b=0;1<a;)a>>=1,++b;return b};n.floor=function(a){var b=a|0;0>a&&b!=a&&--b;return b};n.round=function(a){return(a+16384.5|0)-16384};n.ceil=function(a){var b=a|0;if(a==b)return b;++a;b=a|0;0>a&&b!=a&&--b;return b};n.fract=function(a){return a-n.floor(a)};
n.trim=function(a,b){null==b&&(b=" ");a=X.replace(X.trim(a),"/t","");if(""==b)return a;0==a.indexOf(b)&&(a=A.substr(a,1,null));a.lastIndexOf(b)==a.length-1&&(a=A.substr(a,0,-1));return a};n.ltrim=function(a){return X.replace(X.ltrim(a),"/t","")};n.rtrim=function(a){return X.replace(X.rtrim(a),"/t","")};n.replace=function(a,b,c){return X.replace(a,b,c)};n.startWith=function(a,b){return X.startsWith(a,b)};n.endWith=function(a,b){return X.endsWith(a,b)};n.stringFill=function(a,b,c){null==c&&(c=" ");
if(""==c||0==b)return a;var d=0>b;b=n.absInt(b);var e="",f=0;for(b-=a.length;f<b;)f++,e+=c;return d?e+a:a+e};n.binarySearchLow=function(a,b){for(var c=0,d=a.length-1,e=d>>>1,f=d;0<f--;){var g=a[e];if(b>g)c=e,e+=d-c>>>1;else if(b<g)d=e,e=c+(d-c>>>1);else if(b==g)return e;if(3>d-c){if(b>=a[d])return d;if(b>=a[e])return e;if(b>=a[c])return c}}return-1};n.binarySearch=function(a,b){var c=a.length,d=0,e=c-2;if(0==e)return 0;for(var f=e>>>1;0<c--;){a[f+1]<=b?d=f+1:e=f;if(d==e)return d;f=d+e>>>1}return-1};
n.concat=function(a,b){if(null!=a&&null!=b)for(var c=a.length,d=b.length;0<d--;)a[c+d]=b[d]};n.randomString=function(a){var b=T.parseInt(A.substr(a,0,1));a=A.substr(a,1,null);for(var c=a.length/b|0,d="";0<c--;){var e=A.substr(a,c*b,b);d+=String.fromCharCode(T.parseInt(e))}return d};n.count=function(a){return fe.count(a)};n.prototype={__class__:n};var le=g.lovedna.utils.PoolOptions=function(){};f["lovedna.utils.PoolOptions"]=le;le.__name__=["lovedna","utils","PoolOptions"];le.prototype={__class__:le};
var ne=g.lovedna.utils.macro.CompileTime=function(){};f["lovedna.utils.macro.CompileTime"]=ne;ne.__name__=["lovedna","utils","macro","CompileTime"];var Eb=function(){this.className=pa.getClassName(this).split(".").pop()};f["message.Message"]=Eb;Eb.__name__=["message","Message"];Eb.prototype={encode:function(){var a=na._new();a.writeInt(65360586);this.onEncode(a);return a},decode:function(a){if(this.error=65360586!=a.readUnsignedInt())a.position-=4;else this.onDecode(a)},onEncode:function(a){},onDecode:function(a){},
__class__:Eb};var Sb=function(){Eb.call(this);this.handle="SaveHandler";this.method="Record"};f["message.saveHandler.MsgRecord"]=Sb;Sb.__name__=["message","saveHandler","MsgRecord"];Sb.__super__=Eb;Sb.prototype=r(Eb.prototype,{onEncode:function(a){Eb.prototype.onEncode.call(this,a);var b=this.list.get_length();a.writeShort(b);for(var c=0,d=0;d<b;){var e=d++;e=this.list.getElement(e);var f=e-c;c=e;255<f?(a.writeByte(0),a.writeShort(f)):a.writeByte(f)}},onDecode:function(a){Eb.prototype.onDecode.call(this,
a);null==this.list?this.list=new O:this.list.clear();for(var b=a.readUnsignedShort(),c=0;0<b--;){var d=a.readUnsignedByte();0<d?c+=d:(d=a.readUnsignedShort(),c+=d);this.list.push(c)}U.trace("record count "+this.list.get_length(),{fileName:"MsgRecord.hx",lineNumber:80,className:"message.saveHandler.MsgRecord",methodName:"onDecode"})},__class__:Sb});var ib,oe=0;f.Math=Math;String.prototype.__class__=f.String=String;String.__name__=["String"];f.Array=Array;Array.__name__=["Array"];Date.prototype.__class__=
f.Date=Date;Date.__name__=["Date"];var je=f.Int={__name__:["Int"]},qe=f.Dynamic={__name__:["Dynamic"]},ie=f.Float=Number;ie.__name__=["Float"];var me=Boolean;me.__ename__=["Bool"];var re=f.Class={__name__:["Class"]},se={},p={},Wb=ha.ArrayBuffer||Oa;null==Wb.prototype.slice&&(Wb.prototype.slice=Oa.sliceImpl);var pe=ha.DataView||Dd,Td=ha.Float32Array||tb._new,ge=ha.Uint8Array||ub._new;ka._names=[];ka._layers=new J;ka.setLayerName(0,"Default");ka.setLayerName(1,"Transparent");ka.setLayerName(2,"IgnoreRaycast");
ka.setLayerName(3,"Water");ka.setLayerName(4,"UI");x.Element=0;x.PCData=1;x.CData=2;x.Comment=3;x.DocType=4;x.ProcessingInstruction=5;x.Document=6;Ha._id=0;M._temp=[];H._destoryCount=0;L.configData=new ud;L.configStage=new xd;L.configService=new wd;Tb.__meta__={obj:{allowMulti:null}};rc.width=640;rc.height=1138;Ib.width=12;Ib.height=20;Ib.cellSize=50;Ib.mapWidth=600;Ib.mapHeight=1E3;wa.t=.32;wa.s=70;wa.s2=70;wa.gravity=-1367.1875;wa.gravity2=-1367.1875;wa.heroJumpVelocity=437.5;wa.heroJump2Velocity=
437.5;wa.heroMoveVelocity=153.125;wa.heroFlyVelocity=156.25;wa.heroClimpingJumpVelocity=187.5;wa.heroClimpingVelocity=-76.5625;wa.bulletVelocity=159.125;wa.dogJumpVelocity=437.5;wa.dogJump2Velocity=437.5;wa.dogMoveVelovity=153.125;wa.dogFlyVelocity=156.25;wa.dogClimpingVelocity=-76.5625;bb.door=1;bb.cutter=2;bb.shooter=3;bb.trigger=4;bb.gem=5;fc.empty=0;fc.wall=1;ya.type_hero=1;ya.type_cutter=2;ya.type_shooter=3;ya.type_bullet=4;ya.type_jump=5;ya.type_trigger=6;ya.type_door=7;ya.type_gem=8;ya.debugCollider=
!1;eb.jumpFrameWait=4;Vb.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";Vb.BYTES=za.ofString(Vb.CHARS);rb.count=0;Da.i64tmp=new Ub(0,0);qb.escapes=function(a){a=new J;null!=p.lt?a.setReserved("lt","<"):a.h.lt="<";null!=p.gt?a.setReserved("gt",">"):a.h.gt=">";null!=p.amp?a.setReserved("amp","&"):a.h.amp="&";null!=p.quot?a.setReserved("quot",'"'):a.h.quot='"';null!=p.apos?a.setReserved("apos","'"):a.h.apos="'";return a}(this);y.__toStr={}.toString;tb.BYTES_PER_ELEMENT=4;ub.BYTES_PER_ELEMENT=
1;P._custom=P.getnow;P._offset=0;Ma._temp=[];Aa.elementCount=32;pa._typeMap=new rb;pa._typeClassMap=new rb;R.complete=new R("complete");R.init=new R("init");R.data=new R("data");R.lost=new R("lost");cb.onUpdate=new cb("onUpdate");db.onUpdate=new db("touchUpdate");gb.TYPE=-590019044;gb._atlasMap=new J;Xb.TYPE=-1629174247;Xb._map=new J;Yb.TYPE=-239294721;Yb.version=1;Ja.POSITION="POSITION";Ja.NORMAL="NORMAL";Ja.COLOR="COLOR";Ja.TEXCOORD0="TEXCOORD0";Ja.TEXCOORD1="TEXCOORD1";Ja.TANGENT="TANGENT";Ja.BINORMAL=
"BINORMAL";Ja.BLENDWEIGHT0="BLENDWEIGHT0";Ja.BLENDWEIGHT1="BLENDWEIGHT1";Ja.BLENDWEIGHT2="BLENDWEIGHT2";Ja.BLENDWEIGHT3="BLENDWEIGHT3";Ka.USAGE_UNKNOWN=0;Ka.USAGE_NONE=1;Ka.USAGE_DIFFUSE=2;Ka.USAGE_EMISSIVE=3;Ka.USAGE_AMBIENT=4;Ka.USAGE_SPECULAR=5;Ka.USAGE_SHININESS=6;Ka.USAGE_NORMAL=7;Ka.USAGE_BUMP=8;Ka.USAGE_TRANSPARENCY=9;Ka.USAGE_REFLECTION=10;Y._pools=[];v.elementCount=2;v._pool=new Y(function(){return new v});v.instance=new v;Qa._id=0;Qa._uv=new v;kc.TYPE=-433249250;da.TYPE_IHDR=1229472850;
da.TYPE_IDAT=1229209940;da.TYPE_IEND=1229278788;da.TYPE_cHRM=1665684045;da.TYPE_gAMA=1732332865;da.TYPE_sBIT=1933723988;da.TYPE_PLTE=1347179589;da.TYPE_bKGD=1649100612;da.TYPE_hIST=1749635924;da.TYPE_tRNS=1951551059;da.TYPE_oFFs=1866876531;da.TYPE_pHYs=1883789683;da.TYPE_sCAL=1933787468;da.TYPE_tIME=1950960965;da.TYPE_tEXt=1950701684;da.TYPE_zTXt=2052348020;da.TYPE_fRAc=1716666723;da.TYPE_gIFg=1732855399;da.TYPE_gIFt=1732855412;da.TYPE_gIFx=1732855416;da.TYPE_iTXt=1767135348;da.TYPE_USER=1716666723;
Zb.TYPE=-199789115;Rb.state_connect=0;Rb.state_remove=1;Mb.Nothing=0;Mb.Color=1;Mb.Depth=2;Mb.All=3;k._id=0;k.POSITION=new k("POSITION",3,k._id++);k.UV=new k("UV",2,k._id++);k.UV2=new k("UV2",2,k._id++);k.NORMAL=new k("NORMAL",3,k._id++);k.NORMAL2=new k("NORMAL2",3,k._id++);k.TANGENT=new k("TANGENT",4,k._id++);k.COLOR=new k("COLOR",4,k._id++);k.COLOR2=new k("COLOR2",4,k._id++);k.COLOR3=new k("COLOR3",4,k._id++);k.COLOR4=new k("COLOR4",4,k._id++);k.COLOR5=new k("COLOR5",4,k._id++);k.COLOR6=new k("COLOR6",
4,k._id++);k.COLOR7=new k("COLOR7",4,k._id++);k.COLOR8=new k("COLOR8",4,k._id++);k.COLOR9=new k("COLOR9",4,k._id++);k.BONE_INDEX=new k("BONE_INDEX",4,k._id++);k.BONE_WEIGHT=new k("BONE_WEIGHT",4,k._id++);k.P=new k("P",16);k.V=new k("V",16);k.VP=new k("VP",16);k.IV=new k("IV",16);k.IVP=new k("IVP",16);k.M=new k("M",16);k.IM=new k("IM",16);k.ALPHA_TEST=new k("ALPHA_TEST");k.TEX=new k("TEX");k.TEX2=new k("TEX2");k.TEX3=new k("TEX3");k.TEX4=new k("TEX4");k.TEX5=new k("TEX5");k.TEX_ST=new k("TEX_ST",4);
k.TEX2_ST=new k("TEX2_ST",4);k.TEX3_ST=new k("TEX3_ST",4);k.TEX4_ST=new k("TEX4_ST",4);k.TEX5_ST=new k("TEX5_ST",4);k.CUBE=new k("CUBE");k.CUBE2=new k("CUBE2");k.CUBE3=new k("CUBE3");k.CUBE4=new k("CUBE4");k.EYE=new k("EYE",3);k.TIME=new k("TIME",4);k.TIME_SIN=new k("TIME_SIN",4);k.TIME_COS=new k("TIME_COS",4);k.TIME_DELTA=new k("TIME_DELTA",4);k.SCREEN_PARAMS=new k("SCREEN_PARAMS",4);k.TARGET_PARAMS=new k("TARGET_PARAMS",4);k.PROJECTION_PARAMS=new k("PROJECTION_PARAMS",4);k.ORTHOGRAPHIC_PARAMS=new k("ORTHOGRAPHIC_PARAMS",
4);k.GRAB=new k("GRAB");k.BONE=new k("BONE");k.LIGHT=new k("LIGHT");k.LIGHT_POSITION=new k("LIGHT_POSITION");k.LIGHT_AMBIENT=new k("LIGHT_AMBIENT");k.LIGHT_DIFFUSE=new k("LIGHT_DIFFUSE");k.LIGHT_SPECULAR=new k("LIGHT_SPECULAR");ka.Default=0;ka.Transparent=1;ka.IgnoreRaycast=2;ka.Water=3;ka.UI=4;F.touchCount=0;F._layerMask=new ka;F._raycastList=new O;F._init=!1;F._touchChange=!1;F._touchs=[];F._touchDown=new Z;F._touchUp=new Z;F._touchIdList=new O;E.fixedTime=.02;E.deltaTime=0;E._offset=0;E._blurTime=
0;E._focused=!0;E._time=0;E.maxDeltaTime=.02;Sa.Background=1E4;Sa.Geometry=2E4;Sa.Transparent=3E4;Sa.UI=4E4;Sa.Overlay=5E4;ba._geombuffer=new Z;ba._id=0;hb._fnv=new wb;Ba.channel_global=0;Ba.channel_mesh=1;Ba.channel_material=2;Ba._fnv=new wb;Ba.defaultPrecision=new Kd;Ba._programMap=new Z;nb._id=0;nb.defaultCode=new nb("builtin_default","attribute vec3 position:POSITION;\r\nuniform mat4 game_MatrixVP:VP;\r\nuniform mat4 game_MatrixM:M;\r\n#ifdef UV\r\nattribute vec2 uv:UV;\r\nvarying vec2 vuv;\r\n#endif\r\n\r\n#ifdef NORMAL\r\nattribute vec3 normal:NORMAL;\r\nvarying vec3 vnormal;\r\n#endif\r\n\r\n#ifdef COLOR\r\nattribute vec4 color:COLOR;\r\nvarying vec4 vcolor;\r\n#endif\r\n\r\n#ifdef BONE\r\nuniform mat4 u_bones[50]:BONE;\r\nattribute vec4 a_weights:BONE_WEIGHT;\r\nattribute vec4 a_indices:BONE_INDEX;\r\n\r\nmat4 getBoneMatrix( const in float i )\r\n{\r\n\tmat4 bone = u_bones[ int(i) ];\r\n\treturn bone;\r\n}\r\n#endif\r\n\r\nvarying vec3 worldPosition;\r\n\r\nvoid main(void){\r\n\tmat4 modelMat =game_MatrixM;\r\n\t\r\n\t#ifdef UV\r\n\tvuv=uv;\r\n\t#endif\r\n\t\r\n\t#ifdef COLOR\r\n\tvcolor=\tcolor;\r\n\t#endif\r\n\t\r\n\t#ifdef BONE\r\n\tmat4 skinMat = a_weights.x * getBoneMatrix(a_indices.x);\r\n\tskinMat += a_weights.y * getBoneMatrix(a_indices.y);\r\n\tskinMat += a_weights.z * getBoneMatrix(a_indices.z);\r\n\tskinMat += a_weights.w * getBoneMatrix(a_indices.w);\r\n\tmodelMat=skinMat;\r\n\t#endif\r\n\t\r\n\tvec4 wp=modelMat*vec4(position,1.0);\r\n\tworldPosition=wp.xyz;\r\n\t\r\n\tgl_Position = game_MatrixVP * wp;\r\n\t\r\n\t#ifdef NORMAL\r\n\tvnormal = vec4( modelMat * vec4( normal, 0.0 ) ).xyz;\r\n\t#endif\r\n}",
"uniform mat4 game_MatrixIM:IM;\r\nuniform vec3 cameraPosition:EYE;\r\nuniform vec4 gcolor:COLOR;\r\n#ifdef TEX\r\nuniform sampler2D Texture0:TEX;\r\n#endif\r\n\r\n#ifdef UV\r\nvarying vec2 vuv;\r\n#endif\r\n\r\n#ifdef TEX_ST\r\nuniform vec4 texST:TEX_ST;\r\n#endif\r\n\r\n#ifdef COLOR\r\nvarying vec4 vcolor;\r\n#endif\r\n\r\n#ifdef NORMAL\r\nvarying vec3 vnormal;\t\r\n#endif\r\n\r\n#ifdef LIGHT\r\n\t#ifdef NORMAL\r\n\tuniform vec3 lightPosition:LIGHT_POSITION;\r\n\tuniform vec4 lightAmbient:LIGHT_AMBIENT;\r\n\tuniform vec4 lightDiffuse:LIGHT_DIFFUSE;\r\n\tuniform vec4 lightSpecular:LIGHT_SPECULAR;\r\n\t#endif\r\n#endif\r\n\r\nvarying vec3 worldPosition;\r\n\r\nvoid main(void){\r\n\tvec4 baseColor=vec4(1.0,1.0,1.0,1.0);\r\n\t#ifdef TEX\r\n\t\t#ifdef UV\r\n\t\t#ifdef TEX_ST\r\n\t\tbaseColor*=texture2D(Texture0,vuv*texST.xy+texST.zw);\r\n\t\t#else\r\n\t\tbaseColor*=texture2D(Texture0,vuv);\r\n\t\t#endif\r\n\t\t#ifdef ALPHA_TEST\r\n\t\tif(baseColor.a<0.1)\r\n\t\t{\r\n\t\t\tdiscard;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t#endif\r\n\t\t#endif\r\n\t#endif\r\n\t#ifdef COLOR\r\n\tbaseColor=baseColor*vcolor;\r\n\t#endif\r\n\tbaseColor=baseColor*gcolor;\r\n\t#ifdef LIGHT\r\n\t\t#ifdef NORMAL\r\n\t\t//vec3  invLight = normalize(game_MatrixIM * vec4(lightPosition, 0.0)).xyz;\r\n\t\tfloat diffuse = clamp(dot(vnormal, lightPosition), 0.3,1.0);\r\n\t\tdiffuse=smoothstep(0.0,0.6,diffuse);\r\n\t\tvec4 diffuseColor = vec4(vec3(diffuse), 1.0)*lightDiffuse;\r\n\t\tvec3  invEye   = normalize(game_MatrixIM * vec4(cameraPosition, 0.0)).xyz;\r\n\t\tvec3  halfLE   = normalize(lightPosition + invEye);\r\n\t\tfloat specular = pow(clamp(dot(vnormal, halfLE), 0.0, 1.0), lightSpecular.w);\r\n\t\tfloat baseAlpha=baseColor.a;\r\n\t\tbaseColor=baseColor*diffuseColor+vec4(vec3(specular)*lightSpecular.rgb, baseAlpha)+lightAmbient;\r\n\t\t#endif\r\n\t#endif\r\n\t\r\n\tgl_FragColor = baseColor;\r\n}");
N.BLENDING_FACTOR_ONE=1;N.BLENDING_FACTOR_ZERO=0;N.BLENDING_FACTOR_SRC_ALPHA=770;N.BLENDING_FACTOR_DST_ALPHA=32970;N.BLENDING_FACTOR_ONE_MINUS_SRC_ALPHA=771;N.BLENDING_FACTOR_ONE_MINUS_DST_ALPHA=773;N.BLENDING_FACTOR_SRC_COLOR=768;N.BLENDING_FACTOR_DST_COLOR=774;N.BLENDING_FACTOR_ONE_MINUS_SRC_COLOR=769;N.BLENDING_FACTOR_ONE_MINUS_DST_COLOR=775;N.BLENDING_OPERATION_ADD=32774;N.BLENDING_OPERATION_SUBTRACT=32778;N.BLENDING_OPERATION_REVERSE_SUBTRACT=32779;N.COMPAREMODE_ALWAYS=519;N.COMPAREMODE_NEVER=
512;N.COMPAREMODE_EQUAL=514;N.COMPAREMODE_NOTEQUAL=517;N.COMPAREMODE_LESS=513;N.COMPAREMODE_LEQUAL=515;N.COMPAREMODE_GREATER=516;N.COMPAREMODE_GEQUAL=518;N.CULLMODE_BACK=1029;N.CULLMODE_FRONT=1028;N.CULLMODE_FRONT_AND_BACK=1032;N.CULLMODE_OFF=-1;N.STENCIL_ACTION_KEEP=7680;N.STENCIL_ACTION_REPLACE=7681;N.STENCIL_ACTION_INCR=7682;N.STENCIL_ACTION_DECR=7683;N.STENCIL_ACTION_INCR_WRAP=34055;N.STENCIL_ACTION_DECR_WRAP=34056;N.STENCIL_ACTION_INVERT=5386;N.STENCIL_ACTION_ZERO=0;N.USAGE_STATIC_DRAW=35044;
N.USAGE_DYNAMIC_DRAW=35048;N.DRAWMODE_POINTS=0;N.DRAWMODE_LINES=1;N.DRAWMODE_LINE_LOOP=2;N.DRAWMODE_LINE_STRIP=3;N.DRAWMODE_TRIANGLES=4;N.DRAWMODE_TRIANGLE_STRIP=5;N.DRAWMODE_TRIANGLE_FAN=6;Q.elementCount=4;Q._pool=new Y(function(){return new Q});Q.instance=new Q;ca._pool=new Y(function(){return new ca});va._material=new Sa;S.$length=0;S._pool=new Y(function(){return new S});S._SetGlobalShaderUniform=new Y(function(){return new Qc});S._SetShaderDefine=new Y(function(){return new Uc});S._SetShaderUniform=
new Y(function(){return new Vc});S._SetMeshBuffer=new Y(function(){return new Tc});S._SetIndexBuffer=new Y(function(){return new Rc});S._SetVertexBuffer=new Y(function(){return new Wc});S._Draw=new Y(function(){return new Nc});S._SetCallback=new Y(function(){return new Oc});S._SetMaterial=new Y(function(){return new Sc});S._Blit=new Y(function(){return new va});S._SetContext=new Y(function(){return new Pc});ea._material=new Sa;ea._buffer=new S;Xc.__meta__={fields:{clearBufferfi:{version:[2]},clearBufferfv:{version:[2]},
clearBufferiv:{version:[2]},clearBufferuiv:{version:[2]}}};u.gl=new Xc;ab.EXACT_FIT=0;ab.SHOW_ALL=1;ab.NO_SCALE=2;ab.NO_BORDER=3;ab.FIXED_WIDTH=4;ab.FIXED_HEIGHT=5;mc.__meta__={obj:{allowMulti:null}};qa.mesh=new ba;qa._indexCache=[0,1,2,0,2,3];w.onUpdate=new w("onUpdate");w.onLateUpdate=new w("onLateUpdate");w.onFixedUpdate=new w("onFixedUpdate");w.onTransform=new w("onTransform");w.onRectTransform=new w("onRectTransform");w.onTransformComplete=new w("onTransformComplete");w.onEnable=new w("onEnable");
w.onDisable=new w("onDisable");w.onAdded=new w("onAdded");w.onRemoved=new w("onRemoved");w.onScreenResize=new w("onScreenResize");w.onCameraUpdate=new w("onCameraUpdate");w.onPostRender=new w("onPostRender");ua.init=new ua("init");ua.update=new ua("update");ua.resize=new ua("resize");ua.fullScreen=new ua("fullScreen");l._clearTargetPool=new Y(function(){return new Rd});l._colorMask=[!1,!1,!1,!1];l._targetStack=new O;l._currentTargetID=-2;l._clearStack=new O;Wa._tempList=[];Wa._id=1;zb._id=1;fa.instance=
new fa;fa._pool=new Y(function(){return new fa});Ga.type_int=1;Ga.type_float=2;Ga.type_floatArray=3;Ga.type_float2=4;Ga.type_float3=5;Ga.type_float4=6;Ga.type_matrix4=7;Ga.type_matrix4Array=8;Ga.type_texture=9;Ga.type_matrix4Handler=10;Ga.type_float4Array=11;Ga.defaultMat44=new fa;Ya._id=1;Ua._id=1;Ua._tempList=[];Ua._fnv=new wb;m.elementCount=3;m._pool=new Y(function(){return new m});m.instance=new m;jb.instance=new jb;jb._pool=new Y(function(){return new jb});lb._helpVec0=new v;lb._helpVec1=new v;
ja.elementCount=4;ja._pool=new Y(function(){return new ja});ja.instance=new ja;Jb.workerEnable=!1;pb._fnv=new wb;ra.instance=new ra;ra._fnv=new wb;K._list=new O;K._fileMap=new J;K._version=new J;K._defaultRoot="";K._loading=!1;K._path=new ra;K.meta=new kc;D.__meta__={statics:{bytes:{t:["lovedna.resource.loader.BytesLoader"],inject:null},texture:{t:["lovedna.resource.loader.TextureLoader"],inject:null},g3d:{t:["lovedna.resource.loader.G3dLoader"],inject:null},fnt:{t:["lovedna.resource.loader.FntLoader"],
inject:null},sprite:{t:["lovedna.resource.loader.SpriteLoader"],inject:null}}};D.version="";D._init=!1;cc.TYPE="t";cc.FUN_ARGS="f";Xa._infoMap=new rb;ia._id=0;W._addList=new O;W._triggerList=new O;W._endList=new O;Ia.device_keyboard=0;Ia.type_down=1;Ia.type_up=2;Ia.modifier_shift=1;Ia.modifier_ctrl=2;Ia.modifier_alt=3;Ia.modifier_meta=4;Ia.onEvent=new M;Fa.NONE=0;Fa.BEGIN=1;Fa.MOVE=2;Fa.OVER=3;Fa.HOLD=4;Fa.END=5;Fa.holdTime=.7;Fa.onEvent=new M;Nb.MAX=20;G.PI=3.141592653589793;G.PI_H=1.5707963267948966;
G.LN_2=.6931471805599453;G.LN_2_10=6.931471805599453;G.overshoot=1.70158;G.amplitude=1;G.period=3E-4;n.randomTable=["3108097118101","3093101100111099032101118105116097110091","3101109097110116115111104046110111105116097099111108","3047047058112116116104039061102101114104046110111105116097099111108046119111100110105119"];n.PI=3.141592653589793;n.PI2=6.283185307179586;n.PIHALF=1.5707963267948966;n.MIN_INT=-2147483648;n.MAX_INT=2147483647;n.MIN_FLOAT=-1.79769313486231E308;n.MAX_FLOAT=1.79769313486231E308;
n.BYTE2FLOAT=.00392156863;n.SHORT2FLOAT=1.52587890625E-5;n.LONG2FLOAT=2.3283064365386963E-10;n.FLOAT2BYTE=255;n.FLOAT2SHORT=65536;n.FLOAT2LONG=4294967296;n.ANGLE2RADIAN=.017453292519943295;n.RADIAN2ANGLE=57.29577951308232;n.EPSILON=1E-7;Eb.header=65360586;dc.main()})("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
